Using device: cuda
PermutedDKT
Number of questions:  807
Number of students:  4
Number of concepts: 636
Using batch size: 32
Using batch size: 32
Using device: cuda
PermutedDKT
Number of questions:  807
Number of students:  4
Number of concepts: 636
Using batch size: 32
Using batch size: 32
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   14885 KB |   14885 KB |   14885 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2241 KB |    2241 KB |    2241 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   14885 KB |   14885 KB |   14885 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2241 KB |    2241 KB |    2241 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   24576 KB |   24576 KB |   24576 KB |       0 B  |
|       from large pool |   20480 KB |   20480 KB |   20480 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    9691 KB |   19456 KB |   21504 KB |   11813 KB |
|       from large pool |    7836 KB |   18899 KB |   18899 KB |   11063 KB |
|       from small pool |    1855 KB |    1859 KB |    2605 KB |     750 KB |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Successfull in data prepration!
Successfully loaded the optimizer

======== Epoch 1 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01

tensor([[-1.1231e-03, -1.5673e-03,  2.6431e-05,  ...,  1.9126e-03,
         -8.0316e-04,  2.9957e-03],
        [ 2.2939e-04,  3.7142e-03,  3.3395e-03,  ...,  2.7820e-03,
          2.4658e-03,  3.2105e-03],
        [-2.1529e-03, -3.5113e-03, -7.5788e-04,  ...,  1.0984e-03,
          3.5025e-03, -3.4750e-03],
        ...,
        [-3.1647e-03,  3.7014e-03, -1.4289e-03,  ..., -1.4431e-03,
         -1.2107e-05, -3.1672e-03],
        [ 6.7138e-04, -2.5985e-03, -2.2874e-03,  ...,  2.5131e-03,
         -5.9929e-04, -2.8312e-03],
        [ 1.5101e-03, -6.2271e-04,  2.9718e-03,  ..., -5.1603e-04,
         -3.6196e-03, -2.7177e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
tensor([[-1.1231e-03, -1.5673e-03,  2.6431e-05,  ...,  1.9126e-03,
         -8.0316e-04,  2.9957e-03],
        [ 2.2939e-04,  3.7142e-03,  3.3395e-03,  ...,  2.7820e-03,
          2.4658e-03,  3.2105e-03],
        [-2.1529e-03, -3.5113e-03, -7.5788e-04,  ...,  1.0984e-03,
          3.5025e-03, -3.4750e-03],
        ...,
        [-3.1647e-03,  3.7014e-03, -1.4289e-03,  ..., -1.4431e-03,
         -1.2107e-05, -3.1672e-03],
        [ 6.7138e-04, -2.5985e-03, -2.2874e-03,  ...,  2.5131e-03,
         -5.9929e-04, -2.8312e-03],
        [ 1.5101e-03, -6.2271e-04,  2.9718e-03,  ..., -5.1603e-04,
         -3.6196e-03, -2.7177e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6450], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69264 KB |   75722 KB |  120244 KB |   50980 KB |
|       from large pool |   50936 KB |   55485 KB |   77738 KB |   26801 KB |
|       from small pool |   18328 KB |   20249 KB |   42506 KB |   24178 KB |
|---------------------------------------------------------------------------|
| Active memory         |   69264 KB |   75722 KB |  120244 KB |   50980 KB |
|       from large pool |   50936 KB |   55485 KB |   77738 KB |   26801 KB |
|       from small pool |   18328 KB |   20249 KB |   42506 KB |   24178 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   94208 KB |   94208 KB |   94208 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   20480 KB |   20480 KB |   20480 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   24943 KB |   24943 KB |  132823 KB |  107880 KB |
|       from large pool |   22791 KB |   22791 KB |   90619 KB |   67828 KB |
|       from small pool |    2152 KB |    2152 KB |   42204 KB |   40052 KB |
|---------------------------------------------------------------------------|
| Allocations           |    5706    |    5716    |   14664    |    8958    |
|       from large pool |      31    |      33    |      39    |       8    |
|       from small pool |    5675    |    5684    |   14625    |    8950    |
|---------------------------------------------------------------------------|
| Active allocs         |    5706    |    5716    |   14664    |    8958    |
|       from large pool |      31    |      33    |      39    |       8    |
|       from small pool |    5675    |    5684    |   14625    |    8950    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |      10    |      10    |      10    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |      18    |    3299    |    3283    |
|       from large pool |       3    |       3    |       7    |       4    |
|       from small pool |      13    |      15    |    3292    |    3279    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   76273 KB |  104841 KB |   35033 KB |
|       from large pool |   53741 KB |   58290 KB |   64612 KB |   10871 KB |
|       from small pool |   16067 KB |   17995 KB |   40229 KB |   24162 KB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   76273 KB |  104841 KB |   35033 KB |
|       from large pool |   53741 KB |   58290 KB |   64612 KB |   10871 KB |
|       from small pool |   16067 KB |   17995 KB |   40229 KB |   24162 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   22351 KB |  121489 KB |   99137 KB |
|       from large pool |   19986 KB |   19989 KB |   65564 KB |   45577 KB |
|       from small pool |    2365 KB |    2365 KB |   55925 KB |   53560 KB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |   14628    |    8936    |
|       from large pool |      25    |      27    |      31    |       6    |
|       from small pool |    5667    |    5678    |   14597    |    8930    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |   14628    |    8936    |
|       from large pool |      25    |      27    |      31    |       6    |
|       from small pool |    5667    |    5678    |   14597    |    8930    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |      15    |    3467    |    3452    |
|       from large pool |       3    |       3    |       6    |       3    |
|       from small pool |      12    |      12    |    3461    |    3449    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01

Parameter containing:
tensor([[-1.1229e-03, -1.5671e-03,  2.6663e-05,  ...,  1.9124e-03,
         -8.0339e-04,  2.9955e-03],
        [ 2.1877e-04,  3.7035e-03,  3.3289e-03,  ...,  2.7926e-03,
          2.4764e-03,  3.2212e-03],
        [-2.1374e-03, -3.4959e-03, -7.4242e-04,  ...,  1.0829e-03,
          3.4869e-03, -3.4904e-03],
        ...,
        [-3.1549e-03,  3.7113e-03, -1.4191e-03,  ..., -1.4528e-03,
         -2.1933e-05, -3.1770e-03],
        [ 6.7420e-04, -2.5957e-03, -2.2846e-03,  ...,  2.5103e-03,
         -6.0209e-04, -2.8340e-03],
        [ 1.4587e-03, -6.7381e-04,  2.9205e-03,  ..., -4.6504e-04,
         -3.5687e-03, -2.6666e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1229e-03, -1.5671e-03,  2.6663e-05,  ...,  1.9124e-03,
         -8.0339e-04,  2.9955e-03],
        [ 2.1877e-04,  3.7035e-03,  3.3289e-03,  ...,  2.7926e-03,
          2.4764e-03,  3.2212e-03],
        [-2.1374e-03, -3.4959e-03, -7.4242e-04,  ...,  1.0829e-03,
          3.4869e-03, -3.4904e-03],
        ...,
        [-3.1549e-03,  3.7113e-03, -1.4191e-03,  ..., -1.4528e-03,
         -2.1933e-05, -3.1770e-03],
        [ 6.7420e-04, -2.5957e-03, -2.2846e-03,  ...,  2.5103e-03,
         -6.0209e-04, -2.8340e-03],
        [ 1.4587e-03, -6.7381e-04,  2.9205e-03,  ..., -4.6504e-04,
         -3.5687e-03, -2.6666e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 2 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0 
1
tensor([[-1.1229e-03, -1.5671e-03,  2.6663e-05,  ...,  1.9124e-03,
         -8.0339e-04,  2.9955e-03],
        [ 2.1877e-04,  3.7035e-03,  3.3289e-03,  ...,  2.7926e-03,
          2.4764e-03,  3.2212e-03],
        [-2.1374e-03, -3.4959e-03, -7.4242e-04,  ...,  1.0829e-03,
          3.4869e-03, -3.4904e-03],
        ...,
        [-3.1549e-03,  3.7113e-03, -1.4191e-03,  ..., -1.4528e-03,
         -2.1933e-05, -3.1770e-03],
        [ 6.7420e-04, -2.5957e-03, -2.2846e-03,  ...,  2.5103e-03,
         -6.0209e-04, -2.8340e-03],
        [ 1.4587e-03, -6.7381e-04,  2.9205e-03,  ..., -4.6504e-04,
         -3.5687e-03, -2.6666e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1229e-03, -1.5671e-03,  2.6663e-05,  ...,  1.9124e-03,
         -8.0339e-04,  2.9955e-03],
        [ 2.1877e-04,  3.7035e-03,  3.3289e-03,  ...,  2.7926e-03,
          2.4764e-03,  3.2212e-03],
        [-2.1374e-03, -3.4959e-03, -7.4242e-04,  ...,  1.0829e-03,
          3.4869e-03, -3.4904e-03],
        ...,
        [-3.1549e-03,  3.7113e-03, -1.4191e-03,  ..., -1.4528e-03,
         -2.1933e-05, -3.1770e-03],
        [ 6.7420e-04, -2.5957e-03, -2.2846e-03,  ...,  2.5103e-03,
         -6.0209e-04, -2.8340e-03],
        [ 1.4587e-03, -6.7381e-04,  2.9205e-03,  ..., -4.6504e-04,
         -3.5687e-03, -2.6666e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6437], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  132982 KB |   15556 MB |   15432 MB |
|       from large pool |  101446 KB |  105995 KB |   15375 MB |   15276 MB |
|       from small pool |   25077 KB |   26999 KB |     181 MB |     156 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  132982 KB |   15556 MB |   15432 MB |
|       from large pool |  101446 KB |  105995 KB |   15375 MB |   15276 MB |
|       from small pool |   25077 KB |   26999 KB |     181 MB |     156 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   54636 KB |   15678 MB |   15650 MB |
|       from large pool |   25530 KB |   42425 KB |   15476 MB |   15451 MB |
|       from small pool |    3594 KB |   14091 KB |     202 MB |     198 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |   72404    |   66653    |
|       from large pool |      55    |      57    |    9913    |    9858    |
|       from small pool |    5696    |    5706    |   62491    |   56795    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |   72404    |   66653    |
|       from large pool |      55    |      57    |    9913    |    9858    |
|       from small pool |    5696    |    5706    |   62491    |   56795    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     818    |   36164    |   36141    |
|       from large pool |       5    |       7    |    7670    |    7665    |
|       from small pool |      18    |     815    |   28494    |   28476    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |   15746 MB |   15678 MB |
|       from large pool |   53741 KB |   66810 KB |   15578 MB |   15525 MB |
|       from small pool |   16067 KB |   17995 KB |     168 MB |     152 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |   15746 MB |   15678 MB |
|       from large pool |   53741 KB |   66810 KB |   15578 MB |   15525 MB |
|       from small pool |   16067 KB |   17995 KB |     168 MB |     152 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |   15837 MB |   15816 MB |
|       from large pool |   19986 KB |   56698 KB |   15610 MB |   15590 MB |
|       from small pool |    2365 KB |    9601 KB |     227 MB |     225 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |   72235    |   66543    |
|       from large pool |      25    |      33    |    9867    |    9842    |
|       from small pool |    5667    |    5678    |   62368    |   56701    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |   72235    |   66543    |
|       from large pool |      25    |      33    |    9867    |    9842    |
|       from small pool |    5667    |    5678    |   62368    |   56701    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |   38035    |   38020    |
|       from large pool |       3    |       7    |    8369    |    8366    |
|       from small pool |      12    |     817    |   29666    |   29654    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0 
1
Parameter containing:
tensor([[-1.1225e-03, -1.5667e-03,  2.7063e-05,  ...,  1.9120e-03,
         -8.0378e-04,  2.9951e-03],
        [ 2.0890e-04,  3.6936e-03,  3.3190e-03,  ...,  2.8025e-03,
          2.4863e-03,  3.2311e-03],
        [-2.1169e-03, -3.4755e-03, -7.2201e-04,  ...,  1.0624e-03,
          3.4662e-03, -3.5108e-03],
        ...,
        [-3.1415e-03,  3.7248e-03, -1.4058e-03,  ..., -1.4661e-03,
         -3.5314e-05, -3.1903e-03],
        [ 6.8390e-04, -2.5861e-03, -2.2750e-03,  ...,  2.5006e-03,
         -6.1174e-04, -2.8436e-03],
        [ 1.2832e-03, -8.4853e-04,  2.7454e-03,  ..., -2.9055e-04,
         -3.3945e-03, -2.4919e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1225e-03, -1.5667e-03,  2.7063e-05,  ...,  1.9120e-03,
         -8.0378e-04,  2.9951e-03],
        [ 2.0890e-04,  3.6936e-03,  3.3190e-03,  ...,  2.8025e-03,
          2.4863e-03,  3.2311e-03],
        [-2.1169e-03, -3.4755e-03, -7.2201e-04,  ...,  1.0624e-03,
          3.4662e-03, -3.5108e-03],
        ...,
        [-3.1415e-03,  3.7248e-03, -1.4058e-03,  ..., -1.4661e-03,
         -3.5314e-05, -3.1903e-03],
        [ 6.8390e-04, -2.5861e-03, -2.2750e-03,  ...,  2.5006e-03,
         -6.1174e-04, -2.8436e-03],
        [ 1.2832e-03, -8.4853e-04,  2.7454e-03,  ..., -2.9055e-04,
         -3.3945e-03, -2.4919e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 3 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01

tensor([[-1.1225e-03, -1.5667e-03,  2.7063e-05,  ...,  1.9120e-03,
         -8.0378e-04,  2.9951e-03],
        [ 2.0890e-04,  3.6936e-03,  3.3190e-03,  ...,  2.8025e-03,
          2.4863e-03,  3.2311e-03],
        [-2.1169e-03, -3.4755e-03, -7.2201e-04,  ...,  1.0624e-03,
          3.4662e-03, -3.5108e-03],
        ...,
        [-3.1415e-03,  3.7248e-03, -1.4058e-03,  ..., -1.4661e-03,
         -3.5314e-05, -3.1903e-03],
        [ 6.8390e-04, -2.5861e-03, -2.2750e-03,  ...,  2.5006e-03,
         -6.1174e-04, -2.8436e-03],
        [ 1.2832e-03, -8.4853e-04,  2.7454e-03,  ..., -2.9055e-04,
         -3.3945e-03, -2.4919e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1225e-03, -1.5667e-03,  2.7063e-05,  ...,  1.9120e-03,
         -8.0378e-04,  2.9951e-03],
        [ 2.0890e-04,  3.6936e-03,  3.3190e-03,  ...,  2.8025e-03,
          2.4863e-03,  3.2311e-03],
        [-2.1169e-03, -3.4755e-03, -7.2201e-04,  ...,  1.0624e-03,
          3.4662e-03, -3.5108e-03],
        ...,
        [-3.1415e-03,  3.7248e-03, -1.4058e-03,  ..., -1.4661e-03,
         -3.5314e-05, -3.1903e-03],
        [ 6.8390e-04, -2.5861e-03, -2.2750e-03,  ...,  2.5006e-03,
         -6.1174e-04, -2.8436e-03],
        [ 1.2832e-03, -8.4853e-04,  2.7454e-03,  ..., -2.9055e-04,
         -3.3945e-03, -2.4919e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6425], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |   30961 MB |   30837 MB |
|       from large pool |  101446 KB |  114090 KB |   30646 MB |   30547 MB |
|       from small pool |   25077 KB |   26999 KB |     314 MB |     290 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |   30961 MB |   30837 MB |
|       from large pool |  101446 KB |  114090 KB |   30646 MB |   30547 MB |
|       from small pool |   25077 KB |   26999 KB |     314 MB |     290 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   54636 KB |   31159 MB |   31130 MB |
|       from large pool |   25530 KB |   44736 KB |   30799 MB |   30774 MB |
|       from small pool |    3594 KB |   14091 KB |     360 MB |     356 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  130104    |  124353    |
|       from large pool |      55    |      63    |   19765    |   19710    |
|       from small pool |    5696    |    5706    |  110339    |  104643    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  130104    |  124353    |
|       from large pool |      55    |      63    |   19765    |   19710    |
|       from small pool |    5696    |    5706    |  110339    |  104643    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |     825    |   70930    |   70906    |
|       from large pool |       5    |       9    |   15332    |   15327    |
|       from small pool |      19    |     820    |   55598    |   55579    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |   31390 MB |   31322 MB |
|       from large pool |   53741 KB |   66810 KB |   31093 MB |   31041 MB |
|       from small pool |   16067 KB |   17995 KB |     297 MB |     281 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |   31390 MB |   31322 MB |
|       from large pool |   53741 KB |   66810 KB |   31093 MB |   31041 MB |
|       from small pool |   16067 KB |   17995 KB |     297 MB |     281 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |   31557 MB |   31535 MB |
|       from large pool |   19986 KB |   56698 KB |   31156 MB |   31136 MB |
|       from small pool |    2365 KB |    9601 KB |     401 MB |     398 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  129842    |  124150    |
|       from large pool |      25    |      33    |   19703    |   19678    |
|       from small pool |    5667    |    5678    |  110139    |  104472    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  129842    |  124150    |
|       from large pool |      25    |      33    |   19703    |   19678    |
|       from small pool |    5667    |    5678    |  110139    |  104472    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |   72603    |   72588    |
|       from large pool |       3    |       7    |   16732    |   16729    |
|       from small pool |      12    |     817    |   55871    |   55859    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01

Parameter containing:
tensor([[-1.1219e-03, -1.5662e-03,  2.7572e-05,  ...,  1.9114e-03,
         -8.0427e-04,  2.9946e-03],
        [ 1.9973e-04,  3.6844e-03,  3.3098e-03,  ...,  2.8116e-03,
          2.4955e-03,  3.2403e-03],
        [-2.0930e-03, -3.4518e-03, -6.9821e-04,  ...,  1.0386e-03,
          3.4422e-03, -3.5346e-03],
        ...,
        [-3.1257e-03,  3.7408e-03, -1.3900e-03,  ..., -1.4819e-03,
         -5.1211e-05, -3.2062e-03],
        [ 6.9877e-04, -2.5714e-03, -2.2603e-03,  ...,  2.4857e-03,
         -6.2651e-04, -2.8584e-03],
        [ 1.0702e-03, -1.0610e-03,  2.5326e-03,  ..., -7.8305e-05,
         -3.1825e-03, -2.2794e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1219e-03, -1.5662e-03,  2.7572e-05,  ...,  1.9114e-03,
         -8.0427e-04,  2.9946e-03],
        [ 1.9973e-04,  3.6844e-03,  3.3098e-03,  ...,  2.8116e-03,
          2.4955e-03,  3.2403e-03],
        [-2.0930e-03, -3.4518e-03, -6.9821e-04,  ...,  1.0386e-03,
          3.4422e-03, -3.5346e-03],
        ...,
        [-3.1257e-03,  3.7408e-03, -1.3900e-03,  ..., -1.4819e-03,
         -5.1211e-05, -3.2062e-03],
        [ 6.9877e-04, -2.5714e-03, -2.2603e-03,  ...,  2.4857e-03,
         -6.2651e-04, -2.8584e-03],
        [ 1.0702e-03, -1.0610e-03,  2.5326e-03,  ..., -7.8305e-05,
         -3.1825e-03, -2.2794e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 4 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0 
1
tensor([[-1.1219e-03, -1.5662e-03,  2.7572e-05,  ...,  1.9114e-03,
         -8.0427e-04,  2.9946e-03],
        [ 1.9973e-04,  3.6844e-03,  3.3098e-03,  ...,  2.8116e-03,
          2.4955e-03,  3.2403e-03],
        [-2.0930e-03, -3.4518e-03, -6.9821e-04,  ...,  1.0386e-03,
          3.4422e-03, -3.5346e-03],
        ...,
        [-3.1257e-03,  3.7408e-03, -1.3900e-03,  ..., -1.4819e-03,
         -5.1211e-05, -3.2062e-03],
        [ 6.9877e-04, -2.5714e-03, -2.2603e-03,  ...,  2.4857e-03,
         -6.2651e-04, -2.8584e-03],
        [ 1.0702e-03, -1.0610e-03,  2.5326e-03,  ..., -7.8305e-05,
         -3.1825e-03, -2.2794e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1219e-03, -1.5662e-03,  2.7572e-05,  ...,  1.9114e-03,
         -8.0427e-04,  2.9946e-03],
        [ 1.9973e-04,  3.6844e-03,  3.3098e-03,  ...,  2.8116e-03,
          2.4955e-03,  3.2403e-03],
        [-2.0930e-03, -3.4518e-03, -6.9821e-04,  ...,  1.0386e-03,
          3.4422e-03, -3.5346e-03],
        ...,
        [-3.1257e-03,  3.7408e-03, -1.3900e-03,  ..., -1.4819e-03,
         -5.1211e-05, -3.2062e-03],
        [ 6.9877e-04, -2.5714e-03, -2.2603e-03,  ...,  2.4857e-03,
         -6.2651e-04, -2.8584e-03],
        [ 1.0702e-03, -1.0610e-03,  2.5326e-03,  ..., -7.8305e-05,
         -3.1825e-03, -2.2794e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6415], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |   46365 MB |   46241 MB |
|       from large pool |  101446 KB |  114090 KB |   45917 MB |   45817 MB |
|       from small pool |   25077 KB |   26999 KB |     448 MB |     423 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |   46365 MB |   46241 MB |
|       from large pool |  101446 KB |  114090 KB |   45917 MB |   45817 MB |
|       from small pool |   25077 KB |   26999 KB |     448 MB |     423 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   54721 KB |   46638 MB |   46610 MB |
|       from large pool |   25530 KB |   45163 KB |   46120 MB |   46096 MB |
|       from small pool |    3594 KB |   14091 KB |     517 MB |     514 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  187804    |  182053    |
|       from large pool |      55    |      63    |   29617    |   29562    |
|       from small pool |    5696    |    5706    |  158187    |  152491    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  187804    |  182053    |
|       from large pool |      55    |      63    |   29617    |   29562    |
|       from small pool |    5696    |    5706    |  158187    |  152491    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |     825    |  104009    |  103985    |
|       from large pool |       5    |       9    |   22993    |   22988    |
|       from small pool |      19    |     820    |   81016    |   80997    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |   47034 MB |   46966 MB |
|       from large pool |   53741 KB |   66810 KB |   46608 MB |   46556 MB |
|       from small pool |   16067 KB |   17995 KB |     425 MB |     410 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |   47034 MB |   46966 MB |
|       from large pool |   53741 KB |   66810 KB |   46608 MB |   46556 MB |
|       from small pool |   16067 KB |   17995 KB |     425 MB |     410 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |   47276 MB |   47254 MB |
|       from large pool |   19986 KB |   56698 KB |   46702 MB |   46682 MB |
|       from small pool |    2365 KB |    9601 KB |     574 MB |     572 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  187449    |  181757    |
|       from large pool |      25    |      33    |   29539    |   29514    |
|       from small pool |    5667    |    5678    |  157910    |  152243    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  187449    |  181757    |
|       from large pool |      25    |      33    |   29539    |   29514    |
|       from small pool |    5667    |    5678    |  157910    |  152243    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |  107171    |  107156    |
|       from large pool |       3    |       7    |   25095    |   25092    |
|       from small pool |      12    |     817    |   82076    |   82064    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[-1.1214e-03, -1.5656e-03,  2.8144e-05,  ...,  1.9109e-03,
         -8.0483e-04,  2.9940e-03],
        [ 1.9130e-04,  3.6759e-03,  3.3014e-03,  ...,  2.8200e-03,
          2.5039e-03,  3.2488e-03],
        [-2.0672e-03, -3.4261e-03, -6.7247e-04,  ...,  1.0127e-03,
          3.4162e-03, -3.5604e-03],
        ...,
        [-3.1083e-03,  3.7583e-03, -1.3726e-03,  ..., -1.4992e-03,
         -6.8618e-05, -3.2235e-03],
        [ 7.1715e-04, -2.5532e-03, -2.2421e-03,  ...,  2.4674e-03,
         -6.4478e-04, -2.8767e-03],
        [ 8.5228e-04, -1.2783e-03,  2.3149e-03,  ...,  1.3891e-04,
         -2.9655e-03, -2.0621e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1214e-03, -1.5656e-03,  2.8144e-05,  ...,  1.9109e-03,
         -8.0483e-04,  2.9940e-03],
        [ 1.9130e-04,  3.6759e-03,  3.3014e-03,  ...,  2.8200e-03,
          2.5039e-03,  3.2488e-03],
        [-2.0672e-03, -3.4261e-03, -6.7247e-04,  ...,  1.0127e-03,
          3.4162e-03, -3.5604e-03],
        ...,
        [-3.1083e-03,  3.7583e-03, -1.3726e-03,  ..., -1.4992e-03,
         -6.8618e-05, -3.2235e-03],
        [ 7.1715e-04, -2.5532e-03, -2.2421e-03,  ...,  2.4674e-03,
         -6.4478e-04, -2.8767e-03],
        [ 8.5228e-04, -1.2783e-03,  2.3149e-03,  ...,  1.3891e-04,
         -2.9655e-03, -2.0621e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 5 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0 
1
tensor([[-1.1214e-03, -1.5656e-03,  2.8144e-05,  ...,  1.9109e-03,
         -8.0483e-04,  2.9940e-03],
        [ 1.9130e-04,  3.6759e-03,  3.3014e-03,  ...,  2.8200e-03,
          2.5039e-03,  3.2488e-03],
        [-2.0672e-03, -3.4261e-03, -6.7247e-04,  ...,  1.0127e-03,
          3.4162e-03, -3.5604e-03],
        ...,
        [-3.1083e-03,  3.7583e-03, -1.3726e-03,  ..., -1.4992e-03,
         -6.8618e-05, -3.2235e-03],
        [ 7.1715e-04, -2.5532e-03, -2.2421e-03,  ...,  2.4674e-03,
         -6.4478e-04, -2.8767e-03],
        [ 8.5228e-04, -1.2783e-03,  2.3149e-03,  ...,  1.3891e-04,
         -2.9655e-03, -2.0621e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1214e-03, -1.5656e-03,  2.8144e-05,  ...,  1.9109e-03,
         -8.0483e-04,  2.9940e-03],
        [ 1.9130e-04,  3.6759e-03,  3.3014e-03,  ...,  2.8200e-03,
          2.5039e-03,  3.2488e-03],
        [-2.0672e-03, -3.4261e-03, -6.7247e-04,  ...,  1.0127e-03,
          3.4162e-03, -3.5604e-03],
        ...,
        [-3.1083e-03,  3.7583e-03, -1.3726e-03,  ..., -1.4992e-03,
         -6.8618e-05, -3.2235e-03],
        [ 7.1715e-04, -2.5532e-03, -2.2421e-03,  ...,  2.4674e-03,
         -6.4478e-04, -2.8767e-03],
        [ 8.5228e-04, -1.2783e-03,  2.3149e-03,  ...,  1.3891e-04,
         -2.9655e-03, -2.0621e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6405], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |   61768 MB |   61645 MB |
|       from large pool |  101446 KB |  114090 KB |   61187 MB |   61088 MB |
|       from small pool |   25077 KB |   26999 KB |     581 MB |     556 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |   61768 MB |   61645 MB |
|       from large pool |  101446 KB |  114090 KB |   61187 MB |   61088 MB |
|       from small pool |   25077 KB |   26999 KB |     581 MB |     556 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   54721 KB |   62118 MB |   62089 MB |
|       from large pool |   25530 KB |   45163 KB |   61442 MB |   61417 MB |
|       from small pool |    3594 KB |   14091 KB |     675 MB |     671 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  245504    |  239753    |
|       from large pool |      55    |      63    |   39469    |   39414    |
|       from small pool |    5696    |    5706    |  206035    |  200339    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  245504    |  239753    |
|       from large pool |      55    |      63    |   39469    |   39414    |
|       from small pool |    5696    |    5706    |  206035    |  200339    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     825    |  137945    |  137922    |
|       from large pool |       5    |       9    |   30654    |   30649    |
|       from small pool |      18    |     820    |  107291    |  107273    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |   62678 MB |   62610 MB |
|       from large pool |   53741 KB |   66810 KB |   62123 MB |   62071 MB |
|       from small pool |   16067 KB |   17995 KB |     554 MB |     539 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |   62678 MB |   62610 MB |
|       from large pool |   53741 KB |   66810 KB |   62123 MB |   62071 MB |
|       from small pool |   16067 KB |   17995 KB |     554 MB |     539 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |   62995 MB |   62973 MB |
|       from large pool |   19986 KB |   56698 KB |   62248 MB |   62228 MB |
|       from small pool |    2365 KB |    9601 KB |     747 MB |     745 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  245056    |  239364    |
|       from large pool |      25    |      33    |   39375    |   39350    |
|       from small pool |    5667    |    5678    |  205681    |  200014    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  245056    |  239364    |
|       from large pool |      25    |      33    |   39375    |   39350    |
|       from small pool |    5667    |    5678    |  205681    |  200014    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |  141739    |  141724    |
|       from large pool |       3    |       7    |   33458    |   33455    |
|       from small pool |      12    |     817    |  108281    |  108269    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
Parameter containing:
tensor([[-1.1208e-03, -1.5650e-03,  2.8741e-05,  ...,  1.9103e-03,
         -8.0541e-04,  2.9934e-03],
        [ 1.8370e-04,  3.6682e-03,  3.2938e-03,  ...,  2.8276e-03,
          2.5115e-03,  3.2564e-03],
        [-2.0409e-03, -3.4000e-03, -6.4628e-04,  ...,  9.8649e-04,
          3.3897e-03, -3.5865e-03],
        ...,
        [-3.0904e-03,  3.7763e-03, -1.3548e-03,  ..., -1.5170e-03,
         -8.6518e-05, -3.2414e-03],
        [ 7.3743e-04, -2.5331e-03, -2.2220e-03,  ...,  2.4472e-03,
         -6.6494e-04, -2.8968e-03],
        [ 6.4633e-04, -1.4839e-03,  2.1092e-03,  ...,  3.4436e-04,
         -2.7601e-03, -1.8565e-03]], device='cuda:0', requires_grad=True)
batch input size: torch.Size([1, 807]) Device: 1
tensor([[-1.1208e-03, -1.5650e-03,  2.8741e-05,  ...,  1.9103e-03,
         -8.0541e-04,  2.9934e-03],
        [ 1.8370e-04,  3.6682e-03,  3.2938e-03,  ...,  2.8276e-03,
          2.5115e-03,  3.2564e-03],
        [-2.0409e-03, -3.4000e-03, -6.4628e-04,  ...,  9.8649e-04,
          3.3897e-03, -3.5865e-03],
        ...,
        [-3.0904e-03,  3.7763e-03, -1.3548e-03,  ..., -1.5170e-03,
         -8.6518e-05, -3.2414e-03],
        [ 7.3743e-04, -2.5331e-03, -2.2220e-03,  ...,  2.4472e-03,
         -6.6494e-04, -2.8968e-03],
        [ 6.4633e-04, -1.4839e-03,  2.1092e-03,  ...,  3.4436e-04,
         -2.7601e-03, -1.8565e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 6 / 10 ========
Training...
Step: 0
batch input size: torch.Size([1, 807]) Device:batch input size:  0torch.Size([1, 807])
 Device: 1
tensor([[-1.1208e-03, -1.5650e-03,  2.8741e-05,  ...,  1.9103e-03,
         -8.0541e-04,  2.9934e-03],
        [ 1.8370e-04,  3.6682e-03,  3.2938e-03,  ...,  2.8276e-03,
          2.5115e-03,  3.2564e-03],
        [-2.0409e-03, -3.4000e-03, -6.4628e-04,  ...,  9.8649e-04,
          3.3897e-03, -3.5865e-03],
        ...,
        [-3.0904e-03,  3.7763e-03, -1.3548e-03,  ..., -1.5170e-03,
         -8.6518e-05, -3.2414e-03],
        [ 7.3743e-04, -2.5331e-03, -2.2220e-03,  ...,  2.4472e-03,
         -6.6494e-04, -2.8968e-03],
        [ 6.4633e-04, -1.4839e-03,  2.1092e-03,  ...,  3.4436e-04,
         -2.7601e-03, -1.8565e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1208e-03, -1.5650e-03,  2.8741e-05,  ...,  1.9103e-03,
         -8.0541e-04,  2.9934e-03],
        [ 1.8370e-04,  3.6682e-03,  3.2938e-03,  ...,  2.8276e-03,
          2.5115e-03,  3.2564e-03],
        [-2.0409e-03, -3.4000e-03, -6.4628e-04,  ...,  9.8649e-04,
          3.3897e-03, -3.5865e-03],
        ...,
        [-3.0904e-03,  3.7763e-03, -1.3548e-03,  ..., -1.5170e-03,
         -8.6518e-05, -3.2414e-03],
        [ 7.3743e-04, -2.5331e-03, -2.2220e-03,  ...,  2.4472e-03,
         -6.6494e-04, -2.8968e-03],
        [ 6.4633e-04, -1.4839e-03,  2.1092e-03,  ...,  3.4436e-04,
         -2.7601e-03, -1.8565e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6396], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |   77172 MB |   77049 MB |
|       from large pool |  101446 KB |  114090 KB |   76458 MB |   76358 MB |
|       from small pool |   25077 KB |   26999 KB |     714 MB |     690 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |   77172 MB |   77049 MB |
|       from large pool |  101446 KB |  114090 KB |   76458 MB |   76358 MB |
|       from small pool |   25077 KB |   26999 KB |     714 MB |     690 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   54721 KB |   77597 MB |   77569 MB |
|       from large pool |   25530 KB |   45163 KB |   76764 MB |   76739 MB |
|       from small pool |    3594 KB |   14091 KB |     833 MB |     829 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  303204    |  297453    |
|       from large pool |      55    |      63    |   49321    |   49266    |
|       from small pool |    5696    |    5706    |  253883    |  248187    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  303204    |  297453    |
|       from large pool |      55    |      63    |   49321    |   49266    |
|       from small pool |    5696    |    5706    |  253883    |  248187    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     825    |  171873    |  171850    |
|       from large pool |       5    |       9    |   38315    |   38310    |
|       from small pool |      18    |     820    |  133558    |  133540    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |   78322 MB |   78254 MB |
|       from large pool |   53741 KB |   66810 KB |   77639 MB |   77586 MB |
|       from small pool |   16067 KB |   17995 KB |     683 MB |     667 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |   78322 MB |   78254 MB |
|       from large pool |   53741 KB |   66810 KB |   77639 MB |   77586 MB |
|       from small pool |   16067 KB |   17995 KB |     683 MB |     667 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |   78715 MB |   78693 MB |
|       from large pool |   19986 KB |   56698 KB |   77794 MB |   77774 MB |
|       from small pool |    2365 KB |    9601 KB |     920 MB |     918 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  302663    |  296971    |
|       from large pool |      25    |      33    |   49211    |   49186    |
|       from small pool |    5667    |    5678    |  253452    |  247785    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  302663    |  296971    |
|       from large pool |      25    |      33    |   49211    |   49186    |
|       from small pool |    5667    |    5678    |  253452    |  247785    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |  176307    |  176292    |
|       from large pool |       3    |       7    |   41821    |   41818    |
|       from small pool |      12    |     817    |  134486    |  134474    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[-1.1202e-03, -1.5645e-03,  2.9324e-05,  ...,  1.9097e-03,
         -8.0597e-04,  2.9928e-03],
        [ 1.7705e-04,  3.6615e-03,  3.2871e-03,  ...,  2.8342e-03,
          2.5182e-03,  3.2631e-03],
        [-2.0157e-03, -3.3748e-03, -6.2110e-04,  ...,  9.6124e-04,
          3.3643e-03, -3.6117e-03],
        ...,
        [-3.0731e-03,  3.7938e-03, -1.3375e-03,  ..., -1.5343e-03,
         -1.0388e-04, -3.2587e-03],
        [ 7.5800e-04, -2.5127e-03, -2.2017e-03,  ...,  2.4267e-03,
         -6.8539e-04, -2.9172e-03],
        [ 4.6234e-04, -1.6675e-03,  1.9253e-03,  ...,  5.2796e-04,
         -2.5766e-03, -1.6728e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1202e-03, -1.5645e-03,  2.9324e-05,  ...,  1.9097e-03,
         -8.0597e-04,  2.9928e-03],
        [ 1.7705e-04,  3.6615e-03,  3.2871e-03,  ...,  2.8342e-03,
          2.5182e-03,  3.2631e-03],
        [-2.0157e-03, -3.3748e-03, -6.2110e-04,  ...,  9.6124e-04,
          3.3643e-03, -3.6117e-03],
        ...,
        [-3.0731e-03,  3.7938e-03, -1.3375e-03,  ..., -1.5343e-03,
         -1.0388e-04, -3.2587e-03],
        [ 7.5800e-04, -2.5127e-03, -2.2017e-03,  ...,  2.4267e-03,
         -6.8539e-04, -2.9172e-03],
        [ 4.6234e-04, -1.6675e-03,  1.9253e-03,  ...,  5.2796e-04,
         -2.5766e-03, -1.6728e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 7 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0 
1
tensor([[-1.1202e-03, -1.5645e-03,  2.9324e-05,  ...,  1.9097e-03,
         -8.0597e-04,  2.9928e-03],
        [ 1.7705e-04,  3.6615e-03,  3.2871e-03,  ...,  2.8342e-03,
          2.5182e-03,  3.2631e-03],
        [-2.0157e-03, -3.3748e-03, -6.2110e-04,  ...,  9.6124e-04,
          3.3643e-03, -3.6117e-03],
        ...,
        [-3.0731e-03,  3.7938e-03, -1.3375e-03,  ..., -1.5343e-03,
         -1.0388e-04, -3.2587e-03],
        [ 7.5800e-04, -2.5127e-03, -2.2017e-03,  ...,  2.4267e-03,
         -6.8539e-04, -2.9172e-03],
        [ 4.6234e-04, -1.6675e-03,  1.9253e-03,  ...,  5.2796e-04,
         -2.5766e-03, -1.6728e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1202e-03, -1.5645e-03,  2.9324e-05,  ...,  1.9097e-03,
         -8.0597e-04,  2.9928e-03],
        [ 1.7705e-04,  3.6615e-03,  3.2871e-03,  ...,  2.8342e-03,
          2.5182e-03,  3.2631e-03],
        [-2.0157e-03, -3.3748e-03, -6.2110e-04,  ...,  9.6124e-04,
          3.3643e-03, -3.6117e-03],
        ...,
        [-3.0731e-03,  3.7938e-03, -1.3375e-03,  ..., -1.5343e-03,
         -1.0388e-04, -3.2587e-03],
        [ 7.5800e-04, -2.5127e-03, -2.2017e-03,  ...,  2.4267e-03,
         -6.8539e-04, -2.9172e-03],
        [ 4.6234e-04, -1.6675e-03,  1.9253e-03,  ...,  5.2796e-04,
         -2.5766e-03, -1.6728e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6389], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |   92576 MB |   92452 MB |
|       from large pool |  101446 KB |  114090 KB |   91728 MB |   91629 MB |
|       from small pool |   25077 KB |   26999 KB |     847 MB |     823 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |   92576 MB |   92452 MB |
|       from large pool |  101446 KB |  114090 KB |   91728 MB |   91629 MB |
|       from small pool |   25077 KB |   26999 KB |     847 MB |     823 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   56769 KB |   93075 MB |   93046 MB |
|       from large pool |   25530 KB |   45163 KB |   92086 MB |   92061 MB |
|       from small pool |    3594 KB |   14091 KB |     988 MB |     984 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  360904    |  355153    |
|       from large pool |      55    |      63    |   59173    |   59118    |
|       from small pool |    5696    |    5706    |  301731    |  296035    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  360904    |  355153    |
|       from large pool |      55    |      63    |   59173    |   59118    |
|       from small pool |    5696    |    5706    |  301731    |  296035    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      22    |     825    |  205641    |  205619    |
|       from large pool |       5    |       9    |   45976    |   45971    |
|       from small pool |      17    |     820    |  159665    |  159648    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |   93966 MB |   93898 MB |
|       from large pool |   53741 KB |   66810 KB |   93154 MB |   93101 MB |
|       from small pool |   16067 KB |   17995 KB |     812 MB |     796 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |   93966 MB |   93898 MB |
|       from large pool |   53741 KB |   66810 KB |   93154 MB |   93101 MB |
|       from small pool |   16067 KB |   17995 KB |     812 MB |     796 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |   94434 MB |   94412 MB |
|       from large pool |   19986 KB |   56698 KB |   93340 MB |   93320 MB |
|       from small pool |    2365 KB |    9601 KB |    1094 MB |    1091 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  360270    |  354578    |
|       from large pool |      25    |      33    |   59047    |   59022    |
|       from small pool |    5667    |    5678    |  301223    |  295556    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  360270    |  354578    |
|       from large pool |      25    |      33    |   59047    |   59022    |
|       from small pool |    5667    |    5678    |  301223    |  295556    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |  210875    |  210860    |
|       from large pool |       3    |       7    |   50184    |   50181    |
|       from small pool |      12    |     817    |  160691    |  160679    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: torch.Size([1, 807]) batch input size:Device:  torch.Size([1, 807])0 
Device: 1
Parameter containing:
tensor([[-1.1197e-03, -1.5639e-03,  2.9860e-05,  ...,  1.9092e-03,
         -8.0649e-04,  2.9922e-03],
        [ 1.7146e-04,  3.6559e-03,  3.2815e-03,  ...,  2.8398e-03,
          2.5238e-03,  3.2687e-03],
        [-1.9929e-03, -3.3522e-03, -5.9838e-04,  ...,  9.3846e-04,
          3.3414e-03, -3.6345e-03],
        ...,
        [-3.0573e-03,  3.8097e-03, -1.3218e-03,  ..., -1.5500e-03,
         -1.1966e-04, -3.2744e-03],
        [ 7.7727e-04, -2.4936e-03, -2.1826e-03,  ...,  2.4074e-03,
         -7.0455e-04, -2.9364e-03],
        [ 3.0711e-04, -1.8225e-03,  1.7702e-03,  ...,  6.8292e-04,
         -2.4218e-03, -1.5177e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1197e-03, -1.5639e-03,  2.9860e-05,  ...,  1.9092e-03,
         -8.0649e-04,  2.9922e-03],
        [ 1.7146e-04,  3.6559e-03,  3.2815e-03,  ...,  2.8398e-03,
          2.5238e-03,  3.2687e-03],
        [-1.9929e-03, -3.3522e-03, -5.9838e-04,  ...,  9.3846e-04,
          3.3414e-03, -3.6345e-03],
        ...,
        [-3.0573e-03,  3.8097e-03, -1.3218e-03,  ..., -1.5500e-03,
         -1.1966e-04, -3.2744e-03],
        [ 7.7727e-04, -2.4936e-03, -2.1826e-03,  ...,  2.4074e-03,
         -7.0455e-04, -2.9364e-03],
        [ 3.0711e-04, -1.8225e-03,  1.7702e-03,  ...,  6.8292e-04,
         -2.4218e-03, -1.5177e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 8 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0 
1
tensor([[-1.1197e-03, -1.5639e-03,  2.9860e-05,  ...,  1.9092e-03,
         -8.0649e-04,  2.9922e-03],
        [ 1.7146e-04,  3.6559e-03,  3.2815e-03,  ...,  2.8398e-03,
          2.5238e-03,  3.2687e-03],
        [-1.9929e-03, -3.3522e-03, -5.9838e-04,  ...,  9.3846e-04,
          3.3414e-03, -3.6345e-03],
        ...,
        [-3.0573e-03,  3.8097e-03, -1.3218e-03,  ..., -1.5500e-03,
         -1.1966e-04, -3.2744e-03],
        [ 7.7727e-04, -2.4936e-03, -2.1826e-03,  ...,  2.4074e-03,
         -7.0455e-04, -2.9364e-03],
        [ 3.0711e-04, -1.8225e-03,  1.7702e-03,  ...,  6.8292e-04,
         -2.4218e-03, -1.5177e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1197e-03, -1.5639e-03,  2.9860e-05,  ...,  1.9092e-03,
         -8.0649e-04,  2.9922e-03],
        [ 1.7146e-04,  3.6559e-03,  3.2815e-03,  ...,  2.8398e-03,
          2.5238e-03,  3.2687e-03],
        [-1.9929e-03, -3.3522e-03, -5.9838e-04,  ...,  9.3846e-04,
          3.3414e-03, -3.6345e-03],
        ...,
        [-3.0573e-03,  3.8097e-03, -1.3218e-03,  ..., -1.5500e-03,
         -1.1966e-04, -3.2744e-03],
        [ 7.7727e-04, -2.4936e-03, -2.1826e-03,  ...,  2.4074e-03,
         -7.0455e-04, -2.9364e-03],
        [ 3.0711e-04, -1.8225e-03,  1.7702e-03,  ...,  6.8292e-04,
         -2.4218e-03, -1.5177e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6383], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |  107980 MB |  107856 MB |
|       from large pool |  101446 KB |  114090 KB |  106999 MB |  106900 MB |
|       from small pool |   25077 KB |   26999 KB |     981 MB |     956 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |  107980 MB |  107856 MB |
|       from large pool |  101446 KB |  114090 KB |  106999 MB |  106900 MB |
|       from small pool |   25077 KB |   26999 KB |     981 MB |     956 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   56769 KB |  108552 MB |  108523 MB |
|       from large pool |   25530 KB |   45163 KB |  107408 MB |  107383 MB |
|       from small pool |    3594 KB |   14091 KB |    1143 MB |    1140 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  418604    |  412853    |
|       from large pool |      55    |      63    |   69025    |   68970    |
|       from small pool |    5696    |    5706    |  349579    |  343883    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  418604    |  412853    |
|       from large pool |      55    |      63    |   69025    |   68970    |
|       from small pool |    5696    |    5706    |  349579    |  343883    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      23    |     825    |  239194    |  239171    |
|       from large pool |       5    |       9    |   53637    |   53632    |
|       from small pool |      18    |     820    |  185557    |  185539    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |  109611 MB |  109542 MB |
|       from large pool |   53741 KB |   66810 KB |  108669 MB |  108617 MB |
|       from small pool |   16067 KB |   17995 KB |     941 MB |     925 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |  109611 MB |  109542 MB |
|       from large pool |   53741 KB |   66810 KB |  108669 MB |  108617 MB |
|       from small pool |   16067 KB |   17995 KB |     941 MB |     925 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |  110153 MB |  110131 MB |
|       from large pool |   19986 KB |   56698 KB |  108886 MB |  108866 MB |
|       from small pool |    2365 KB |    9601 KB |    1267 MB |    1265 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  417877    |  412185    |
|       from large pool |      25    |      33    |   68883    |   68858    |
|       from small pool |    5667    |    5678    |  348994    |  343327    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  417877    |  412185    |
|       from large pool |      25    |      33    |   68883    |   68858    |
|       from small pool |    5667    |    5678    |  348994    |  343327    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |  245443    |  245428    |
|       from large pool |       3    |       7    |   58547    |   58544    |
|       from small pool |      12    |     817    |  186896    |  186884    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device: 0
 Device: 1
Parameter containing:
tensor([[-1.1192e-03, -1.5635e-03,  3.0310e-05,  ...,  1.9087e-03,
         -8.0693e-04,  2.9918e-03],
        [ 1.6707e-04,  3.6515e-03,  3.2771e-03,  ...,  2.8442e-03,
          2.5282e-03,  3.2731e-03],
        [-1.9739e-03, -3.3334e-03, -5.7951e-04,  ...,  9.1955e-04,
          3.3223e-03, -3.6533e-03],
        ...,
        [-3.0441e-03,  3.8229e-03, -1.3087e-03,  ..., -1.5631e-03,
         -1.3284e-04, -3.2876e-03],
        [ 7.9371e-04, -2.4773e-03, -2.1663e-03,  ...,  2.3910e-03,
         -7.2090e-04, -2.9527e-03],
        [ 1.8560e-04, -1.9439e-03,  1.6487e-03,  ...,  8.0424e-04,
         -2.3005e-03, -1.3964e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1192e-03, -1.5635e-03,  3.0310e-05,  ...,  1.9087e-03,
         -8.0693e-04,  2.9918e-03],
        [ 1.6707e-04,  3.6515e-03,  3.2771e-03,  ...,  2.8442e-03,
          2.5282e-03,  3.2731e-03],
        [-1.9739e-03, -3.3334e-03, -5.7951e-04,  ...,  9.1955e-04,
          3.3223e-03, -3.6533e-03],
        ...,
        [-3.0441e-03,  3.8229e-03, -1.3087e-03,  ..., -1.5631e-03,
         -1.3284e-04, -3.2876e-03],
        [ 7.9371e-04, -2.4773e-03, -2.1663e-03,  ...,  2.3910e-03,
         -7.2090e-04, -2.9527e-03],
        [ 1.8560e-04, -1.9439e-03,  1.6487e-03,  ...,  8.0424e-04,
         -2.3005e-03, -1.3964e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 9 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device: 1Device:
 0
tensor([[-1.1192e-03, -1.5635e-03,  3.0310e-05,  ...,  1.9087e-03,
         -8.0693e-04,  2.9918e-03],
        [ 1.6707e-04,  3.6515e-03,  3.2771e-03,  ...,  2.8442e-03,
          2.5282e-03,  3.2731e-03],
        [-1.9739e-03, -3.3334e-03, -5.7951e-04,  ...,  9.1955e-04,
          3.3223e-03, -3.6533e-03],
        ...,
        [-3.0441e-03,  3.8229e-03, -1.3087e-03,  ..., -1.5631e-03,
         -1.3284e-04, -3.2876e-03],
        [ 7.9371e-04, -2.4773e-03, -2.1663e-03,  ...,  2.3910e-03,
         -7.2090e-04, -2.9527e-03],
        [ 1.8560e-04, -1.9439e-03,  1.6487e-03,  ...,  8.0424e-04,
         -2.3005e-03, -1.3964e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1192e-03, -1.5635e-03,  3.0310e-05,  ...,  1.9087e-03,
         -8.0693e-04,  2.9918e-03],
        [ 1.6707e-04,  3.6515e-03,  3.2771e-03,  ...,  2.8442e-03,
          2.5282e-03,  3.2731e-03],
        [-1.9739e-03, -3.3334e-03, -5.7951e-04,  ...,  9.1955e-04,
          3.3223e-03, -3.6533e-03],
        ...,
        [-3.0441e-03,  3.8229e-03, -1.3087e-03,  ..., -1.5631e-03,
         -1.3284e-04, -3.2876e-03],
        [ 7.9371e-04, -2.4773e-03, -2.1663e-03,  ...,  2.3910e-03,
         -7.2090e-04, -2.9527e-03],
        [ 1.8560e-04, -1.9439e-03,  1.6487e-03,  ...,  8.0424e-04,
         -2.3005e-03, -1.3964e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6379], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  126523 KB |  137132 KB |  123384 MB |  123260 MB |
|       from large pool |  101446 KB |  114090 KB |  122269 MB |  122170 MB |
|       from small pool |   25077 KB |   26999 KB |    1114 MB |    1090 MB |
|---------------------------------------------------------------------------|
| Active memory         |  126523 KB |  137132 KB |  123384 MB |  123260 MB |
|       from large pool |  101446 KB |  114090 KB |  122269 MB |  122170 MB |
|       from small pool |   25077 KB |   26999 KB |    1114 MB |    1090 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  155648 KB |  155648 KB |  155648 KB |       0 B  |
|       from large pool |  126976 KB |  126976 KB |  126976 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   29124 KB |   56769 KB |  124029 MB |  124001 MB |
|       from large pool |   25530 KB |   45163 KB |  122730 MB |  122705 MB |
|       from small pool |    3594 KB |   14091 KB |    1299 MB |    1295 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5751    |    5762    |  476304    |  470553    |
|       from large pool |      55    |      63    |   78877    |   78822    |
|       from small pool |    5696    |    5706    |  397427    |  391731    |
|---------------------------------------------------------------------------|
| Active allocs         |    5751    |    5762    |  476304    |  470553    |
|       from large pool |      55    |      63    |   78877    |   78822    |
|       from small pool |    5696    |    5706    |  397427    |  391731    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      21    |      21    |      21    |       0    |
|       from large pool |       7    |       7    |       7    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      24    |     825    |  272923    |  272899    |
|       from large pool |       5    |       9    |   61298    |   61293    |
|       from small pool |      19    |     820    |  211625    |  211606    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   69808 KB |   80834 KB |  125255 MB |  125186 MB |
|       from large pool |   53741 KB |   66810 KB |  124184 MB |  124132 MB |
|       from small pool |   16067 KB |   17995 KB |    1070 MB |    1054 MB |
|---------------------------------------------------------------------------|
| Active memory         |   69808 KB |   80834 KB |  125255 MB |  125186 MB |
|       from large pool |   53741 KB |   66810 KB |  124184 MB |  124132 MB |
|       from small pool |   16067 KB |   17995 KB |    1070 MB |    1054 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   92160 KB |   92160 KB |   92160 KB |       0 B  |
|       from large pool |   73728 KB |   73728 KB |   73728 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   22351 KB |   60792 KB |  125872 MB |  125851 MB |
|       from large pool |   19986 KB |   56698 KB |  124432 MB |  124412 MB |
|       from small pool |    2365 KB |    9601 KB |    1440 MB |    1438 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5692    |    5704    |  475484    |  469792    |
|       from large pool |      25    |      33    |   78719    |   78694    |
|       from small pool |    5667    |    5678    |  396765    |  391098    |
|---------------------------------------------------------------------------|
| Active allocs         |    5692    |    5704    |  475484    |  469792    |
|       from large pool |      25    |      33    |   78719    |   78694    |
|       from small pool |    5667    |    5678    |  396765    |  391098    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      13    |      13    |      13    |       0    |
|       from large pool |       4    |       4    |       4    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |     820    |  280011    |  279996    |
|       from large pool |       3    |       7    |   66910    |   66907    |
|       from small pool |      12    |     817    |  213101    |  213089    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[-1.1189e-03, -1.5632e-03,  3.0642e-05,  ...,  1.9084e-03,
         -8.0725e-04,  2.9915e-03],
        [ 1.6402e-04,  3.6484e-03,  3.2741e-03,  ...,  2.8472e-03,
          2.5312e-03,  3.2762e-03],
        [-1.9602e-03, -3.3197e-03, -5.6581e-04,  ...,  9.0582e-04,
          3.3085e-03, -3.6670e-03],
        ...,
        [-3.0345e-03,  3.8326e-03, -1.2991e-03,  ..., -1.5727e-03,
         -1.4247e-04, -3.2972e-03],
        [ 8.0590e-04, -2.4652e-03, -2.1542e-03,  ...,  2.3789e-03,
         -7.3302e-04, -2.9648e-03],
        [ 1.0170e-04, -2.0277e-03,  1.5649e-03,  ...,  8.8802e-04,
         -2.2168e-03, -1.3126e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1189e-03, -1.5632e-03,  3.0642e-05,  ...,  1.9084e-03,
         -8.0725e-04,  2.9915e-03],
        [ 1.6402e-04,  3.6484e-03,  3.2741e-03,  ...,  2.8472e-03,
          2.5312e-03,  3.2762e-03],
        [-1.9602e-03, -3.3197e-03, -5.6581e-04,  ...,  9.0582e-04,
          3.3085e-03, -3.6670e-03],
        ...,
        [-3.0345e-03,  3.8326e-03, -1.2991e-03,  ..., -1.5727e-03,
         -1.4247e-04, -3.2972e-03],
        [ 8.0590e-04, -2.4652e-03, -2.1542e-03,  ...,  2.3789e-03,
         -7.3302e-04, -2.9648e-03],
        [ 1.0170e-04, -2.0277e-03,  1.5649e-03,  ...,  8.8802e-04,
         -2.2168e-03, -1.3126e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36

======== Epoch 10 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device: 0
 Device: 1
tensor([[-1.1189e-03, -1.5632e-03,  3.0642e-05,  ...,  1.9084e-03,
         -8.0725e-04,  2.9915e-03],
        [ 1.6402e-04,  3.6484e-03,  3.2741e-03,  ...,  2.8472e-03,
          2.5312e-03,  3.2762e-03],
        [-1.9602e-03, -3.3197e-03, -5.6581e-04,  ...,  9.0582e-04,
          3.3085e-03, -3.6670e-03],
        ...,
        [-3.0345e-03,  3.8326e-03, -1.2991e-03,  ..., -1.5727e-03,
         -1.4247e-04, -3.2972e-03],
        [ 8.0590e-04, -2.4652e-03, -2.1542e-03,  ...,  2.3789e-03,
         -7.3302e-04, -2.9648e-03],
        [ 1.0170e-04, -2.0277e-03,  1.5649e-03,  ...,  8.8802e-04,
         -2.2168e-03, -1.3126e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.1189e-03, -1.5632e-03,  3.0642e-05,  ...,  1.9084e-03,
         -8.0725e-04,  2.9915e-03],
        [ 1.6402e-04,  3.6484e-03,  3.2741e-03,  ...,  2.8472e-03,
          2.5312e-03,  3.2762e-03],
        [-1.9602e-03, -3.3197e-03, -5.6581e-04,  ...,  9.0582e-04,
          3.3085e-03, -3.6670e-03],
        ...,
        [-3.0345e-03,  3.8326e-03, -1.2991e-03,  ..., -1.5727e-03,
         -1.4247e-04, -3.2972e-03],
        [ 8.0590e-04, -2.4652e-03, -2.1542e-03,  ...,  2.3789e-03,
         -7.3302e-04, -2.9648e-03],
        [ 1.0170e-04, -2.0277e-03,  1.5649e-03,  ...,  8.8802e-04,
         -2.2168e-03, -1.3126e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6376], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  142353 KB |  148812 KB |  138803 MB |  138664 MB |
|       from large pool |  117251 KB |  121800 KB |  137555 MB |  137441 MB |
|       from small pool |   25102 KB |   27024 KB |    1247 MB |    1223 MB |
|---------------------------------------------------------------------------|
| Active memory         |  142353 KB |  148812 KB |  138803 MB |  138664 MB |
|       from large pool |  117251 KB |  121800 KB |  137555 MB |  137441 MB |
|       from small pool |   25102 KB |   27024 KB |    1247 MB |    1223 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  176128 KB |  176128 KB |  176128 KB |       0 B  |
|       from large pool |  147456 KB |  147456 KB |  147456 KB |       0 B  |
|       from small pool |   28672 KB |   28672 KB |   28672 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   13294 KB |   56769 KB |  139512 MB |  139499 MB |
|       from large pool |    9725 KB |   45163 KB |  138067 MB |  138058 MB |
|       from small pool |    3569 KB |   14091 KB |    1444 MB |    1441 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5771    |    5782    |  534024    |  528253    |
|       from large pool |      65    |      67    |   88739    |   88674    |
|       from small pool |    5706    |    5716    |  445285    |  439579    |
|---------------------------------------------------------------------------|
| Active allocs         |    5771    |    5782    |  534024    |  528253    |
|       from large pool |      65    |      67    |   88739    |   88674    |
|       from small pool |    5706    |    5716    |  445285    |  439579    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      22    |      22    |      22    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      25    |     825    |  306248    |  306223    |
|       from large pool |       6    |       9    |   68961    |   68955    |
|       from small pool |      19    |     820    |  237287    |  237268    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   86301 KB |   92766 KB |  140915 MB |  140831 MB |
|       from large pool |   70209 KB |   74758 KB |  139716 MB |  139647 MB |
|       from small pool |   16092 KB |   18020 KB |    1199 MB |    1183 MB |
|---------------------------------------------------------------------------|
| Active memory         |   86301 KB |   92766 KB |  140915 MB |  140831 MB |
|       from large pool |   70209 KB |   74758 KB |  139716 MB |  139647 MB |
|       from small pool |   16092 KB |   18020 KB |    1199 MB |    1183 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  112640 KB |  112640 KB |  112640 KB |       0 B  |
|       from large pool |   94208 KB |   94208 KB |   94208 KB |       0 B  |
|       from small pool |   18432 KB |   18432 KB |   18432 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    5859 KB |   60792 KB |  141593 MB |  141587 MB |
|       from large pool |    3519 KB |   56698 KB |  139993 MB |  139990 MB |
|       from small pool |    2340 KB |    9601 KB |    1600 MB |    1597 MB |
|---------------------------------------------------------------------------|
| Allocations           |    5712    |    5724    |  533111    |  527399    |
|       from large pool |      35    |      37    |   88565    |   88530    |
|       from small pool |    5677    |    5688    |  444546    |  438869    |
|---------------------------------------------------------------------------|
| Active allocs         |    5712    |    5724    |  533111    |  527399    |
|       from large pool |      35    |      37    |   88565    |   88530    |
|       from small pool |    5677    |    5688    |  444546    |  438869    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      14    |      14    |      14    |       0    |
|       from large pool |       5    |       5    |       5    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |     820    |  314568    |  314554    |
|       from large pool |       2    |       7    |   75274    |   75272    |
|       from small pool |      12    |     817    |  239294    |  239282    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|


  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[-1.1187e-03, -1.5630e-03,  3.0863e-05,  ...,  1.9082e-03,
         -8.0746e-04,  2.9912e-03],
        [ 1.6216e-04,  3.6466e-03,  3.2722e-03,  ...,  2.8491e-03,
          2.5331e-03,  3.2781e-03],
        [-1.9516e-03, -3.3111e-03, -5.5721e-04,  ...,  8.9718e-04,
          3.2998e-03, -3.6756e-03],
        ...,
        [-3.0284e-03,  3.8388e-03, -1.2930e-03,  ..., -1.5788e-03,
         -1.4863e-04, -3.3033e-03],
        [ 8.1377e-04, -2.4574e-03, -2.1465e-03,  ...,  2.3710e-03,
         -7.4084e-04, -2.9726e-03],
        [ 5.9539e-05, -2.0698e-03,  1.5228e-03,  ...,  9.3014e-04,
         -2.1746e-03, -1.2704e-03]], device='cuda:0', requires_grad=True)
tensor([[-1.1187e-03, -1.5630e-03,  3.0863e-05,  ...,  1.9082e-03,
         -8.0746e-04,  2.9912e-03],
        [ 1.6216e-04,  3.6466e-03,  3.2722e-03,  ...,  2.8491e-03,
          2.5331e-03,  3.2781e-03],
        [-1.9516e-03, -3.3111e-03, -5.5721e-04,  ...,  8.9718e-04,
          3.2998e-03, -3.6756e-03],
        ...,
        [-3.0284e-03,  3.8388e-03, -1.2930e-03,  ..., -1.5788e-03,
         -1.4863e-04, -3.3033e-03],
        [ 8.1377e-04, -2.4574e-03, -2.1465e-03,  ...,  2.3710e-03,
         -7.4084e-04, -2.9726e-03],
        [ 5.9539e-05, -2.0698e-03,  1.5228e-03,  ...,  9.3014e-04,
         -2.1746e-03, -1.2704e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
Least Validation loss: 0.3618593215942383
