/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py:546: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(dataset_tensor[:, 1, :].clone().detach(), dtype=torch.long)
PermutedDKT
Number of questions:  20
Number of students:  9
Number of concepts: 52
Using batch size: 64
Using batch size: 64
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1774 KB |    1987 KB |    1987 KB |  217600 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    1774 KB |    1987 KB |    1987 KB |  217600 B  |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Successfull in data prepration!
Successfully loaded the optimizer
======== Epoch 1 / 100 ========
Training...
Step: 0
/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0136, -0.0190,  0.0003,  ...,  0.0433,  0.0381,  0.0397],
        [ 0.0010, -0.0135, -0.0453,  ..., -0.0081,  0.0124,  0.0410],
        [ 0.0331, -0.0087,  0.0067,  ...,  0.0036, -0.0303, -0.0194],
        ...,
        [ 0.0274, -0.0008,  0.0460,  ...,  0.0275,  0.0407, -0.0304],
        [-0.0285, -0.0410,  0.0217,  ..., -0.0182,  0.0050,  0.0400],
        [-0.0398,  0.0070, -0.0124,  ..., -0.0170,  0.0179, -0.0254]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0136, -0.0190,  0.0003,  ...,  0.0433,  0.0381,  0.0397],
        [ 0.0010, -0.0135, -0.0453,  ..., -0.0081,  0.0124,  0.0410],
        [ 0.0331, -0.0087,  0.0067,  ...,  0.0036, -0.0303, -0.0194],
        ...,
        [ 0.0274, -0.0008,  0.0460,  ...,  0.0275,  0.0407, -0.0304],
        [-0.0285, -0.0410,  0.0217,  ..., -0.0182,  0.0050,  0.0400],
        [-0.0398,  0.0070, -0.0124,  ..., -0.0170,  0.0179, -0.0254]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.7076, 0.6959], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     889 KB |    1098 KB |    1664 KB |     775 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     889 KB |    1098 KB |    1664 KB |     775 KB |
|---------------------------------------------------------------------------|
| Active memory         |     889 KB |    1098 KB |    1664 KB |     775 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     889 KB |    1098 KB |    1664 KB |     775 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1159 KB |    1987 KB |    2762 KB |    1603 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1159 KB |    1987 KB |    2762 KB |    1603 KB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     208    |     495    |     298    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     197    |     208    |     495    |     298    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     208    |     495    |     298    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     197    |     208    |     495    |     298    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |       6    |     174    |     169    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |       6    |     174    |     169    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |    1262 KB |  454656 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |     818 KB |     977 KB |    1262 KB |  454656 B  |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |    1262 KB |  454656 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |     818 KB |     977 KB |    1262 KB |  454656 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |    2491 KB |    1261 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |    2491 KB |    1261 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |     459    |     277    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |     459    |     277    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |     459    |     277    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |     459    |     277    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |       7    |     163    |     156    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |       7    |     163    |     156    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0136, -0.0190,  0.0004,  ...,  0.0433,  0.0381,  0.0396],
        [ 0.0006, -0.0139, -0.0457,  ..., -0.0077,  0.0128,  0.0414],
        [ 0.0334, -0.0085,  0.0070,  ...,  0.0033, -0.0306, -0.0196],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0303],
        [-0.0289, -0.0415,  0.0212,  ..., -0.0177,  0.0054,  0.0404],
        [-0.0395,  0.0074, -0.0120,  ..., -0.0174,  0.0175, -0.0257]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0136, -0.0190,  0.0004,  ...,  0.0433,  0.0381,  0.0396],
        [ 0.0006, -0.0139, -0.0457,  ..., -0.0077,  0.0128,  0.0414],
        [ 0.0334, -0.0085,  0.0070,  ...,  0.0033, -0.0306, -0.0196],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0303],
        [-0.0289, -0.0415,  0.0212,  ..., -0.0177,  0.0054,  0.0404],
        [-0.0395,  0.0074, -0.0120,  ..., -0.0174,  0.0175, -0.0257]],
       device='cuda:1')
  Average validation loss: 13.55
======== Epoch 2 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0136, -0.0190,  0.0004,  ...,  0.0433,  0.0381,  0.0396],
        [ 0.0006, -0.0139, -0.0457,  ..., -0.0077,  0.0128,  0.0414],
        [ 0.0334, -0.0085,  0.0070,  ...,  0.0033, -0.0306, -0.0196],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0303],
        [-0.0289, -0.0415,  0.0212,  ..., -0.0177,  0.0054,  0.0404],
        [-0.0395,  0.0074, -0.0120,  ..., -0.0174,  0.0175, -0.0257]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0136, -0.0190,  0.0004,  ...,  0.0433,  0.0381,  0.0396],
        [ 0.0006, -0.0139, -0.0457,  ..., -0.0077,  0.0128,  0.0414],
        [ 0.0334, -0.0085,  0.0070,  ...,  0.0033, -0.0306, -0.0196],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0303],
        [-0.0289, -0.0415,  0.0212,  ..., -0.0177,  0.0054,  0.0404],
        [-0.0395,  0.0074, -0.0120,  ..., -0.0174,  0.0175, -0.0257]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.7054, 0.6938], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   10325 KB |    8367 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   10325 KB |    8367 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   10325 KB |    8367 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   10325 KB |    8367 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2138 KB |   12386 KB |   10248 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2138 KB |   12386 KB |   10248 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |    2330    |    2089    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    2330    |    2089    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |    2330    |    2089    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    2330    |    2089    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      27    |    1242    |    1235    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      27    |    1242    |    1235    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |    8098 KB |    7280 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |    8098 KB |    7280 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |    8098 KB |    7280 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |    8098 KB |    7280 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   13422 KB |   12192 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   13422 KB |   12192 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |    2181    |    1999    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    2181    |    1999    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |    2181    |    1999    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    2181    |    1999    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    1286    |    1279    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    1286    |    1279    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0136, -0.0191,  0.0003,  ...,  0.0434,  0.0381,  0.0396],
        [ 0.0002, -0.0143, -0.0461,  ..., -0.0074,  0.0132,  0.0418],
        [ 0.0337, -0.0082,  0.0073,  ...,  0.0031, -0.0308, -0.0199],
        ...,
        [ 0.0271, -0.0011,  0.0457,  ...,  0.0277,  0.0409, -0.0302],
        [-0.0293, -0.0419,  0.0208,  ..., -0.0173,  0.0059,  0.0409],
        [-0.0391,  0.0077, -0.0117,  ..., -0.0178,  0.0171, -0.0261]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0136, -0.0191,  0.0003,  ...,  0.0434,  0.0381,  0.0396],
        [ 0.0002, -0.0143, -0.0461,  ..., -0.0074,  0.0132,  0.0418],
        [ 0.0337, -0.0082,  0.0073,  ...,  0.0031, -0.0308, -0.0199],
        ...,
        [ 0.0271, -0.0011,  0.0457,  ...,  0.0277,  0.0409, -0.0302],
        [-0.0293, -0.0419,  0.0208,  ..., -0.0173,  0.0059,  0.0409],
        [-0.0391,  0.0077, -0.0117,  ..., -0.0178,  0.0171, -0.0261]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.55
======== Epoch 3 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0136, -0.0191,  0.0003,  ...,  0.0434,  0.0381,  0.0396],
        [ 0.0002, -0.0143, -0.0461,  ..., -0.0074,  0.0132,  0.0418],
        [ 0.0337, -0.0082,  0.0073,  ...,  0.0031, -0.0308, -0.0199],
        ...,
        [ 0.0271, -0.0011,  0.0457,  ...,  0.0277,  0.0409, -0.0302],
        [-0.0293, -0.0419,  0.0208,  ..., -0.0173,  0.0059,  0.0409],
        [-0.0391,  0.0077, -0.0117,  ..., -0.0178,  0.0171, -0.0261]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0136, -0.0191,  0.0003,  ...,  0.0434,  0.0381,  0.0396],
        [ 0.0002, -0.0143, -0.0461,  ..., -0.0074,  0.0132,  0.0418],
        [ 0.0337, -0.0082,  0.0073,  ...,  0.0031, -0.0308, -0.0199],
        ...,
        [ 0.0271, -0.0011,  0.0457,  ...,  0.0277,  0.0409, -0.0302],
        [-0.0293, -0.0419,  0.0208,  ..., -0.0173,  0.0059,  0.0409],
        [-0.0391,  0.0077, -0.0117,  ..., -0.0178,  0.0171, -0.0261]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.7033, 0.6918], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   18188 KB |   16230 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   18188 KB |   16230 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   18188 KB |   16230 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   18188 KB |   16230 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |   29851 KB |   27713 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |   29851 KB |   27713 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |    4125    |    3884    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    4125    |    3884    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |    4125    |    3884    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    4125    |    3884    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      27    |    2339    |    2331    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       8    |      27    |    2339    |    2331    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   14935 KB |   14117 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   14935 KB |   14117 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   14935 KB |   14117 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   14935 KB |   14117 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   24352 KB |   23122 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   24352 KB |   23122 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |    3903    |    3721    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    3903    |    3721    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |    3903    |    3721    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    3903    |    3721    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    2409    |    2402    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    2409    |    2402    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0137, -0.0192,  0.0002,  ...,  0.0435,  0.0382,  0.0397],
        [-0.0002, -0.0147, -0.0464,  ..., -0.0070,  0.0135,  0.0422],
        [ 0.0340, -0.0079,  0.0076,  ...,  0.0028, -0.0311, -0.0202],
        ...,
        [ 0.0271, -0.0011,  0.0458,  ...,  0.0277,  0.0409, -0.0303],
        [-0.0298, -0.0423,  0.0204,  ..., -0.0169,  0.0063,  0.0413],
        [-0.0387,  0.0081, -0.0113,  ..., -0.0181,  0.0167, -0.0265]],
       device='cuda:0', requires_grad=True)tensor([[-0.0137, -0.0192,  0.0002,  ...,  0.0435,  0.0382,  0.0397],
        [-0.0002, -0.0147, -0.0464,  ..., -0.0070,  0.0135,  0.0422],
        [ 0.0340, -0.0079,  0.0076,  ...,  0.0028, -0.0311, -0.0202],
        ...,
        [ 0.0271, -0.0011,  0.0458,  ...,  0.0277,  0.0409, -0.0303],
        [-0.0298, -0.0423,  0.0204,  ..., -0.0169,  0.0063,  0.0413],
        [-0.0387,  0.0081, -0.0113,  ..., -0.0181,  0.0167, -0.0265]],
       device='cuda:1')
  Average validation loss: 13.55
======== Epoch 4 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0137, -0.0192,  0.0002,  ...,  0.0435,  0.0382,  0.0397],
        [-0.0002, -0.0147, -0.0464,  ..., -0.0070,  0.0135,  0.0422],
        [ 0.0340, -0.0079,  0.0076,  ...,  0.0028, -0.0311, -0.0202],
        ...,
        [ 0.0271, -0.0011,  0.0458,  ...,  0.0277,  0.0409, -0.0303],
        [-0.0298, -0.0423,  0.0204,  ..., -0.0169,  0.0063,  0.0413],
        [-0.0387,  0.0081, -0.0113,  ..., -0.0181,  0.0167, -0.0265]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0137, -0.0192,  0.0002,  ...,  0.0435,  0.0382,  0.0397],
        [-0.0002, -0.0147, -0.0464,  ..., -0.0070,  0.0135,  0.0422],
        [ 0.0340, -0.0079,  0.0076,  ...,  0.0028, -0.0311, -0.0202],
        ...,
        [ 0.0271, -0.0011,  0.0458,  ...,  0.0277,  0.0409, -0.0303],
        [-0.0298, -0.0423,  0.0204,  ..., -0.0169,  0.0063,  0.0413],
        [-0.0387,  0.0081, -0.0113,  ..., -0.0181,  0.0167, -0.0265]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.7011, 0.6897], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   26050 KB |   24092 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   26050 KB |   24092 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   26050 KB |   24092 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   26050 KB |   24092 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |   47317 KB |   45179 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |   47317 KB |   45179 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |    5920    |    5679    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    5920    |    5679    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |    5920    |    5679    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    5920    |    5679    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      27    |    3507    |    3500    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      27    |    3507    |    3500    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   21771 KB |   20953 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   21771 KB |   20953 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   21771 KB |   20953 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   21771 KB |   20953 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   35283 KB |   34053 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   35283 KB |   34053 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |    5625    |    5443    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    5625    |    5443    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |    5625    |    5443    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    5625    |    5443    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    3532    |    3525    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    3532    |    3525    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0138, -0.0193,  0.0001,  ...,  0.0436,  0.0384,  0.0399],
        [-0.0006, -0.0151, -0.0468,  ..., -0.0066,  0.0139,  0.0426],
        [ 0.0343, -0.0076,  0.0079,  ...,  0.0025, -0.0314, -0.0206],
        ...,
        [ 0.0272, -0.0010,  0.0459,  ...,  0.0276,  0.0408, -0.0304],
        [-0.0302, -0.0428,  0.0199,  ..., -0.0165,  0.0067,  0.0417],
        [-0.0383,  0.0085, -0.0109,  ..., -0.0185,  0.0164, -0.0269]],
       device='cuda:1')Parameter containing:
tensor([[-0.0138, -0.0193,  0.0001,  ...,  0.0436,  0.0384,  0.0399],
        [-0.0006, -0.0151, -0.0468,  ..., -0.0066,  0.0139,  0.0426],
        [ 0.0343, -0.0076,  0.0079,  ...,  0.0025, -0.0314, -0.0206],
        ...,
        [ 0.0272, -0.0010,  0.0459,  ...,  0.0276,  0.0408, -0.0304],
        [-0.0302, -0.0428,  0.0199,  ..., -0.0165,  0.0067,  0.0417],
        [-0.0383,  0.0085, -0.0109,  ..., -0.0185,  0.0164, -0.0269]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.56
======== Epoch 5 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0138, -0.0193,  0.0001,  ...,  0.0436,  0.0384,  0.0399],
        [-0.0006, -0.0151, -0.0468,  ..., -0.0066,  0.0139,  0.0426],
        [ 0.0343, -0.0076,  0.0079,  ...,  0.0025, -0.0314, -0.0206],
        ...,
        [ 0.0272, -0.0010,  0.0459,  ...,  0.0276,  0.0408, -0.0304],
        [-0.0302, -0.0428,  0.0199,  ..., -0.0165,  0.0067,  0.0417],
        [-0.0383,  0.0085, -0.0109,  ..., -0.0185,  0.0164, -0.0269]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0138, -0.0193,  0.0001,  ...,  0.0436,  0.0384,  0.0399],
        [-0.0006, -0.0151, -0.0468,  ..., -0.0066,  0.0139,  0.0426],
        [ 0.0343, -0.0076,  0.0079,  ...,  0.0025, -0.0314, -0.0206],
        ...,
        [ 0.0272, -0.0010,  0.0459,  ...,  0.0276,  0.0408, -0.0304],
        [-0.0302, -0.0428,  0.0199,  ..., -0.0165,  0.0067,  0.0417],
        [-0.0383,  0.0085, -0.0109,  ..., -0.0185,  0.0164, -0.0269]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6989, 0.6876], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   33913 KB |   31955 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   33913 KB |   31955 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   33913 KB |   31955 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   33913 KB |   31955 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |   64782 KB |   62644 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |   64782 KB |   62644 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |    7715    |    7474    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    7715    |    7474    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |    7715    |    7474    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    7715    |    7474    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      27    |    4644    |    4637    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      27    |    4644    |    4637    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   28608 KB |   27790 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   28608 KB |   27790 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   28608 KB |   27790 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   28608 KB |   27790 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   46213 KB |   44983 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   46213 KB |   44983 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |    7347    |    7165    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    7347    |    7165    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |    7347    |    7165    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    7347    |    7165    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    4655    |    4648    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    4655    |    4648    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-1.4028e-02, -1.9521e-02, -6.8844e-05,  ...,  4.3810e-02,
          3.8578e-02,  4.0054e-02],
        [-1.0281e-03, -1.5475e-02, -4.7205e-02,  ..., -6.1910e-03,
          1.4332e-02,  4.3010e-02],
        [ 3.4644e-02, -7.2856e-03,  8.2192e-03,  ...,  2.1281e-03,
         -3.1755e-02, -2.0889e-02],
        ...,
        [ 2.7399e-02, -9.0284e-04,  4.6032e-02,  ...,  2.7487e-02,
          4.0649e-02, -3.0543e-02],
        [-3.0610e-02, -4.3182e-02,  1.9525e-02,  ..., -1.6036e-02,
          7.1577e-03,  4.2153e-02],
        [-3.7951e-02,  8.9089e-03, -1.0517e-02,  ..., -1.8894e-02,
          1.5962e-02, -2.7278e-02]], device='cuda:0', requires_grad=True)tensor([[-1.4028e-02, -1.9521e-02, -6.8844e-05,  ...,  4.3810e-02,
          3.8578e-02,  4.0054e-02],
        [-1.0281e-03, -1.5475e-02, -4.7205e-02,  ..., -6.1910e-03,
          1.4332e-02,  4.3010e-02],
        [ 3.4644e-02, -7.2856e-03,  8.2192e-03,  ...,  2.1281e-03,
         -3.1755e-02, -2.0889e-02],
        ...,
        [ 2.7399e-02, -9.0284e-04,  4.6032e-02,  ...,  2.7487e-02,
          4.0649e-02, -3.0543e-02],
        [-3.0610e-02, -4.3182e-02,  1.9525e-02,  ..., -1.6036e-02,
          7.1577e-03,  4.2153e-02],
        [-3.7951e-02,  8.9089e-03, -1.0517e-02,  ..., -1.8894e-02,
          1.5962e-02, -2.7278e-02]], device='cuda:1')
  Average validation loss: 13.56
======== Epoch 6 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0 1
tensor([[-1.4028e-02, -1.9521e-02, -6.8844e-05,  ...,  4.3810e-02,
          3.8578e-02,  4.0054e-02],
        [-1.0281e-03, -1.5475e-02, -4.7205e-02,  ..., -6.1910e-03,
          1.4332e-02,  4.3010e-02],
        [ 3.4644e-02, -7.2856e-03,  8.2192e-03,  ...,  2.1281e-03,
         -3.1755e-02, -2.0889e-02],
        ...,
        [ 2.7399e-02, -9.0284e-04,  4.6032e-02,  ...,  2.7487e-02,
          4.0649e-02, -3.0543e-02],
        [-3.0610e-02, -4.3182e-02,  1.9525e-02,  ..., -1.6036e-02,
          7.1577e-03,  4.2153e-02],
        [-3.7951e-02,  8.9089e-03, -1.0517e-02,  ..., -1.8894e-02,
          1.5962e-02, -2.7278e-02]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-1.4028e-02, -1.9521e-02, -6.8844e-05,  ...,  4.3810e-02,
          3.8578e-02,  4.0054e-02],
        [-1.0281e-03, -1.5475e-02, -4.7205e-02,  ..., -6.1910e-03,
          1.4332e-02,  4.3010e-02],
        [ 3.4644e-02, -7.2856e-03,  8.2192e-03,  ...,  2.1281e-03,
         -3.1755e-02, -2.0889e-02],
        ...,
        [ 2.7399e-02, -9.0284e-04,  4.6032e-02,  ...,  2.7487e-02,
          4.0649e-02, -3.0543e-02],
        [-3.0610e-02, -4.3182e-02,  1.9525e-02,  ..., -1.6036e-02,
          7.1577e-03,  4.2153e-02],
        [-3.7951e-02,  8.9089e-03, -1.0517e-02,  ..., -1.8894e-02,
          1.5962e-02, -2.7278e-02]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.6967, 0.6855], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   41775 KB |   39817 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   41775 KB |   39817 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   41775 KB |   39817 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   41775 KB |   39817 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |   82248 KB |   80110 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |   82248 KB |   80110 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |    9510    |    9269    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    9510    |    9269    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |    9510    |    9269    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |    9510    |    9269    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      27    |    5780    |    5772    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       8    |      27    |    5780    |    5772    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   35444 KB |   34626 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   35444 KB |   34626 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   35444 KB |   34626 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   35444 KB |   34626 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   57144 KB |   55914 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   57144 KB |   55914 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |    9069    |    8887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    9069    |    8887    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |    9069    |    8887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |    9069    |    8887    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    5778    |    5771    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    5778    |    5771    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0142, -0.0197, -0.0003,  ...,  0.0440,  0.0388,  0.0403],
        [-0.0014, -0.0159, -0.0476,  ..., -0.0058,  0.0147,  0.0434],
        [ 0.0350, -0.0069,  0.0086,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0276, -0.0007,  0.0462,  ...,  0.0273,  0.0405, -0.0307],
        [-0.0310, -0.0436,  0.0191,  ..., -0.0156,  0.0076,  0.0426],
        [-0.0376,  0.0093, -0.0101,  ..., -0.0193,  0.0156, -0.0277]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0142, -0.0197, -0.0003,  ...,  0.0440,  0.0388,  0.0403],
        [-0.0014, -0.0159, -0.0476,  ..., -0.0058,  0.0147,  0.0434],
        [ 0.0350, -0.0069,  0.0086,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0276, -0.0007,  0.0462,  ...,  0.0273,  0.0405, -0.0307],
        [-0.0310, -0.0436,  0.0191,  ..., -0.0156,  0.0076,  0.0426],
        [-0.0376,  0.0093, -0.0101,  ..., -0.0193,  0.0156, -0.0277]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.56
======== Epoch 7 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0142, -0.0197, -0.0003,  ...,  0.0440,  0.0388,  0.0403],
        [-0.0014, -0.0159, -0.0476,  ..., -0.0058,  0.0147,  0.0434],
        [ 0.0350, -0.0069,  0.0086,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0276, -0.0007,  0.0462,  ...,  0.0273,  0.0405, -0.0307],
        [-0.0310, -0.0436,  0.0191,  ..., -0.0156,  0.0076,  0.0426],
        [-0.0376,  0.0093, -0.0101,  ..., -0.0193,  0.0156, -0.0277]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0142, -0.0197, -0.0003,  ...,  0.0440,  0.0388,  0.0403],
        [-0.0014, -0.0159, -0.0476,  ..., -0.0058,  0.0147,  0.0434],
        [ 0.0350, -0.0069,  0.0086,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0276, -0.0007,  0.0462,  ...,  0.0273,  0.0405, -0.0307],
        [-0.0310, -0.0436,  0.0191,  ..., -0.0156,  0.0076,  0.0426],
        [-0.0376,  0.0093, -0.0101,  ..., -0.0193,  0.0156, -0.0277]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6944, 0.6834], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   49638 KB |   47680 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   49638 KB |   47680 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   49638 KB |   47680 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   49638 KB |   47680 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |   99713 KB |   97575 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |   99713 KB |   97575 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |   11305    |   11064    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |   11305    |   11064    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |   11305    |   11064    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |   11305    |   11064    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      27    |    6950    |    6943    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      27    |    6950    |    6943    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   42281 KB |   41463 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   42281 KB |   41463 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   42281 KB |   41463 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   42281 KB |   41463 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   68074 KB |   66844 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   68074 KB |   66844 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |   10791    |   10609    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |   10791    |   10609    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |   10791    |   10609    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |   10791    |   10609    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    6901    |    6894    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    6901    |    6894    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0145, -0.0200, -0.0005,  ...,  0.0443,  0.0390,  0.0405],
        [-0.0018, -0.0162, -0.0480,  ..., -0.0054,  0.0151,  0.0438],
        [ 0.0354, -0.0066,  0.0089,  ...,  0.0014, -0.0324, -0.0216],
        ...,
        [ 0.0278, -0.0005,  0.0465,  ...,  0.0271,  0.0402, -0.0310],
        [-0.0314, -0.0440,  0.0187,  ..., -0.0152,  0.0080,  0.0430],
        [-0.0372,  0.0097, -0.0097,  ..., -0.0197,  0.0152, -0.0281]],
       device='cuda:0', requires_grad=True)tensor([[-0.0145, -0.0200, -0.0005,  ...,  0.0443,  0.0390,  0.0405],
        [-0.0018, -0.0162, -0.0480,  ..., -0.0054,  0.0151,  0.0438],
        [ 0.0354, -0.0066,  0.0089,  ...,  0.0014, -0.0324, -0.0216],
        ...,
        [ 0.0278, -0.0005,  0.0465,  ...,  0.0271,  0.0402, -0.0310],
        [-0.0314, -0.0440,  0.0187,  ..., -0.0152,  0.0080,  0.0430],
        [-0.0372,  0.0097, -0.0097,  ..., -0.0197,  0.0152, -0.0281]],
       device='cuda:1')
  Average validation loss: 13.56
======== Epoch 8 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0145, -0.0200, -0.0005,  ...,  0.0443,  0.0390,  0.0405],
        [-0.0018, -0.0162, -0.0480,  ..., -0.0054,  0.0151,  0.0438],
        [ 0.0354, -0.0066,  0.0089,  ...,  0.0014, -0.0324, -0.0216],
        ...,
        [ 0.0278, -0.0005,  0.0465,  ...,  0.0271,  0.0402, -0.0310],
        [-0.0314, -0.0440,  0.0187,  ..., -0.0152,  0.0080,  0.0430],
        [-0.0372,  0.0097, -0.0097,  ..., -0.0197,  0.0152, -0.0281]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0145, -0.0200, -0.0005,  ...,  0.0443,  0.0390,  0.0405],
        [-0.0018, -0.0162, -0.0480,  ..., -0.0054,  0.0151,  0.0438],
        [ 0.0354, -0.0066,  0.0089,  ...,  0.0014, -0.0324, -0.0216],
        ...,
        [ 0.0278, -0.0005,  0.0465,  ...,  0.0271,  0.0402, -0.0310],
        [-0.0314, -0.0440,  0.0187,  ..., -0.0152,  0.0080,  0.0430],
        [-0.0372,  0.0097, -0.0097,  ..., -0.0197,  0.0152, -0.0281]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6921, 0.6812], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   57500 KB |   55542 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   57500 KB |   55542 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   57500 KB |   55542 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   57500 KB |   55542 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |  117179 KB |  115041 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |  117179 KB |  115041 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |   13100    |   12859    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |   13100    |   12859    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |   13100    |   12859    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |   13100    |   12859    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      27    |    8088    |    8081    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      27    |    8088    |    8081    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   49117 KB |   48299 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   49117 KB |   48299 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   49117 KB |   48299 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   49117 KB |   48299 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   79005 KB |   77775 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   79005 KB |   77775 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |   12513    |   12331    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |   12513    |   12331    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |   12513    |   12331    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |   12513    |   12331    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    8024    |    8017    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    8024    |    8017    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0147, -0.0202, -0.0007,  ...,  0.0445,  0.0393,  0.0408],
        [-0.0022, -0.0166, -0.0483,  ..., -0.0050,  0.0155,  0.0442],
        [ 0.0357, -0.0062,  0.0093,  ...,  0.0011, -0.0328, -0.0220],
        ...,
        [ 0.0281, -0.0003,  0.0467,  ...,  0.0268,  0.0400, -0.0312],
        [-0.0318, -0.0444,  0.0183,  ..., -0.0148,  0.0084,  0.0434],
        [-0.0368,  0.0101, -0.0093,  ..., -0.0201,  0.0148, -0.0285]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0147, -0.0202, -0.0007,  ...,  0.0445,  0.0393,  0.0408],
        [-0.0022, -0.0166, -0.0483,  ..., -0.0050,  0.0155,  0.0442],
        [ 0.0357, -0.0062,  0.0093,  ...,  0.0011, -0.0328, -0.0220],
        ...,
        [ 0.0281, -0.0003,  0.0467,  ...,  0.0268,  0.0400, -0.0312],
        [-0.0318, -0.0444,  0.0183,  ..., -0.0148,  0.0084,  0.0434],
        [-0.0368,  0.0101, -0.0093,  ..., -0.0201,  0.0148, -0.0285]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.57
======== Epoch 9 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0147, -0.0202, -0.0007,  ...,  0.0445,  0.0393,  0.0408],
        [-0.0022, -0.0166, -0.0483,  ..., -0.0050,  0.0155,  0.0442],
        [ 0.0357, -0.0062,  0.0093,  ...,  0.0011, -0.0328, -0.0220],
        ...,
        [ 0.0281, -0.0003,  0.0467,  ...,  0.0268,  0.0400, -0.0312],
        [-0.0318, -0.0444,  0.0183,  ..., -0.0148,  0.0084,  0.0434],
        [-0.0368,  0.0101, -0.0093,  ..., -0.0201,  0.0148, -0.0285]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0147, -0.0202, -0.0007,  ...,  0.0445,  0.0393,  0.0408],
        [-0.0022, -0.0166, -0.0483,  ..., -0.0050,  0.0155,  0.0442],
        [ 0.0357, -0.0062,  0.0093,  ...,  0.0011, -0.0328, -0.0220],
        ...,
        [ 0.0281, -0.0003,  0.0467,  ...,  0.0268,  0.0400, -0.0312],
        [-0.0318, -0.0444,  0.0183,  ..., -0.0148,  0.0084,  0.0434],
        [-0.0368,  0.0101, -0.0093,  ..., -0.0201,  0.0148, -0.0285]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6898, 0.6790], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1958 KB |    2168 KB |   65363 KB |   63405 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   65363 KB |   63405 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1958 KB |    2168 KB |   65363 KB |   63405 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1958 KB |    2168 KB |   65363 KB |   63405 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2138 KB |    2480 KB |  134644 KB |  132506 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2138 KB |    2480 KB |  134644 KB |  132506 KB |
|---------------------------------------------------------------------------|
| Allocations           |     241    |     253    |   14895    |   14654    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |   14895    |   14654    |
|---------------------------------------------------------------------------|
| Active allocs         |     241    |     253    |   14895    |   14654    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     241    |     253    |   14895    |   14654    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      27    |    9224    |    9216    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       8    |      27    |    9224    |    9216    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     818 KB |     977 KB |   55954 KB |   55136 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   55954 KB |   55136 KB |
|---------------------------------------------------------------------------|
| Active memory         |     818 KB |     977 KB |   55954 KB |   55136 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     818 KB |     977 KB |   55954 KB |   55136 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1230 KB |    2047 KB |   89935 KB |   88705 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1230 KB |    2047 KB |   89935 KB |   88705 KB |
|---------------------------------------------------------------------------|
| Allocations           |     182    |     195    |   14235    |   14053    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |   14235    |   14053    |
|---------------------------------------------------------------------------|
| Active allocs         |     182    |     195    |   14235    |   14053    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     182    |     195    |   14235    |   14053    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |    9147    |    9140    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |    9147    |    9140    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.68
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-1.4990e-02, -2.0500e-02, -9.9940e-04,  ...,  4.4797e-02,
          3.9572e-02,  4.1025e-02],
        [-2.5787e-03, -1.7011e-02, -4.8698e-02,  ..., -4.6696e-03,
          1.5877e-02,  4.4576e-02],
        [ 3.6114e-02, -5.8676e-03,  9.6486e-03,  ...,  7.1148e-04,
         -3.3160e-02, -2.2327e-02],
        ...,
        [ 2.8399e-02,  2.2439e-05,  4.7030e-02,  ...,  2.6537e-02,
          3.9668e-02, -3.1522e-02],
        [-3.2239e-02, -4.4800e-02,  1.7894e-02,  ..., -1.4422e-02,
          8.7901e-03,  4.3803e-02],
        [-3.6343e-02,  1.0526e-02, -8.9150e-03,  ..., -2.0488e-02,
          1.4338e-02, -2.8895e-02]], device='cuda:0', requires_grad=True)
tensor([[-1.4990e-02, -2.0500e-02, -9.9940e-04,  ...,  4.4797e-02,
          3.9572e-02,  4.1025e-02],
        [-2.5787e-03, -1.7011e-02, -4.8698e-02,  ..., -4.6696e-03,
          1.5877e-02,  4.4576e-02],
        [ 3.6114e-02, -5.8676e-03,  9.6486e-03,  ...,  7.1148e-04,
         -3.3160e-02, -2.2327e-02],
        ...,
        [ 2.8399e-02,  2.2439e-05,  4.7030e-02,  ...,  2.6537e-02,
          3.9668e-02, -3.1522e-02],
        [-3.2239e-02, -4.4800e-02,  1.7894e-02,  ..., -1.4422e-02,
          8.7901e-03,  4.3803e-02],
        [-3.6343e-02,  1.0526e-02, -8.9150e-03,  ..., -2.0488e-02,
          1.4338e-02, -2.8895e-02]], device='cuda:1')
  Average validation loss: 13.57
======== Epoch 10 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-1.4990e-02, -2.0500e-02, -9.9940e-04,  ...,  4.4797e-02,
          3.9572e-02,  4.1025e-02],
        [-2.5787e-03, -1.7011e-02, -4.8698e-02,  ..., -4.6696e-03,
          1.5877e-02,  4.4576e-02],
        [ 3.6114e-02, -5.8676e-03,  9.6486e-03,  ...,  7.1148e-04,
         -3.3160e-02, -2.2327e-02],
        ...,
        [ 2.8399e-02,  2.2439e-05,  4.7030e-02,  ...,  2.6537e-02,
          3.9668e-02, -3.1522e-02],
        [-3.2239e-02, -4.4800e-02,  1.7894e-02,  ..., -1.4422e-02,
          8.7901e-03,  4.3803e-02],
        [-3.6343e-02,  1.0526e-02, -8.9150e-03,  ..., -2.0488e-02,
          1.4338e-02, -2.8895e-02]], device='cuda:0',
       grad_fn=<BroadcastBackward>)tensor([[-1.4990e-02, -2.0500e-02, -9.9940e-04,  ...,  4.4797e-02,
          3.9572e-02,  4.1025e-02],
        [-2.5787e-03, -1.7011e-02, -4.8698e-02,  ..., -4.6696e-03,
          1.5877e-02,  4.4576e-02],
        [ 3.6114e-02, -5.8676e-03,  9.6486e-03,  ...,  7.1148e-04,
         -3.3160e-02, -2.2327e-02],
        ...,
        [ 2.8399e-02,  2.2439e-05,  4.7030e-02,  ...,  2.6537e-02,
          3.9668e-02, -3.1522e-02],
        [-3.2239e-02, -4.4800e-02,  1.7894e-02,  ..., -1.4422e-02,
          8.7901e-03,  4.3803e-02],
        [-3.6343e-02,  1.0526e-02, -8.9150e-03,  ..., -2.0488e-02,
          1.4338e-02, -2.8895e-02]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.6875, 0.6768], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |   73338 KB |   71265 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   73338 KB |   71265 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |   73338 KB |   71265 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   73338 KB |   71265 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2480 KB |  154169 KB |  152146 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2480 KB |  154169 KB |  152146 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   16706    |   16445    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   16706    |   16445    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   16706    |   16445    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   16706    |   16445    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   10393    |   10388    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   10393    |   10388    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |   62903 KB |   61970 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   62903 KB |   61970 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |   62903 KB |   61970 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   62903 KB |   61970 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  100864 KB |   99749 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  100864 KB |   99749 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   15973    |   15771    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   15973    |   15771    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   15973    |   15771    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   15973    |   15771    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   10270    |   10263    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   10270    |   10263    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.68
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
tensor([[-0.0153, -0.0208, -0.0013,  ...,  0.0451,  0.0399,  0.0413],
        [-0.0030, -0.0174, -0.0491,  ..., -0.0043,  0.0163,  0.0450],
        [ 0.0365, -0.0055,  0.0100,  ...,  0.0003, -0.0335, -0.0227],
        ...,
        [ 0.0287,  0.0003,  0.0473,  ...,  0.0262,  0.0394, -0.0318],
        [-0.0326, -0.0452,  0.0175,  ..., -0.0140,  0.0092,  0.0442],
        [-0.0359,  0.0109, -0.0085,  ..., -0.0209,  0.0139, -0.0293]],
       device='cuda:1')Parameter containing:
tensor([[-0.0153, -0.0208, -0.0013,  ...,  0.0451,  0.0399,  0.0413],
        [-0.0030, -0.0174, -0.0491,  ..., -0.0043,  0.0163,  0.0450],
        [ 0.0365, -0.0055,  0.0100,  ...,  0.0003, -0.0335, -0.0227],
        ...,
        [ 0.0287,  0.0003,  0.0473,  ...,  0.0262,  0.0394, -0.0318],
        [-0.0326, -0.0452,  0.0175,  ..., -0.0140,  0.0092,  0.0442],
        [-0.0359,  0.0109, -0.0085,  ..., -0.0209,  0.0139, -0.0293]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.57
======== Epoch 11 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0153, -0.0208, -0.0013,  ...,  0.0451,  0.0399,  0.0413],
        [-0.0030, -0.0174, -0.0491,  ..., -0.0043,  0.0163,  0.0450],
        [ 0.0365, -0.0055,  0.0100,  ...,  0.0003, -0.0335, -0.0227],
        ...,
        [ 0.0287,  0.0003,  0.0473,  ...,  0.0262,  0.0394, -0.0318],
        [-0.0326, -0.0452,  0.0175,  ..., -0.0140,  0.0092,  0.0442],
        [-0.0359,  0.0109, -0.0085,  ..., -0.0209,  0.0139, -0.0293]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0153, -0.0208, -0.0013,  ...,  0.0451,  0.0399,  0.0413],
        [-0.0030, -0.0174, -0.0491,  ..., -0.0043,  0.0163,  0.0450],
        [ 0.0365, -0.0055,  0.0100,  ...,  0.0003, -0.0335, -0.0227],
        ...,
        [ 0.0287,  0.0003,  0.0473,  ...,  0.0262,  0.0394, -0.0318],
        [-0.0326, -0.0452,  0.0175,  ..., -0.0140,  0.0092,  0.0442],
        [-0.0359,  0.0109, -0.0085,  ..., -0.0209,  0.0139, -0.0293]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6851, 0.6746], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |   82096 KB |   80023 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   82096 KB |   80023 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |   82096 KB |   80023 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   82096 KB |   80023 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  166751 KB |  164728 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  166751 KB |  164728 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   18611    |   18350    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   18611    |   18350    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   18611    |   18350    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   18611    |   18350    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   11580    |   11575    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   11580    |   11575    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |   70635 KB |   69702 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   70635 KB |   69702 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |   70635 KB |   69702 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   70635 KB |   69702 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  112689 KB |  111574 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  112689 KB |  111574 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   17805    |   17603    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   17805    |   17603    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   17805    |   17603    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   17805    |   17603    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   11443    |   11436    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   11443    |   11436    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.68
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-1.5595e-02, -2.1107e-02, -1.5921e-03,  ...,  4.5408e-02,
          4.0188e-02,  4.1636e-02],
        [-3.3691e-03, -1.7795e-02, -4.9465e-02,  ..., -3.8908e-03,
          1.6665e-02,  4.5372e-02],
        [ 3.6870e-02, -5.1202e-03,  1.0396e-02,  ..., -3.3299e-05,
         -3.3906e-02, -2.3080e-02],
        ...,
        [ 2.9038e-02,  6.4230e-04,  4.7665e-02,  ...,  2.5912e-02,
          3.9035e-02, -3.2153e-02],
        [-3.3059e-02, -4.5615e-02,  1.7072e-02,  ..., -1.3608e-02,
          9.6124e-03,  4.4633e-02],
        [-3.5535e-02,  1.1328e-02, -8.1143e-03,  ..., -2.1289e-02,
          1.3535e-02, -2.9703e-02]], device='cuda:0', requires_grad=True)tensor([[-1.5595e-02, -2.1107e-02, -1.5921e-03,  ...,  4.5408e-02,
          4.0188e-02,  4.1636e-02],
        [-3.3691e-03, -1.7795e-02, -4.9465e-02,  ..., -3.8908e-03,
          1.6665e-02,  4.5372e-02],
        [ 3.6870e-02, -5.1202e-03,  1.0396e-02,  ..., -3.3299e-05,
         -3.3906e-02, -2.3080e-02],
        ...,
        [ 2.9038e-02,  6.4230e-04,  4.7665e-02,  ...,  2.5912e-02,
          3.9035e-02, -3.2153e-02],
        [-3.3059e-02, -4.5615e-02,  1.7072e-02,  ..., -1.3608e-02,
          9.6124e-03,  4.4633e-02],
        [-3.5535e-02,  1.1328e-02, -8.1143e-03,  ..., -2.1289e-02,
          1.3535e-02, -2.9703e-02]], device='cuda:1')
  Average validation loss: 13.57
======== Epoch 12 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-1.5595e-02, -2.1107e-02, -1.5921e-03,  ...,  4.5408e-02,
          4.0188e-02,  4.1636e-02],
        [-3.3691e-03, -1.7795e-02, -4.9465e-02,  ..., -3.8908e-03,
          1.6665e-02,  4.5372e-02],
        [ 3.6870e-02, -5.1202e-03,  1.0396e-02,  ..., -3.3299e-05,
         -3.3906e-02, -2.3080e-02],
        ...,
        [ 2.9038e-02,  6.4230e-04,  4.7665e-02,  ...,  2.5912e-02,
          3.9035e-02, -3.2153e-02],
        [-3.3059e-02, -4.5615e-02,  1.7072e-02,  ..., -1.3608e-02,
          9.6124e-03,  4.4633e-02],
        [-3.5535e-02,  1.1328e-02, -8.1143e-03,  ..., -2.1289e-02,
          1.3535e-02, -2.9703e-02]], device='cuda:0',
       grad_fn=<BroadcastBackward>)tensor([[-1.5595e-02, -2.1107e-02, -1.5921e-03,  ...,  4.5408e-02,
          4.0188e-02,  4.1636e-02],
        [-3.3691e-03, -1.7795e-02, -4.9465e-02,  ..., -3.8908e-03,
          1.6665e-02,  4.5372e-02],
        [ 3.6870e-02, -5.1202e-03,  1.0396e-02,  ..., -3.3299e-05,
         -3.3906e-02, -2.3080e-02],
        ...,
        [ 2.9038e-02,  6.4230e-04,  4.7665e-02,  ...,  2.5912e-02,
          3.9035e-02, -3.2153e-02],
        [-3.3059e-02, -4.5615e-02,  1.7072e-02,  ..., -1.3608e-02,
          9.6124e-03,  4.4633e-02],
        [-3.5535e-02,  1.1328e-02, -8.1143e-03,  ..., -2.1289e-02,
          1.3535e-02, -2.9703e-02]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.6827, 0.6723], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |   90851 KB |   88778 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   90851 KB |   88778 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |   90851 KB |   88778 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   90851 KB |   88778 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  179330 KB |  177307 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  179330 KB |  177307 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   20512    |   20251    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   20512    |   20251    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   20512    |   20251    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   20512    |   20251    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   12767    |   12761    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   12767    |   12761    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |   78364 KB |   77431 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   78364 KB |   77431 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |   78364 KB |   77431 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   78364 KB |   77431 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  124513 KB |  123398 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  124513 KB |  123398 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   19633    |   19431    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   19633    |   19431    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   19633    |   19431    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   19633    |   19431    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   12616    |   12609    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   12616    |   12609    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.68
batch input size: torch.Size([1, 20]) Device: 0
batch input size: torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0159, -0.0214, -0.0019,  ...,  0.0457,  0.0405,  0.0420],
        [-0.0038, -0.0182, -0.0499,  ..., -0.0035,  0.0171,  0.0458],
        [ 0.0373, -0.0047,  0.0108,  ..., -0.0004, -0.0343, -0.0235],
        ...,
        [ 0.0294,  0.0010,  0.0480,  ...,  0.0256,  0.0387, -0.0325],
        [-0.0335, -0.0460,  0.0167,  ..., -0.0132,  0.0100,  0.0451],
        [-0.0351,  0.0117, -0.0077,  ..., -0.0217,  0.0131, -0.0301]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0159, -0.0214, -0.0019,  ...,  0.0457,  0.0405,  0.0420],
        [-0.0038, -0.0182, -0.0499,  ..., -0.0035,  0.0171,  0.0458],
        [ 0.0373, -0.0047,  0.0108,  ..., -0.0004, -0.0343, -0.0235],
        ...,
        [ 0.0294,  0.0010,  0.0480,  ...,  0.0256,  0.0387, -0.0325],
        [-0.0335, -0.0460,  0.0167,  ..., -0.0132,  0.0100,  0.0451],
        [-0.0351,  0.0117, -0.0077,  ..., -0.0217,  0.0131, -0.0301]],
       device='cuda:1')
  Average validation loss: 13.57
======== Epoch 13 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0159, -0.0214, -0.0019,  ...,  0.0457,  0.0405,  0.0420],
        [-0.0038, -0.0182, -0.0499,  ..., -0.0035,  0.0171,  0.0458],
        [ 0.0373, -0.0047,  0.0108,  ..., -0.0004, -0.0343, -0.0235],
        ...,
        [ 0.0294,  0.0010,  0.0480,  ...,  0.0256,  0.0387, -0.0325],
        [-0.0335, -0.0460,  0.0167,  ..., -0.0132,  0.0100,  0.0451],
        [-0.0351,  0.0117, -0.0077,  ..., -0.0217,  0.0131, -0.0301]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0159, -0.0214, -0.0019,  ...,  0.0457,  0.0405,  0.0420],
        [-0.0038, -0.0182, -0.0499,  ..., -0.0035,  0.0171,  0.0458],
        [ 0.0373, -0.0047,  0.0108,  ..., -0.0004, -0.0343, -0.0235],
        ...,
        [ 0.0294,  0.0010,  0.0480,  ...,  0.0256,  0.0387, -0.0325],
        [-0.0335, -0.0460,  0.0167,  ..., -0.0132,  0.0100,  0.0451],
        [-0.0351,  0.0117, -0.0077,  ..., -0.0217,  0.0131, -0.0301]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6802, 0.6699], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |   99609 KB |   97536 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   99609 KB |   97536 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |   99609 KB |   97536 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |   99609 KB |   97536 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  191912 KB |  189889 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  191912 KB |  189889 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   22417    |   22156    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   22417    |   22156    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   22417    |   22156    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   22417    |   22156    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   13957    |   13952    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   13957    |   13952    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |   86096 KB |   85163 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   86096 KB |   85163 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |   86096 KB |   85163 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   86096 KB |   85163 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  136338 KB |  135223 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  136338 KB |  135223 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   21465    |   21263    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   21465    |   21263    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   21465    |   21263    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   21465    |   21263    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   13789    |   13782    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   13789    |   13782    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.68
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0163, -0.0218, -0.0023,  ...,  0.0461,  0.0409,  0.0423],
        [-0.0042, -0.0186, -0.0503,  ..., -0.0031,  0.0175,  0.0462],
        [ 0.0377, -0.0043,  0.0112,  ..., -0.0008, -0.0347, -0.0239],
        ...,
        [ 0.0298,  0.0013,  0.0484,  ...,  0.0252,  0.0383, -0.0329],
        [-0.0339, -0.0464,  0.0162,  ..., -0.0128,  0.0105,  0.0455],
        [-0.0347,  0.0122, -0.0073,  ..., -0.0221,  0.0127, -0.0305]],
       device='cuda:1')Parameter containing:
tensor([[-0.0163, -0.0218, -0.0023,  ...,  0.0461,  0.0409,  0.0423],
        [-0.0042, -0.0186, -0.0503,  ..., -0.0031,  0.0175,  0.0462],
        [ 0.0377, -0.0043,  0.0112,  ..., -0.0008, -0.0347, -0.0239],
        ...,
        [ 0.0298,  0.0013,  0.0484,  ...,  0.0252,  0.0383, -0.0329],
        [-0.0339, -0.0464,  0.0162,  ..., -0.0128,  0.0105,  0.0455],
        [-0.0347,  0.0122, -0.0073,  ..., -0.0221,  0.0127, -0.0305]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.58
======== Epoch 14 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0163, -0.0218, -0.0023,  ...,  0.0461,  0.0409,  0.0423],
        [-0.0042, -0.0186, -0.0503,  ..., -0.0031,  0.0175,  0.0462],
        [ 0.0377, -0.0043,  0.0112,  ..., -0.0008, -0.0347, -0.0239],
        ...,
        [ 0.0298,  0.0013,  0.0484,  ...,  0.0252,  0.0383, -0.0329],
        [-0.0339, -0.0464,  0.0162,  ..., -0.0128,  0.0105,  0.0455],
        [-0.0347,  0.0122, -0.0073,  ..., -0.0221,  0.0127, -0.0305]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0163, -0.0218, -0.0023,  ...,  0.0461,  0.0409,  0.0423],
        [-0.0042, -0.0186, -0.0503,  ..., -0.0031,  0.0175,  0.0462],
        [ 0.0377, -0.0043,  0.0112,  ..., -0.0008, -0.0347, -0.0239],
        ...,
        [ 0.0298,  0.0013,  0.0484,  ...,  0.0252,  0.0383, -0.0329],
        [-0.0339, -0.0464,  0.0162,  ..., -0.0128,  0.0105,  0.0455],
        [-0.0347,  0.0122, -0.0073,  ..., -0.0221,  0.0127, -0.0305]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6778, 0.6676], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |  108366 KB |  106293 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  108366 KB |  106293 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |  108366 KB |  106293 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  108366 KB |  106293 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  204493 KB |  202470 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  204493 KB |  202470 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   24322    |   24061    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   24322    |   24061    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   24322    |   24061    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   24322    |   24061    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   15144    |   15139    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   15144    |   15139    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |   93827 KB |   92894 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   93827 KB |   92894 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |   93827 KB |   92894 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |   93827 KB |   92894 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  148164 KB |  147049 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  148164 KB |  147049 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   23297    |   23095    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   23297    |   23095    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   23297    |   23095    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   23297    |   23095    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   14962    |   14955    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   14962    |   14955    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.67
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0166, -0.0221, -0.0026,  ...,  0.0465,  0.0412,  0.0427],
        [-0.0046, -0.0190, -0.0507,  ..., -0.0027,  0.0179,  0.0466],
        [ 0.0381, -0.0039,  0.0116,  ..., -0.0012, -0.0351, -0.0243],
        ...,
        [ 0.0301,  0.0017,  0.0488,  ...,  0.0248,  0.0379, -0.0332],
        [-0.0343, -0.0469,  0.0158,  ..., -0.0124,  0.0109,  0.0459],
        [-0.0343,  0.0126, -0.0069,  ..., -0.0225,  0.0123, -0.0310]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0166, -0.0221, -0.0026,  ...,  0.0465,  0.0412,  0.0427],
        [-0.0046, -0.0190, -0.0507,  ..., -0.0027,  0.0179,  0.0466],
        [ 0.0381, -0.0039,  0.0116,  ..., -0.0012, -0.0351, -0.0243],
        ...,
        [ 0.0301,  0.0017,  0.0488,  ...,  0.0248,  0.0379, -0.0332],
        [-0.0343, -0.0469,  0.0158,  ..., -0.0124,  0.0109,  0.0459],
        [-0.0343,  0.0126, -0.0069,  ..., -0.0225,  0.0123, -0.0310]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.58
======== Epoch 15 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0166, -0.0221, -0.0026,  ...,  0.0465,  0.0412,  0.0427],
        [-0.0046, -0.0190, -0.0507,  ..., -0.0027,  0.0179,  0.0466],
        [ 0.0381, -0.0039,  0.0116,  ..., -0.0012, -0.0351, -0.0243],
        ...,
        [ 0.0301,  0.0017,  0.0488,  ...,  0.0248,  0.0379, -0.0332],
        [-0.0343, -0.0469,  0.0158,  ..., -0.0124,  0.0109,  0.0459],
        [-0.0343,  0.0126, -0.0069,  ..., -0.0225,  0.0123, -0.0310]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0166, -0.0221, -0.0026,  ...,  0.0465,  0.0412,  0.0427],
        [-0.0046, -0.0190, -0.0507,  ..., -0.0027,  0.0179,  0.0466],
        [ 0.0381, -0.0039,  0.0116,  ..., -0.0012, -0.0351, -0.0243],
        ...,
        [ 0.0301,  0.0017,  0.0488,  ...,  0.0248,  0.0379, -0.0332],
        [-0.0343, -0.0469,  0.0158,  ..., -0.0124,  0.0109,  0.0459],
        [-0.0343,  0.0126, -0.0069,  ..., -0.0225,  0.0123, -0.0310]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6753, 0.6652], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |  117124 KB |  115051 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  117124 KB |  115051 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |  117124 KB |  115051 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  117124 KB |  115051 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  217075 KB |  215052 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  217075 KB |  215052 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   26227    |   25966    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   26227    |   25966    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   26227    |   25966    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   26227    |   25966    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   16327    |   16322    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   16327    |   16322    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |  101559 KB |  100626 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  101559 KB |  100626 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |  101559 KB |  100626 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  101559 KB |  100626 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  159989 KB |  158874 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  159989 KB |  158874 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   25129    |   24927    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   25129    |   24927    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   25129    |   24927    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   25129    |   24927    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   16135    |   16128    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   16135    |   16128    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.67
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0170, -0.0225, -0.0030,  ...,  0.0468,  0.0416,  0.0431],
        [-0.0050, -0.0194, -0.0511,  ..., -0.0023,  0.0183,  0.0470],
        [ 0.0385, -0.0035,  0.0120,  ..., -0.0016, -0.0355, -0.0247],
        ...,
        [ 0.0305,  0.0021,  0.0492,  ...,  0.0244,  0.0375, -0.0336],
        [-0.0347, -0.0473,  0.0154,  ..., -0.0119,  0.0113,  0.0463],
        [-0.0338,  0.0130, -0.0064,  ..., -0.0230,  0.0118, -0.0314]],
       device='cuda:0', requires_grad=True)tensor([[-0.0170, -0.0225, -0.0030,  ...,  0.0468,  0.0416,  0.0431],
        [-0.0050, -0.0194, -0.0511,  ..., -0.0023,  0.0183,  0.0470],
        [ 0.0385, -0.0035,  0.0120,  ..., -0.0016, -0.0355, -0.0247],
        ...,
        [ 0.0305,  0.0021,  0.0492,  ...,  0.0244,  0.0375, -0.0336],
        [-0.0347, -0.0473,  0.0154,  ..., -0.0119,  0.0113,  0.0463],
        [-0.0338,  0.0130, -0.0064,  ..., -0.0230,  0.0118, -0.0314]],
       device='cuda:1')
  Average validation loss: 13.58
======== Epoch 16 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0170, -0.0225, -0.0030,  ...,  0.0468,  0.0416,  0.0431],
        [-0.0050, -0.0194, -0.0511,  ..., -0.0023,  0.0183,  0.0470],
        [ 0.0385, -0.0035,  0.0120,  ..., -0.0016, -0.0355, -0.0247],
        ...,
        [ 0.0305,  0.0021,  0.0492,  ...,  0.0244,  0.0375, -0.0336],
        [-0.0347, -0.0473,  0.0154,  ..., -0.0119,  0.0113,  0.0463],
        [-0.0338,  0.0130, -0.0064,  ..., -0.0230,  0.0118, -0.0314]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0170, -0.0225, -0.0030,  ...,  0.0468,  0.0416,  0.0431],
        [-0.0050, -0.0194, -0.0511,  ..., -0.0023,  0.0183,  0.0470],
        [ 0.0385, -0.0035,  0.0120,  ..., -0.0016, -0.0355, -0.0247],
        ...,
        [ 0.0305,  0.0021,  0.0492,  ...,  0.0244,  0.0375, -0.0336],
        [-0.0347, -0.0473,  0.0154,  ..., -0.0119,  0.0113,  0.0463],
        [-0.0338,  0.0130, -0.0064,  ..., -0.0230,  0.0118, -0.0314]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6728, 0.6628], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |  125881 KB |  123808 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  125881 KB |  123808 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |  125881 KB |  123808 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  125881 KB |  123808 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  229656 KB |  227633 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  229656 KB |  227633 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   28132    |   27871    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   28132    |   27871    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   28132    |   27871    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   28132    |   27871    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   17521    |   17516    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   17521    |   17516    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |  109290 KB |  108357 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  109290 KB |  108357 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |  109290 KB |  108357 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  109290 KB |  108357 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  171815 KB |  170700 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  171815 KB |  170700 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   26961    |   26759    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   26961    |   26759    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   26961    |   26759    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   26961    |   26759    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   17308    |   17301    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   17308    |   17301    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.67
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0174, -0.0229, -0.0034,  ...,  0.0472,  0.0420,  0.0434],
        [-0.0054, -0.0198, -0.0515,  ..., -0.0019,  0.0187,  0.0474],
        [ 0.0389, -0.0031,  0.0124,  ..., -0.0021, -0.0359, -0.0251],
        ...,
        [ 0.0309,  0.0025,  0.0496,  ...,  0.0240,  0.0371, -0.0340],
        [-0.0352, -0.0477,  0.0150,  ..., -0.0115,  0.0117,  0.0468],
        [-0.0334,  0.0135, -0.0060,  ..., -0.0234,  0.0114, -0.0318]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0174, -0.0229, -0.0034,  ...,  0.0472,  0.0420,  0.0434],
        [-0.0054, -0.0198, -0.0515,  ..., -0.0019,  0.0187,  0.0474],
        [ 0.0389, -0.0031,  0.0124,  ..., -0.0021, -0.0359, -0.0251],
        ...,
        [ 0.0309,  0.0025,  0.0496,  ...,  0.0240,  0.0371, -0.0340],
        [-0.0352, -0.0477,  0.0150,  ..., -0.0115,  0.0117,  0.0468],
        [-0.0334,  0.0135, -0.0060,  ..., -0.0234,  0.0114, -0.0318]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.58
======== Epoch 17 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0174, -0.0229, -0.0034,  ...,  0.0472,  0.0420,  0.0434],
        [-0.0054, -0.0198, -0.0515,  ..., -0.0019,  0.0187,  0.0474],
        [ 0.0389, -0.0031,  0.0124,  ..., -0.0021, -0.0359, -0.0251],
        ...,
        [ 0.0309,  0.0025,  0.0496,  ...,  0.0240,  0.0371, -0.0340],
        [-0.0352, -0.0477,  0.0150,  ..., -0.0115,  0.0117,  0.0468],
        [-0.0334,  0.0135, -0.0060,  ..., -0.0234,  0.0114, -0.0318]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0174, -0.0229, -0.0034,  ...,  0.0472,  0.0420,  0.0434],
        [-0.0054, -0.0198, -0.0515,  ..., -0.0019,  0.0187,  0.0474],
        [ 0.0389, -0.0031,  0.0124,  ..., -0.0021, -0.0359, -0.0251],
        ...,
        [ 0.0309,  0.0025,  0.0496,  ...,  0.0240,  0.0371, -0.0340],
        [-0.0352, -0.0477,  0.0150,  ..., -0.0115,  0.0117,  0.0468],
        [-0.0334,  0.0135, -0.0060,  ..., -0.0234,  0.0114, -0.0318]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6702, 0.6604], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |  134639 KB |  132566 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  134639 KB |  132566 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |  134639 KB |  132566 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  134639 KB |  132566 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  242238 KB |  240215 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  242238 KB |  240215 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   30037    |   29776    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   30037    |   29776    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   30037    |   29776    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   30037    |   29776    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   18706    |   18701    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   18706    |   18701    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |  117022 KB |  116089 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  117022 KB |  116089 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |  117022 KB |  116089 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  117022 KB |  116089 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  183640 KB |  182525 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  183640 KB |  182525 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   28793    |   28591    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   28793    |   28591    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   28793    |   28591    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   28793    |   28591    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   18481    |   18474    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   18481    |   18474    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.67
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0178, -0.0233, -0.0037,  ...,  0.0476,  0.0424,  0.0438],
        [-0.0059, -0.0203, -0.0519,  ..., -0.0014,  0.0191,  0.0479],
        [ 0.0394, -0.0027,  0.0129,  ..., -0.0025, -0.0364, -0.0256],
        ...,
        [ 0.0313,  0.0029,  0.0500,  ...,  0.0236,  0.0367, -0.0344],
        [-0.0356, -0.0481,  0.0145,  ..., -0.0111,  0.0121,  0.0472],
        [-0.0330,  0.0139, -0.0056,  ..., -0.0238,  0.0110, -0.0323]],
       device='cuda:0', requires_grad=True)tensor([[-0.0178, -0.0233, -0.0037,  ...,  0.0476,  0.0424,  0.0438],
        [-0.0059, -0.0203, -0.0519,  ..., -0.0014,  0.0191,  0.0479],
        [ 0.0394, -0.0027,  0.0129,  ..., -0.0025, -0.0364, -0.0256],
        ...,
        [ 0.0313,  0.0029,  0.0500,  ...,  0.0236,  0.0367, -0.0344],
        [-0.0356, -0.0481,  0.0145,  ..., -0.0111,  0.0121,  0.0472],
        [-0.0330,  0.0139, -0.0056,  ..., -0.0238,  0.0110, -0.0323]],
       device='cuda:1')
  Average validation loss: 13.58
======== Epoch 18 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0178, -0.0233, -0.0037,  ...,  0.0476,  0.0424,  0.0438],
        [-0.0059, -0.0203, -0.0519,  ..., -0.0014,  0.0191,  0.0479],
        [ 0.0394, -0.0027,  0.0129,  ..., -0.0025, -0.0364, -0.0256],
        ...,
        [ 0.0313,  0.0029,  0.0500,  ...,  0.0236,  0.0367, -0.0344],
        [-0.0356, -0.0481,  0.0145,  ..., -0.0111,  0.0121,  0.0472],
        [-0.0330,  0.0139, -0.0056,  ..., -0.0238,  0.0110, -0.0323]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0178, -0.0233, -0.0037,  ...,  0.0476,  0.0424,  0.0438],
        [-0.0059, -0.0203, -0.0519,  ..., -0.0014,  0.0191,  0.0479],
        [ 0.0394, -0.0027,  0.0129,  ..., -0.0025, -0.0364, -0.0256],
        ...,
        [ 0.0313,  0.0029,  0.0500,  ...,  0.0236,  0.0367, -0.0344],
        [-0.0356, -0.0481,  0.0145,  ..., -0.0111,  0.0121,  0.0472],
        [-0.0330,  0.0139, -0.0056,  ..., -0.0238,  0.0110, -0.0323]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6677, 0.6579], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |  143396 KB |  141323 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  143396 KB |  141323 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |  143396 KB |  141323 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  143396 KB |  141323 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  254819 KB |  252796 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  254819 KB |  252796 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   31942    |   31681    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   31942    |   31681    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   31942    |   31681    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   31942    |   31681    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   19891    |   19886    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   19891    |   19886    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |  124753 KB |  123820 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  124753 KB |  123820 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |  124753 KB |  123820 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  124753 KB |  123820 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  195466 KB |  194351 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  195466 KB |  194351 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   30625    |   30423    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   30625    |   30423    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   30625    |   30423    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   30625    |   30423    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   19654    |   19647    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   19654    |   19647    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.66
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device: 0
1
Parameter containing:
tensor([[-0.0182, -0.0237, -0.0041,  ...,  0.0480,  0.0428,  0.0442],
        [-0.0063, -0.0207, -0.0523,  ..., -0.0010,  0.0196,  0.0483],
        [ 0.0398, -0.0022,  0.0133,  ..., -0.0029, -0.0368, -0.0260],
        ...,
        [ 0.0318,  0.0033,  0.0504,  ...,  0.0232,  0.0363, -0.0348],
        [-0.0360, -0.0485,  0.0141,  ..., -0.0107,  0.0126,  0.0476],
        [-0.0325,  0.0143, -0.0051,  ..., -0.0243,  0.0105, -0.0327]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0182, -0.0237, -0.0041,  ...,  0.0480,  0.0428,  0.0442],
        [-0.0063, -0.0207, -0.0523,  ..., -0.0010,  0.0196,  0.0483],
        [ 0.0398, -0.0022,  0.0133,  ..., -0.0029, -0.0368, -0.0260],
        ...,
        [ 0.0318,  0.0033,  0.0504,  ...,  0.0232,  0.0363, -0.0348],
        [-0.0360, -0.0485,  0.0141,  ..., -0.0107,  0.0126,  0.0476],
        [-0.0325,  0.0143, -0.0051,  ..., -0.0243,  0.0105, -0.0327]],
       device='cuda:1')
  Average validation loss: 13.59
======== Epoch 19 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0182, -0.0237, -0.0041,  ...,  0.0480,  0.0428,  0.0442],
        [-0.0063, -0.0207, -0.0523,  ..., -0.0010,  0.0196,  0.0483],
        [ 0.0398, -0.0022,  0.0133,  ..., -0.0029, -0.0368, -0.0260],
        ...,
        [ 0.0318,  0.0033,  0.0504,  ...,  0.0232,  0.0363, -0.0348],
        [-0.0360, -0.0485,  0.0141,  ..., -0.0107,  0.0126,  0.0476],
        [-0.0325,  0.0143, -0.0051,  ..., -0.0243,  0.0105, -0.0327]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0182, -0.0237, -0.0041,  ...,  0.0480,  0.0428,  0.0442],
        [-0.0063, -0.0207, -0.0523,  ..., -0.0010,  0.0196,  0.0483],
        [ 0.0398, -0.0022,  0.0133,  ..., -0.0029, -0.0368, -0.0260],
        ...,
        [ 0.0318,  0.0033,  0.0504,  ...,  0.0232,  0.0363, -0.0348],
        [-0.0360, -0.0485,  0.0141,  ..., -0.0107,  0.0126,  0.0476],
        [-0.0325,  0.0143, -0.0051,  ..., -0.0243,  0.0105, -0.0327]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6651, 0.6554], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2073 KB |    2283 KB |  152154 KB |  150081 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  152154 KB |  150081 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2073 KB |    2283 KB |  152154 KB |  150081 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2073 KB |    2283 KB |  152154 KB |  150081 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2023 KB |    2486 KB |  267401 KB |  265378 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2023 KB |    2486 KB |  267401 KB |  265378 KB |
|---------------------------------------------------------------------------|
| Allocations           |     261    |     273    |   33847    |   33586    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   33847    |   33586    |
|---------------------------------------------------------------------------|
| Active allocs         |     261    |     273    |   33847    |   33586    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     261    |     273    |   33847    |   33586    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   21082    |   21077    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   21082    |   21077    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |     933 KB |    1092 KB |  132485 KB |  131552 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  132485 KB |  131552 KB |
|---------------------------------------------------------------------------|
| Active memory         |     933 KB |    1092 KB |  132485 KB |  131552 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     933 KB |    1092 KB |  132485 KB |  131552 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1115 KB |    2047 KB |  207291 KB |  206176 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1115 KB |    2047 KB |  207291 KB |  206176 KB |
|---------------------------------------------------------------------------|
| Allocations           |     202    |     215    |   32457    |   32255    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   32457    |   32255    |
|---------------------------------------------------------------------------|
| Active allocs         |     202    |     215    |   32457    |   32255    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     202    |     215    |   32457    |   32255    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   20827    |   20820    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   20827    |   20820    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.66
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0186, -0.0241, -0.0045,  ...,  0.0484,  0.0432,  0.0446],
        [-0.0067, -0.0211, -0.0527,  ..., -0.0006,  0.0200,  0.0487],
        [ 0.0402, -0.0018,  0.0137,  ..., -0.0034, -0.0372, -0.0264],
        ...,
        [ 0.0322,  0.0037,  0.0508,  ...,  0.0228,  0.0359, -0.0353],
        [-0.0364, -0.0490,  0.0137,  ..., -0.0103,  0.0130,  0.0480],
        [-0.0321,  0.0148, -0.0047,  ..., -0.0247,  0.0101, -0.0332]],
       device='cuda:0', requires_grad=True)tensor([[-0.0186, -0.0241, -0.0045,  ...,  0.0484,  0.0432,  0.0446],
        [-0.0067, -0.0211, -0.0527,  ..., -0.0006,  0.0200,  0.0487],
        [ 0.0402, -0.0018,  0.0137,  ..., -0.0034, -0.0372, -0.0264],
        ...,
        [ 0.0322,  0.0037,  0.0508,  ...,  0.0228,  0.0359, -0.0353],
        [-0.0364, -0.0490,  0.0137,  ..., -0.0103,  0.0130,  0.0480],
        [-0.0321,  0.0148, -0.0047,  ..., -0.0247,  0.0101, -0.0332]],
       device='cuda:1')
  Average validation loss: 13.59
======== Epoch 20 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20])batch input size:  Device:torch.Size([3, 20])  0Device:
 1
tensor([[-0.0186, -0.0241, -0.0045,  ...,  0.0484,  0.0432,  0.0446],
        [-0.0067, -0.0211, -0.0527,  ..., -0.0006,  0.0200,  0.0487],
        [ 0.0402, -0.0018,  0.0137,  ..., -0.0034, -0.0372, -0.0264],
        ...,
        [ 0.0322,  0.0037,  0.0508,  ...,  0.0228,  0.0359, -0.0353],
        [-0.0364, -0.0490,  0.0137,  ..., -0.0103,  0.0130,  0.0480],
        [-0.0321,  0.0148, -0.0047,  ..., -0.0247,  0.0101, -0.0332]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0186, -0.0241, -0.0045,  ...,  0.0484,  0.0432,  0.0446],
        [-0.0067, -0.0211, -0.0527,  ..., -0.0006,  0.0200,  0.0487],
        [ 0.0402, -0.0018,  0.0137,  ..., -0.0034, -0.0372, -0.0264],
        ...,
        [ 0.0322,  0.0037,  0.0508,  ...,  0.0228,  0.0359, -0.0353],
        [-0.0364, -0.0490,  0.0137,  ..., -0.0103,  0.0130,  0.0480],
        [-0.0321,  0.0148, -0.0047,  ..., -0.0247,  0.0101, -0.0332]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6625, 0.6529], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  161026 KB |  158838 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  161026 KB |  158838 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  161026 KB |  158838 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  161026 KB |  158838 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2486 KB |  277926 KB |  276018 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2486 KB |  277926 KB |  276018 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   35772    |   35491    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   35772    |   35491    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   35772    |   35491    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   35772    |   35491    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   22255    |   22249    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   22255    |   22249    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  140331 KB |  139283 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  140331 KB |  139283 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  140331 KB |  139283 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  140331 KB |  139283 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  219117 KB |  218117 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  219117 KB |  218117 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   34309    |   34087    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   34309    |   34087    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   34309    |   34087    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   34309    |   34087    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   22001    |   21994    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   22001    |   21994    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.66
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0190, -0.0245, -0.0049,  ...,  0.0488,  0.0436,  0.0450],
        [-0.0071, -0.0215, -0.0531,  ..., -0.0002,  0.0204,  0.0491],
        [ 0.0407, -0.0014,  0.0142,  ..., -0.0038, -0.0376, -0.0268],
        ...,
        [ 0.0326,  0.0042,  0.0512,  ...,  0.0224,  0.0355, -0.0357],
        [-0.0368, -0.0494,  0.0133,  ..., -0.0098,  0.0134,  0.0485],
        [-0.0316,  0.0152, -0.0042,  ..., -0.0252,  0.0096, -0.0336]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0190, -0.0245, -0.0049,  ...,  0.0488,  0.0436,  0.0450],
        [-0.0071, -0.0215, -0.0531,  ..., -0.0002,  0.0204,  0.0491],
        [ 0.0407, -0.0014,  0.0142,  ..., -0.0038, -0.0376, -0.0268],
        ...,
        [ 0.0326,  0.0042,  0.0512,  ...,  0.0224,  0.0355, -0.0357],
        [-0.0368, -0.0494,  0.0133,  ..., -0.0098,  0.0134,  0.0485],
        [-0.0316,  0.0152, -0.0042,  ..., -0.0252,  0.0096, -0.0336]],
       device='cuda:1')
  Average validation loss: 13.59
======== Epoch 21 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0190, -0.0245, -0.0049,  ...,  0.0488,  0.0436,  0.0450],
        [-0.0071, -0.0215, -0.0531,  ..., -0.0002,  0.0204,  0.0491],
        [ 0.0407, -0.0014,  0.0142,  ..., -0.0038, -0.0376, -0.0268],
        ...,
        [ 0.0326,  0.0042,  0.0512,  ...,  0.0224,  0.0355, -0.0357],
        [-0.0368, -0.0494,  0.0133,  ..., -0.0098,  0.0134,  0.0485],
        [-0.0316,  0.0152, -0.0042,  ..., -0.0252,  0.0096, -0.0336]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0190, -0.0245, -0.0049,  ...,  0.0488,  0.0436,  0.0450],
        [-0.0071, -0.0215, -0.0531,  ..., -0.0002,  0.0204,  0.0491],
        [ 0.0407, -0.0014,  0.0142,  ..., -0.0038, -0.0376, -0.0268],
        ...,
        [ 0.0326,  0.0042,  0.0512,  ...,  0.0224,  0.0355, -0.0357],
        [-0.0368, -0.0494,  0.0133,  ..., -0.0098,  0.0134,  0.0485],
        [-0.0316,  0.0152, -0.0042,  ..., -0.0252,  0.0096, -0.0336]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6598, 0.6504], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  170679 KB |  168491 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  170679 KB |  168491 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  170679 KB |  168491 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  170679 KB |  168491 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  289615 KB |  287707 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  289615 KB |  287707 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   37787    |   37506    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   37787    |   37506    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   37787    |   37506    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   37787    |   37506    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   23523    |   23517    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   23523    |   23517    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  148958 KB |  147910 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  148958 KB |  147910 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  148958 KB |  147910 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  148958 KB |  147910 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  231837 KB |  230837 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  231837 KB |  230837 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   36251    |   36029    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   36251    |   36029    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   36251    |   36029    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   36251    |   36029    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   23232    |   23225    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   23232    |   23225    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.66
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0194, -0.0249, -0.0053,  ...,  0.0492,  0.0440,  0.0454],
        [-0.0075, -0.0219, -0.0535,  ...,  0.0002,  0.0208,  0.0496],
        [ 0.0411, -0.0009,  0.0146,  ..., -0.0042, -0.0381, -0.0273],
        ...,
        [ 0.0330,  0.0046,  0.0517,  ...,  0.0220,  0.0351, -0.0361],
        [-0.0373, -0.0498,  0.0128,  ..., -0.0094,  0.0139,  0.0489],
        [-0.0312,  0.0157, -0.0038,  ..., -0.0256,  0.0092, -0.0340]],
       device='cuda:0', requires_grad=True)tensor([[-0.0194, -0.0249, -0.0053,  ...,  0.0492,  0.0440,  0.0454],
        [-0.0075, -0.0219, -0.0535,  ...,  0.0002,  0.0208,  0.0496],
        [ 0.0411, -0.0009,  0.0146,  ..., -0.0042, -0.0381, -0.0273],
        ...,
        [ 0.0330,  0.0046,  0.0517,  ...,  0.0220,  0.0351, -0.0361],
        [-0.0373, -0.0498,  0.0128,  ..., -0.0094,  0.0139,  0.0489],
        [-0.0312,  0.0157, -0.0038,  ..., -0.0256,  0.0092, -0.0340]],
       device='cuda:1')
  Average validation loss: 13.59
======== Epoch 22 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0194, -0.0249, -0.0053,  ...,  0.0492,  0.0440,  0.0454],
        [-0.0075, -0.0219, -0.0535,  ...,  0.0002,  0.0208,  0.0496],
        [ 0.0411, -0.0009,  0.0146,  ..., -0.0042, -0.0381, -0.0273],
        ...,
        [ 0.0330,  0.0046,  0.0517,  ...,  0.0220,  0.0351, -0.0361],
        [-0.0373, -0.0498,  0.0128,  ..., -0.0094,  0.0139,  0.0489],
        [-0.0312,  0.0157, -0.0038,  ..., -0.0256,  0.0092, -0.0340]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0194, -0.0249, -0.0053,  ...,  0.0492,  0.0440,  0.0454],
        [-0.0075, -0.0219, -0.0535,  ...,  0.0002,  0.0208,  0.0496],
        [ 0.0411, -0.0009,  0.0146,  ..., -0.0042, -0.0381, -0.0273],
        ...,
        [ 0.0330,  0.0046,  0.0517,  ...,  0.0220,  0.0351, -0.0361],
        [-0.0373, -0.0498,  0.0128,  ..., -0.0094,  0.0139,  0.0489],
        [-0.0312,  0.0157, -0.0038,  ..., -0.0256,  0.0092, -0.0340]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6572, 0.6479], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  180331 KB |  178143 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  180331 KB |  178143 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  180331 KB |  178143 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  180331 KB |  178143 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  301304 KB |  299396 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  301304 KB |  299396 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   39802    |   39521    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   39802    |   39521    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   39802    |   39521    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   39802    |   39521    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   24795    |   24789    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   24795    |   24789    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  157584 KB |  156536 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  157584 KB |  156536 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  157584 KB |  156536 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  157584 KB |  156536 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  244558 KB |  243558 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  244558 KB |  243558 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   38193    |   37971    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   38193    |   37971    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   38193    |   37971    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   38193    |   37971    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   24463    |   24456    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   24463    |   24456    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.65
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  10
Parameter containing:
tensor([[-0.0198, -0.0253, -0.0057,  ...,  0.0496,  0.0444,  0.0459],
        [-0.0080, -0.0224, -0.0539,  ...,  0.0007,  0.0213,  0.0500],
        [ 0.0415, -0.0005,  0.0150,  ..., -0.0047, -0.0385, -0.0277],
        ...,
        [ 0.0335,  0.0050,  0.0521,  ...,  0.0215,  0.0346, -0.0365],
        [-0.0377, -0.0502,  0.0124,  ..., -0.0090,  0.0143,  0.0494],
        [-0.0307,  0.0161, -0.0033,  ..., -0.0261,  0.0087, -0.0345]],
       device='cuda:0', requires_grad=True)tensor([[-0.0198, -0.0253, -0.0057,  ...,  0.0496,  0.0444,  0.0459],
        [-0.0080, -0.0224, -0.0539,  ...,  0.0007,  0.0213,  0.0500],
        [ 0.0415, -0.0005,  0.0150,  ..., -0.0047, -0.0385, -0.0277],
        ...,
        [ 0.0335,  0.0050,  0.0521,  ...,  0.0215,  0.0346, -0.0365],
        [-0.0377, -0.0502,  0.0124,  ..., -0.0090,  0.0143,  0.0494],
        [-0.0307,  0.0161, -0.0033,  ..., -0.0261,  0.0087, -0.0345]],
       device='cuda:1')
  Average validation loss: 13.59
======== Epoch 23 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0198, -0.0253, -0.0057,  ...,  0.0496,  0.0444,  0.0459],
        [-0.0080, -0.0224, -0.0539,  ...,  0.0007,  0.0213,  0.0500],
        [ 0.0415, -0.0005,  0.0150,  ..., -0.0047, -0.0385, -0.0277],
        ...,
        [ 0.0335,  0.0050,  0.0521,  ...,  0.0215,  0.0346, -0.0365],
        [-0.0377, -0.0502,  0.0124,  ..., -0.0090,  0.0143,  0.0494],
        [-0.0307,  0.0161, -0.0033,  ..., -0.0261,  0.0087, -0.0345]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0198, -0.0253, -0.0057,  ...,  0.0496,  0.0444,  0.0459],
        [-0.0080, -0.0224, -0.0539,  ...,  0.0007,  0.0213,  0.0500],
        [ 0.0415, -0.0005,  0.0150,  ..., -0.0047, -0.0385, -0.0277],
        ...,
        [ 0.0335,  0.0050,  0.0521,  ...,  0.0215,  0.0346, -0.0365],
        [-0.0377, -0.0502,  0.0124,  ..., -0.0090,  0.0143,  0.0494],
        [-0.0307,  0.0161, -0.0033,  ..., -0.0261,  0.0087, -0.0345]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6545, 0.6453], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  189984 KB |  187796 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  189984 KB |  187796 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  189984 KB |  187796 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  189984 KB |  187796 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  312993 KB |  311085 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  312993 KB |  311085 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   41817    |   41536    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   41817    |   41536    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   41817    |   41536    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   41817    |   41536    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   26067    |   26061    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   26067    |   26061    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  166211 KB |  165163 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  166211 KB |  165163 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  166211 KB |  165163 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  166211 KB |  165163 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  257278 KB |  256278 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  257278 KB |  256278 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   40135    |   39913    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   40135    |   39913    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   40135    |   39913    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   40135    |   39913    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   25694    |   25687    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   25694    |   25687    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.65
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-2.0197e-02, -2.5706e-02, -6.1446e-03,  ...,  5.0060e-02,
          4.4862e-02,  4.6290e-02],
        [-8.4040e-03, -2.2799e-02, -5.4344e-02,  ...,  1.0840e-03,
          2.1700e-02,  5.0444e-02],
        [ 4.1987e-02, -4.3694e-05,  1.5478e-02,  ..., -5.1068e-03,
         -3.8964e-02, -2.8173e-02],
        ...,
        [ 3.3898e-02,  5.4355e-03,  5.2518e-02,  ...,  2.1094e-02,
          3.4188e-02, -3.6958e-02],
        [-3.8142e-02, -5.0670e-02,  1.1952e-02,  ..., -8.5508e-03,
          1.4732e-02,  4.9795e-02],
        [-3.0296e-02,  1.6562e-02, -2.8889e-03,  ..., -2.6510e-02,
          8.2966e-03, -3.4945e-02]], device='cuda:1')Parameter containing:
tensor([[-2.0197e-02, -2.5706e-02, -6.1446e-03,  ...,  5.0060e-02,
          4.4862e-02,  4.6290e-02],
        [-8.4040e-03, -2.2799e-02, -5.4344e-02,  ...,  1.0840e-03,
          2.1700e-02,  5.0444e-02],
        [ 4.1987e-02, -4.3694e-05,  1.5478e-02,  ..., -5.1068e-03,
         -3.8964e-02, -2.8173e-02],
        ...,
        [ 3.3898e-02,  5.4355e-03,  5.2518e-02,  ...,  2.1094e-02,
          3.4188e-02, -3.6958e-02],
        [-3.8142e-02, -5.0670e-02,  1.1952e-02,  ..., -8.5508e-03,
          1.4732e-02,  4.9795e-02],
        [-3.0296e-02,  1.6562e-02, -2.8889e-03,  ..., -2.6510e-02,
          8.2966e-03, -3.4945e-02]], device='cuda:0', requires_grad=True)
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
  Average validation loss: 13.59
======== Epoch 24 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0 1
tensor([[-2.0197e-02, -2.5706e-02, -6.1446e-03,  ...,  5.0060e-02,
          4.4862e-02,  4.6290e-02],
        [-8.4040e-03, -2.2799e-02, -5.4344e-02,  ...,  1.0840e-03,
          2.1700e-02,  5.0444e-02],
        [ 4.1987e-02, -4.3694e-05,  1.5478e-02,  ..., -5.1068e-03,
         -3.8964e-02, -2.8173e-02],
        ...,
        [ 3.3898e-02,  5.4355e-03,  5.2518e-02,  ...,  2.1094e-02,
          3.4188e-02, -3.6958e-02],
        [-3.8142e-02, -5.0670e-02,  1.1952e-02,  ..., -8.5508e-03,
          1.4732e-02,  4.9795e-02],
        [-3.0296e-02,  1.6562e-02, -2.8889e-03,  ..., -2.6510e-02,
          8.2966e-03, -3.4945e-02]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-2.0197e-02, -2.5706e-02, -6.1446e-03,  ...,  5.0060e-02,
          4.4862e-02,  4.6290e-02],
        [-8.4040e-03, -2.2799e-02, -5.4344e-02,  ...,  1.0840e-03,
          2.1700e-02,  5.0444e-02],
        [ 4.1987e-02, -4.3694e-05,  1.5478e-02,  ..., -5.1068e-03,
         -3.8964e-02, -2.8173e-02],
        ...,
        [ 3.3898e-02,  5.4355e-03,  5.2518e-02,  ...,  2.1094e-02,
          3.4188e-02, -3.6958e-02],
        [-3.8142e-02, -5.0670e-02,  1.1952e-02,  ..., -8.5508e-03,
          1.4732e-02,  4.9795e-02],
        [-3.0296e-02,  1.6562e-02, -2.8889e-03,  ..., -2.6510e-02,
          8.2966e-03, -3.4945e-02]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.6518, 0.6427], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  199634 KB |  197446 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  199634 KB |  197446 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  199634 KB |  197446 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  199634 KB |  197446 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  324680 KB |  322772 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  324680 KB |  322772 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   43828    |   43547    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   43828    |   43547    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   43828    |   43547    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   43828    |   43547    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   27332    |   27326    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   27332    |   27326    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  174835 KB |  173787 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  174835 KB |  173787 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  174835 KB |  173787 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  174835 KB |  173787 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  269997 KB |  268997 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  269997 KB |  268997 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   42073    |   41851    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   42073    |   41851    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   42073    |   41851    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   42073    |   41851    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   26925    |   26918    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   26925    |   26918    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.65
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0206, -0.0261, -0.0066,  ...,  0.0505,  0.0453,  0.0467],
        [-0.0088, -0.0232, -0.0548,  ...,  0.0015,  0.0221,  0.0509],
        [ 0.0424,  0.0004,  0.0159,  ..., -0.0056, -0.0394, -0.0286],
        ...,
        [ 0.0343,  0.0059,  0.0530,  ...,  0.0207,  0.0337, -0.0374],
        [-0.0386, -0.0511,  0.0115,  ..., -0.0081,  0.0152,  0.0502],
        [-0.0298,  0.0170, -0.0024,  ..., -0.0270,  0.0078, -0.0354]],
       device='cuda:1')Parameter containing:
tensor([[-0.0206, -0.0261, -0.0066,  ...,  0.0505,  0.0453,  0.0467],
        [-0.0088, -0.0232, -0.0548,  ...,  0.0015,  0.0221,  0.0509],
        [ 0.0424,  0.0004,  0.0159,  ..., -0.0056, -0.0394, -0.0286],
        ...,
        [ 0.0343,  0.0059,  0.0530,  ...,  0.0207,  0.0337, -0.0374],
        [-0.0386, -0.0511,  0.0115,  ..., -0.0081,  0.0152,  0.0502],
        [-0.0298,  0.0170, -0.0024,  ..., -0.0270,  0.0078, -0.0354]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.60
======== Epoch 25 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0206, -0.0261, -0.0066,  ...,  0.0505,  0.0453,  0.0467],
        [-0.0088, -0.0232, -0.0548,  ...,  0.0015,  0.0221,  0.0509],
        [ 0.0424,  0.0004,  0.0159,  ..., -0.0056, -0.0394, -0.0286],
        ...,
        [ 0.0343,  0.0059,  0.0530,  ...,  0.0207,  0.0337, -0.0374],
        [-0.0386, -0.0511,  0.0115,  ..., -0.0081,  0.0152,  0.0502],
        [-0.0298,  0.0170, -0.0024,  ..., -0.0270,  0.0078, -0.0354]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0206, -0.0261, -0.0066,  ...,  0.0505,  0.0453,  0.0467],
        [-0.0088, -0.0232, -0.0548,  ...,  0.0015,  0.0221,  0.0509],
        [ 0.0424,  0.0004,  0.0159,  ..., -0.0056, -0.0394, -0.0286],
        ...,
        [ 0.0343,  0.0059,  0.0530,  ...,  0.0207,  0.0337, -0.0374],
        [-0.0386, -0.0511,  0.0115,  ..., -0.0081,  0.0152,  0.0502],
        [-0.0298,  0.0170, -0.0024,  ..., -0.0270,  0.0078, -0.0354]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6491, 0.6401], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  209287 KB |  207099 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  209287 KB |  207099 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  209287 KB |  207099 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  209287 KB |  207099 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  336369 KB |  334461 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  336369 KB |  334461 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   45843    |   45562    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   45843    |   45562    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   45843    |   45562    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   45843    |   45562    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   28606    |   28600    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   28606    |   28600    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  183462 KB |  182414 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  183462 KB |  182414 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  183462 KB |  182414 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  183462 KB |  182414 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  282717 KB |  281717 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  282717 KB |  281717 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   44015    |   43793    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   44015    |   43793    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   44015    |   43793    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   44015    |   43793    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   28156    |   28149    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   28156    |   28149    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.64
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-0.0210, -0.0266, -0.0070,  ...,  0.0509,  0.0457,  0.0471],
        [-0.0093, -0.0237, -0.0552,  ...,  0.0019,  0.0226,  0.0513],
        [ 0.0429,  0.0008,  0.0164,  ..., -0.0060, -0.0399, -0.0291],
        ...,
        [ 0.0348,  0.0063,  0.0534,  ...,  0.0202,  0.0333, -0.0378],
        [-0.0390, -0.0515,  0.0111,  ..., -0.0077,  0.0156,  0.0507],
        [-0.0294,  0.0175, -0.0020,  ..., -0.0274,  0.0074, -0.0358]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0210, -0.0266, -0.0070,  ...,  0.0509,  0.0457,  0.0471],
        [-0.0093, -0.0237, -0.0552,  ...,  0.0019,  0.0226,  0.0513],
        [ 0.0429,  0.0008,  0.0164,  ..., -0.0060, -0.0399, -0.0291],
        ...,
        [ 0.0348,  0.0063,  0.0534,  ...,  0.0202,  0.0333, -0.0378],
        [-0.0390, -0.0515,  0.0111,  ..., -0.0077,  0.0156,  0.0507],
        [-0.0294,  0.0175, -0.0020,  ..., -0.0274,  0.0074, -0.0358]],
       device='cuda:1')
  Average validation loss: 13.60
======== Epoch 26 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0210, -0.0266, -0.0070,  ...,  0.0509,  0.0457,  0.0471],
        [-0.0093, -0.0237, -0.0552,  ...,  0.0019,  0.0226,  0.0513],
        [ 0.0429,  0.0008,  0.0164,  ..., -0.0060, -0.0399, -0.0291],
        ...,
        [ 0.0348,  0.0063,  0.0534,  ...,  0.0202,  0.0333, -0.0378],
        [-0.0390, -0.0515,  0.0111,  ..., -0.0077,  0.0156,  0.0507],
        [-0.0294,  0.0175, -0.0020,  ..., -0.0274,  0.0074, -0.0358]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0210, -0.0266, -0.0070,  ...,  0.0509,  0.0457,  0.0471],
        [-0.0093, -0.0237, -0.0552,  ...,  0.0019,  0.0226,  0.0513],
        [ 0.0429,  0.0008,  0.0164,  ..., -0.0060, -0.0399, -0.0291],
        ...,
        [ 0.0348,  0.0063,  0.0534,  ...,  0.0202,  0.0333, -0.0378],
        [-0.0390, -0.0515,  0.0111,  ..., -0.0077,  0.0156,  0.0507],
        [-0.0294,  0.0175, -0.0020,  ..., -0.0274,  0.0074, -0.0358]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6464, 0.6375], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  218939 KB |  216751 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  218939 KB |  216751 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  218939 KB |  216751 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  218939 KB |  216751 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  348058 KB |  346150 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  348058 KB |  346150 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   47858    |   47577    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   47858    |   47577    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   47858    |   47577    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   47858    |   47577    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   29879    |   29873    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   29879    |   29873    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  192088 KB |  191040 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  192088 KB |  191040 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  192088 KB |  191040 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  192088 KB |  191040 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  295438 KB |  294438 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  295438 KB |  294438 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   45957    |   45735    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   45957    |   45735    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   45957    |   45735    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   45957    |   45735    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   29387    |   29380    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   29387    |   29380    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.64
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0215, -0.0270, -0.0074,  ...,  0.0513,  0.0462,  0.0476],
        [-0.0097, -0.0241, -0.0556,  ...,  0.0024,  0.0230,  0.0517],
        [ 0.0433,  0.0013,  0.0168,  ..., -0.0064, -0.0403, -0.0295],
        ...,
        [ 0.0352,  0.0068,  0.0538,  ...,  0.0198,  0.0329, -0.0383],
        [-0.0394, -0.0520,  0.0106,  ..., -0.0073,  0.0160,  0.0511],
        [-0.0289,  0.0179, -0.0015,  ..., -0.0279,  0.0069, -0.0363]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0215, -0.0270, -0.0074,  ...,  0.0513,  0.0462,  0.0476],
        [-0.0097, -0.0241, -0.0556,  ...,  0.0024,  0.0230,  0.0517],
        [ 0.0433,  0.0013,  0.0168,  ..., -0.0064, -0.0403, -0.0295],
        ...,
        [ 0.0352,  0.0068,  0.0538,  ...,  0.0198,  0.0329, -0.0383],
        [-0.0394, -0.0520,  0.0106,  ..., -0.0073,  0.0160,  0.0511],
        [-0.0289,  0.0179, -0.0015,  ..., -0.0279,  0.0069, -0.0363]],
       device='cuda:1')
  Average validation loss: 13.60
======== Epoch 27 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0215, -0.0270, -0.0074,  ...,  0.0513,  0.0462,  0.0476],
        [-0.0097, -0.0241, -0.0556,  ...,  0.0024,  0.0230,  0.0517],
        [ 0.0433,  0.0013,  0.0168,  ..., -0.0064, -0.0403, -0.0295],
        ...,
        [ 0.0352,  0.0068,  0.0538,  ...,  0.0198,  0.0329, -0.0383],
        [-0.0394, -0.0520,  0.0106,  ..., -0.0073,  0.0160,  0.0511],
        [-0.0289,  0.0179, -0.0015,  ..., -0.0279,  0.0069, -0.0363]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0215, -0.0270, -0.0074,  ...,  0.0513,  0.0462,  0.0476],
        [-0.0097, -0.0241, -0.0556,  ...,  0.0024,  0.0230,  0.0517],
        [ 0.0433,  0.0013,  0.0168,  ..., -0.0064, -0.0403, -0.0295],
        ...,
        [ 0.0352,  0.0068,  0.0538,  ...,  0.0198,  0.0329, -0.0383],
        [-0.0394, -0.0520,  0.0106,  ..., -0.0073,  0.0160,  0.0511],
        [-0.0289,  0.0179, -0.0015,  ..., -0.0279,  0.0069, -0.0363]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6437, 0.6348], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  228592 KB |  226404 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  228592 KB |  226404 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  228592 KB |  226404 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  228592 KB |  226404 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  359747 KB |  357839 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  359747 KB |  357839 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   49873    |   49592    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   49873    |   49592    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   49873    |   49592    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   49873    |   49592    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   31142    |   31136    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   31142    |   31136    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  200715 KB |  199667 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  200715 KB |  199667 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  200715 KB |  199667 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  200715 KB |  199667 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  308158 KB |  307158 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  308158 KB |  307158 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   47899    |   47677    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   47899    |   47677    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   47899    |   47677    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   47899    |   47677    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   30618    |   30611    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   30618    |   30611    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.64
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0219, -0.0274, -0.0078,  ...,  0.0518,  0.0466,  0.0480],
        [-0.0101, -0.0245, -0.0560,  ...,  0.0028,  0.0234,  0.0522],
        [ 0.0438,  0.0017,  0.0173,  ..., -0.0069, -0.0407, -0.0300],
        ...,
        [ 0.0357,  0.0072,  0.0543,  ...,  0.0193,  0.0324, -0.0387],
        [-0.0399, -0.0524,  0.0102,  ..., -0.0068,  0.0165,  0.0516],
        [-0.0285,  0.0184, -0.0011,  ..., -0.0283,  0.0065, -0.0368]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0219, -0.0274, -0.0078,  ...,  0.0518,  0.0466,  0.0480],
        [-0.0101, -0.0245, -0.0560,  ...,  0.0028,  0.0234,  0.0522],
        [ 0.0438,  0.0017,  0.0173,  ..., -0.0069, -0.0407, -0.0300],
        ...,
        [ 0.0357,  0.0072,  0.0543,  ...,  0.0193,  0.0324, -0.0387],
        [-0.0399, -0.0524,  0.0102,  ..., -0.0068,  0.0165,  0.0516],
        [-0.0285,  0.0184, -0.0011,  ..., -0.0283,  0.0065, -0.0368]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.60
======== Epoch 28 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0219, -0.0274, -0.0078,  ...,  0.0518,  0.0466,  0.0480],
        [-0.0101, -0.0245, -0.0560,  ...,  0.0028,  0.0234,  0.0522],
        [ 0.0438,  0.0017,  0.0173,  ..., -0.0069, -0.0407, -0.0300],
        ...,
        [ 0.0357,  0.0072,  0.0543,  ...,  0.0193,  0.0324, -0.0387],
        [-0.0399, -0.0524,  0.0102,  ..., -0.0068,  0.0165,  0.0516],
        [-0.0285,  0.0184, -0.0011,  ..., -0.0283,  0.0065, -0.0368]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0219, -0.0274, -0.0078,  ...,  0.0518,  0.0466,  0.0480],
        [-0.0101, -0.0245, -0.0560,  ...,  0.0028,  0.0234,  0.0522],
        [ 0.0438,  0.0017,  0.0173,  ..., -0.0069, -0.0407, -0.0300],
        ...,
        [ 0.0357,  0.0072,  0.0543,  ...,  0.0193,  0.0324, -0.0387],
        [-0.0399, -0.0524,  0.0102,  ..., -0.0068,  0.0165,  0.0516],
        [-0.0285,  0.0184, -0.0011,  ..., -0.0283,  0.0065, -0.0368]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6409, 0.6322], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  238244 KB |  236056 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  238244 KB |  236056 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  238244 KB |  236056 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  238244 KB |  236056 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  371436 KB |  369528 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  371436 KB |  369528 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   51888    |   51607    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   51888    |   51607    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   51888    |   51607    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   51888    |   51607    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   32418    |   32412    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   32418    |   32412    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  209341 KB |  208293 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  209341 KB |  208293 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  209341 KB |  208293 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  209341 KB |  208293 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  320879 KB |  319879 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  320879 KB |  319879 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   49841    |   49619    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   49841    |   49619    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   49841    |   49619    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   49841    |   49619    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   31849    |   31842    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   31849    |   31842    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.64
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0223, -0.0278, -0.0083,  ...,  0.0522,  0.0470,  0.0484],
        [-0.0106, -0.0249, -0.0564,  ...,  0.0032,  0.0239,  0.0526],
        [ 0.0442,  0.0022,  0.0177,  ..., -0.0073, -0.0412, -0.0304],
        ...,
        [ 0.0361,  0.0076,  0.0547,  ...,  0.0189,  0.0320, -0.0392],
        [-0.0403, -0.0528,  0.0098,  ..., -0.0064,  0.0169,  0.0520],
        [-0.0280,  0.0188, -0.0006,  ..., -0.0288,  0.0060, -0.0372]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0223, -0.0278, -0.0083,  ...,  0.0522,  0.0470,  0.0484],
        [-0.0106, -0.0249, -0.0564,  ...,  0.0032,  0.0239,  0.0526],
        [ 0.0442,  0.0022,  0.0177,  ..., -0.0073, -0.0412, -0.0304],
        ...,
        [ 0.0361,  0.0076,  0.0547,  ...,  0.0189,  0.0320, -0.0392],
        [-0.0403, -0.0528,  0.0098,  ..., -0.0064,  0.0169,  0.0520],
        [-0.0280,  0.0188, -0.0006,  ..., -0.0288,  0.0060, -0.0372]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.60
======== Epoch 29 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0223, -0.0278, -0.0083,  ...,  0.0522,  0.0470,  0.0484],
        [-0.0106, -0.0249, -0.0564,  ...,  0.0032,  0.0239,  0.0526],
        [ 0.0442,  0.0022,  0.0177,  ..., -0.0073, -0.0412, -0.0304],
        ...,
        [ 0.0361,  0.0076,  0.0547,  ...,  0.0189,  0.0320, -0.0392],
        [-0.0403, -0.0528,  0.0098,  ..., -0.0064,  0.0169,  0.0520],
        [-0.0280,  0.0188, -0.0006,  ..., -0.0288,  0.0060, -0.0372]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0223, -0.0278, -0.0083,  ...,  0.0522,  0.0470,  0.0484],
        [-0.0106, -0.0249, -0.0564,  ...,  0.0032,  0.0239,  0.0526],
        [ 0.0442,  0.0022,  0.0177,  ..., -0.0073, -0.0412, -0.0304],
        ...,
        [ 0.0361,  0.0076,  0.0547,  ...,  0.0189,  0.0320, -0.0392],
        [-0.0403, -0.0528,  0.0098,  ..., -0.0064,  0.0169,  0.0520],
        [-0.0280,  0.0188, -0.0006,  ..., -0.0288,  0.0060, -0.0372]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6382, 0.6295], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2188 KB |    2398 KB |  247897 KB |  245709 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  247897 KB |  245709 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2188 KB |    2398 KB |  247897 KB |  245709 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2188 KB |    2398 KB |  247897 KB |  245709 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1908 KB |    2749 KB |  383125 KB |  381217 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1908 KB |    2749 KB |  383125 KB |  381217 KB |
|---------------------------------------------------------------------------|
| Allocations           |     281    |     293    |   53903    |   53622    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   53903    |   53622    |
|---------------------------------------------------------------------------|
| Active allocs         |     281    |     293    |   53903    |   53622    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     281    |     293    |   53903    |   53622    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   33688    |   33682    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   33688    |   33682    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1048 KB |    1207 KB |  217968 KB |  216920 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  217968 KB |  216920 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1048 KB |    1207 KB |  217968 KB |  216920 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1048 KB |    1207 KB |  217968 KB |  216920 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1000 KB |    2047 KB |  333599 KB |  332599 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1000 KB |    2047 KB |  333599 KB |  332599 KB |
|---------------------------------------------------------------------------|
| Allocations           |     222    |     235    |   51783    |   51561    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   51783    |   51561    |
|---------------------------------------------------------------------------|
| Active allocs         |     222    |     235    |   51783    |   51561    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     222    |     235    |   51783    |   51561    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   33080    |   33073    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   33080    |   33073    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.63
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0228, -0.0283, -0.0087,  ...,  0.0527,  0.0475,  0.0489],
        [-0.0110, -0.0254, -0.0568,  ...,  0.0036,  0.0243,  0.0530],
        [ 0.0447,  0.0026,  0.0182,  ..., -0.0078, -0.0416, -0.0309],
        ...,
        [ 0.0366,  0.0081,  0.0552,  ...,  0.0184,  0.0315, -0.0396],
        [-0.0407, -0.0533,  0.0093,  ..., -0.0060,  0.0174,  0.0524],
        [-0.0276,  0.0193, -0.0002,  ..., -0.0292,  0.0056, -0.0377]],
       device='cuda:0', requires_grad=True)tensor([[-0.0228, -0.0283, -0.0087,  ...,  0.0527,  0.0475,  0.0489],
        [-0.0110, -0.0254, -0.0568,  ...,  0.0036,  0.0243,  0.0530],
        [ 0.0447,  0.0026,  0.0182,  ..., -0.0078, -0.0416, -0.0309],
        ...,
        [ 0.0366,  0.0081,  0.0552,  ...,  0.0184,  0.0315, -0.0396],
        [-0.0407, -0.0533,  0.0093,  ..., -0.0060,  0.0174,  0.0524],
        [-0.0276,  0.0193, -0.0002,  ..., -0.0292,  0.0056, -0.0377]],
       device='cuda:1')
  Average validation loss: 13.60
======== Epoch 30 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0228, -0.0283, -0.0087,  ...,  0.0527,  0.0475,  0.0489],
        [-0.0110, -0.0254, -0.0568,  ...,  0.0036,  0.0243,  0.0530],
        [ 0.0447,  0.0026,  0.0182,  ..., -0.0078, -0.0416, -0.0309],
        ...,
        [ 0.0366,  0.0081,  0.0552,  ...,  0.0184,  0.0315, -0.0396],
        [-0.0407, -0.0533,  0.0093,  ..., -0.0060,  0.0174,  0.0524],
        [-0.0276,  0.0193, -0.0002,  ..., -0.0292,  0.0056, -0.0377]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0228, -0.0283, -0.0087,  ...,  0.0527,  0.0475,  0.0489],
        [-0.0110, -0.0254, -0.0568,  ...,  0.0036,  0.0243,  0.0530],
        [ 0.0447,  0.0026,  0.0182,  ..., -0.0078, -0.0416, -0.0309],
        ...,
        [ 0.0366,  0.0081,  0.0552,  ...,  0.0184,  0.0315, -0.0396],
        [-0.0407, -0.0533,  0.0093,  ..., -0.0060,  0.0174,  0.0524],
        [-0.0276,  0.0193, -0.0002,  ..., -0.0292,  0.0056, -0.0377]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6354, 0.6269], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  257664 KB |  255361 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  257664 KB |  255361 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  257664 KB |  255361 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  257664 KB |  255361 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  394814 KB |  393021 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  394814 KB |  393021 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   55938    |   55637    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   55938    |   55637    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   55938    |   55637    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   55938    |   55637    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   34969    |   34964    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   34969    |   34964    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  226709 KB |  225546 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  226709 KB |  225546 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  226709 KB |  225546 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  226709 KB |  225546 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  346320 KB |  345435 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  346320 KB |  345435 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   53745    |   53503    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   53745    |   53503    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   53745    |   53503    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   53745    |   53503    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   34311    |   34304    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   34311    |   34304    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.63
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0232, -0.0287, -0.0091,  ...,  0.0531,  0.0479,  0.0493],
        [-0.0114, -0.0258, -0.0572,  ...,  0.0041,  0.0247,  0.0535],
        [ 0.0451,  0.0031,  0.0186,  ..., -0.0082, -0.0421, -0.0313],
        ...,
        [ 0.0370,  0.0085,  0.0556,  ...,  0.0180,  0.0311, -0.0400],
        [-0.0412, -0.0537,  0.0089,  ..., -0.0055,  0.0178,  0.0529],
        [-0.0271,  0.0197,  0.0003,  ..., -0.0297,  0.0051, -0.0381]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0232, -0.0287, -0.0091,  ...,  0.0531,  0.0479,  0.0493],
        [-0.0114, -0.0258, -0.0572,  ...,  0.0041,  0.0247,  0.0535],
        [ 0.0451,  0.0031,  0.0186,  ..., -0.0082, -0.0421, -0.0313],
        ...,
        [ 0.0370,  0.0085,  0.0556,  ...,  0.0180,  0.0311, -0.0400],
        [-0.0412, -0.0537,  0.0089,  ..., -0.0055,  0.0178,  0.0529],
        [-0.0271,  0.0197,  0.0003,  ..., -0.0297,  0.0051, -0.0381]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.60
======== Epoch 31 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0232, -0.0287, -0.0091,  ...,  0.0531,  0.0479,  0.0493],
        [-0.0114, -0.0258, -0.0572,  ...,  0.0041,  0.0247,  0.0535],
        [ 0.0451,  0.0031,  0.0186,  ..., -0.0082, -0.0421, -0.0313],
        ...,
        [ 0.0370,  0.0085,  0.0556,  ...,  0.0180,  0.0311, -0.0400],
        [-0.0412, -0.0537,  0.0089,  ..., -0.0055,  0.0178,  0.0529],
        [-0.0271,  0.0197,  0.0003,  ..., -0.0297,  0.0051, -0.0381]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0232, -0.0287, -0.0091,  ...,  0.0531,  0.0479,  0.0493],
        [-0.0114, -0.0258, -0.0572,  ...,  0.0041,  0.0247,  0.0535],
        [ 0.0451,  0.0031,  0.0186,  ..., -0.0082, -0.0421, -0.0313],
        ...,
        [ 0.0370,  0.0085,  0.0556,  ...,  0.0180,  0.0311, -0.0400],
        [-0.0412, -0.0537,  0.0089,  ..., -0.0055,  0.0178,  0.0529],
        [-0.0271,  0.0197,  0.0003,  ..., -0.0297,  0.0051, -0.0381]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6327, 0.6242], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  268212 KB |  265909 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  268212 KB |  265909 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  268212 KB |  265909 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  268212 KB |  265909 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  407130 KB |  405337 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  407130 KB |  405337 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   58063    |   57762    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   58063    |   57762    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   58063    |   57762    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   58063    |   57762    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   36254    |   36249    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   36254    |   36249    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  236231 KB |  235068 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  236231 KB |  235068 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  236231 KB |  235068 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  236231 KB |  235068 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  359935 KB |  359050 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  359935 KB |  359050 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   55797    |   55555    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   55797    |   55555    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   55797    |   55555    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   55797    |   55555    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   35602    |   35595    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   35602    |   35595    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.63
batch input size: torch.Size([1, 20]) Device: 0
Parameter containing:
tensor([[-0.0236, -0.0291, -0.0096,  ...,  0.0535,  0.0483,  0.0498],
        [-0.0118, -0.0262, -0.0577,  ...,  0.0045,  0.0251,  0.0539],
        [ 0.0456,  0.0035,  0.0191,  ..., -0.0087, -0.0425, -0.0318],
        ...,
        [ 0.0375,  0.0090,  0.0561,  ...,  0.0175,  0.0306, -0.0405],
        [-0.0416, -0.0541,  0.0084,  ..., -0.0051,  0.0182,  0.0533],
        [-0.0267,  0.0202,  0.0007,  ..., -0.0301,  0.0047, -0.0386]],
       device='cuda:0', requires_grad=True)
batch input size: torch.Size([1, 20]) Device: 1
tensor([[-0.0236, -0.0291, -0.0096,  ...,  0.0535,  0.0483,  0.0498],
        [-0.0118, -0.0262, -0.0577,  ...,  0.0045,  0.0251,  0.0539],
        [ 0.0456,  0.0035,  0.0191,  ..., -0.0087, -0.0425, -0.0318],
        ...,
        [ 0.0375,  0.0090,  0.0561,  ...,  0.0175,  0.0306, -0.0405],
        [-0.0416, -0.0541,  0.0084,  ..., -0.0051,  0.0182,  0.0533],
        [-0.0267,  0.0202,  0.0007,  ..., -0.0301,  0.0047, -0.0386]],
       device='cuda:1')
  Average validation loss: 13.61
======== Epoch 32 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0236, -0.0291, -0.0096,  ...,  0.0535,  0.0483,  0.0498],
        [-0.0118, -0.0262, -0.0577,  ...,  0.0045,  0.0251,  0.0539],
        [ 0.0456,  0.0035,  0.0191,  ..., -0.0087, -0.0425, -0.0318],
        ...,
        [ 0.0375,  0.0090,  0.0561,  ...,  0.0175,  0.0306, -0.0405],
        [-0.0416, -0.0541,  0.0084,  ..., -0.0051,  0.0182,  0.0533],
        [-0.0267,  0.0202,  0.0007,  ..., -0.0301,  0.0047, -0.0386]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0236, -0.0291, -0.0096,  ...,  0.0535,  0.0483,  0.0498],
        [-0.0118, -0.0262, -0.0577,  ...,  0.0045,  0.0251,  0.0539],
        [ 0.0456,  0.0035,  0.0191,  ..., -0.0087, -0.0425, -0.0318],
        ...,
        [ 0.0375,  0.0090,  0.0561,  ...,  0.0175,  0.0306, -0.0405],
        [-0.0416, -0.0541,  0.0084,  ..., -0.0051,  0.0182,  0.0533],
        [-0.0267,  0.0202,  0.0007,  ..., -0.0301,  0.0047, -0.0386]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6299, 0.6215], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  278759 KB |  276456 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  278759 KB |  276456 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  278759 KB |  276456 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  278759 KB |  276456 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  419445 KB |  417652 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  419445 KB |  417652 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   60188    |   59887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   60188    |   59887    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   60188    |   59887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   60188    |   59887    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   37530    |   37525    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   37530    |   37525    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  245752 KB |  244589 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  245752 KB |  244589 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  245752 KB |  244589 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  245752 KB |  244589 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  373551 KB |  372666 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  373551 KB |  372666 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   57849    |   57607    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   57849    |   57607    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   57849    |   57607    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   57849    |   57607    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   36893    |   36886    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   36893    |   36886    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.63
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
tensor([[-0.0241, -0.0296, -0.0100,  ...,  0.0540,  0.0488,  0.0502],
        [-0.0123, -0.0267, -0.0581,  ...,  0.0049,  0.0256,  0.0543],
        [ 0.0460,  0.0040,  0.0195,  ..., -0.0091, -0.0430, -0.0322],
        ...,
        [ 0.0379,  0.0094,  0.0565,  ...,  0.0171,  0.0302, -0.0409],
        [-0.0421, -0.0546,  0.0080,  ..., -0.0046,  0.0187,  0.0538],
        [-0.0262,  0.0206,  0.0012,  ..., -0.0306,  0.0042, -0.0390]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0241, -0.0296, -0.0100,  ...,  0.0540,  0.0488,  0.0502],
        [-0.0123, -0.0267, -0.0581,  ...,  0.0049,  0.0256,  0.0543],
        [ 0.0460,  0.0040,  0.0195,  ..., -0.0091, -0.0430, -0.0322],
        ...,
        [ 0.0379,  0.0094,  0.0565,  ...,  0.0171,  0.0302, -0.0409],
        [-0.0421, -0.0546,  0.0080,  ..., -0.0046,  0.0187,  0.0538],
        [-0.0262,  0.0206,  0.0012,  ..., -0.0306,  0.0042, -0.0390]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.61
======== Epoch 33 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0241, -0.0296, -0.0100,  ...,  0.0540,  0.0488,  0.0502],
        [-0.0123, -0.0267, -0.0581,  ...,  0.0049,  0.0256,  0.0543],
        [ 0.0460,  0.0040,  0.0195,  ..., -0.0091, -0.0430, -0.0322],
        ...,
        [ 0.0379,  0.0094,  0.0565,  ...,  0.0171,  0.0302, -0.0409],
        [-0.0421, -0.0546,  0.0080,  ..., -0.0046,  0.0187,  0.0538],
        [-0.0262,  0.0206,  0.0012,  ..., -0.0306,  0.0042, -0.0390]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0241, -0.0296, -0.0100,  ...,  0.0540,  0.0488,  0.0502],
        [-0.0123, -0.0267, -0.0581,  ...,  0.0049,  0.0256,  0.0543],
        [ 0.0460,  0.0040,  0.0195,  ..., -0.0091, -0.0430, -0.0322],
        ...,
        [ 0.0379,  0.0094,  0.0565,  ...,  0.0171,  0.0302, -0.0409],
        [-0.0421, -0.0546,  0.0080,  ..., -0.0046,  0.0187,  0.0538],
        [-0.0262,  0.0206,  0.0012,  ..., -0.0306,  0.0042, -0.0390]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6271, 0.6189], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  289307 KB |  287004 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  289307 KB |  287004 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  289307 KB |  287004 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  289307 KB |  287004 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  431761 KB |  429968 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  431761 KB |  429968 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   62313    |   62012    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   62313    |   62012    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   62313    |   62012    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   62313    |   62012    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   38808    |   38803    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   38808    |   38803    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  255274 KB |  254111 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  255274 KB |  254111 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  255274 KB |  254111 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  255274 KB |  254111 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  387166 KB |  386281 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  387166 KB |  386281 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   59901    |   59659    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   59901    |   59659    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   59901    |   59659    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   59901    |   59659    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   38184    |   38177    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   38184    |   38177    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.62
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0245, -0.0300, -0.0104,  ...,  0.0544,  0.0492,  0.0506],
        [-0.0127, -0.0271, -0.0585,  ...,  0.0053,  0.0260,  0.0547],
        [ 0.0465,  0.0044,  0.0200,  ..., -0.0096, -0.0434, -0.0327],
        ...,
        [ 0.0384,  0.0099,  0.0570,  ...,  0.0166,  0.0297, -0.0414],
        [-0.0425, -0.0550,  0.0076,  ..., -0.0042,  0.0191,  0.0542],
        [-0.0258,  0.0211,  0.0016,  ..., -0.0310,  0.0038, -0.0395]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0245, -0.0300, -0.0104,  ...,  0.0544,  0.0492,  0.0506],
        [-0.0127, -0.0271, -0.0585,  ...,  0.0053,  0.0260,  0.0547],
        [ 0.0465,  0.0044,  0.0200,  ..., -0.0096, -0.0434, -0.0327],
        ...,
        [ 0.0384,  0.0099,  0.0570,  ...,  0.0166,  0.0297, -0.0414],
        [-0.0425, -0.0550,  0.0076,  ..., -0.0042,  0.0191,  0.0542],
        [-0.0258,  0.0211,  0.0016,  ..., -0.0310,  0.0038, -0.0395]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.61
======== Epoch 34 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0245, -0.0300, -0.0104,  ...,  0.0544,  0.0492,  0.0506],
        [-0.0127, -0.0271, -0.0585,  ...,  0.0053,  0.0260,  0.0547],
        [ 0.0465,  0.0044,  0.0200,  ..., -0.0096, -0.0434, -0.0327],
        ...,
        [ 0.0384,  0.0099,  0.0570,  ...,  0.0166,  0.0297, -0.0414],
        [-0.0425, -0.0550,  0.0076,  ..., -0.0042,  0.0191,  0.0542],
        [-0.0258,  0.0211,  0.0016,  ..., -0.0310,  0.0038, -0.0395]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0245, -0.0300, -0.0104,  ...,  0.0544,  0.0492,  0.0506],
        [-0.0127, -0.0271, -0.0585,  ...,  0.0053,  0.0260,  0.0547],
        [ 0.0465,  0.0044,  0.0200,  ..., -0.0096, -0.0434, -0.0327],
        ...,
        [ 0.0384,  0.0099,  0.0570,  ...,  0.0166,  0.0297, -0.0414],
        [-0.0425, -0.0550,  0.0076,  ..., -0.0042,  0.0191,  0.0542],
        [-0.0258,  0.0211,  0.0016,  ..., -0.0310,  0.0038, -0.0395]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6244, 0.6162], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  299854 KB |  297551 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  299854 KB |  297551 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  299854 KB |  297551 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  299854 KB |  297551 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  444076 KB |  442283 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  444076 KB |  442283 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   64438    |   64137    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   64438    |   64137    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   64438    |   64137    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   64438    |   64137    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   40090    |   40085    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   40090    |   40085    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  264795 KB |  263632 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  264795 KB |  263632 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  264795 KB |  263632 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  264795 KB |  263632 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  400782 KB |  399897 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  400782 KB |  399897 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   61953    |   61711    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   61953    |   61711    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   61953    |   61711    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   61953    |   61711    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   39475    |   39468    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   39475    |   39468    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.62
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0249, -0.0305, -0.0109,  ...,  0.0549,  0.0497,  0.0511],
        [-0.0131, -0.0275, -0.0589,  ...,  0.0057,  0.0264,  0.0552],
        [ 0.0469,  0.0049,  0.0204,  ..., -0.0100, -0.0439, -0.0331],
        ...,
        [ 0.0388,  0.0103,  0.0574,  ...,  0.0162,  0.0293, -0.0418],
        [-0.0429, -0.0554,  0.0071,  ..., -0.0038,  0.0196,  0.0547],
        [-0.0253,  0.0216,  0.0021,  ..., -0.0315,  0.0033, -0.0399]],
       device='cuda:0', requires_grad=True)tensor([[-0.0249, -0.0305, -0.0109,  ...,  0.0549,  0.0497,  0.0511],
        [-0.0131, -0.0275, -0.0589,  ...,  0.0057,  0.0264,  0.0552],
        [ 0.0469,  0.0049,  0.0204,  ..., -0.0100, -0.0439, -0.0331],
        ...,
        [ 0.0388,  0.0103,  0.0574,  ...,  0.0162,  0.0293, -0.0418],
        [-0.0429, -0.0554,  0.0071,  ..., -0.0038,  0.0196,  0.0547],
        [-0.0253,  0.0216,  0.0021,  ..., -0.0315,  0.0033, -0.0399]],
       device='cuda:1')
  Average validation loss: 13.61
======== Epoch 35 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device:batch input size:  0torch.Size([3, 20])
 Device: 1
tensor([[-0.0249, -0.0305, -0.0109,  ...,  0.0549,  0.0497,  0.0511],
        [-0.0131, -0.0275, -0.0589,  ...,  0.0057,  0.0264,  0.0552],
        [ 0.0469,  0.0049,  0.0204,  ..., -0.0100, -0.0439, -0.0331],
        ...,
        [ 0.0388,  0.0103,  0.0574,  ...,  0.0162,  0.0293, -0.0418],
        [-0.0429, -0.0554,  0.0071,  ..., -0.0038,  0.0196,  0.0547],
        [-0.0253,  0.0216,  0.0021,  ..., -0.0315,  0.0033, -0.0399]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0249, -0.0305, -0.0109,  ...,  0.0549,  0.0497,  0.0511],
        [-0.0131, -0.0275, -0.0589,  ...,  0.0057,  0.0264,  0.0552],
        [ 0.0469,  0.0049,  0.0204,  ..., -0.0100, -0.0439, -0.0331],
        ...,
        [ 0.0388,  0.0103,  0.0574,  ...,  0.0162,  0.0293, -0.0418],
        [-0.0429, -0.0554,  0.0071,  ..., -0.0038,  0.0196,  0.0547],
        [-0.0253,  0.0216,  0.0021,  ..., -0.0315,  0.0033, -0.0399]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6216, 0.6135], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  310402 KB |  308099 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  310402 KB |  308099 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  310402 KB |  308099 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  310402 KB |  308099 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  456392 KB |  454599 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  456392 KB |  454599 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   66563    |   66262    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   66563    |   66262    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   66563    |   66262    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   66563    |   66262    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   41368    |   41363    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   41368    |   41363    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  274317 KB |  273154 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  274317 KB |  273154 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  274317 KB |  273154 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  274317 KB |  273154 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  414397 KB |  413512 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  414397 KB |  413512 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   64005    |   63763    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   64005    |   63763    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   64005    |   63763    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   64005    |   63763    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   40766    |   40759    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   40766    |   40759    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.62
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0254, -0.0309, -0.0113,  ...,  0.0553,  0.0501,  0.0515],
        [-0.0135, -0.0279, -0.0593,  ...,  0.0061,  0.0268,  0.0556],
        [ 0.0474,  0.0053,  0.0209,  ..., -0.0105, -0.0443, -0.0336],
        ...,
        [ 0.0392,  0.0108,  0.0579,  ...,  0.0158,  0.0288, -0.0423],
        [-0.0434, -0.0559,  0.0067,  ..., -0.0033,  0.0200,  0.0551],
        [-0.0249,  0.0220,  0.0025,  ..., -0.0319,  0.0029, -0.0404]],
       device='cuda:0', requires_grad=True)tensor([[-0.0254, -0.0309, -0.0113,  ...,  0.0553,  0.0501,  0.0515],
        [-0.0135, -0.0279, -0.0593,  ...,  0.0061,  0.0268,  0.0556],
        [ 0.0474,  0.0053,  0.0209,  ..., -0.0105, -0.0443, -0.0336],
        ...,
        [ 0.0392,  0.0108,  0.0579,  ...,  0.0158,  0.0288, -0.0423],
        [-0.0434, -0.0559,  0.0067,  ..., -0.0033,  0.0200,  0.0551],
        [-0.0249,  0.0220,  0.0025,  ..., -0.0319,  0.0029, -0.0404]],
       device='cuda:1')
  Average validation loss: 13.61
======== Epoch 36 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0254, -0.0309, -0.0113,  ...,  0.0553,  0.0501,  0.0515],
        [-0.0135, -0.0279, -0.0593,  ...,  0.0061,  0.0268,  0.0556],
        [ 0.0474,  0.0053,  0.0209,  ..., -0.0105, -0.0443, -0.0336],
        ...,
        [ 0.0392,  0.0108,  0.0579,  ...,  0.0158,  0.0288, -0.0423],
        [-0.0434, -0.0559,  0.0067,  ..., -0.0033,  0.0200,  0.0551],
        [-0.0249,  0.0220,  0.0025,  ..., -0.0319,  0.0029, -0.0404]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0254, -0.0309, -0.0113,  ...,  0.0553,  0.0501,  0.0515],
        [-0.0135, -0.0279, -0.0593,  ...,  0.0061,  0.0268,  0.0556],
        [ 0.0474,  0.0053,  0.0209,  ..., -0.0105, -0.0443, -0.0336],
        ...,
        [ 0.0392,  0.0108,  0.0579,  ...,  0.0158,  0.0288, -0.0423],
        [-0.0434, -0.0559,  0.0067,  ..., -0.0033,  0.0200,  0.0551],
        [-0.0249,  0.0220,  0.0025,  ..., -0.0319,  0.0029, -0.0404]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6188, 0.6109], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  320949 KB |  318646 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  320949 KB |  318646 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  320949 KB |  318646 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  320949 KB |  318646 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  468707 KB |  466914 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  468707 KB |  466914 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   68688    |   68387    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   68688    |   68387    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   68688    |   68387    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   68688    |   68387    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   42647    |   42642    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   42647    |   42642    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  283838 KB |  282675 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  283838 KB |  282675 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  283838 KB |  282675 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  283838 KB |  282675 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  428013 KB |  427128 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  428013 KB |  427128 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   66057    |   65815    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   66057    |   65815    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   66057    |   65815    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   66057    |   65815    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   42057    |   42050    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   42057    |   42050    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.61
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-0.0258, -0.0313, -0.0118,  ...,  0.0557,  0.0505,  0.0520],
        [-0.0140, -0.0283, -0.0597,  ...,  0.0065,  0.0273,  0.0560],
        [ 0.0478,  0.0058,  0.0213,  ..., -0.0109, -0.0448, -0.0340],
        ...,
        [ 0.0397,  0.0112,  0.0583,  ...,  0.0153,  0.0284, -0.0427],
        [-0.0438, -0.0563,  0.0062,  ..., -0.0029,  0.0204,  0.0555],
        [-0.0244,  0.0225,  0.0030,  ..., -0.0324,  0.0024, -0.0408]],
       device='cuda:0', requires_grad=True)tensor([[-0.0258, -0.0313, -0.0118,  ...,  0.0557,  0.0505,  0.0520],
        [-0.0140, -0.0283, -0.0597,  ...,  0.0065,  0.0273,  0.0560],
        [ 0.0478,  0.0058,  0.0213,  ..., -0.0109, -0.0448, -0.0340],
        ...,
        [ 0.0397,  0.0112,  0.0583,  ...,  0.0153,  0.0284, -0.0427],
        [-0.0438, -0.0563,  0.0062,  ..., -0.0029,  0.0204,  0.0555],
        [-0.0244,  0.0225,  0.0030,  ..., -0.0324,  0.0024, -0.0408]],
       device='cuda:1')
  Average validation loss: 13.61
======== Epoch 37 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0258, -0.0313, -0.0118,  ...,  0.0557,  0.0505,  0.0520],
        [-0.0140, -0.0283, -0.0597,  ...,  0.0065,  0.0273,  0.0560],
        [ 0.0478,  0.0058,  0.0213,  ..., -0.0109, -0.0448, -0.0340],
        ...,
        [ 0.0397,  0.0112,  0.0583,  ...,  0.0153,  0.0284, -0.0427],
        [-0.0438, -0.0563,  0.0062,  ..., -0.0029,  0.0204,  0.0555],
        [-0.0244,  0.0225,  0.0030,  ..., -0.0324,  0.0024, -0.0408]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0258, -0.0313, -0.0118,  ...,  0.0557,  0.0505,  0.0520],
        [-0.0140, -0.0283, -0.0597,  ...,  0.0065,  0.0273,  0.0560],
        [ 0.0478,  0.0058,  0.0213,  ..., -0.0109, -0.0448, -0.0340],
        ...,
        [ 0.0397,  0.0112,  0.0583,  ...,  0.0153,  0.0284, -0.0427],
        [-0.0438, -0.0563,  0.0062,  ..., -0.0029,  0.0204,  0.0555],
        [-0.0244,  0.0225,  0.0030,  ..., -0.0324,  0.0024, -0.0408]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6161, 0.6082], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  331497 KB |  329194 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  331497 KB |  329194 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  331497 KB |  329194 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  331497 KB |  329194 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  481023 KB |  479230 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  481023 KB |  479230 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   70813    |   70512    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   70813    |   70512    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   70813    |   70512    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   70813    |   70512    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   43927    |   43922    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   43927    |   43922    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  293360 KB |  292197 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  293360 KB |  292197 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  293360 KB |  292197 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  293360 KB |  292197 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  441628 KB |  440743 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  441628 KB |  440743 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   68109    |   67867    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   68109    |   67867    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   68109    |   67867    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   68109    |   67867    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   43348    |   43341    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   43348    |   43341    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.61
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0263, -0.0318, -0.0122,  ...,  0.0562,  0.0510,  0.0524],
        [-0.0144, -0.0288, -0.0601,  ...,  0.0069,  0.0277,  0.0564],
        [ 0.0483,  0.0062,  0.0218,  ..., -0.0114, -0.0452, -0.0344],
        ...,
        [ 0.0401,  0.0116,  0.0588,  ...,  0.0149,  0.0279, -0.0432],
        [-0.0442, -0.0567,  0.0058,  ..., -0.0025,  0.0209,  0.0560],
        [-0.0240,  0.0229,  0.0034,  ..., -0.0328,  0.0020, -0.0413]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0263, -0.0318, -0.0122,  ...,  0.0562,  0.0510,  0.0524],
        [-0.0144, -0.0288, -0.0601,  ...,  0.0069,  0.0277,  0.0564],
        [ 0.0483,  0.0062,  0.0218,  ..., -0.0114, -0.0452, -0.0344],
        ...,
        [ 0.0401,  0.0116,  0.0588,  ...,  0.0149,  0.0279, -0.0432],
        [-0.0442, -0.0567,  0.0058,  ..., -0.0025,  0.0209,  0.0560],
        [-0.0240,  0.0229,  0.0034,  ..., -0.0328,  0.0020, -0.0413]],
       device='cuda:1')
  Average validation loss: 13.61
======== Epoch 38 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0263, -0.0318, -0.0122,  ...,  0.0562,  0.0510,  0.0524],
        [-0.0144, -0.0288, -0.0601,  ...,  0.0069,  0.0277,  0.0564],
        [ 0.0483,  0.0062,  0.0218,  ..., -0.0114, -0.0452, -0.0344],
        ...,
        [ 0.0401,  0.0116,  0.0588,  ...,  0.0149,  0.0279, -0.0432],
        [-0.0442, -0.0567,  0.0058,  ..., -0.0025,  0.0209,  0.0560],
        [-0.0240,  0.0229,  0.0034,  ..., -0.0328,  0.0020, -0.0413]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0263, -0.0318, -0.0122,  ...,  0.0562,  0.0510,  0.0524],
        [-0.0144, -0.0288, -0.0601,  ...,  0.0069,  0.0277,  0.0564],
        [ 0.0483,  0.0062,  0.0218,  ..., -0.0114, -0.0452, -0.0344],
        ...,
        [ 0.0401,  0.0116,  0.0588,  ...,  0.0149,  0.0279, -0.0432],
        [-0.0442, -0.0567,  0.0058,  ..., -0.0025,  0.0209,  0.0560],
        [-0.0240,  0.0229,  0.0034,  ..., -0.0328,  0.0020, -0.0413]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6133, 0.6056], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  342044 KB |  339741 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  342044 KB |  339741 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  342044 KB |  339741 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  342044 KB |  339741 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  493338 KB |  491545 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  493338 KB |  491545 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   72938    |   72637    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   72938    |   72637    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   72938    |   72637    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   72938    |   72637    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   45207    |   45202    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   45207    |   45202    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  302881 KB |  301718 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  302881 KB |  301718 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  302881 KB |  301718 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  302881 KB |  301718 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  455244 KB |  454359 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  455244 KB |  454359 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   70161    |   69919    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   70161    |   69919    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   70161    |   69919    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   70161    |   69919    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   44639    |   44632    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   44639    |   44632    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.61
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0267, -0.0322, -0.0126,  ...,  0.0566,  0.0514,  0.0528],
        [-0.0148, -0.0292, -0.0604,  ...,  0.0073,  0.0281,  0.0568],
        [ 0.0487,  0.0067,  0.0222,  ..., -0.0118, -0.0456, -0.0349],
        ...,
        [ 0.0406,  0.0121,  0.0592,  ...,  0.0144,  0.0275, -0.0436],
        [-0.0447, -0.0572,  0.0054,  ..., -0.0021,  0.0213,  0.0564],
        [-0.0235,  0.0233,  0.0039,  ..., -0.0333,  0.0015, -0.0417]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0267, -0.0322, -0.0126,  ...,  0.0566,  0.0514,  0.0528],
        [-0.0148, -0.0292, -0.0604,  ...,  0.0073,  0.0281,  0.0568],
        [ 0.0487,  0.0067,  0.0222,  ..., -0.0118, -0.0456, -0.0349],
        ...,
        [ 0.0406,  0.0121,  0.0592,  ...,  0.0144,  0.0275, -0.0436],
        [-0.0447, -0.0572,  0.0054,  ..., -0.0021,  0.0213,  0.0564],
        [-0.0235,  0.0233,  0.0039,  ..., -0.0333,  0.0015, -0.0417]],
       device='cuda:1')
  Average validation loss: 13.61
======== Epoch 39 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0267, -0.0322, -0.0126,  ...,  0.0566,  0.0514,  0.0528],
        [-0.0148, -0.0292, -0.0604,  ...,  0.0073,  0.0281,  0.0568],
        [ 0.0487,  0.0067,  0.0222,  ..., -0.0118, -0.0456, -0.0349],
        ...,
        [ 0.0406,  0.0121,  0.0592,  ...,  0.0144,  0.0275, -0.0436],
        [-0.0447, -0.0572,  0.0054,  ..., -0.0021,  0.0213,  0.0564],
        [-0.0235,  0.0233,  0.0039,  ..., -0.0333,  0.0015, -0.0417]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0267, -0.0322, -0.0126,  ...,  0.0566,  0.0514,  0.0528],
        [-0.0148, -0.0292, -0.0604,  ...,  0.0073,  0.0281,  0.0568],
        [ 0.0487,  0.0067,  0.0222,  ..., -0.0118, -0.0456, -0.0349],
        ...,
        [ 0.0406,  0.0121,  0.0592,  ...,  0.0144,  0.0275, -0.0436],
        [-0.0447, -0.0572,  0.0054,  ..., -0.0021,  0.0213,  0.0564],
        [-0.0235,  0.0233,  0.0039,  ..., -0.0333,  0.0015, -0.0417]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6106, 0.6029], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2303 KB |    2513 KB |  352592 KB |  350289 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  352592 KB |  350289 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2303 KB |    2513 KB |  352592 KB |  350289 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2303 KB |    2513 KB |  352592 KB |  350289 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1793 KB |    2749 KB |  505654 KB |  503861 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1793 KB |    2749 KB |  505654 KB |  503861 KB |
|---------------------------------------------------------------------------|
| Allocations           |     301    |     313    |   75063    |   74762    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   75063    |   74762    |
|---------------------------------------------------------------------------|
| Active allocs         |     301    |     313    |   75063    |   74762    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     301    |     313    |   75063    |   74762    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |      27    |   46483    |   46478    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |      27    |   46483    |   46478    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1163 KB |    1322 KB |  312403 KB |  311240 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  312403 KB |  311240 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1163 KB |    1322 KB |  312403 KB |  311240 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1163 KB |    1322 KB |  312403 KB |  311240 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     885 KB |    2047 KB |  468859 KB |  467974 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     885 KB |    2047 KB |  468859 KB |  467974 KB |
|---------------------------------------------------------------------------|
| Allocations           |     242    |     255    |   72213    |   71971    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   72213    |   71971    |
|---------------------------------------------------------------------------|
| Active allocs         |     242    |     255    |   72213    |   71971    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     242    |     255    |   72213    |   71971    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   45930    |   45923    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   45930    |   45923    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.61
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0271, -0.0326, -0.0131,  ...,  0.0570,  0.0519,  0.0533],
        [-0.0152, -0.0296, -0.0608,  ...,  0.0077,  0.0285,  0.0572],
        [ 0.0492,  0.0071,  0.0226,  ..., -0.0123, -0.0461, -0.0353],
        ...,
        [ 0.0410,  0.0125,  0.0596,  ...,  0.0140,  0.0271, -0.0440],
        [-0.0451, -0.0576,  0.0049,  ..., -0.0016,  0.0217,  0.0568],
        [-0.0231,  0.0238,  0.0043,  ..., -0.0337,  0.0011, -0.0422]],
       device='cuda:1')Parameter containing:
tensor([[-0.0271, -0.0326, -0.0131,  ...,  0.0570,  0.0519,  0.0533],
        [-0.0152, -0.0296, -0.0608,  ...,  0.0077,  0.0285,  0.0572],
        [ 0.0492,  0.0071,  0.0226,  ..., -0.0123, -0.0461, -0.0353],
        ...,
        [ 0.0410,  0.0125,  0.0596,  ...,  0.0140,  0.0271, -0.0440],
        [-0.0451, -0.0576,  0.0049,  ..., -0.0016,  0.0217,  0.0568],
        [-0.0231,  0.0238,  0.0043,  ..., -0.0337,  0.0011, -0.0422]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.62
======== Epoch 40 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0271, -0.0326, -0.0131,  ...,  0.0570,  0.0519,  0.0533],
        [-0.0152, -0.0296, -0.0608,  ...,  0.0077,  0.0285,  0.0572],
        [ 0.0492,  0.0071,  0.0226,  ..., -0.0123, -0.0461, -0.0353],
        ...,
        [ 0.0410,  0.0125,  0.0596,  ...,  0.0140,  0.0271, -0.0440],
        [-0.0451, -0.0576,  0.0049,  ..., -0.0016,  0.0217,  0.0568],
        [-0.0231,  0.0238,  0.0043,  ..., -0.0337,  0.0011, -0.0422]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0271, -0.0326, -0.0131,  ...,  0.0570,  0.0519,  0.0533],
        [-0.0152, -0.0296, -0.0608,  ...,  0.0077,  0.0285,  0.0572],
        [ 0.0492,  0.0071,  0.0226,  ..., -0.0123, -0.0461, -0.0353],
        ...,
        [ 0.0410,  0.0125,  0.0596,  ...,  0.0140,  0.0271, -0.0440],
        [-0.0451, -0.0576,  0.0049,  ..., -0.0016,  0.0217,  0.0568],
        [-0.0231,  0.0238,  0.0043,  ..., -0.0337,  0.0011, -0.0422]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6079, 0.6003], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  363254 KB |  360836 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  363254 KB |  360836 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  363254 KB |  360836 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  363254 KB |  360836 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  517969 KB |  516291 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  517969 KB |  516291 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   77208    |   76887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   77208    |   76887    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   77208    |   76887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   77208    |   76887    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   47748    |   47742    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   47748    |   47742    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  322039 KB |  320761 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  322039 KB |  320761 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  322039 KB |  320761 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  322039 KB |  320761 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  482475 KB |  481705 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  482475 KB |  481705 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   74285    |   74023    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   74285    |   74023    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   74285    |   74023    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   74285    |   74023    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   47221    |   47214    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   47221    |   47214    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.60
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0276, -0.0331, -0.0135,  ...,  0.0575,  0.0523,  0.0537],
        [-0.0156, -0.0300, -0.0612,  ...,  0.0081,  0.0289,  0.0575],
        [ 0.0496,  0.0075,  0.0231,  ..., -0.0127, -0.0465, -0.0358],
        ...,
        [ 0.0415,  0.0130,  0.0601,  ...,  0.0136,  0.0266, -0.0445],
        [-0.0455, -0.0580,  0.0045,  ..., -0.0012,  0.0222,  0.0573],
        [-0.0226,  0.0242,  0.0048,  ..., -0.0342,  0.0006, -0.0426]],
       device='cuda:0', requires_grad=True)tensor([[-0.0276, -0.0331, -0.0135,  ...,  0.0575,  0.0523,  0.0537],
        [-0.0156, -0.0300, -0.0612,  ...,  0.0081,  0.0289,  0.0575],
        [ 0.0496,  0.0075,  0.0231,  ..., -0.0127, -0.0465, -0.0358],
        ...,
        [ 0.0415,  0.0130,  0.0601,  ...,  0.0136,  0.0266, -0.0445],
        [-0.0455, -0.0580,  0.0045,  ..., -0.0012,  0.0222,  0.0573],
        [-0.0226,  0.0242,  0.0048,  ..., -0.0342,  0.0006, -0.0426]],
       device='cuda:1')
  Average validation loss: 13.62
======== Epoch 41 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0276, -0.0331, -0.0135,  ...,  0.0575,  0.0523,  0.0537],
        [-0.0156, -0.0300, -0.0612,  ...,  0.0081,  0.0289,  0.0575],
        [ 0.0496,  0.0075,  0.0231,  ..., -0.0127, -0.0465, -0.0358],
        ...,
        [ 0.0415,  0.0130,  0.0601,  ...,  0.0136,  0.0266, -0.0445],
        [-0.0455, -0.0580,  0.0045,  ..., -0.0012,  0.0222,  0.0573],
        [-0.0226,  0.0242,  0.0048,  ..., -0.0342,  0.0006, -0.0426]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0276, -0.0331, -0.0135,  ...,  0.0575,  0.0523,  0.0537],
        [-0.0156, -0.0300, -0.0612,  ...,  0.0081,  0.0289,  0.0575],
        [ 0.0496,  0.0075,  0.0231,  ..., -0.0127, -0.0465, -0.0358],
        ...,
        [ 0.0415,  0.0130,  0.0601,  ...,  0.0136,  0.0266, -0.0445],
        [-0.0455, -0.0580,  0.0045,  ..., -0.0012,  0.0222,  0.0573],
        [-0.0226,  0.0242,  0.0048,  ..., -0.0342,  0.0006, -0.0426]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6052, 0.5977], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  374697 KB |  372279 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  374697 KB |  372279 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  374697 KB |  372279 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  374697 KB |  372279 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  531448 KB |  529770 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  531448 KB |  529770 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   79443    |   79122    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   79443    |   79122    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   79443    |   79122    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   79443    |   79122    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   49058    |   49052    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   49058    |   49052    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  332456 KB |  331178 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  332456 KB |  331178 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  332456 KB |  331178 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  332456 KB |  331178 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  496985 KB |  496215 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  496985 KB |  496215 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   76447    |   76185    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   76447    |   76185    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   76447    |   76185    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   76447    |   76185    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   48572    |   48565    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   48572    |   48565    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.60
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0280, -0.0335, -0.0139,  ...,  0.0579,  0.0527,  0.0541],
        [-0.0160, -0.0304, -0.0616,  ...,  0.0085,  0.0293,  0.0579],
        [ 0.0500,  0.0080,  0.0235,  ..., -0.0131, -0.0469, -0.0362],
        ...,
        [ 0.0419,  0.0134,  0.0605,  ...,  0.0131,  0.0262, -0.0449],
        [-0.0459, -0.0584,  0.0041,  ..., -0.0008,  0.0226,  0.0577],
        [-0.0222,  0.0247,  0.0052,  ..., -0.0346,  0.0002, -0.0430]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0280, -0.0335, -0.0139,  ...,  0.0579,  0.0527,  0.0541],
        [-0.0160, -0.0304, -0.0616,  ...,  0.0085,  0.0293,  0.0579],
        [ 0.0500,  0.0080,  0.0235,  ..., -0.0131, -0.0469, -0.0362],
        ...,
        [ 0.0419,  0.0134,  0.0605,  ...,  0.0131,  0.0262, -0.0449],
        [-0.0459, -0.0584,  0.0041,  ..., -0.0008,  0.0226,  0.0577],
        [-0.0222,  0.0247,  0.0052,  ..., -0.0346,  0.0002, -0.0430]],
       device='cuda:1')
  Average validation loss: 13.62
======== Epoch 42 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0280, -0.0335, -0.0139,  ...,  0.0579,  0.0527,  0.0541],
        [-0.0160, -0.0304, -0.0616,  ...,  0.0085,  0.0293,  0.0579],
        [ 0.0500,  0.0080,  0.0235,  ..., -0.0131, -0.0469, -0.0362],
        ...,
        [ 0.0419,  0.0134,  0.0605,  ...,  0.0131,  0.0262, -0.0449],
        [-0.0459, -0.0584,  0.0041,  ..., -0.0008,  0.0226,  0.0577],
        [-0.0222,  0.0247,  0.0052,  ..., -0.0346,  0.0002, -0.0430]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0280, -0.0335, -0.0139,  ...,  0.0579,  0.0527,  0.0541],
        [-0.0160, -0.0304, -0.0616,  ...,  0.0085,  0.0293,  0.0579],
        [ 0.0500,  0.0080,  0.0235,  ..., -0.0131, -0.0469, -0.0362],
        ...,
        [ 0.0419,  0.0134,  0.0605,  ...,  0.0131,  0.0262, -0.0449],
        [-0.0459, -0.0584,  0.0041,  ..., -0.0008,  0.0226,  0.0577],
        [-0.0222,  0.0247,  0.0052,  ..., -0.0346,  0.0002, -0.0430]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.6025, 0.5950], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  386139 KB |  383721 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  386139 KB |  383721 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  386139 KB |  383721 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  386139 KB |  383721 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  544927 KB |  543249 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  544927 KB |  543249 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   81678    |   81357    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   81678    |   81357    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   81678    |   81357    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   81678    |   81357    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   50359    |   50353    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   50359    |   50353    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  342872 KB |  341594 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  342872 KB |  341594 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  342872 KB |  341594 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  342872 KB |  341594 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  511496 KB |  510726 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  511496 KB |  510726 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   78609    |   78347    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   78609    |   78347    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   78609    |   78347    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   78609    |   78347    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   49923    |   49916    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   49923    |   49916    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.60
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
tensor([[-0.0284, -0.0339, -0.0143,  ...,  0.0583,  0.0532,  0.0546],
        [-0.0164, -0.0308, -0.0619,  ...,  0.0088,  0.0297,  0.0583],
        [ 0.0505,  0.0084,  0.0239,  ..., -0.0136, -0.0474, -0.0366],
        ...,
        [ 0.0423,  0.0138,  0.0609,  ...,  0.0127,  0.0258, -0.0453],
        [-0.0464, -0.0589,  0.0036,  ..., -0.0004,  0.0230,  0.0581],
        [-0.0218,  0.0251,  0.0056,  ..., -0.0350, -0.0002, -0.0435]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0284, -0.0339, -0.0143,  ...,  0.0583,  0.0532,  0.0546],
        [-0.0164, -0.0308, -0.0619,  ...,  0.0088,  0.0297,  0.0583],
        [ 0.0505,  0.0084,  0.0239,  ..., -0.0136, -0.0474, -0.0366],
        ...,
        [ 0.0423,  0.0138,  0.0609,  ...,  0.0127,  0.0258, -0.0453],
        [-0.0464, -0.0589,  0.0036,  ..., -0.0004,  0.0230,  0.0581],
        [-0.0218,  0.0251,  0.0056,  ..., -0.0350, -0.0002, -0.0435]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.62
======== Epoch 43 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0284, -0.0339, -0.0143,  ...,  0.0583,  0.0532,  0.0546],
        [-0.0164, -0.0308, -0.0619,  ...,  0.0088,  0.0297,  0.0583],
        [ 0.0505,  0.0084,  0.0239,  ..., -0.0136, -0.0474, -0.0366],
        ...,
        [ 0.0423,  0.0138,  0.0609,  ...,  0.0127,  0.0258, -0.0453],
        [-0.0464, -0.0589,  0.0036,  ..., -0.0004,  0.0230,  0.0581],
        [-0.0218,  0.0251,  0.0056,  ..., -0.0350, -0.0002, -0.0435]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0284, -0.0339, -0.0143,  ...,  0.0583,  0.0532,  0.0546],
        [-0.0164, -0.0308, -0.0619,  ...,  0.0088,  0.0297,  0.0583],
        [ 0.0505,  0.0084,  0.0239,  ..., -0.0136, -0.0474, -0.0366],
        ...,
        [ 0.0423,  0.0138,  0.0609,  ...,  0.0127,  0.0258, -0.0453],
        [-0.0464, -0.0589,  0.0036,  ..., -0.0004,  0.0230,  0.0581],
        [-0.0218,  0.0251,  0.0056,  ..., -0.0350, -0.0002, -0.0435]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5998, 0.5925], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  397582 KB |  395164 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  397582 KB |  395164 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  397582 KB |  395164 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  397582 KB |  395164 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  558406 KB |  556728 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  558406 KB |  556728 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   83913    |   83592    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   83913    |   83592    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   83913    |   83592    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   83913    |   83592    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   51672    |   51666    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   51672    |   51666    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  363705 KB |  362427 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  363705 KB |  362427 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  363705 KB |  362427 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  363705 KB |  362427 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  540517 KB |  539747 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  540517 KB |  539747 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   82933    |   82671    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   82933    |   82671    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   82933    |   82671    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   82933    |   82671    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   52625    |   52618    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   52625    |   52618    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.59
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0293, -0.0348, -0.0152,  ...,  0.0592,  0.0540,  0.0554],
        [-0.0172, -0.0316, -0.0627,  ...,  0.0095,  0.0304,  0.0589],
        [ 0.0513,  0.0093,  0.0248,  ..., -0.0144, -0.0482, -0.0375],
        ...,
        [ 0.0432,  0.0147,  0.0618,  ...,  0.0118,  0.0249, -0.0462],
        [-0.0472, -0.0597,  0.0028,  ...,  0.0005,  0.0239,  0.0590],
        [-0.0209,  0.0260,  0.0065,  ..., -0.0359, -0.0011, -0.0443]],
       device='cuda:0', requires_grad=True)tensor([[-0.0293, -0.0348, -0.0152,  ...,  0.0592,  0.0540,  0.0554],
        [-0.0172, -0.0316, -0.0627,  ...,  0.0095,  0.0304,  0.0589],
        [ 0.0513,  0.0093,  0.0248,  ..., -0.0144, -0.0482, -0.0375],
        ...,
        [ 0.0432,  0.0147,  0.0618,  ...,  0.0118,  0.0249, -0.0462],
        [-0.0472, -0.0597,  0.0028,  ...,  0.0005,  0.0239,  0.0590],
        [-0.0209,  0.0260,  0.0065,  ..., -0.0359, -0.0011, -0.0443]],
       device='cuda:1')
  Average validation loss: 13.62
======== Epoch 45 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0293, -0.0348, -0.0152,  ...,  0.0592,  0.0540,  0.0554],
        [-0.0172, -0.0316, -0.0627,  ...,  0.0095,  0.0304,  0.0589],
        [ 0.0513,  0.0093,  0.0248,  ..., -0.0144, -0.0482, -0.0375],
        ...,
        [ 0.0432,  0.0147,  0.0618,  ...,  0.0118,  0.0249, -0.0462],
        [-0.0472, -0.0597,  0.0028,  ...,  0.0005,  0.0239,  0.0590],
        [-0.0209,  0.0260,  0.0065,  ..., -0.0359, -0.0011, -0.0443]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0293, -0.0348, -0.0152,  ...,  0.0592,  0.0540,  0.0554],
        [-0.0172, -0.0316, -0.0627,  ...,  0.0095,  0.0304,  0.0589],
        [ 0.0513,  0.0093,  0.0248,  ..., -0.0144, -0.0482, -0.0375],
        ...,
        [ 0.0432,  0.0147,  0.0618,  ...,  0.0118,  0.0249, -0.0462],
        [-0.0472, -0.0597,  0.0028,  ...,  0.0005,  0.0239,  0.0590],
        [-0.0209,  0.0260,  0.0065,  ..., -0.0359, -0.0011, -0.0443]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5945, 0.5873], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  420467 KB |  418049 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  420467 KB |  418049 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  420467 KB |  418049 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  420467 KB |  418049 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  585364 KB |  583686 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  585364 KB |  583686 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   88383    |   88062    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   88383    |   88062    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   88383    |   88062    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   88383    |   88062    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   54282    |   54276    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   54282    |   54276    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  374122 KB |  372844 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  374122 KB |  372844 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  374122 KB |  372844 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  374122 KB |  372844 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  555027 KB |  554257 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  555027 KB |  554257 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   85095    |   84833    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   85095    |   84833    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   85095    |   84833    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   85095    |   84833    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   53976    |   53969    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   53976    |   53969    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.59
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0297, -0.0352, -0.0156,  ...,  0.0596,  0.0544,  0.0558],
        [-0.0175, -0.0320, -0.0630,  ...,  0.0098,  0.0308,  0.0592],
        [ 0.0518,  0.0097,  0.0252,  ..., -0.0148, -0.0486, -0.0379],
        ...,
        [ 0.0436,  0.0151,  0.0622,  ...,  0.0114,  0.0245, -0.0466],
        [-0.0476, -0.0601,  0.0024,  ...,  0.0009,  0.0243,  0.0594],
        [-0.0205,  0.0264,  0.0069,  ..., -0.0363, -0.0015, -0.0447]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0297, -0.0352, -0.0156,  ...,  0.0596,  0.0544,  0.0558],
        [-0.0175, -0.0320, -0.0630,  ...,  0.0098,  0.0308,  0.0592],
        [ 0.0518,  0.0097,  0.0252,  ..., -0.0148, -0.0486, -0.0379],
        ...,
        [ 0.0436,  0.0151,  0.0622,  ...,  0.0114,  0.0245, -0.0466],
        [-0.0476, -0.0601,  0.0024,  ...,  0.0009,  0.0243,  0.0594],
        [-0.0205,  0.0264,  0.0069,  ..., -0.0363, -0.0015, -0.0447]],
       device='cuda:1')
  Average validation loss: 13.62
======== Epoch 46 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0297, -0.0352, -0.0156,  ...,  0.0596,  0.0544,  0.0558],
        [-0.0175, -0.0320, -0.0630,  ...,  0.0098,  0.0308,  0.0592],
        [ 0.0518,  0.0097,  0.0252,  ..., -0.0148, -0.0486, -0.0379],
        ...,
        [ 0.0436,  0.0151,  0.0622,  ...,  0.0114,  0.0245, -0.0466],
        [-0.0476, -0.0601,  0.0024,  ...,  0.0009,  0.0243,  0.0594],
        [-0.0205,  0.0264,  0.0069,  ..., -0.0363, -0.0015, -0.0447]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0297, -0.0352, -0.0156,  ...,  0.0596,  0.0544,  0.0558],
        [-0.0175, -0.0320, -0.0630,  ...,  0.0098,  0.0308,  0.0592],
        [ 0.0518,  0.0097,  0.0252,  ..., -0.0148, -0.0486, -0.0379],
        ...,
        [ 0.0436,  0.0151,  0.0622,  ...,  0.0114,  0.0245, -0.0466],
        [-0.0476, -0.0601,  0.0024,  ...,  0.0009,  0.0243,  0.0594],
        [-0.0205,  0.0264,  0.0069,  ..., -0.0363, -0.0015, -0.0447]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5919, 0.5848], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  431909 KB |  429491 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  431909 KB |  429491 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  431909 KB |  429491 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  431909 KB |  429491 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  598843 KB |  597165 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  598843 KB |  597165 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   90618    |   90297    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   90618    |   90297    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   90618    |   90297    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   90618    |   90297    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   55596    |   55590    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   55596    |   55590    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  384538 KB |  383260 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  384538 KB |  383260 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  384538 KB |  383260 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  384538 KB |  383260 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  569538 KB |  568768 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  569538 KB |  568768 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   87257    |   86995    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   87257    |   86995    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   87257    |   86995    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   87257    |   86995    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   55327    |   55320    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   55327    |   55320    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.59
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20]) Device:  Device:0
1
Parameter containing:
tensor([[-0.0301, -0.0356, -0.0160,  ...,  0.0600,  0.0549,  0.0563],
        [-0.0179, -0.0323, -0.0633,  ...,  0.0102,  0.0311,  0.0594],
        [ 0.0522,  0.0101,  0.0256,  ..., -0.0153, -0.0491, -0.0383],
        ...,
        [ 0.0440,  0.0155,  0.0626,  ...,  0.0110,  0.0241, -0.0470],
        [-0.0480, -0.0605,  0.0019,  ...,  0.0013,  0.0247,  0.0598],
        [-0.0201,  0.0268,  0.0074,  ..., -0.0367, -0.0019, -0.0452]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0301, -0.0356, -0.0160,  ...,  0.0600,  0.0549,  0.0563],
        [-0.0179, -0.0323, -0.0633,  ...,  0.0102,  0.0311,  0.0594],
        [ 0.0522,  0.0101,  0.0256,  ..., -0.0153, -0.0491, -0.0383],
        ...,
        [ 0.0440,  0.0155,  0.0626,  ...,  0.0110,  0.0241, -0.0470],
        [-0.0480, -0.0605,  0.0019,  ...,  0.0013,  0.0247,  0.0598],
        [-0.0201,  0.0268,  0.0074,  ..., -0.0367, -0.0019, -0.0452]],
       device='cuda:1')
  Average validation loss: 13.62
======== Epoch 47 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0301, -0.0356, -0.0160,  ...,  0.0600,  0.0549,  0.0563],
        [-0.0179, -0.0323, -0.0633,  ...,  0.0102,  0.0311,  0.0594],
        [ 0.0522,  0.0101,  0.0256,  ..., -0.0153, -0.0491, -0.0383],
        ...,
        [ 0.0440,  0.0155,  0.0626,  ...,  0.0110,  0.0241, -0.0470],
        [-0.0480, -0.0605,  0.0019,  ...,  0.0013,  0.0247,  0.0598],
        [-0.0201,  0.0268,  0.0074,  ..., -0.0367, -0.0019, -0.0452]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0301, -0.0356, -0.0160,  ...,  0.0600,  0.0549,  0.0563],
        [-0.0179, -0.0323, -0.0633,  ...,  0.0102,  0.0311,  0.0594],
        [ 0.0522,  0.0101,  0.0256,  ..., -0.0153, -0.0491, -0.0383],
        ...,
        [ 0.0440,  0.0155,  0.0626,  ...,  0.0110,  0.0241, -0.0470],
        [-0.0480, -0.0605,  0.0019,  ...,  0.0013,  0.0247,  0.0598],
        [-0.0201,  0.0268,  0.0074,  ..., -0.0367, -0.0019, -0.0452]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5892, 0.5823], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  443352 KB |  440934 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  443352 KB |  440934 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  443352 KB |  440934 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  443352 KB |  440934 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  612322 KB |  610644 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  612322 KB |  610644 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   92853    |   92532    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   92853    |   92532    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   92853    |   92532    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   92853    |   92532    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   56901    |   56895    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   56901    |   56895    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  394955 KB |  393677 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  394955 KB |  393677 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  394955 KB |  393677 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  394955 KB |  393677 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  584048 KB |  583278 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  584048 KB |  583278 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   89419    |   89157    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   89419    |   89157    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   89419    |   89157    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   89419    |   89157    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   56678    |   56671    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   56678    |   56671    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.59
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0305, -0.0360, -0.0165,  ...,  0.0605,  0.0553,  0.0567],
        [-0.0183, -0.0327, -0.0637,  ...,  0.0104,  0.0315,  0.0596],
        [ 0.0526,  0.0105,  0.0261,  ..., -0.0157, -0.0495, -0.0387],
        ...,
        [ 0.0444,  0.0159,  0.0631,  ...,  0.0106,  0.0236, -0.0474],
        [-0.0484, -0.0609,  0.0015,  ...,  0.0017,  0.0251,  0.0602],
        [-0.0197,  0.0272,  0.0078,  ..., -0.0371, -0.0024, -0.0456]],
       device='cuda:0', requires_grad=True)tensor([[-0.0305, -0.0360, -0.0165,  ...,  0.0605,  0.0553,  0.0567],
        [-0.0183, -0.0327, -0.0637,  ...,  0.0104,  0.0315,  0.0596],
        [ 0.0526,  0.0105,  0.0261,  ..., -0.0157, -0.0495, -0.0387],
        ...,
        [ 0.0444,  0.0159,  0.0631,  ...,  0.0106,  0.0236, -0.0474],
        [-0.0484, -0.0609,  0.0015,  ...,  0.0017,  0.0251,  0.0602],
        [-0.0197,  0.0272,  0.0078,  ..., -0.0371, -0.0024, -0.0456]],
       device='cuda:1')
  Average validation loss: 13.62
======== Epoch 48 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0305, -0.0360, -0.0165,  ...,  0.0605,  0.0553,  0.0567],
        [-0.0183, -0.0327, -0.0637,  ...,  0.0104,  0.0315,  0.0596],
        [ 0.0526,  0.0105,  0.0261,  ..., -0.0157, -0.0495, -0.0387],
        ...,
        [ 0.0444,  0.0159,  0.0631,  ...,  0.0106,  0.0236, -0.0474],
        [-0.0484, -0.0609,  0.0015,  ...,  0.0017,  0.0251,  0.0602],
        [-0.0197,  0.0272,  0.0078,  ..., -0.0371, -0.0024, -0.0456]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0305, -0.0360, -0.0165,  ...,  0.0605,  0.0553,  0.0567],
        [-0.0183, -0.0327, -0.0637,  ...,  0.0104,  0.0315,  0.0596],
        [ 0.0526,  0.0105,  0.0261,  ..., -0.0157, -0.0495, -0.0387],
        ...,
        [ 0.0444,  0.0159,  0.0631,  ...,  0.0106,  0.0236, -0.0474],
        [-0.0484, -0.0609,  0.0015,  ...,  0.0017,  0.0251,  0.0602],
        [-0.0197,  0.0272,  0.0078,  ..., -0.0371, -0.0024, -0.0456]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5867, 0.5798], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  454794 KB |  452376 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  454794 KB |  452376 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  454794 KB |  452376 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  454794 KB |  452376 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  625801 KB |  624123 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  625801 KB |  624123 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   95088    |   94767    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   95088    |   94767    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   95088    |   94767    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   95088    |   94767    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   58206    |   58200    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   58206    |   58200    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  405371 KB |  404093 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  405371 KB |  404093 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  405371 KB |  404093 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  405371 KB |  404093 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  598559 KB |  597789 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  598559 KB |  597789 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   91581    |   91319    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   91581    |   91319    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   91581    |   91319    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   91581    |   91319    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   58029    |   58022    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   58029    |   58022    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.58
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0309, -0.0364, -0.0169,  ...,  0.0609,  0.0557,  0.0571],
        [-0.0186, -0.0331, -0.0640,  ...,  0.0107,  0.0318,  0.0598],
        [ 0.0530,  0.0109,  0.0265,  ..., -0.0161, -0.0499, -0.0391],
        ...,
        [ 0.0449,  0.0163,  0.0635,  ...,  0.0102,  0.0232, -0.0478],
        [-0.0488, -0.0613,  0.0011,  ...,  0.0021,  0.0255,  0.0606],
        [-0.0192,  0.0276,  0.0082,  ..., -0.0376, -0.0028, -0.0460]],
       device='cuda:1')Parameter containing:
tensor([[-0.0309, -0.0364, -0.0169,  ...,  0.0609,  0.0557,  0.0571],
        [-0.0186, -0.0331, -0.0640,  ...,  0.0107,  0.0318,  0.0598],
        [ 0.0530,  0.0109,  0.0265,  ..., -0.0161, -0.0499, -0.0391],
        ...,
        [ 0.0449,  0.0163,  0.0635,  ...,  0.0102,  0.0232, -0.0478],
        [-0.0488, -0.0613,  0.0011,  ...,  0.0021,  0.0255,  0.0606],
        [-0.0192,  0.0276,  0.0082,  ..., -0.0376, -0.0028, -0.0460]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.63
======== Epoch 49 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device: 1
0
tensor([[-0.0309, -0.0364, -0.0169,  ...,  0.0609,  0.0557,  0.0571],
        [-0.0186, -0.0331, -0.0640,  ...,  0.0107,  0.0318,  0.0598],
        [ 0.0530,  0.0109,  0.0265,  ..., -0.0161, -0.0499, -0.0391],
        ...,
        [ 0.0449,  0.0163,  0.0635,  ...,  0.0102,  0.0232, -0.0478],
        [-0.0488, -0.0613,  0.0011,  ...,  0.0021,  0.0255,  0.0606],
        [-0.0192,  0.0276,  0.0082,  ..., -0.0376, -0.0028, -0.0460]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0309, -0.0364, -0.0169,  ...,  0.0609,  0.0557,  0.0571],
        [-0.0186, -0.0331, -0.0640,  ...,  0.0107,  0.0318,  0.0598],
        [ 0.0530,  0.0109,  0.0265,  ..., -0.0161, -0.0499, -0.0391],
        ...,
        [ 0.0449,  0.0163,  0.0635,  ...,  0.0102,  0.0232, -0.0478],
        [-0.0488, -0.0613,  0.0011,  ...,  0.0021,  0.0255,  0.0606],
        [-0.0192,  0.0276,  0.0082,  ..., -0.0376, -0.0028, -0.0460]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5841, 0.5773], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2418 KB |    2628 KB |  466237 KB |  463819 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  466237 KB |  463819 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2418 KB |    2628 KB |  466237 KB |  463819 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2418 KB |    2628 KB |  466237 KB |  463819 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1678 KB |    2749 KB |  639280 KB |  637602 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1678 KB |    2749 KB |  639280 KB |  637602 KB |
|---------------------------------------------------------------------------|
| Allocations           |     321    |     333    |   97323    |   97002    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   97323    |   97002    |
|---------------------------------------------------------------------------|
| Active allocs         |     321    |     333    |   97323    |   97002    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     321    |     333    |   97323    |   97002    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   59517    |   59511    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   59517    |   59511    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1278 KB |    1437 KB |  415788 KB |  414510 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  415788 KB |  414510 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1278 KB |    1437 KB |  415788 KB |  414510 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1278 KB |    1437 KB |  415788 KB |  414510 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     770 KB |    2047 KB |  613069 KB |  612299 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     770 KB |    2047 KB |  613069 KB |  612299 KB |
|---------------------------------------------------------------------------|
| Allocations           |     262    |     275    |   93743    |   93481    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   93743    |   93481    |
|---------------------------------------------------------------------------|
| Active allocs         |     262    |     275    |   93743    |   93481    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     262    |     275    |   93743    |   93481    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   59380    |   59373    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   59380    |   59373    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.58
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0313, -0.0368, -0.0173,  ...,  0.0613,  0.0561,  0.0575],
        [-0.0190, -0.0334, -0.0643,  ...,  0.0110,  0.0321,  0.0600],
        [ 0.0534,  0.0113,  0.0269,  ..., -0.0165, -0.0503, -0.0395],
        ...,
        [ 0.0453,  0.0167,  0.0639,  ...,  0.0098,  0.0228, -0.0482],
        [-0.0492, -0.0617,  0.0007,  ...,  0.0025,  0.0259,  0.0610],
        [-0.0188,  0.0281,  0.0086,  ..., -0.0380, -0.0032, -0.0464]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0313, -0.0368, -0.0173,  ...,  0.0613,  0.0561,  0.0575],
        [-0.0190, -0.0334, -0.0643,  ...,  0.0110,  0.0321,  0.0600],
        [ 0.0534,  0.0113,  0.0269,  ..., -0.0165, -0.0503, -0.0395],
        ...,
        [ 0.0453,  0.0167,  0.0639,  ...,  0.0098,  0.0228, -0.0482],
        [-0.0492, -0.0617,  0.0007,  ...,  0.0025,  0.0259,  0.0610],
        [-0.0188,  0.0281,  0.0086,  ..., -0.0380, -0.0032, -0.0464]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.63
======== Epoch 50 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20])batch input size:  Device:torch.Size([3, 20])  0Device:
 1
tensor([[-0.0313, -0.0368, -0.0173,  ...,  0.0613,  0.0561,  0.0575],
        [-0.0190, -0.0334, -0.0643,  ...,  0.0110,  0.0321,  0.0600],
        [ 0.0534,  0.0113,  0.0269,  ..., -0.0165, -0.0503, -0.0395],
        ...,
        [ 0.0453,  0.0167,  0.0639,  ...,  0.0098,  0.0228, -0.0482],
        [-0.0492, -0.0617,  0.0007,  ...,  0.0025,  0.0259,  0.0610],
        [-0.0188,  0.0281,  0.0086,  ..., -0.0380, -0.0032, -0.0464]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0313, -0.0368, -0.0173,  ...,  0.0613,  0.0561,  0.0575],
        [-0.0190, -0.0334, -0.0643,  ...,  0.0110,  0.0321,  0.0600],
        [ 0.0534,  0.0113,  0.0269,  ..., -0.0165, -0.0503, -0.0395],
        ...,
        [ 0.0453,  0.0167,  0.0639,  ...,  0.0098,  0.0228, -0.0482],
        [-0.0492, -0.0617,  0.0007,  ...,  0.0025,  0.0259,  0.0610],
        [-0.0188,  0.0281,  0.0086,  ..., -0.0380, -0.0032, -0.0464]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5816, 0.5749], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  477794 KB |  475261 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  477794 KB |  475261 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  477794 KB |  475261 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  477794 KB |  475261 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  652759 KB |  651196 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  652759 KB |  651196 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |   99578    |   99237    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |   99578    |   99237    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |   99578    |   99237    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |   99578    |   99237    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   60825    |   60819    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   60825    |   60819    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  426319 KB |  424926 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  426319 KB |  424926 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  426319 KB |  424926 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  426319 KB |  424926 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  627580 KB |  626925 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  627580 KB |  626925 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |   95925    |   95643    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |   95925    |   95643    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |   95925    |   95643    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |   95925    |   95643    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   60731    |   60724    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   60731    |   60724    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.58
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0317, -0.0372, -0.0177,  ...,  0.0617,  0.0565,  0.0579],
        [-0.0193, -0.0338, -0.0646,  ...,  0.0112,  0.0324,  0.0600],
        [ 0.0538,  0.0117,  0.0273,  ..., -0.0169, -0.0507, -0.0399],
        ...,
        [ 0.0457,  0.0171,  0.0643,  ...,  0.0094,  0.0224, -0.0486],
        [-0.0496, -0.0621,  0.0003,  ...,  0.0029,  0.0263,  0.0614],
        [-0.0184,  0.0285,  0.0090,  ..., -0.0384, -0.0036, -0.0468]],
       device='cuda:1')Parameter containing:
tensor([[-0.0317, -0.0372, -0.0177,  ...,  0.0617,  0.0565,  0.0579],
        [-0.0193, -0.0338, -0.0646,  ...,  0.0112,  0.0324,  0.0600],
        [ 0.0538,  0.0117,  0.0273,  ..., -0.0169, -0.0507, -0.0399],
        ...,
        [ 0.0457,  0.0171,  0.0643,  ...,  0.0094,  0.0224, -0.0486],
        [-0.0496, -0.0621,  0.0003,  ...,  0.0029,  0.0263,  0.0614],
        [-0.0184,  0.0285,  0.0090,  ..., -0.0384, -0.0036, -0.0468]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.63
======== Epoch 51 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device: Device:  01
tensor([[-0.0317, -0.0372, -0.0177,  ...,  0.0617,  0.0565,  0.0579],
        [-0.0193, -0.0338, -0.0646,  ...,  0.0112,  0.0324,  0.0600],
        [ 0.0538,  0.0117,  0.0273,  ..., -0.0169, -0.0507, -0.0399],
        ...,
        [ 0.0457,  0.0171,  0.0643,  ...,  0.0094,  0.0224, -0.0486],
        [-0.0496, -0.0621,  0.0003,  ...,  0.0029,  0.0263,  0.0614],
        [-0.0184,  0.0285,  0.0090,  ..., -0.0384, -0.0036, -0.0468]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0317, -0.0372, -0.0177,  ...,  0.0617,  0.0565,  0.0579],
        [-0.0193, -0.0338, -0.0646,  ...,  0.0112,  0.0324,  0.0600],
        [ 0.0538,  0.0117,  0.0273,  ..., -0.0169, -0.0507, -0.0399],
        ...,
        [ 0.0457,  0.0171,  0.0643,  ...,  0.0094,  0.0224, -0.0486],
        [-0.0496, -0.0621,  0.0003,  ...,  0.0029,  0.0263,  0.0614],
        [-0.0184,  0.0285,  0.0090,  ..., -0.0384, -0.0036, -0.0468]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5791, 0.5725], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  490132 KB |  487599 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  490132 KB |  487599 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  490132 KB |  487599 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  490132 KB |  487599 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  667133 KB |  665570 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  667133 KB |  665570 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  101923    |  101582    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  101923    |  101582    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  101923    |  101582    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  101923    |  101582    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   62169    |   62163    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   62169    |   62163    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  437631 KB |  436238 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  437631 KB |  436238 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  437631 KB |  436238 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  437631 KB |  436238 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  642985 KB |  642330 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  642985 KB |  642330 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |   98197    |   97915    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |   98197    |   97915    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |   98197    |   97915    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |   98197    |   97915    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   62142    |   62135    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   62142    |   62135    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.58
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-3.2134e-02, -3.7642e-02, -1.8074e-02,  ...,  6.2091e-02,
          5.6913e-02,  5.8316e-02],
        [-1.9633e-02, -3.4142e-02, -6.4910e-02,  ...,  1.1327e-02,
          3.2651e-02,  5.9977e-02],
        [ 5.4234e-02,  1.2127e-02,  2.7682e-02,  ..., -1.7290e-02,
         -5.1066e-02, -4.0329e-02],
        ...,
        [ 4.6062e-02,  1.7523e-02,  6.4684e-02,  ...,  8.9616e-03,
          2.2038e-02, -4.8994e-02],
        [-5.0032e-02, -6.2527e-02, -8.7936e-05,  ...,  3.2867e-03,
          2.6730e-02,  6.1838e-02],
        [-1.8035e-02,  2.8856e-02,  9.3890e-03,  ..., -3.8752e-02,
         -3.9873e-03, -4.7184e-02]], device='cuda:0', requires_grad=True)
tensor([[-3.2134e-02, -3.7642e-02, -1.8074e-02,  ...,  6.2091e-02,
          5.6913e-02,  5.8316e-02],
        [-1.9633e-02, -3.4142e-02, -6.4910e-02,  ...,  1.1327e-02,
          3.2651e-02,  5.9977e-02],
        [ 5.4234e-02,  1.2127e-02,  2.7682e-02,  ..., -1.7290e-02,
         -5.1066e-02, -4.0329e-02],
        ...,
        [ 4.6062e-02,  1.7523e-02,  6.4684e-02,  ...,  8.9616e-03,
          2.2038e-02, -4.8994e-02],
        [-5.0032e-02, -6.2527e-02, -8.7936e-05,  ...,  3.2867e-03,
          2.6730e-02,  6.1838e-02],
        [-1.8035e-02,  2.8856e-02,  9.3890e-03,  ..., -3.8752e-02,
         -3.9873e-03, -4.7184e-02]], device='cuda:1')
  Average validation loss: 13.63
======== Epoch 52 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-3.2134e-02, -3.7642e-02, -1.8074e-02,  ...,  6.2091e-02,
          5.6913e-02,  5.8316e-02],
        [-1.9633e-02, -3.4142e-02, -6.4910e-02,  ...,  1.1327e-02,
          3.2651e-02,  5.9977e-02],
        [ 5.4234e-02,  1.2127e-02,  2.7682e-02,  ..., -1.7290e-02,
         -5.1066e-02, -4.0329e-02],
        ...,
        [ 4.6062e-02,  1.7523e-02,  6.4684e-02,  ...,  8.9616e-03,
          2.2038e-02, -4.8994e-02],
        [-5.0032e-02, -6.2527e-02, -8.7936e-05,  ...,  3.2867e-03,
          2.6730e-02,  6.1838e-02],
        [-1.8035e-02,  2.8856e-02,  9.3890e-03,  ..., -3.8752e-02,
         -3.9873e-03, -4.7184e-02]], device='cuda:1',
       grad_fn=<BroadcastBackward>)tensor([[-3.2134e-02, -3.7642e-02, -1.8074e-02,  ...,  6.2091e-02,
          5.6913e-02,  5.8316e-02],
        [-1.9633e-02, -3.4142e-02, -6.4910e-02,  ...,  1.1327e-02,
          3.2651e-02,  5.9977e-02],
        [ 5.4234e-02,  1.2127e-02,  2.7682e-02,  ..., -1.7290e-02,
         -5.1066e-02, -4.0329e-02],
        ...,
        [ 4.6062e-02,  1.7523e-02,  6.4684e-02,  ...,  8.9616e-03,
          2.2038e-02, -4.8994e-02],
        [-5.0032e-02, -6.2527e-02, -8.7936e-05,  ...,  3.2867e-03,
          2.6730e-02,  6.1838e-02],
        [-1.8035e-02,  2.8856e-02,  9.3890e-03,  ..., -3.8752e-02,
         -3.9873e-03, -4.7184e-02]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.5766, 0.5701], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  502469 KB |  499936 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  502469 KB |  499936 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  502469 KB |  499936 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  502469 KB |  499936 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  681507 KB |  679944 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  681507 KB |  679944 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  104268    |  103927    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  104268    |  103927    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  104268    |  103927    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  104268    |  103927    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   63516    |   63510    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   63516    |   63510    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  448942 KB |  447549 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  448942 KB |  447549 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  448942 KB |  447549 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  448942 KB |  447549 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  658391 KB |  657736 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  658391 KB |  657736 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  100469    |  100187    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  100469    |  100187    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  100469    |  100187    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  100469    |  100187    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   63553    |   63546    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   63553    |   63546    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.57
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0325, -0.0380, -0.0185,  ...,  0.0625,  0.0573,  0.0587],
        [-0.0200, -0.0345, -0.0652,  ...,  0.0114,  0.0329,  0.0599],
        [ 0.0546,  0.0125,  0.0281,  ..., -0.0177, -0.0515, -0.0407],
        ...,
        [ 0.0465,  0.0179,  0.0651,  ...,  0.0086,  0.0216, -0.0494],
        [-0.0504, -0.0629, -0.0005,  ...,  0.0037,  0.0271,  0.0622],
        [-0.0176,  0.0293,  0.0098,  ..., -0.0391, -0.0044, -0.0476]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0325, -0.0380, -0.0185,  ...,  0.0625,  0.0573,  0.0587],
        [-0.0200, -0.0345, -0.0652,  ...,  0.0114,  0.0329,  0.0599],
        [ 0.0546,  0.0125,  0.0281,  ..., -0.0177, -0.0515, -0.0407],
        ...,
        [ 0.0465,  0.0179,  0.0651,  ...,  0.0086,  0.0216, -0.0494],
        [-0.0504, -0.0629, -0.0005,  ...,  0.0037,  0.0271,  0.0622],
        [-0.0176,  0.0293,  0.0098,  ..., -0.0391, -0.0044, -0.0476]],
       device='cuda:1')
  Average validation loss: 13.63
======== Epoch 53 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0325, -0.0380, -0.0185,  ...,  0.0625,  0.0573,  0.0587],
        [-0.0200, -0.0345, -0.0652,  ...,  0.0114,  0.0329,  0.0599],
        [ 0.0546,  0.0125,  0.0281,  ..., -0.0177, -0.0515, -0.0407],
        ...,
        [ 0.0465,  0.0179,  0.0651,  ...,  0.0086,  0.0216, -0.0494],
        [-0.0504, -0.0629, -0.0005,  ...,  0.0037,  0.0271,  0.0622],
        [-0.0176,  0.0293,  0.0098,  ..., -0.0391, -0.0044, -0.0476]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0325, -0.0380, -0.0185,  ...,  0.0625,  0.0573,  0.0587],
        [-0.0200, -0.0345, -0.0652,  ...,  0.0114,  0.0329,  0.0599],
        [ 0.0546,  0.0125,  0.0281,  ..., -0.0177, -0.0515, -0.0407],
        ...,
        [ 0.0465,  0.0179,  0.0651,  ...,  0.0086,  0.0216, -0.0494],
        [-0.0504, -0.0629, -0.0005,  ...,  0.0037,  0.0271,  0.0622],
        [-0.0176,  0.0293,  0.0098,  ..., -0.0391, -0.0044, -0.0476]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5742, 0.5678], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  514807 KB |  512274 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  514807 KB |  512274 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  514807 KB |  512274 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  514807 KB |  512274 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  695881 KB |  694318 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  695881 KB |  694318 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  106613    |  106272    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  106613    |  106272    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  106613    |  106272    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  106613    |  106272    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   64863    |   64857    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   64863    |   64857    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  460254 KB |  458861 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  460254 KB |  458861 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  460254 KB |  458861 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  460254 KB |  458861 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  673796 KB |  673141 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  673796 KB |  673141 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  102741    |  102459    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  102741    |  102459    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  102741    |  102459    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  102741    |  102459    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   64964    |   64957    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   64964    |   64957    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.57
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0329, -0.0384, -0.0189,  ...,  0.0629,  0.0577,  0.0591],
        [-0.0203, -0.0348, -0.0655,  ...,  0.0115,  0.0331,  0.0597],
        [ 0.0550,  0.0129,  0.0285,  ..., -0.0181, -0.0518, -0.0411],
        ...,
        [ 0.0468,  0.0183,  0.0655,  ...,  0.0082,  0.0213, -0.0498],
        [-0.0508, -0.0633, -0.0009,  ...,  0.0040,  0.0275,  0.0626],
        [-0.0173,  0.0296,  0.0102,  ..., -0.0395, -0.0048, -0.0480]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0329, -0.0384, -0.0189,  ...,  0.0629,  0.0577,  0.0591],
        [-0.0203, -0.0348, -0.0655,  ...,  0.0115,  0.0331,  0.0597],
        [ 0.0550,  0.0129,  0.0285,  ..., -0.0181, -0.0518, -0.0411],
        ...,
        [ 0.0468,  0.0183,  0.0655,  ...,  0.0082,  0.0213, -0.0498],
        [-0.0508, -0.0633, -0.0009,  ...,  0.0040,  0.0275,  0.0626],
        [-0.0173,  0.0296,  0.0102,  ..., -0.0395, -0.0048, -0.0480]],
       device='cuda:1')
  Average validation loss: 13.63
======== Epoch 54 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0329, -0.0384, -0.0189,  ...,  0.0629,  0.0577,  0.0591],
        [-0.0203, -0.0348, -0.0655,  ...,  0.0115,  0.0331,  0.0597],
        [ 0.0550,  0.0129,  0.0285,  ..., -0.0181, -0.0518, -0.0411],
        ...,
        [ 0.0468,  0.0183,  0.0655,  ...,  0.0082,  0.0213, -0.0498],
        [-0.0508, -0.0633, -0.0009,  ...,  0.0040,  0.0275,  0.0626],
        [-0.0173,  0.0296,  0.0102,  ..., -0.0395, -0.0048, -0.0480]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0329, -0.0384, -0.0189,  ...,  0.0629,  0.0577,  0.0591],
        [-0.0203, -0.0348, -0.0655,  ...,  0.0115,  0.0331,  0.0597],
        [ 0.0550,  0.0129,  0.0285,  ..., -0.0181, -0.0518, -0.0411],
        ...,
        [ 0.0468,  0.0183,  0.0655,  ...,  0.0082,  0.0213, -0.0498],
        [-0.0508, -0.0633, -0.0009,  ...,  0.0040,  0.0275,  0.0626],
        [-0.0173,  0.0296,  0.0102,  ..., -0.0395, -0.0048, -0.0480]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5718, 0.5655], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  527144 KB |  524611 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  527144 KB |  524611 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  527144 KB |  524611 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  527144 KB |  524611 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  710255 KB |  708692 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  710255 KB |  708692 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  108958    |  108617    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  108958    |  108617    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  108958    |  108617    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  108958    |  108617    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   66204    |   66198    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   66204    |   66198    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  471565 KB |  470172 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  471565 KB |  470172 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  471565 KB |  470172 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  471565 KB |  470172 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  689202 KB |  688547 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  689202 KB |  688547 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  105013    |  104731    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  105013    |  104731    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  105013    |  104731    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  105013    |  104731    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   66375    |   66368    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   66375    |   66368    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.57
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0333, -0.0388, -0.0192,  ...,  0.0633,  0.0581,  0.0595],
        [-0.0206, -0.0352, -0.0657,  ...,  0.0115,  0.0333,  0.0595],
        [ 0.0554,  0.0133,  0.0288,  ..., -0.0185, -0.0522, -0.0415],
        ...,
        [ 0.0472,  0.0187,  0.0659,  ...,  0.0078,  0.0209, -0.0501],
        [-0.0512, -0.0637, -0.0013,  ...,  0.0044,  0.0279,  0.0630],
        [-0.0169,  0.0300,  0.0106,  ..., -0.0399, -0.0052, -0.0483]],
       device='cuda:0', requires_grad=True)tensor([[-0.0333, -0.0388, -0.0192,  ...,  0.0633,  0.0581,  0.0595],
        [-0.0206, -0.0352, -0.0657,  ...,  0.0115,  0.0333,  0.0595],
        [ 0.0554,  0.0133,  0.0288,  ..., -0.0185, -0.0522, -0.0415],
        ...,
        [ 0.0472,  0.0187,  0.0659,  ...,  0.0078,  0.0209, -0.0501],
        [-0.0512, -0.0637, -0.0013,  ...,  0.0044,  0.0279,  0.0630],
        [-0.0169,  0.0300,  0.0106,  ..., -0.0399, -0.0052, -0.0483]],
       device='cuda:1')
  Average validation loss: 13.63
======== Epoch 55 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0333, -0.0388, -0.0192,  ...,  0.0633,  0.0581,  0.0595],
        [-0.0206, -0.0352, -0.0657,  ...,  0.0115,  0.0333,  0.0595],
        [ 0.0554,  0.0133,  0.0288,  ..., -0.0185, -0.0522, -0.0415],
        ...,
        [ 0.0472,  0.0187,  0.0659,  ...,  0.0078,  0.0209, -0.0501],
        [-0.0512, -0.0637, -0.0013,  ...,  0.0044,  0.0279,  0.0630],
        [-0.0169,  0.0300,  0.0106,  ..., -0.0399, -0.0052, -0.0483]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0333, -0.0388, -0.0192,  ...,  0.0633,  0.0581,  0.0595],
        [-0.0206, -0.0352, -0.0657,  ...,  0.0115,  0.0333,  0.0595],
        [ 0.0554,  0.0133,  0.0288,  ..., -0.0185, -0.0522, -0.0415],
        ...,
        [ 0.0472,  0.0187,  0.0659,  ...,  0.0078,  0.0209, -0.0501],
        [-0.0512, -0.0637, -0.0013,  ...,  0.0044,  0.0279,  0.0630],
        [-0.0169,  0.0300,  0.0106,  ..., -0.0399, -0.0052, -0.0483]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5694, 0.5632], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  539482 KB |  536949 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  539482 KB |  536949 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  539482 KB |  536949 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  539482 KB |  536949 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  724629 KB |  723066 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  724629 KB |  723066 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  111303    |  110962    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  111303    |  110962    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  111303    |  110962    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  111303    |  110962    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   67553    |   67547    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   67553    |   67547    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  482877 KB |  481484 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  482877 KB |  481484 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  482877 KB |  481484 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  482877 KB |  481484 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  704607 KB |  703952 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  704607 KB |  703952 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  107285    |  107003    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  107285    |  107003    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  107285    |  107003    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  107285    |  107003    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   67786    |   67779    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   67786    |   67779    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.57
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0337, -0.0392, -0.0196,  ...,  0.0637,  0.0585,  0.0599],
        [-0.0209, -0.0355, -0.0660,  ...,  0.0115,  0.0334,  0.0593],
        [ 0.0558,  0.0137,  0.0292,  ..., -0.0188, -0.0526, -0.0419],
        ...,
        [ 0.0476,  0.0190,  0.0662,  ...,  0.0074,  0.0205, -0.0505],
        [-0.0515, -0.0640, -0.0016,  ...,  0.0048,  0.0283,  0.0634],
        [-0.0165,  0.0304,  0.0109,  ..., -0.0403, -0.0055, -0.0487]],
       device='cuda:0', requires_grad=True)tensor([[-0.0337, -0.0392, -0.0196,  ...,  0.0637,  0.0585,  0.0599],
        [-0.0209, -0.0355, -0.0660,  ...,  0.0115,  0.0334,  0.0593],
        [ 0.0558,  0.0137,  0.0292,  ..., -0.0188, -0.0526, -0.0419],
        ...,
        [ 0.0476,  0.0190,  0.0662,  ...,  0.0074,  0.0205, -0.0505],
        [-0.0515, -0.0640, -0.0016,  ...,  0.0048,  0.0283,  0.0634],
        [-0.0165,  0.0304,  0.0109,  ..., -0.0403, -0.0055, -0.0487]],
       device='cuda:1')
  Average validation loss: 13.63
======== Epoch 56 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0337, -0.0392, -0.0196,  ...,  0.0637,  0.0585,  0.0599],
        [-0.0209, -0.0355, -0.0660,  ...,  0.0115,  0.0334,  0.0593],
        [ 0.0558,  0.0137,  0.0292,  ..., -0.0188, -0.0526, -0.0419],
        ...,
        [ 0.0476,  0.0190,  0.0662,  ...,  0.0074,  0.0205, -0.0505],
        [-0.0515, -0.0640, -0.0016,  ...,  0.0048,  0.0283,  0.0634],
        [-0.0165,  0.0304,  0.0109,  ..., -0.0403, -0.0055, -0.0487]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0337, -0.0392, -0.0196,  ...,  0.0637,  0.0585,  0.0599],
        [-0.0209, -0.0355, -0.0660,  ...,  0.0115,  0.0334,  0.0593],
        [ 0.0558,  0.0137,  0.0292,  ..., -0.0188, -0.0526, -0.0419],
        ...,
        [ 0.0476,  0.0190,  0.0662,  ...,  0.0074,  0.0205, -0.0505],
        [-0.0515, -0.0640, -0.0016,  ...,  0.0048,  0.0283,  0.0634],
        [-0.0165,  0.0304,  0.0109,  ..., -0.0403, -0.0055, -0.0487]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5671, 0.5610], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  551819 KB |  549286 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  551819 KB |  549286 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  551819 KB |  549286 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  551819 KB |  549286 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  739003 KB |  737440 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  739003 KB |  737440 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  113648    |  113307    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  113648    |  113307    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  113648    |  113307    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  113648    |  113307    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   68901    |   68895    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   68901    |   68895    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  494188 KB |  492795 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  494188 KB |  492795 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  494188 KB |  492795 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  494188 KB |  492795 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  720013 KB |  719358 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  720013 KB |  719358 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  109557    |  109275    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  109557    |  109275    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  109557    |  109275    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  109557    |  109275    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   69197    |   69190    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   69197    |   69190    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.56
batch input size: torch.Size([1, 20])batch input size:  Device:torch.Size([1, 20])  0Device:
1
Parameter containing:
tensor([[-0.0341, -0.0396, -0.0200,  ...,  0.0640,  0.0589,  0.0603],
        [-0.0211, -0.0358, -0.0662,  ...,  0.0114,  0.0335,  0.0590],
        [ 0.0562,  0.0140,  0.0296,  ..., -0.0192, -0.0529, -0.0422],
        ...,
        [ 0.0480,  0.0194,  0.0666,  ...,  0.0071,  0.0201, -0.0509],
        [-0.0519, -0.0644, -0.0020,  ...,  0.0052,  0.0286,  0.0637],
        [-0.0161,  0.0308,  0.0113,  ..., -0.0407, -0.0059, -0.0491]],
       device='cuda:0', requires_grad=True)tensor([[-0.0341, -0.0396, -0.0200,  ...,  0.0640,  0.0589,  0.0603],
        [-0.0211, -0.0358, -0.0662,  ...,  0.0114,  0.0335,  0.0590],
        [ 0.0562,  0.0140,  0.0296,  ..., -0.0192, -0.0529, -0.0422],
        ...,
        [ 0.0480,  0.0194,  0.0666,  ...,  0.0071,  0.0201, -0.0509],
        [-0.0519, -0.0644, -0.0020,  ...,  0.0052,  0.0286,  0.0637],
        [-0.0161,  0.0308,  0.0113,  ..., -0.0407, -0.0059, -0.0491]],
       device='cuda:1')
  Average validation loss: 13.63
======== Epoch 57 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0341, -0.0396, -0.0200,  ...,  0.0640,  0.0589,  0.0603],
        [-0.0211, -0.0358, -0.0662,  ...,  0.0114,  0.0335,  0.0590],
        [ 0.0562,  0.0140,  0.0296,  ..., -0.0192, -0.0529, -0.0422],
        ...,
        [ 0.0480,  0.0194,  0.0666,  ...,  0.0071,  0.0201, -0.0509],
        [-0.0519, -0.0644, -0.0020,  ...,  0.0052,  0.0286,  0.0637],
        [-0.0161,  0.0308,  0.0113,  ..., -0.0407, -0.0059, -0.0491]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0341, -0.0396, -0.0200,  ...,  0.0640,  0.0589,  0.0603],
        [-0.0211, -0.0358, -0.0662,  ...,  0.0114,  0.0335,  0.0590],
        [ 0.0562,  0.0140,  0.0296,  ..., -0.0192, -0.0529, -0.0422],
        ...,
        [ 0.0480,  0.0194,  0.0666,  ...,  0.0071,  0.0201, -0.0509],
        [-0.0519, -0.0644, -0.0020,  ...,  0.0052,  0.0286,  0.0637],
        [-0.0161,  0.0308,  0.0113,  ..., -0.0407, -0.0059, -0.0491]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5648, 0.5588], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  564157 KB |  561624 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  564157 KB |  561624 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  564157 KB |  561624 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  564157 KB |  561624 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  753377 KB |  751814 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  753377 KB |  751814 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  115993    |  115652    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  115993    |  115652    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  115993    |  115652    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  115993    |  115652    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   70240    |   70234    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   70240    |   70234    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  505500 KB |  504107 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  505500 KB |  504107 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  505500 KB |  504107 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  505500 KB |  504107 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  735418 KB |  734763 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  735418 KB |  734763 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  111829    |  111547    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  111829    |  111547    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  111829    |  111547    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  111829    |  111547    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   70608    |   70601    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   70608    |   70601    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.56
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0344, -0.0399, -0.0204,  ...,  0.0644,  0.0592,  0.0606],
        [-0.0214, -0.0361, -0.0664,  ...,  0.0113,  0.0336,  0.0588],
        [ 0.0565,  0.0144,  0.0300,  ..., -0.0196, -0.0533, -0.0426],
        ...,
        [ 0.0483,  0.0198,  0.0670,  ...,  0.0067,  0.0198, -0.0512],
        [-0.0523, -0.0648, -0.0024,  ...,  0.0055,  0.0290,  0.0641],
        [-0.0158,  0.0312,  0.0117,  ..., -0.0410, -0.0063, -0.0494]],
       device='cuda:0', requires_grad=True)tensor([[-0.0344, -0.0399, -0.0204,  ...,  0.0644,  0.0592,  0.0606],
        [-0.0214, -0.0361, -0.0664,  ...,  0.0113,  0.0336,  0.0588],
        [ 0.0565,  0.0144,  0.0300,  ..., -0.0196, -0.0533, -0.0426],
        ...,
        [ 0.0483,  0.0198,  0.0670,  ...,  0.0067,  0.0198, -0.0512],
        [-0.0523, -0.0648, -0.0024,  ...,  0.0055,  0.0290,  0.0641],
        [-0.0158,  0.0312,  0.0117,  ..., -0.0410, -0.0063, -0.0494]],
       device='cuda:1')
  Average validation loss: 13.63
======== Epoch 58 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0344, -0.0399, -0.0204,  ...,  0.0644,  0.0592,  0.0606],
        [-0.0214, -0.0361, -0.0664,  ...,  0.0113,  0.0336,  0.0588],
        [ 0.0565,  0.0144,  0.0300,  ..., -0.0196, -0.0533, -0.0426],
        ...,
        [ 0.0483,  0.0198,  0.0670,  ...,  0.0067,  0.0198, -0.0512],
        [-0.0523, -0.0648, -0.0024,  ...,  0.0055,  0.0290,  0.0641],
        [-0.0158,  0.0312,  0.0117,  ..., -0.0410, -0.0063, -0.0494]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0344, -0.0399, -0.0204,  ...,  0.0644,  0.0592,  0.0606],
        [-0.0214, -0.0361, -0.0664,  ...,  0.0113,  0.0336,  0.0588],
        [ 0.0565,  0.0144,  0.0300,  ..., -0.0196, -0.0533, -0.0426],
        ...,
        [ 0.0483,  0.0198,  0.0670,  ...,  0.0067,  0.0198, -0.0512],
        [-0.0523, -0.0648, -0.0024,  ...,  0.0055,  0.0290,  0.0641],
        [-0.0158,  0.0312,  0.0117,  ..., -0.0410, -0.0063, -0.0494]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5625, 0.5566], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  576494 KB |  573961 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  576494 KB |  573961 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  576494 KB |  573961 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  576494 KB |  573961 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  767751 KB |  766188 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  767751 KB |  766188 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  118338    |  117997    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  118338    |  117997    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  118338    |  117997    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  118338    |  117997    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   71591    |   71585    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   71591    |   71585    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  516811 KB |  515418 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  516811 KB |  515418 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  516811 KB |  515418 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  516811 KB |  515418 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  750824 KB |  750169 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  750824 KB |  750169 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  114101    |  113819    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  114101    |  113819    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  114101    |  113819    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  114101    |  113819    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   72019    |   72012    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   72019    |   72012    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.56
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
tensor([[-0.0348, -0.0403, -0.0207,  ...,  0.0648,  0.0596,  0.0610],
        [-0.0216, -0.0364, -0.0666,  ...,  0.0111,  0.0336,  0.0585],
        [ 0.0569,  0.0148,  0.0303,  ..., -0.0199, -0.0537, -0.0429],
        ...,
        [ 0.0487,  0.0201,  0.0673,  ...,  0.0063,  0.0194, -0.0516],
        [-0.0526, -0.0651, -0.0027,  ...,  0.0059,  0.0294,  0.0645],
        [-0.0154,  0.0315,  0.0120,  ..., -0.0414, -0.0066, -0.0498]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0348, -0.0403, -0.0207,  ...,  0.0648,  0.0596,  0.0610],
        [-0.0216, -0.0364, -0.0666,  ...,  0.0111,  0.0336,  0.0585],
        [ 0.0569,  0.0148,  0.0303,  ..., -0.0199, -0.0537, -0.0429],
        ...,
        [ 0.0487,  0.0201,  0.0673,  ...,  0.0063,  0.0194, -0.0516],
        [-0.0526, -0.0651, -0.0027,  ...,  0.0059,  0.0294,  0.0645],
        [-0.0154,  0.0315,  0.0120,  ..., -0.0414, -0.0066, -0.0498]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.63
======== Epoch 59 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20])batch input size:  Device:torch.Size([3, 20])  0Device:
1
tensor([[-0.0348, -0.0403, -0.0207,  ...,  0.0648,  0.0596,  0.0610],
        [-0.0216, -0.0364, -0.0666,  ...,  0.0111,  0.0336,  0.0585],
        [ 0.0569,  0.0148,  0.0303,  ..., -0.0199, -0.0537, -0.0429],
        ...,
        [ 0.0487,  0.0201,  0.0673,  ...,  0.0063,  0.0194, -0.0516],
        [-0.0526, -0.0651, -0.0027,  ...,  0.0059,  0.0294,  0.0645],
        [-0.0154,  0.0315,  0.0120,  ..., -0.0414, -0.0066, -0.0498]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0348, -0.0403, -0.0207,  ...,  0.0648,  0.0596,  0.0610],
        [-0.0216, -0.0364, -0.0666,  ...,  0.0111,  0.0336,  0.0585],
        [ 0.0569,  0.0148,  0.0303,  ..., -0.0199, -0.0537, -0.0429],
        ...,
        [ 0.0487,  0.0201,  0.0673,  ...,  0.0063,  0.0194, -0.0516],
        [-0.0526, -0.0651, -0.0027,  ...,  0.0059,  0.0294,  0.0645],
        [-0.0154,  0.0315,  0.0120,  ..., -0.0414, -0.0066, -0.0498]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5603, 0.5545], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2533 KB |    2743 KB |  588832 KB |  586299 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  588832 KB |  586299 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2533 KB |    2743 KB |  588832 KB |  586299 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2533 KB |    2743 KB |  588832 KB |  586299 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1563 KB |    2749 KB |  782125 KB |  780562 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1563 KB |    2749 KB |  782125 KB |  780562 KB |
|---------------------------------------------------------------------------|
| Allocations           |     341    |     353    |  120683    |  120342    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  120683    |  120342    |
|---------------------------------------------------------------------------|
| Active allocs         |     341    |     353    |  120683    |  120342    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     341    |     353    |  120683    |  120342    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   72936    |   72930    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   72936    |   72930    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1393 KB |    1552 KB |  528123 KB |  526730 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  528123 KB |  526730 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1393 KB |    1552 KB |  528123 KB |  526730 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1393 KB |    1552 KB |  528123 KB |  526730 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  670720 B  |    2047 KB |  766229 KB |  765574 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  670720 B  |    2047 KB |  766229 KB |  765574 KB |
|---------------------------------------------------------------------------|
| Allocations           |     282    |     295    |  116373    |  116091    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  116373    |  116091    |
|---------------------------------------------------------------------------|
| Active allocs         |     282    |     295    |  116373    |  116091    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     282    |     295    |  116373    |  116091    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   73430    |   73423    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   73430    |   73423    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.56
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-0.0351, -0.0406, -0.0211,  ...,  0.0651,  0.0600,  0.0614],
        [-0.0219, -0.0367, -0.0668,  ...,  0.0110,  0.0336,  0.0582],
        [ 0.0573,  0.0151,  0.0307,  ..., -0.0203, -0.0540, -0.0433],
        ...,
        [ 0.0491,  0.0205,  0.0677,  ...,  0.0060,  0.0191, -0.0519],
        [-0.0530, -0.0655, -0.0031,  ...,  0.0062,  0.0297,  0.0648],
        [-0.0151,  0.0319,  0.0124,  ..., -0.0417, -0.0070, -0.0501]],
       device='cuda:0', requires_grad=True)tensor([[-0.0351, -0.0406, -0.0211,  ...,  0.0651,  0.0600,  0.0614],
        [-0.0219, -0.0367, -0.0668,  ...,  0.0110,  0.0336,  0.0582],
        [ 0.0573,  0.0151,  0.0307,  ..., -0.0203, -0.0540, -0.0433],
        ...,
        [ 0.0491,  0.0205,  0.0677,  ...,  0.0060,  0.0191, -0.0519],
        [-0.0530, -0.0655, -0.0031,  ...,  0.0062,  0.0297,  0.0648],
        [-0.0151,  0.0319,  0.0124,  ..., -0.0417, -0.0070, -0.0501]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 60 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0351, -0.0406, -0.0211,  ...,  0.0651,  0.0600,  0.0614],
        [-0.0219, -0.0367, -0.0668,  ...,  0.0110,  0.0336,  0.0582],
        [ 0.0573,  0.0151,  0.0307,  ..., -0.0203, -0.0540, -0.0433],
        ...,
        [ 0.0491,  0.0205,  0.0677,  ...,  0.0060,  0.0191, -0.0519],
        [-0.0530, -0.0655, -0.0031,  ...,  0.0062,  0.0297,  0.0648],
        [-0.0151,  0.0319,  0.0124,  ..., -0.0417, -0.0070, -0.0501]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0351, -0.0406, -0.0211,  ...,  0.0651,  0.0600,  0.0614],
        [-0.0219, -0.0367, -0.0668,  ...,  0.0110,  0.0336,  0.0582],
        [ 0.0573,  0.0151,  0.0307,  ..., -0.0203, -0.0540, -0.0433],
        ...,
        [ 0.0491,  0.0205,  0.0677,  ...,  0.0060,  0.0191, -0.0519],
        [-0.0530, -0.0655, -0.0031,  ...,  0.0062,  0.0297,  0.0648],
        [-0.0151,  0.0319,  0.0124,  ..., -0.0417, -0.0070, -0.0501]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5581, 0.5523], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  601284 KB |  598636 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  601284 KB |  598636 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  601284 KB |  598636 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  601284 KB |  598636 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     777 MB |     776 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     777 MB |     776 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  123048    |  122687    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  123048    |  122687    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  123048    |  122687    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  123048    |  122687    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   74277    |   74271    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   74277    |   74271    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  539549 KB |  538041 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  539549 KB |  538041 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  539549 KB |  538041 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  539549 KB |  538041 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |  781635 KB |  781095 KB |
|       from large pool |       0 B  |       0 KB |       0 KB |       0 KB |
|       from small pool |  552960 B  |    2047 KB |  781635 KB |  781095 KB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  118665    |  118363    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  118665    |  118363    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  118665    |  118363    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  118665    |  118363    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   74841    |   74834    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   74841    |   74834    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.56
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0355, -0.0410, -0.0214,  ...,  0.0655,  0.0603,  0.0617],
        [-0.0221, -0.0370, -0.0670,  ...,  0.0107,  0.0335,  0.0579],
        [ 0.0576,  0.0154,  0.0310,  ..., -0.0206, -0.0543, -0.0436],
        ...,
        [ 0.0494,  0.0208,  0.0680,  ...,  0.0056,  0.0187, -0.0522],
        [-0.0533, -0.0658, -0.0034,  ...,  0.0065,  0.0300,  0.0652],
        [-0.0147,  0.0322,  0.0127,  ..., -0.0421, -0.0073, -0.0505]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0355, -0.0410, -0.0214,  ...,  0.0655,  0.0603,  0.0617],
        [-0.0221, -0.0370, -0.0670,  ...,  0.0107,  0.0335,  0.0579],
        [ 0.0576,  0.0154,  0.0310,  ..., -0.0206, -0.0543, -0.0436],
        ...,
        [ 0.0494,  0.0208,  0.0680,  ...,  0.0056,  0.0187, -0.0522],
        [-0.0533, -0.0658, -0.0034,  ...,  0.0065,  0.0300,  0.0652],
        [-0.0147,  0.0322,  0.0127,  ..., -0.0421, -0.0073, -0.0505]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 61 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0355, -0.0410, -0.0214,  ...,  0.0655,  0.0603,  0.0617],
        [-0.0221, -0.0370, -0.0670,  ...,  0.0107,  0.0335,  0.0579],
        [ 0.0576,  0.0154,  0.0310,  ..., -0.0206, -0.0543, -0.0436],
        ...,
        [ 0.0494,  0.0208,  0.0680,  ...,  0.0056,  0.0187, -0.0522],
        [-0.0533, -0.0658, -0.0034,  ...,  0.0065,  0.0300,  0.0652],
        [-0.0147,  0.0322,  0.0127,  ..., -0.0421, -0.0073, -0.0505]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0355, -0.0410, -0.0214,  ...,  0.0655,  0.0603,  0.0617],
        [-0.0221, -0.0370, -0.0670,  ...,  0.0107,  0.0335,  0.0579],
        [ 0.0576,  0.0154,  0.0310,  ..., -0.0206, -0.0543, -0.0436],
        ...,
        [ 0.0494,  0.0208,  0.0680,  ...,  0.0056,  0.0187, -0.0522],
        [-0.0533, -0.0658, -0.0034,  ...,  0.0065,  0.0300,  0.0652],
        [-0.0147,  0.0322,  0.0127,  ..., -0.0421, -0.0073, -0.0505]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5559, 0.5503], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  614517 KB |  611869 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  614517 KB |  611869 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  614517 KB |  611869 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  614517 KB |  611869 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     792 MB |     791 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     792 MB |     791 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  125503    |  125142    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  125503    |  125142    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  125503    |  125142    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  125503    |  125142    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   75669    |   75663    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   75669    |   75663    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  551756 KB |  550248 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  551756 KB |  550248 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  551756 KB |  550248 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  551756 KB |  550248 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     779 MB |     778 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     779 MB |     778 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  121047    |  120745    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  121047    |  120745    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  121047    |  120745    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  121047    |  120745    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   76312    |   76305    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   76312    |   76305    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.55
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0358, -0.0413, -0.0218,  ...,  0.0658,  0.0607,  0.0621],
        [-0.0223, -0.0372, -0.0671,  ...,  0.0105,  0.0334,  0.0576],
        [ 0.0580,  0.0158,  0.0314,  ..., -0.0210, -0.0547, -0.0440],
        ...,
        [ 0.0497,  0.0211,  0.0684,  ...,  0.0053,  0.0184, -0.0526],
        [-0.0536, -0.0661, -0.0038,  ...,  0.0069,  0.0304,  0.0655],
        [-0.0144,  0.0326,  0.0131,  ..., -0.0424, -0.0077, -0.0508]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0358, -0.0413, -0.0218,  ...,  0.0658,  0.0607,  0.0621],
        [-0.0223, -0.0372, -0.0671,  ...,  0.0105,  0.0334,  0.0576],
        [ 0.0580,  0.0158,  0.0314,  ..., -0.0210, -0.0547, -0.0440],
        ...,
        [ 0.0497,  0.0211,  0.0684,  ...,  0.0053,  0.0184, -0.0526],
        [-0.0536, -0.0661, -0.0038,  ...,  0.0069,  0.0304,  0.0655],
        [-0.0144,  0.0326,  0.0131,  ..., -0.0424, -0.0077, -0.0508]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 62 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0358, -0.0413, -0.0218,  ...,  0.0658,  0.0607,  0.0621],
        [-0.0223, -0.0372, -0.0671,  ...,  0.0105,  0.0334,  0.0576],
        [ 0.0580,  0.0158,  0.0314,  ..., -0.0210, -0.0547, -0.0440],
        ...,
        [ 0.0497,  0.0211,  0.0684,  ...,  0.0053,  0.0184, -0.0526],
        [-0.0536, -0.0661, -0.0038,  ...,  0.0069,  0.0304,  0.0655],
        [-0.0144,  0.0326,  0.0131,  ..., -0.0424, -0.0077, -0.0508]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0358, -0.0413, -0.0218,  ...,  0.0658,  0.0607,  0.0621],
        [-0.0223, -0.0372, -0.0671,  ...,  0.0105,  0.0334,  0.0576],
        [ 0.0580,  0.0158,  0.0314,  ..., -0.0210, -0.0547, -0.0440],
        ...,
        [ 0.0497,  0.0211,  0.0684,  ...,  0.0053,  0.0184, -0.0526],
        [-0.0536, -0.0661, -0.0038,  ...,  0.0069,  0.0304,  0.0655],
        [-0.0144,  0.0326,  0.0131,  ..., -0.0424, -0.0077, -0.0508]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5538, 0.5483], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  627749 KB |  625101 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  627749 KB |  625101 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  627749 KB |  625101 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  627749 KB |  625101 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     807 MB |     806 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     807 MB |     806 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  127958    |  127597    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  127958    |  127597    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  127958    |  127597    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  127958    |  127597    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   77052    |   77046    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   77052    |   77046    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  563962 KB |  562454 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  563962 KB |  562454 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  563962 KB |  562454 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  563962 KB |  562454 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     795 MB |     794 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     795 MB |     794 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  123429    |  123127    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  123429    |  123127    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  123429    |  123127    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  123429    |  123127    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   77783    |   77776    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   77783    |   77776    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.55
batch input size: torch.Size([1, 20]) Device: 0
batch input size: torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0362, -0.0417, -0.0221,  ...,  0.0662,  0.0610,  0.0624],
        [-0.0225, -0.0375, -0.0673,  ...,  0.0102,  0.0332,  0.0572],
        [ 0.0583,  0.0161,  0.0317,  ..., -0.0213, -0.0550, -0.0443],
        ...,
        [ 0.0501,  0.0214,  0.0687,  ...,  0.0050,  0.0181, -0.0529],
        [-0.0540, -0.0665, -0.0041,  ...,  0.0072,  0.0307,  0.0658],
        [-0.0140,  0.0329,  0.0134,  ..., -0.0427, -0.0080, -0.0511]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0362, -0.0417, -0.0221,  ...,  0.0662,  0.0610,  0.0624],
        [-0.0225, -0.0375, -0.0673,  ...,  0.0102,  0.0332,  0.0572],
        [ 0.0583,  0.0161,  0.0317,  ..., -0.0213, -0.0550, -0.0443],
        ...,
        [ 0.0501,  0.0214,  0.0687,  ...,  0.0050,  0.0181, -0.0529],
        [-0.0540, -0.0665, -0.0041,  ...,  0.0072,  0.0307,  0.0658],
        [-0.0140,  0.0329,  0.0134,  ..., -0.0427, -0.0080, -0.0511]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 63 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0362, -0.0417, -0.0221,  ...,  0.0662,  0.0610,  0.0624],
        [-0.0225, -0.0375, -0.0673,  ...,  0.0102,  0.0332,  0.0572],
        [ 0.0583,  0.0161,  0.0317,  ..., -0.0213, -0.0550, -0.0443],
        ...,
        [ 0.0501,  0.0214,  0.0687,  ...,  0.0050,  0.0181, -0.0529],
        [-0.0540, -0.0665, -0.0041,  ...,  0.0072,  0.0307,  0.0658],
        [-0.0140,  0.0329,  0.0134,  ..., -0.0427, -0.0080, -0.0511]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0362, -0.0417, -0.0221,  ...,  0.0662,  0.0610,  0.0624],
        [-0.0225, -0.0375, -0.0673,  ...,  0.0102,  0.0332,  0.0572],
        [ 0.0583,  0.0161,  0.0317,  ..., -0.0213, -0.0550, -0.0443],
        ...,
        [ 0.0501,  0.0214,  0.0687,  ...,  0.0050,  0.0181, -0.0529],
        [-0.0540, -0.0665, -0.0041,  ...,  0.0072,  0.0307,  0.0658],
        [-0.0140,  0.0329,  0.0134,  ..., -0.0427, -0.0080, -0.0511]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5517, 0.5463], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  640982 KB |  638334 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  640982 KB |  638334 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  640982 KB |  638334 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  640982 KB |  638334 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     822 MB |     821 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     822 MB |     821 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  130413    |  130052    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  130413    |  130052    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  130413    |  130052    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  130413    |  130052    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   78435    |   78429    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   78435    |   78429    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  576169 KB |  574661 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  576169 KB |  574661 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  576169 KB |  574661 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  576169 KB |  574661 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     811 MB |     810 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     811 MB |     810 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  125811    |  125509    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  125811    |  125509    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  125811    |  125509    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  125811    |  125509    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   79254    |   79247    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   79254    |   79247    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.55
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0365, -0.0420, -0.0225,  ...,  0.0665,  0.0613,  0.0627],
        [-0.0227, -0.0377, -0.0674,  ...,  0.0099,  0.0330,  0.0569],
        [ 0.0586,  0.0164,  0.0320,  ..., -0.0216, -0.0553, -0.0446],
        ...,
        [ 0.0504,  0.0218,  0.0690,  ...,  0.0047,  0.0177, -0.0532],
        [-0.0543, -0.0668, -0.0044,  ...,  0.0075,  0.0310,  0.0661],
        [-0.0137,  0.0332,  0.0137,  ..., -0.0430, -0.0083, -0.0515]],
       device='cuda:0', requires_grad=True)tensor([[-0.0365, -0.0420, -0.0225,  ...,  0.0665,  0.0613,  0.0627],
        [-0.0227, -0.0377, -0.0674,  ...,  0.0099,  0.0330,  0.0569],
        [ 0.0586,  0.0164,  0.0320,  ..., -0.0216, -0.0553, -0.0446],
        ...,
        [ 0.0504,  0.0218,  0.0690,  ...,  0.0047,  0.0177, -0.0532],
        [-0.0543, -0.0668, -0.0044,  ...,  0.0075,  0.0310,  0.0661],
        [-0.0137,  0.0332,  0.0137,  ..., -0.0430, -0.0083, -0.0515]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 64 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0365, -0.0420, -0.0225,  ...,  0.0665,  0.0613,  0.0627],
        [-0.0227, -0.0377, -0.0674,  ...,  0.0099,  0.0330,  0.0569],
        [ 0.0586,  0.0164,  0.0320,  ..., -0.0216, -0.0553, -0.0446],
        ...,
        [ 0.0504,  0.0218,  0.0690,  ...,  0.0047,  0.0177, -0.0532],
        [-0.0543, -0.0668, -0.0044,  ...,  0.0075,  0.0310,  0.0661],
        [-0.0137,  0.0332,  0.0137,  ..., -0.0430, -0.0083, -0.0515]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0365, -0.0420, -0.0225,  ...,  0.0665,  0.0613,  0.0627],
        [-0.0227, -0.0377, -0.0674,  ...,  0.0099,  0.0330,  0.0569],
        [ 0.0586,  0.0164,  0.0320,  ..., -0.0216, -0.0553, -0.0446],
        ...,
        [ 0.0504,  0.0218,  0.0690,  ...,  0.0047,  0.0177, -0.0532],
        [-0.0543, -0.0668, -0.0044,  ...,  0.0075,  0.0310,  0.0661],
        [-0.0137,  0.0332,  0.0137,  ..., -0.0430, -0.0083, -0.0515]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5497, 0.5444], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  654214 KB |  651566 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  654214 KB |  651566 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  654214 KB |  651566 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  654214 KB |  651566 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     837 MB |     836 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     837 MB |     836 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  132868    |  132507    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  132868    |  132507    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  132868    |  132507    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  132868    |  132507    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   79824    |   79818    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   79824    |   79818    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  588375 KB |  586867 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  588375 KB |  586867 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  588375 KB |  586867 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  588375 KB |  586867 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     826 MB |     826 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     826 MB |     826 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  128193    |  127891    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  128193    |  127891    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  128193    |  127891    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  128193    |  127891    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   80725    |   80718    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   80725    |   80718    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.55
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0368, -0.0423, -0.0228,  ...,  0.0668,  0.0617,  0.0631],
        [-0.0228, -0.0380, -0.0675,  ...,  0.0097,  0.0328,  0.0566],
        [ 0.0589,  0.0168,  0.0324,  ..., -0.0219, -0.0556, -0.0449],
        ...,
        [ 0.0507,  0.0221,  0.0694,  ...,  0.0043,  0.0174, -0.0535],
        [-0.0546, -0.0671, -0.0048,  ...,  0.0078,  0.0314,  0.0665],
        [-0.0134,  0.0335,  0.0141,  ..., -0.0434, -0.0086, -0.0518]],
       device='cuda:0', requires_grad=True)tensor([[-0.0368, -0.0423, -0.0228,  ...,  0.0668,  0.0617,  0.0631],
        [-0.0228, -0.0380, -0.0675,  ...,  0.0097,  0.0328,  0.0566],
        [ 0.0589,  0.0168,  0.0324,  ..., -0.0219, -0.0556, -0.0449],
        ...,
        [ 0.0507,  0.0221,  0.0694,  ...,  0.0043,  0.0174, -0.0535],
        [-0.0546, -0.0671, -0.0048,  ...,  0.0078,  0.0314,  0.0665],
        [-0.0134,  0.0335,  0.0141,  ..., -0.0434, -0.0086, -0.0518]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 65 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0368, -0.0423, -0.0228,  ...,  0.0668,  0.0617,  0.0631],
        [-0.0228, -0.0380, -0.0675,  ...,  0.0097,  0.0328,  0.0566],
        [ 0.0589,  0.0168,  0.0324,  ..., -0.0219, -0.0556, -0.0449],
        ...,
        [ 0.0507,  0.0221,  0.0694,  ...,  0.0043,  0.0174, -0.0535],
        [-0.0546, -0.0671, -0.0048,  ...,  0.0078,  0.0314,  0.0665],
        [-0.0134,  0.0335,  0.0141,  ..., -0.0434, -0.0086, -0.0518]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0368, -0.0423, -0.0228,  ...,  0.0668,  0.0617,  0.0631],
        [-0.0228, -0.0380, -0.0675,  ...,  0.0097,  0.0328,  0.0566],
        [ 0.0589,  0.0168,  0.0324,  ..., -0.0219, -0.0556, -0.0449],
        ...,
        [ 0.0507,  0.0221,  0.0694,  ...,  0.0043,  0.0174, -0.0535],
        [-0.0546, -0.0671, -0.0048,  ...,  0.0078,  0.0314,  0.0665],
        [-0.0134,  0.0335,  0.0141,  ..., -0.0434, -0.0086, -0.0518]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5477, 0.5425], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  667447 KB |  664799 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  667447 KB |  664799 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  667447 KB |  664799 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  667447 KB |  664799 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     852 MB |     850 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     852 MB |     850 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  135323    |  134962    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  135323    |  134962    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  135323    |  134962    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  135323    |  134962    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   81209    |   81203    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   81209    |   81203    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  600582 KB |  599074 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  600582 KB |  599074 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  600582 KB |  599074 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  600582 KB |  599074 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     842 MB |     842 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     842 MB |     842 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  130575    |  130273    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  130575    |  130273    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  130575    |  130273    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  130575    |  130273    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   82196    |   82189    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   82196    |   82189    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.55
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0371, -0.0426, -0.0231,  ...,  0.0672,  0.0620,  0.0634],
        [-0.0230, -0.0382, -0.0676,  ...,  0.0094,  0.0326,  0.0563],
        [ 0.0593,  0.0171,  0.0327,  ..., -0.0222, -0.0559, -0.0452],
        ...,
        [ 0.0510,  0.0224,  0.0697,  ...,  0.0040,  0.0171, -0.0538],
        [-0.0549, -0.0674, -0.0051,  ...,  0.0081,  0.0317,  0.0668],
        [-0.0131,  0.0339,  0.0144,  ..., -0.0437, -0.0090, -0.0521]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0371, -0.0426, -0.0231,  ...,  0.0672,  0.0620,  0.0634],
        [-0.0230, -0.0382, -0.0676,  ...,  0.0094,  0.0326,  0.0563],
        [ 0.0593,  0.0171,  0.0327,  ..., -0.0222, -0.0559, -0.0452],
        ...,
        [ 0.0510,  0.0224,  0.0697,  ...,  0.0040,  0.0171, -0.0538],
        [-0.0549, -0.0674, -0.0051,  ...,  0.0081,  0.0317,  0.0668],
        [-0.0131,  0.0339,  0.0144,  ..., -0.0437, -0.0090, -0.0521]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 66 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0371, -0.0426, -0.0231,  ...,  0.0672,  0.0620,  0.0634],
        [-0.0230, -0.0382, -0.0676,  ...,  0.0094,  0.0326,  0.0563],
        [ 0.0593,  0.0171,  0.0327,  ..., -0.0222, -0.0559, -0.0452],
        ...,
        [ 0.0510,  0.0224,  0.0697,  ...,  0.0040,  0.0171, -0.0538],
        [-0.0549, -0.0674, -0.0051,  ...,  0.0081,  0.0317,  0.0668],
        [-0.0131,  0.0339,  0.0144,  ..., -0.0437, -0.0090, -0.0521]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0371, -0.0426, -0.0231,  ...,  0.0672,  0.0620,  0.0634],
        [-0.0230, -0.0382, -0.0676,  ...,  0.0094,  0.0326,  0.0563],
        [ 0.0593,  0.0171,  0.0327,  ..., -0.0222, -0.0559, -0.0452],
        ...,
        [ 0.0510,  0.0224,  0.0697,  ...,  0.0040,  0.0171, -0.0538],
        [-0.0549, -0.0674, -0.0051,  ...,  0.0081,  0.0317,  0.0668],
        [-0.0131,  0.0339,  0.0144,  ..., -0.0437, -0.0090, -0.0521]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5458, 0.5407], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  680679 KB |  678031 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  680679 KB |  678031 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  680679 KB |  678031 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  680679 KB |  678031 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     867 MB |     865 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     867 MB |     865 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  137778    |  137417    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  137778    |  137417    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  137778    |  137417    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  137778    |  137417    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   82593    |   82587    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   82593    |   82587    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  612788 KB |  611280 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  612788 KB |  611280 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  612788 KB |  611280 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  612788 KB |  611280 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     858 MB |     858 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     858 MB |     858 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  132957    |  132655    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  132957    |  132655    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  132957    |  132655    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  132957    |  132655    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   83667    |   83660    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   83667    |   83660    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.54
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0374, -0.0429, -0.0234,  ...,  0.0675,  0.0623,  0.0637],
        [-0.0231, -0.0384, -0.0676,  ...,  0.0091,  0.0323,  0.0560],
        [ 0.0596,  0.0174,  0.0330,  ..., -0.0226, -0.0562, -0.0455],
        ...,
        [ 0.0513,  0.0227,  0.0700,  ...,  0.0037,  0.0168, -0.0541],
        [-0.0552, -0.0677, -0.0054,  ...,  0.0084,  0.0320,  0.0671],
        [-0.0128,  0.0342,  0.0147,  ..., -0.0440, -0.0093, -0.0524]],
       device='cuda:1')Parameter containing:
tensor([[-0.0374, -0.0429, -0.0234,  ...,  0.0675,  0.0623,  0.0637],
        [-0.0231, -0.0384, -0.0676,  ...,  0.0091,  0.0323,  0.0560],
        [ 0.0596,  0.0174,  0.0330,  ..., -0.0226, -0.0562, -0.0455],
        ...,
        [ 0.0513,  0.0227,  0.0700,  ...,  0.0037,  0.0168, -0.0541],
        [-0.0552, -0.0677, -0.0054,  ...,  0.0084,  0.0320,  0.0671],
        [-0.0128,  0.0342,  0.0147,  ..., -0.0440, -0.0093, -0.0524]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 67 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0374, -0.0429, -0.0234,  ...,  0.0675,  0.0623,  0.0637],
        [-0.0231, -0.0384, -0.0676,  ...,  0.0091,  0.0323,  0.0560],
        [ 0.0596,  0.0174,  0.0330,  ..., -0.0226, -0.0562, -0.0455],
        ...,
        [ 0.0513,  0.0227,  0.0700,  ...,  0.0037,  0.0168, -0.0541],
        [-0.0552, -0.0677, -0.0054,  ...,  0.0084,  0.0320,  0.0671],
        [-0.0128,  0.0342,  0.0147,  ..., -0.0440, -0.0093, -0.0524]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0374, -0.0429, -0.0234,  ...,  0.0675,  0.0623,  0.0637],
        [-0.0231, -0.0384, -0.0676,  ...,  0.0091,  0.0323,  0.0560],
        [ 0.0596,  0.0174,  0.0330,  ..., -0.0226, -0.0562, -0.0455],
        ...,
        [ 0.0513,  0.0227,  0.0700,  ...,  0.0037,  0.0168, -0.0541],
        [-0.0552, -0.0677, -0.0054,  ...,  0.0084,  0.0320,  0.0671],
        [-0.0128,  0.0342,  0.0147,  ..., -0.0440, -0.0093, -0.0524]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5439, 0.5389], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  693912 KB |  691264 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  693912 KB |  691264 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  693912 KB |  691264 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  693912 KB |  691264 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     882 MB |     880 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     882 MB |     880 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  140233    |  139872    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  140233    |  139872    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  140233    |  139872    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  140233    |  139872    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   83980    |   83974    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   83980    |   83974    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  624995 KB |  623487 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  624995 KB |  623487 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  624995 KB |  623487 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  624995 KB |  623487 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     874 MB |     874 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     874 MB |     874 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  135339    |  135037    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  135339    |  135037    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  135339    |  135037    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  135339    |  135037    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   85138    |   85131    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   85138    |   85131    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.54
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0377, -0.0432, -0.0237,  ...,  0.0678,  0.0626,  0.0640],
        [-0.0232, -0.0387, -0.0677,  ...,  0.0088,  0.0321,  0.0557],
        [ 0.0599,  0.0177,  0.0333,  ..., -0.0228, -0.0565, -0.0458],
        ...,
        [ 0.0516,  0.0229,  0.0703,  ...,  0.0034,  0.0165, -0.0544],
        [-0.0555, -0.0680, -0.0057,  ...,  0.0087,  0.0323,  0.0674],
        [-0.0125,  0.0345,  0.0150,  ..., -0.0443, -0.0096, -0.0527]],
       device='cuda:1')Parameter containing:
tensor([[-0.0377, -0.0432, -0.0237,  ...,  0.0678,  0.0626,  0.0640],
        [-0.0232, -0.0387, -0.0677,  ...,  0.0088,  0.0321,  0.0557],
        [ 0.0599,  0.0177,  0.0333,  ..., -0.0228, -0.0565, -0.0458],
        ...,
        [ 0.0516,  0.0229,  0.0703,  ...,  0.0034,  0.0165, -0.0544],
        [-0.0555, -0.0680, -0.0057,  ...,  0.0087,  0.0323,  0.0674],
        [-0.0125,  0.0345,  0.0150,  ..., -0.0443, -0.0096, -0.0527]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 68 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0377, -0.0432, -0.0237,  ...,  0.0678,  0.0626,  0.0640],
        [-0.0232, -0.0387, -0.0677,  ...,  0.0088,  0.0321,  0.0557],
        [ 0.0599,  0.0177,  0.0333,  ..., -0.0228, -0.0565, -0.0458],
        ...,
        [ 0.0516,  0.0229,  0.0703,  ...,  0.0034,  0.0165, -0.0544],
        [-0.0555, -0.0680, -0.0057,  ...,  0.0087,  0.0323,  0.0674],
        [-0.0125,  0.0345,  0.0150,  ..., -0.0443, -0.0096, -0.0527]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0377, -0.0432, -0.0237,  ...,  0.0678,  0.0626,  0.0640],
        [-0.0232, -0.0387, -0.0677,  ...,  0.0088,  0.0321,  0.0557],
        [ 0.0599,  0.0177,  0.0333,  ..., -0.0228, -0.0565, -0.0458],
        ...,
        [ 0.0516,  0.0229,  0.0703,  ...,  0.0034,  0.0165, -0.0544],
        [-0.0555, -0.0680, -0.0057,  ...,  0.0087,  0.0323,  0.0674],
        [-0.0125,  0.0345,  0.0150,  ..., -0.0443, -0.0096, -0.0527]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5421, 0.5371], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  707144 KB |  704496 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  707144 KB |  704496 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  707144 KB |  704496 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  707144 KB |  704496 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     897 MB |     895 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     897 MB |     895 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  142688    |  142327    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  142688    |  142327    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  142688    |  142327    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  142688    |  142327    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   85367    |   85361    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   85367    |   85361    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  637201 KB |  635693 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  637201 KB |  635693 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  637201 KB |  635693 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  637201 KB |  635693 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     890 MB |     890 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     890 MB |     890 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  137721    |  137419    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  137721    |  137419    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  137721    |  137419    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  137721    |  137419    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   86609    |   86602    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   86609    |   86602    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.54
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0380, -0.0435, -0.0240,  ...,  0.0681,  0.0629,  0.0643],
        [-0.0233, -0.0389, -0.0677,  ...,  0.0085,  0.0318,  0.0554],
        [ 0.0602,  0.0180,  0.0336,  ..., -0.0231, -0.0568, -0.0461],
        ...,
        [ 0.0519,  0.0232,  0.0706,  ...,  0.0032,  0.0162, -0.0546],
        [-0.0558, -0.0683, -0.0060,  ...,  0.0090,  0.0326,  0.0676],
        [-0.0122,  0.0348,  0.0153,  ..., -0.0445, -0.0098, -0.0529]],
       device='cuda:1')Parameter containing:
tensor([[-0.0380, -0.0435, -0.0240,  ...,  0.0681,  0.0629,  0.0643],
        [-0.0233, -0.0389, -0.0677,  ...,  0.0085,  0.0318,  0.0554],
        [ 0.0602,  0.0180,  0.0336,  ..., -0.0231, -0.0568, -0.0461],
        ...,
        [ 0.0519,  0.0232,  0.0706,  ...,  0.0032,  0.0162, -0.0546],
        [-0.0558, -0.0683, -0.0060,  ...,  0.0090,  0.0326,  0.0676],
        [-0.0122,  0.0348,  0.0153,  ..., -0.0445, -0.0098, -0.0529]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 69 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0380, -0.0435, -0.0240,  ...,  0.0681,  0.0629,  0.0643],
        [-0.0233, -0.0389, -0.0677,  ...,  0.0085,  0.0318,  0.0554],
        [ 0.0602,  0.0180,  0.0336,  ..., -0.0231, -0.0568, -0.0461],
        ...,
        [ 0.0519,  0.0232,  0.0706,  ...,  0.0032,  0.0162, -0.0546],
        [-0.0558, -0.0683, -0.0060,  ...,  0.0090,  0.0326,  0.0676],
        [-0.0122,  0.0348,  0.0153,  ..., -0.0445, -0.0098, -0.0529]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0380, -0.0435, -0.0240,  ...,  0.0681,  0.0629,  0.0643],
        [-0.0233, -0.0389, -0.0677,  ...,  0.0085,  0.0318,  0.0554],
        [ 0.0602,  0.0180,  0.0336,  ..., -0.0231, -0.0568, -0.0461],
        ...,
        [ 0.0519,  0.0232,  0.0706,  ...,  0.0032,  0.0162, -0.0546],
        [-0.0558, -0.0683, -0.0060,  ...,  0.0090,  0.0326,  0.0676],
        [-0.0122,  0.0348,  0.0153,  ..., -0.0445, -0.0098, -0.0529]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5403, 0.5354], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2648 KB |    2858 KB |  720377 KB |  717729 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  720377 KB |  717729 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2648 KB |    2858 KB |  720377 KB |  717729 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2648 KB |    2858 KB |  720377 KB |  717729 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1448 KB |    2749 KB |     912 MB |     910 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1448 KB |    2749 KB |     912 MB |     910 MB |
|---------------------------------------------------------------------------|
| Allocations           |     361    |     373    |  145143    |  144782    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  145143    |  144782    |
|---------------------------------------------------------------------------|
| Active allocs         |     361    |     373    |  145143    |  144782    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     361    |     373    |  145143    |  144782    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   86748    |   86742    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   86748    |   86742    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1508 KB |    1667 KB |  649408 KB |  647900 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  649408 KB |  647900 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1508 KB |    1667 KB |  649408 KB |  647900 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1508 KB |    1667 KB |  649408 KB |  647900 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  552960 B  |    2047 KB |     906 MB |     906 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  552960 B  |    2047 KB |     906 MB |     906 MB |
|---------------------------------------------------------------------------|
| Allocations           |     302    |     315    |  140103    |  139801    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  140103    |  139801    |
|---------------------------------------------------------------------------|
| Active allocs         |     302    |     315    |  140103    |  139801    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     302    |     315    |  140103    |  139801    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   88080    |   88073    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   88080    |   88073    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.54
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0383, -0.0438, -0.0243,  ...,  0.0684,  0.0632,  0.0646],
        [-0.0233, -0.0391, -0.0677,  ...,  0.0083,  0.0315,  0.0551],
        [ 0.0605,  0.0182,  0.0338,  ..., -0.0234, -0.0571, -0.0464],
        ...,
        [ 0.0522,  0.0235,  0.0708,  ...,  0.0029,  0.0160, -0.0549],
        [-0.0561, -0.0685, -0.0063,  ...,  0.0092,  0.0328,  0.0679],
        [-0.0119,  0.0350,  0.0155,  ..., -0.0448, -0.0101, -0.0532]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0383, -0.0438, -0.0243,  ...,  0.0684,  0.0632,  0.0646],
        [-0.0233, -0.0391, -0.0677,  ...,  0.0083,  0.0315,  0.0551],
        [ 0.0605,  0.0182,  0.0338,  ..., -0.0234, -0.0571, -0.0464],
        ...,
        [ 0.0522,  0.0235,  0.0708,  ...,  0.0029,  0.0160, -0.0549],
        [-0.0561, -0.0685, -0.0063,  ...,  0.0092,  0.0328,  0.0679],
        [-0.0119,  0.0350,  0.0155,  ..., -0.0448, -0.0101, -0.0532]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 70 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0383, -0.0438, -0.0243,  ...,  0.0684,  0.0632,  0.0646],
        [-0.0233, -0.0391, -0.0677,  ...,  0.0083,  0.0315,  0.0551],
        [ 0.0605,  0.0182,  0.0338,  ..., -0.0234, -0.0571, -0.0464],
        ...,
        [ 0.0522,  0.0235,  0.0708,  ...,  0.0029,  0.0160, -0.0549],
        [-0.0561, -0.0685, -0.0063,  ...,  0.0092,  0.0328,  0.0679],
        [-0.0119,  0.0350,  0.0155,  ..., -0.0448, -0.0101, -0.0532]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0383, -0.0438, -0.0243,  ...,  0.0684,  0.0632,  0.0646],
        [-0.0233, -0.0391, -0.0677,  ...,  0.0083,  0.0315,  0.0551],
        [ 0.0605,  0.0182,  0.0338,  ..., -0.0234, -0.0571, -0.0464],
        ...,
        [ 0.0522,  0.0235,  0.0708,  ...,  0.0029,  0.0160, -0.0549],
        [-0.0561, -0.0685, -0.0063,  ...,  0.0092,  0.0328,  0.0679],
        [-0.0119,  0.0350,  0.0155,  ..., -0.0448, -0.0101, -0.0532]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5385, 0.5337], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |  733724 KB |  730961 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  733724 KB |  730961 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |  733724 KB |  730961 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  733724 KB |  730961 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |     926 MB |     925 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |     926 MB |     925 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  147618    |  147237    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  147618    |  147237    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  147618    |  147237    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  147618    |  147237    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   88137    |   88131    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   88137    |   88131    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  661729 KB |  660106 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  661729 KB |  660106 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  661729 KB |  660106 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  661729 KB |  660106 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |     922 MB |     922 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |     922 MB |     922 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  142505    |  142183    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  142505    |  142183    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  142505    |  142183    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  142505    |  142183    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   89551    |   89544    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   89551    |   89544    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.54
batch input size: torch.Size([1, 20]) Device: 0
Parameter containing:
tensor([[-0.0386, -0.0441, -0.0246,  ...,  0.0686,  0.0635,  0.0649],
        [-0.0234, -0.0393, -0.0677,  ...,  0.0080,  0.0313,  0.0548],
        [ 0.0607,  0.0185,  0.0341,  ..., -0.0237, -0.0573, -0.0467],
        ...,
        [ 0.0525,  0.0237,  0.0711,  ...,  0.0026,  0.0157, -0.0552],
        [-0.0563, -0.0688, -0.0065,  ...,  0.0095,  0.0331,  0.0682],
        [-0.0117,  0.0353,  0.0158,  ..., -0.0451, -0.0104, -0.0535]],
       device='cuda:0', requires_grad=True)
batch input size: torch.Size([1, 20]) Device: 1
tensor([[-0.0386, -0.0441, -0.0246,  ...,  0.0686,  0.0635,  0.0649],
        [-0.0234, -0.0393, -0.0677,  ...,  0.0080,  0.0313,  0.0548],
        [ 0.0607,  0.0185,  0.0341,  ..., -0.0237, -0.0573, -0.0467],
        ...,
        [ 0.0525,  0.0237,  0.0711,  ...,  0.0026,  0.0157, -0.0552],
        [-0.0563, -0.0688, -0.0065,  ...,  0.0095,  0.0331,  0.0682],
        [-0.0117,  0.0353,  0.0158,  ..., -0.0451, -0.0104, -0.0535]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 71 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0386, -0.0441, -0.0246,  ...,  0.0686,  0.0635,  0.0649],
        [-0.0234, -0.0393, -0.0677,  ...,  0.0080,  0.0313,  0.0548],
        [ 0.0607,  0.0185,  0.0341,  ..., -0.0237, -0.0573, -0.0467],
        ...,
        [ 0.0525,  0.0237,  0.0711,  ...,  0.0026,  0.0157, -0.0552],
        [-0.0563, -0.0688, -0.0065,  ...,  0.0095,  0.0331,  0.0682],
        [-0.0117,  0.0353,  0.0158,  ..., -0.0451, -0.0104, -0.0535]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0386, -0.0441, -0.0246,  ...,  0.0686,  0.0635,  0.0649],
        [-0.0234, -0.0393, -0.0677,  ...,  0.0080,  0.0313,  0.0548],
        [ 0.0607,  0.0185,  0.0341,  ..., -0.0237, -0.0573, -0.0467],
        ...,
        [ 0.0525,  0.0237,  0.0711,  ...,  0.0026,  0.0157, -0.0552],
        [-0.0563, -0.0688, -0.0065,  ...,  0.0095,  0.0331,  0.0682],
        [-0.0117,  0.0353,  0.0158,  ..., -0.0451, -0.0104, -0.0535]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5368, 0.5321], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |  747852 KB |  745089 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  747852 KB |  745089 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |  747852 KB |  745089 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  747852 KB |  745089 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |     942 MB |     941 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |     942 MB |     941 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  150183    |  149802    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  150183    |  149802    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  150183    |  149802    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  150183    |  149802    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   89565    |   89559    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   89565    |   89559    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  674831 KB |  673208 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  674831 KB |  673208 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  674831 KB |  673208 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  674831 KB |  673208 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |     939 MB |     938 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |     939 MB |     938 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  144997    |  144675    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  144997    |  144675    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  144997    |  144675    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  144997    |  144675    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   91082    |   91075    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   91082    |   91075    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.53
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0388, -0.0444, -0.0248,  ...,  0.0689,  0.0638,  0.0651],
        [-0.0234, -0.0394, -0.0677,  ...,  0.0077,  0.0310,  0.0545],
        [ 0.0610,  0.0188,  0.0344,  ..., -0.0240, -0.0576, -0.0469],
        ...,
        [ 0.0527,  0.0240,  0.0714,  ...,  0.0023,  0.0154, -0.0554],
        [-0.0566, -0.0691, -0.0068,  ...,  0.0097,  0.0334,  0.0684],
        [-0.0114,  0.0356,  0.0161,  ..., -0.0453, -0.0107, -0.0537]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0388, -0.0444, -0.0248,  ...,  0.0689,  0.0638,  0.0651],
        [-0.0234, -0.0394, -0.0677,  ...,  0.0077,  0.0310,  0.0545],
        [ 0.0610,  0.0188,  0.0344,  ..., -0.0240, -0.0576, -0.0469],
        ...,
        [ 0.0527,  0.0240,  0.0714,  ...,  0.0023,  0.0154, -0.0554],
        [-0.0566, -0.0691, -0.0068,  ...,  0.0097,  0.0334,  0.0684],
        [-0.0114,  0.0356,  0.0161,  ..., -0.0453, -0.0107, -0.0537]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 72 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0388, -0.0444, -0.0248,  ...,  0.0689,  0.0638,  0.0651],
        [-0.0234, -0.0394, -0.0677,  ...,  0.0077,  0.0310,  0.0545],
        [ 0.0610,  0.0188,  0.0344,  ..., -0.0240, -0.0576, -0.0469],
        ...,
        [ 0.0527,  0.0240,  0.0714,  ...,  0.0023,  0.0154, -0.0554],
        [-0.0566, -0.0691, -0.0068,  ...,  0.0097,  0.0334,  0.0684],
        [-0.0114,  0.0356,  0.0161,  ..., -0.0453, -0.0107, -0.0537]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0388, -0.0444, -0.0248,  ...,  0.0689,  0.0638,  0.0651],
        [-0.0234, -0.0394, -0.0677,  ...,  0.0077,  0.0310,  0.0545],
        [ 0.0610,  0.0188,  0.0344,  ..., -0.0240, -0.0576, -0.0469],
        ...,
        [ 0.0527,  0.0240,  0.0714,  ...,  0.0023,  0.0154, -0.0554],
        [-0.0566, -0.0691, -0.0068,  ...,  0.0097,  0.0334,  0.0684],
        [-0.0114,  0.0356,  0.0161,  ..., -0.0453, -0.0107, -0.0537]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5352, 0.5306], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |  761979 KB |  759216 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  761979 KB |  759216 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |  761979 KB |  759216 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  761979 KB |  759216 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |     958 MB |     957 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |     958 MB |     957 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  152748    |  152367    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  152748    |  152367    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  152748    |  152367    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  152748    |  152367    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   90984    |   90978    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   90984    |   90978    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  687932 KB |  686309 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  687932 KB |  686309 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  687932 KB |  686309 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  687932 KB |  686309 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |     956 MB |     955 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |     956 MB |     955 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  147489    |  147167    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  147489    |  147167    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  147489    |  147167    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  147489    |  147167    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   92613    |   92606    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   92613    |   92606    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.53
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0391, -0.0446, -0.0251,  ...,  0.0692,  0.0640,  0.0654],
        [-0.0234, -0.0396, -0.0676,  ...,  0.0074,  0.0308,  0.0543],
        [ 0.0613,  0.0190,  0.0346,  ..., -0.0242, -0.0578, -0.0472],
        ...,
        [ 0.0530,  0.0242,  0.0716,  ...,  0.0021,  0.0152, -0.0556],
        [-0.0568, -0.0693, -0.0071,  ...,  0.0100,  0.0336,  0.0687],
        [-0.0111,  0.0358,  0.0163,  ..., -0.0456, -0.0109, -0.0540]],
       device='cuda:1')Parameter containing:
tensor([[-0.0391, -0.0446, -0.0251,  ...,  0.0692,  0.0640,  0.0654],
        [-0.0234, -0.0396, -0.0676,  ...,  0.0074,  0.0308,  0.0543],
        [ 0.0613,  0.0190,  0.0346,  ..., -0.0242, -0.0578, -0.0472],
        ...,
        [ 0.0530,  0.0242,  0.0716,  ...,  0.0021,  0.0152, -0.0556],
        [-0.0568, -0.0693, -0.0071,  ...,  0.0100,  0.0336,  0.0687],
        [-0.0111,  0.0358,  0.0163,  ..., -0.0456, -0.0109, -0.0540]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.64
======== Epoch 73 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0391, -0.0446, -0.0251,  ...,  0.0692,  0.0640,  0.0654],
        [-0.0234, -0.0396, -0.0676,  ...,  0.0074,  0.0308,  0.0543],
        [ 0.0613,  0.0190,  0.0346,  ..., -0.0242, -0.0578, -0.0472],
        ...,
        [ 0.0530,  0.0242,  0.0716,  ...,  0.0021,  0.0152, -0.0556],
        [-0.0568, -0.0693, -0.0071,  ...,  0.0100,  0.0336,  0.0687],
        [-0.0111,  0.0358,  0.0163,  ..., -0.0456, -0.0109, -0.0540]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0391, -0.0446, -0.0251,  ...,  0.0692,  0.0640,  0.0654],
        [-0.0234, -0.0396, -0.0676,  ...,  0.0074,  0.0308,  0.0543],
        [ 0.0613,  0.0190,  0.0346,  ..., -0.0242, -0.0578, -0.0472],
        ...,
        [ 0.0530,  0.0242,  0.0716,  ...,  0.0021,  0.0152, -0.0556],
        [-0.0568, -0.0693, -0.0071,  ...,  0.0100,  0.0336,  0.0687],
        [-0.0111,  0.0358,  0.0163,  ..., -0.0456, -0.0109, -0.0540]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5336, 0.5291], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |  776107 KB |  773344 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  776107 KB |  773344 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |  776107 KB |  773344 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2763 KB |    2973 KB |  776107 KB |  773344 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |     974 MB |     972 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |     974 MB |     972 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  155313    |  154932    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  155313    |  154932    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  155313    |  154932    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  155313    |  154932    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   92415    |   92409    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   92415    |   92409    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  701034 KB |  699411 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  701034 KB |  699411 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  701034 KB |  699411 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  701034 KB |  699411 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |     972 MB |     972 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |     972 MB |     972 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  149981    |  149659    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  149981    |  149659    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  149981    |  149659    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  149981    |  149659    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   94144    |   94137    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   94144    |   94137    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.53
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0394, -0.0449, -0.0253,  ...,  0.0694,  0.0643,  0.0657],
        [-0.0234, -0.0398, -0.0676,  ...,  0.0072,  0.0305,  0.0540],
        [ 0.0615,  0.0193,  0.0349,  ..., -0.0245, -0.0581, -0.0474],
        ...,
        [ 0.0532,  0.0245,  0.0719,  ...,  0.0018,  0.0149, -0.0559],
        [-0.0571, -0.0695, -0.0073,  ...,  0.0102,  0.0339,  0.0689],
        [-0.0109,  0.0361,  0.0166,  ..., -0.0458, -0.0112, -0.0542]],
       device='cuda:0', requires_grad=True)tensor([[-0.0394, -0.0449, -0.0253,  ...,  0.0694,  0.0643,  0.0657],
        [-0.0234, -0.0398, -0.0676,  ...,  0.0072,  0.0305,  0.0540],
        [ 0.0615,  0.0193,  0.0349,  ..., -0.0245, -0.0581, -0.0474],
        ...,
        [ 0.0532,  0.0245,  0.0719,  ...,  0.0018,  0.0149, -0.0559],
        [-0.0571, -0.0695, -0.0073,  ...,  0.0102,  0.0339,  0.0689],
        [-0.0109,  0.0361,  0.0166,  ..., -0.0458, -0.0112, -0.0542]],
       device='cuda:1')
  Average validation loss: 13.64
======== Epoch 74 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0394, -0.0449, -0.0253,  ...,  0.0694,  0.0643,  0.0657],
        [-0.0234, -0.0398, -0.0676,  ...,  0.0072,  0.0305,  0.0540],
        [ 0.0615,  0.0193,  0.0349,  ..., -0.0245, -0.0581, -0.0474],
        ...,
        [ 0.0532,  0.0245,  0.0719,  ...,  0.0018,  0.0149, -0.0559],
        [-0.0571, -0.0695, -0.0073,  ...,  0.0102,  0.0339,  0.0689],
        [-0.0109,  0.0361,  0.0166,  ..., -0.0458, -0.0112, -0.0542]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0394, -0.0449, -0.0253,  ...,  0.0694,  0.0643,  0.0657],
        [-0.0234, -0.0398, -0.0676,  ...,  0.0072,  0.0305,  0.0540],
        [ 0.0615,  0.0193,  0.0349,  ..., -0.0245, -0.0581, -0.0474],
        ...,
        [ 0.0532,  0.0245,  0.0719,  ...,  0.0018,  0.0149, -0.0559],
        [-0.0571, -0.0695, -0.0073,  ...,  0.0102,  0.0339,  0.0689],
        [-0.0109,  0.0361,  0.0166,  ..., -0.0458, -0.0112, -0.0542]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5320, 0.5276], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |     771 MB |     769 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     771 MB |     769 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |     771 MB |     769 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     771 MB |     769 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |     990 MB |     988 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |     990 MB |     988 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  157878    |  157497    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  157878    |  157497    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  157878    |  157497    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  157878    |  157497    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   93840    |   93834    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   93840    |   93834    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  714135 KB |  712512 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  714135 KB |  712512 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  714135 KB |  712512 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  714135 KB |  712512 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |     989 MB |     989 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |     989 MB |     989 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  152473    |  152151    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  152473    |  152151    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  152473    |  152151    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  152473    |  152151    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   95675    |   95668    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   95675    |   95668    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
  Average training loss: 0.53   0    |       0    |       0    |       0    |
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0396, -0.0451, -0.0256,  ...,  0.0697,  0.0645,  0.0659],
        [-0.0234, -0.0399, -0.0675,  ...,  0.0069,  0.0303,  0.0537],
        [ 0.0618,  0.0195,  0.0351,  ..., -0.0247, -0.0583, -0.0476],, 20])Device:  Device:0
        ...,
        [ 0.0535,  0.0247,  0.0721,  ...,  0.0016,  0.0147, -0.0561],
        [-0.0573, -0.0698, -0.0075,  ...,  0.0104,  0.0341,  0.0691],
        [-0.0107,  0.0363,  0.0168,  ..., -0.0461, -0.0114, -0.0545]],
       device='cuda:1')Parameter containing:02,  ...,  9.1852e-03,
tensor([[-0.0396, -0.0451, -0.0256,  ...,  0.0697,  0.0645,  0.0659],
        [-0.0234, -0.0399, -0.0675,  ...,  0.0069,  0.0303,  0.0537],
        [ 0.0618,  0.0195,  0.0351,  ..., -0.0247, -0.0583, -0.0476],
        ...,
        [ 0.0535,  0.0247,  0.0721,  ...,  0.0016,  0.0147, -0.0561],
        [-0.0573, -0.0698, -0.0075,  ...,  0.0104,  0.0341,  0.0691],
        [-0.0107,  0.0363,  0.0168,  ..., -0.0461, -0.0114, -0.0545]],
       device='cuda:0', requires_grad=True)
        [-2.1338e-02,  2.5534e-02,  6.0746e-03,  ..., -3.5457e-02,
  Average validation loss: 13.642]], device='cuda:0', requires_grad=True)tensor([[-2.8843e-02, -3.4350e-02, -1.4775e-02,  ...,  5.8773e-02,
          5.3592e-02,  5.4999e-02],
======== Epoch 75 / 100 ========2, -6.2306e-02,  ...,  9.1852e-03,
Training....0043e-02,  5.8586e-02],
Step: 0 [ 5.0912e-02,  8.8374e-03,  2.4377e-02,  ..., -1.3994e-02,
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1       ...,
tensor([[-0.0396, -0.0451, -0.0256,  ...,  0.0697,  0.0645,  0.0659],
        [-0.0234, -0.0399, -0.0675,  ...,  0.0069,  0.0303,  0.0537],
        [ 0.0618,  0.0195,  0.0351,  ..., -0.0247, -0.0583, -0.0476],
        ...,3460e-02,  5.8562e-02],
        [ 0.0535,  0.0247,  0.0721,  ...,  0.0016,  0.0147, -0.0561],
        [-0.0573, -0.0698, -0.0075,  ...,  0.0104,  0.0341,  0.0691],
        [-0.0107,  0.0363,  0.0168,  ..., -0.0461, -0.0114, -0.0545]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0396, -0.0451, -0.0256,  ...,  0.0697,  0.0645,  0.0659],
        [-0.0234, -0.0399, -0.0675,  ...,  0.0069,  0.0303,  0.0537],
        [ 0.0618,  0.0195,  0.0351,  ..., -0.0247, -0.0583, -0.0476],
        ...,
        [ 0.0535,  0.0247,  0.0721,  ...,  0.0016,  0.0147, -0.0561],
        [-0.0573, -0.0698, -0.0075,  ...,  0.0104,  0.0341,  0.0691],.Size([3, 20])0
        [-0.0107,  0.0363,  0.0168,  ..., -0.0461, -0.0114, -0.0545]],
       device='cuda:0', grad_fn=<BroadcastBackward>),  5.8773e-02,
          5.3592e-02,  5.4999e-02],
step loss: tensor([0.5305, 0.5262], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS02,  5.8586e-02],
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |     785 MB |     782 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     785 MB |     782 MB |e-02,  ...,  5.8773e-02,
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |     785 MB |     782 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     785 MB |     782 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |    1005 MB |    1004 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |    1005 MB |    1004 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  160443    |  160062    |
|       from large pool |       0    |       0    |       0    |       0    |)
|       from small pool |     381    |     393    |  160443    |  160062    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  160443    |  160062    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  160443    |  160062    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   95261    |   95255    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   95261    |   95255    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  727237 KB |  725614 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  727237 KB |  725614 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  727237 KB |  725614 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  727237 KB |  725614 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |    1006 MB |    1006 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |    1006 MB |    1006 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  154965    |  154643    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  154965    |  154643    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  154965    |  154643    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  154965    |  154643    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   97206    |   97199    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   97206    |   97199    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.53
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
tensor([[-0.0398, -0.0453, -0.0258,  ...,  0.0699,  0.0648,  0.0662],
        [-0.0233, -0.0401, -0.0674,  ...,  0.0067,  0.0300,  0.0535],
        [ 0.0620,  0.0197,  0.0354,  ..., -0.0249, -0.0585, -0.0479],
        ...,
        [ 0.0537,  0.0249,  0.0724,  ...,  0.0014,  0.0145, -0.0563],
        [-0.0575, -0.0700, -0.0078,  ...,  0.0106,  0.0343,  0.0694],
        [-0.0104,  0.0366,  0.0171,  ..., -0.0463, -0.0116, -0.0547]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0398, -0.0453, -0.0258,  ...,  0.0699,  0.0648,  0.0662],
        [-0.0233, -0.0401, -0.0674,  ...,  0.0067,  0.0300,  0.0535],
        [ 0.0620,  0.0197,  0.0354,  ..., -0.0249, -0.0585, -0.0479],
        ...,
        [ 0.0537,  0.0249,  0.0724,  ...,  0.0014,  0.0145, -0.0563],
        [-0.0575, -0.0700, -0.0078,  ...,  0.0106,  0.0343,  0.0694],
        [-0.0104,  0.0366,  0.0171,  ..., -0.0463, -0.0116, -0.0547]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 76 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0398, -0.0453, -0.0258,  ...,  0.0699,  0.0648,  0.0662],
        [-0.0233, -0.0401, -0.0674,  ...,  0.0067,  0.0300,  0.0535],
        [ 0.0620,  0.0197,  0.0354,  ..., -0.0249, -0.0585, -0.0479],
        ...,
        [ 0.0537,  0.0249,  0.0724,  ...,  0.0014,  0.0145, -0.0563],
        [-0.0575, -0.0700, -0.0078,  ...,  0.0106,  0.0343,  0.0694],
        [-0.0104,  0.0366,  0.0171,  ..., -0.0463, -0.0116, -0.0547]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0398, -0.0453, -0.0258,  ...,  0.0699,  0.0648,  0.0662],
        [-0.0233, -0.0401, -0.0674,  ...,  0.0067,  0.0300,  0.0535],
        [ 0.0620,  0.0197,  0.0354,  ..., -0.0249, -0.0585, -0.0479],
        ...,
        [ 0.0537,  0.0249,  0.0724,  ...,  0.0014,  0.0145, -0.0563],
        [-0.0575, -0.0700, -0.0078,  ...,  0.0106,  0.0343,  0.0694],
        [-0.0104,  0.0366,  0.0171,  ..., -0.0463, -0.0116, -0.0547]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5291, 0.5248], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |     799 MB |     796 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     799 MB |     796 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |     799 MB |     796 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     799 MB |     796 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |    1021 MB |    1020 MB |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  740338 KB |  738715 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  740338 KB |  738715 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  740338 KB |  738715 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  740338 KB |  738715 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |    1023 MB |    1022 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |    1023 MB |    1022 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  157457    |  157135    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  157457    |  157135    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  157457    |  157135    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  157457    |  157135    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |   98737    |   98730    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |   98737    |   98730    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.53
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0400, -0.0456, -0.0260,  ...,  0.0702,  0.0650,  0.0664],
        [-0.0233, -0.0402, -0.0673,  ...,  0.0064,  0.0298,  0.0532],
        [ 0.0623,  0.0200,  0.0356,  ..., -0.0252, -0.0588, -0.0481],
        ...,
        [ 0.0539,  0.0251,  0.0726,  ...,  0.0012,  0.0142, -0.0565],
        [-0.0577, -0.0702, -0.0080,  ...,  0.0108,  0.0345,  0.0696],
        [-0.0102,  0.0368,  0.0173,  ..., -0.0465, -0.0119, -0.0549]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0400, -0.0456, -0.0260,  ...,  0.0702,  0.0650,  0.0664],
        [-0.0233, -0.0402, -0.0673,  ...,  0.0064,  0.0298,  0.0532],
        [ 0.0623,  0.0200,  0.0356,  ..., -0.0252, -0.0588, -0.0481],
        ...,
        [ 0.0539,  0.0251,  0.0726,  ...,  0.0012,  0.0142, -0.0565],
        [-0.0577, -0.0702, -0.0080,  ...,  0.0108,  0.0345,  0.0696],
        [-0.0102,  0.0368,  0.0173,  ..., -0.0465, -0.0119, -0.0549]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 77 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0400, -0.0456, -0.0260,  ...,  0.0702,  0.0650,  0.0664],
        [-0.0233, -0.0402, -0.0673,  ...,  0.0064,  0.0298,  0.0532],
        [ 0.0623,  0.0200,  0.0356,  ..., -0.0252, -0.0588, -0.0481],
        ...,
        [ 0.0539,  0.0251,  0.0726,  ...,  0.0012,  0.0142, -0.0565],
        [-0.0577, -0.0702, -0.0080,  ...,  0.0108,  0.0345,  0.0696],
        [-0.0102,  0.0368,  0.0173,  ..., -0.0465, -0.0119, -0.0549]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0400, -0.0456, -0.0260,  ...,  0.0702,  0.0650,  0.0664],
        [-0.0233, -0.0402, -0.0673,  ...,  0.0064,  0.0298,  0.0532],
        [ 0.0623,  0.0200,  0.0356,  ..., -0.0252, -0.0588, -0.0481],
        ...,
        [ 0.0539,  0.0251,  0.0726,  ...,  0.0012,  0.0142, -0.0565],
        [-0.0577, -0.0702, -0.0080,  ...,  0.0108,  0.0345,  0.0696],
        [-0.0102,  0.0368,  0.0173,  ..., -0.0465, -0.0119, -0.0549]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5277, 0.5235], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |     813 MB |     810 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     813 MB |     810 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |     813 MB |     810 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     813 MB |     810 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |    1037 MB |    1036 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |    1037 MB |    1036 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  165573    |  165192    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  165573    |  165192    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  165573    |  165192    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  165573    |  165192    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   98116    |   98110    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   98116    |   98110    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  753440 KB |  751817 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  753440 KB |  751817 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  753440 KB |  751817 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  753440 KB |  751817 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |    1040 MB |    1039 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |    1040 MB |    1039 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  159949    |  159627    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  159949    |  159627    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  159949    |  159627    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  159949    |  159627    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  100268    |  100261    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  100268    |  100261    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.53
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-0.0403, -0.0458, -0.0263,  ...,  0.0704,  0.0652,  0.0666],
        [-0.0232, -0.0403, -0.0673,  ...,  0.0062,  0.0295,  0.0530],
        [ 0.0625,  0.0202,  0.0358,  ..., -0.0254, -0.0590, -0.0483],
        ...,
        [ 0.0541,  0.0253,  0.0728,  ...,  0.0010,  0.0140, -0.0567],
        [-0.0579, -0.0704, -0.0082,  ...,  0.0110,  0.0348,  0.0698],
        [-0.0100,  0.0370,  0.0175,  ..., -0.0467, -0.0121, -0.0551]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0403, -0.0458, -0.0263,  ...,  0.0704,  0.0652,  0.0666],
        [-0.0232, -0.0403, -0.0673,  ...,  0.0062,  0.0295,  0.0530],
        [ 0.0625,  0.0202,  0.0358,  ..., -0.0254, -0.0590, -0.0483],
        ...,
        [ 0.0541,  0.0253,  0.0728,  ...,  0.0010,  0.0140, -0.0567],
        [-0.0579, -0.0704, -0.0082,  ...,  0.0110,  0.0348,  0.0698],
        [-0.0100,  0.0370,  0.0175,  ..., -0.0467, -0.0121, -0.0551]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 78 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0batch input size:
 torch.Size([3, 20]) Device: 1
tensor([[-0.0403, -0.0458, -0.0263,  ...,  0.0704,  0.0652,  0.0666],
        [-0.0232, -0.0403, -0.0673,  ...,  0.0062,  0.0295,  0.0530],
        [ 0.0625,  0.0202,  0.0358,  ..., -0.0254, -0.0590, -0.0483],
        ...,
        [ 0.0541,  0.0253,  0.0728,  ...,  0.0010,  0.0140, -0.0567],
        [-0.0579, -0.0704, -0.0082,  ...,  0.0110,  0.0348,  0.0698],
        [-0.0100,  0.0370,  0.0175,  ..., -0.0467, -0.0121, -0.0551]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0403, -0.0458, -0.0263,  ...,  0.0704,  0.0652,  0.0666],
        [-0.0232, -0.0403, -0.0673,  ...,  0.0062,  0.0295,  0.0530],
        [ 0.0625,  0.0202,  0.0358,  ..., -0.0254, -0.0590, -0.0483],
        ...,
        [ 0.0541,  0.0253,  0.0728,  ...,  0.0010,  0.0140, -0.0567],
        [-0.0579, -0.0704, -0.0082,  ...,  0.0110,  0.0348,  0.0698],
        [-0.0100,  0.0370,  0.0175,  ..., -0.0467, -0.0121, -0.0551]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5263, 0.5223], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |     826 MB |     824 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     826 MB |     824 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |     826 MB |     824 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     826 MB |     824 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |    1053 MB |    1051 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |    1053 MB |    1051 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  168138    |  167757    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  168138    |  167757    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  168138    |  167757    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  168138    |  167757    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   99539    |   99533    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   99539    |   99533    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  766541 KB |  764918 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  766541 KB |  764918 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  766541 KB |  764918 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  766541 KB |  764918 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |    1056 MB |    1056 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |    1056 MB |    1056 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  162441    |  162119    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  162441    |  162119    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  162441    |  162119    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  162441    |  162119    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  101799    |  101792    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  101799    |  101792    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0405, -0.0460, -0.0265,  ...,  0.0706,  0.0654,  0.0668],
        [-0.0232, -0.0405, -0.0672,  ...,  0.0060,  0.0293,  0.0528],
        [ 0.0627,  0.0204,  0.0360,  ..., -0.0256, -0.0592, -0.0485],
        ...,
        [ 0.0543,  0.0255,  0.0730,  ...,  0.0008,  0.0138, -0.0569],
        [-0.0581, -0.0706, -0.0084,  ...,  0.0112,  0.0350,  0.0699],
        [-0.0098,  0.0372,  0.0177,  ..., -0.0469, -0.0123, -0.0553]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0405, -0.0460, -0.0265,  ...,  0.0706,  0.0654,  0.0668],
        [-0.0232, -0.0405, -0.0672,  ...,  0.0060,  0.0293,  0.0528],
        [ 0.0627,  0.0204,  0.0360,  ..., -0.0256, -0.0592, -0.0485],
        ...,
        [ 0.0543,  0.0255,  0.0730,  ...,  0.0008,  0.0138, -0.0569],
        [-0.0581, -0.0706, -0.0084,  ...,  0.0112,  0.0350,  0.0699],
        [-0.0098,  0.0372,  0.0177,  ..., -0.0469, -0.0123, -0.0553]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 79 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0 1
tensor([[-0.0405, -0.0460, -0.0265,  ...,  0.0706,  0.0654,  0.0668],
        [-0.0232, -0.0405, -0.0672,  ...,  0.0060,  0.0293,  0.0528],
        [ 0.0627,  0.0204,  0.0360,  ..., -0.0256, -0.0592, -0.0485],
        ...,
        [ 0.0543,  0.0255,  0.0730,  ...,  0.0008,  0.0138, -0.0569],
        [-0.0581, -0.0706, -0.0084,  ...,  0.0112,  0.0350,  0.0699],
        [-0.0098,  0.0372,  0.0177,  ..., -0.0469, -0.0123, -0.0553]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0405, -0.0460, -0.0265,  ...,  0.0706,  0.0654,  0.0668],
        [-0.0232, -0.0405, -0.0672,  ...,  0.0060,  0.0293,  0.0528],
        [ 0.0627,  0.0204,  0.0360,  ..., -0.0256, -0.0592, -0.0485],
        ...,
        [ 0.0543,  0.0255,  0.0730,  ...,  0.0008,  0.0138, -0.0569],
        [-0.0581, -0.0706, -0.0084,  ...,  0.0112,  0.0350,  0.0699],
        [-0.0098,  0.0372,  0.0177,  ..., -0.0469, -0.0123, -0.0553]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5250, 0.5210], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2763 KB |    2973 KB |     840 MB |     837 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     840 MB |     837 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2763 KB |    2973 KB |     840 MB |     837 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2763 KB |    2973 KB |     840 MB |     837 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1333 KB |    2749 KB |    1069 MB |    1067 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |    1069 MB |    1067 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  170703    |  170322    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  170703    |  170322    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  170703    |  170322    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  170703    |  170322    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  100968    |  100962    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  100968    |  100962    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1623 KB |    1782 KB |  779643 KB |  778020 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  779643 KB |  778020 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1623 KB |    1782 KB |  779643 KB |  778020 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1623 KB |    1782 KB |  779643 KB |  778020 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  435200 B  |    2047 KB |    1073 MB |    1073 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  435200 B  |    2047 KB |    1073 MB |    1073 MB |
|---------------------------------------------------------------------------|
| Allocations           |     322    |     335    |  164933    |  164611    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  164933    |  164611    |
|---------------------------------------------------------------------------|
| Active allocs         |     322    |     335    |  164933    |  164611    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     322    |     335    |  164933    |  164611    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  103330    |  103323    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  103330    |  103323    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0407, -0.0462, -0.0267,  ...,  0.0708,  0.0656,  0.0670],
        [-0.0231, -0.0406, -0.0671,  ...,  0.0058,  0.0291,  0.0526],
        [ 0.0629,  0.0206,  0.0362,  ..., -0.0258, -0.0594, -0.0487],
        ...,
        [ 0.0545,  0.0257,  0.0732,  ...,  0.0006,  0.0136, -0.0571],
        [-0.0583, -0.0708, -0.0086,  ...,  0.0114,  0.0351,  0.0701],
        [-0.0096,  0.0374,  0.0179,  ..., -0.0471, -0.0125, -0.0555]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0407, -0.0462, -0.0267,  ...,  0.0708,  0.0656,  0.0670],
        [-0.0231, -0.0406, -0.0671,  ...,  0.0058,  0.0291,  0.0526],
        [ 0.0629,  0.0206,  0.0362,  ..., -0.0258, -0.0594, -0.0487],
        ...,
        [ 0.0545,  0.0257,  0.0732,  ...,  0.0006,  0.0136, -0.0571],
        [-0.0583, -0.0708, -0.0086,  ...,  0.0114,  0.0351,  0.0701],
        [-0.0096,  0.0374,  0.0179,  ..., -0.0471, -0.0125, -0.0555]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 80 / 100 ========
Training...
Step: 0
batch input size:batch input size: torch.Size([3, 20])  torch.Size([4, 20])Device:  Device:1
0
tensor([[-0.0407, -0.0462, -0.0267,  ...,  0.0708,  0.0656,  0.0670],
        [-0.0231, -0.0406, -0.0671,  ...,  0.0058,  0.0291,  0.0526],
        [ 0.0629,  0.0206,  0.0362,  ..., -0.0258, -0.0594, -0.0487],
        ...,
        [ 0.0545,  0.0257,  0.0732,  ...,  0.0006,  0.0136, -0.0571],
        [-0.0583, -0.0708, -0.0086,  ...,  0.0114,  0.0351,  0.0701],
        [-0.0096,  0.0374,  0.0179,  ..., -0.0471, -0.0125, -0.0555]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0407, -0.0462, -0.0267,  ...,  0.0708,  0.0656,  0.0670],
        [-0.0231, -0.0406, -0.0671,  ...,  0.0058,  0.0291,  0.0526],
        [ 0.0629,  0.0206,  0.0362,  ..., -0.0258, -0.0594, -0.0487],
        ...,
        [ 0.0545,  0.0257,  0.0732,  ...,  0.0006,  0.0136, -0.0571],
        [-0.0583, -0.0708, -0.0086,  ...,  0.0114,  0.0351,  0.0701],
        [-0.0096,  0.0374,  0.0179,  ..., -0.0471, -0.0125, -0.0555]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5238, 0.5198], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     854 MB |     851 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     854 MB |     851 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     854 MB |     851 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     854 MB |     851 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1084 MB |    1083 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1084 MB |    1083 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  173288    |  172887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  173288    |  172887    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  173288    |  172887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  173288    |  172887    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  102393    |  102387    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  102393    |  102387    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     774 MB |     772 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     774 MB |     772 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     774 MB |     772 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     774 MB |     772 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1090 MB |    1090 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1090 MB |    1090 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  167445    |  167103    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  167445    |  167103    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  167445    |  167103    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  167445    |  167103    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  104861    |  104854    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  104861    |  104854    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0408, -0.0464, -0.0269,  ...,  0.0710,  0.0658,  0.0672],
        [-0.0230, -0.0407, -0.0669,  ...,  0.0056,  0.0289,  0.0524],
        [ 0.0631,  0.0207,  0.0364,  ..., -0.0260, -0.0595, -0.0489],
        ...,
        [ 0.0547,  0.0258,  0.0734,  ...,  0.0004,  0.0135, -0.0572],
        [-0.0585, -0.0710, -0.0088,  ...,  0.0115,  0.0353,  0.0703],
        [-0.0094,  0.0376,  0.0181,  ..., -0.0473, -0.0127, -0.0557]],
       device='cuda:0', requires_grad=True)tensor([[-0.0408, -0.0464, -0.0269,  ...,  0.0710,  0.0658,  0.0672],
        [-0.0230, -0.0407, -0.0669,  ...,  0.0056,  0.0289,  0.0524],
        [ 0.0631,  0.0207,  0.0364,  ..., -0.0260, -0.0595, -0.0489],
        ...,
        [ 0.0547,  0.0258,  0.0734,  ...,  0.0004,  0.0135, -0.0572],
        [-0.0585, -0.0710, -0.0088,  ...,  0.0115,  0.0353,  0.0703],
        [-0.0094,  0.0376,  0.0181,  ..., -0.0473, -0.0127, -0.0557]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 81 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0408, -0.0464, -0.0269,  ...,  0.0710,  0.0658,  0.0672],
        [-0.0230, -0.0407, -0.0669,  ...,  0.0056,  0.0289,  0.0524],
        [ 0.0631,  0.0207,  0.0364,  ..., -0.0260, -0.0595, -0.0489],
        ...,
        [ 0.0547,  0.0258,  0.0734,  ...,  0.0004,  0.0135, -0.0572],
        [-0.0585, -0.0710, -0.0088,  ...,  0.0115,  0.0353,  0.0703],
        [-0.0094,  0.0376,  0.0181,  ..., -0.0473, -0.0127, -0.0557]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0408, -0.0464, -0.0269,  ...,  0.0710,  0.0658,  0.0672],
        [-0.0230, -0.0407, -0.0669,  ...,  0.0056,  0.0289,  0.0524],
        [ 0.0631,  0.0207,  0.0364,  ..., -0.0260, -0.0595, -0.0489],
        ...,
        [ 0.0547,  0.0258,  0.0734,  ...,  0.0004,  0.0135, -0.0572],
        [-0.0585, -0.0710, -0.0088,  ...,  0.0115,  0.0353,  0.0703],
        [-0.0094,  0.0376,  0.0181,  ..., -0.0473, -0.0127, -0.0557]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5226, 0.5187], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     869 MB |     866 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     869 MB |     866 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     869 MB |     866 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     869 MB |     866 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1101 MB |    1100 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1101 MB |    1100 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  175963    |  175562    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  175963    |  175562    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  175963    |  175562    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  175963    |  175562    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  103857    |  103851    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  103857    |  103851    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     787 MB |     786 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     787 MB |     786 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     787 MB |     786 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     787 MB |     786 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1108 MB |    1107 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1108 MB |    1107 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  170047    |  169705    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  170047    |  169705    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  170047    |  169705    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  170047    |  169705    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  106452    |  106445    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  106452    |  106445    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-0.0410, -0.0465, -0.0270,  ...,  0.0712,  0.0660,  0.0674],
        [-0.0229, -0.0408, -0.0668,  ...,  0.0054,  0.0287,  0.0522],
        [ 0.0633,  0.0209,  0.0366,  ..., -0.0261, -0.0597, -0.0490],
        ...,
        [ 0.0549,  0.0260,  0.0736,  ...,  0.0002,  0.0133, -0.0574],
        [-0.0587, -0.0711, -0.0090,  ...,  0.0117,  0.0355,  0.0704],
        [-0.0092,  0.0378,  0.0183,  ..., -0.0475, -0.0128, -0.0558]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0410, -0.0465, -0.0270,  ...,  0.0712,  0.0660,  0.0674],
        [-0.0229, -0.0408, -0.0668,  ...,  0.0054,  0.0287,  0.0522],
        [ 0.0633,  0.0209,  0.0366,  ..., -0.0261, -0.0597, -0.0490],
        ...,
        [ 0.0549,  0.0260,  0.0736,  ...,  0.0002,  0.0133, -0.0574],
        [-0.0587, -0.0711, -0.0090,  ...,  0.0117,  0.0355,  0.0704],
        [-0.0092,  0.0378,  0.0183,  ..., -0.0475, -0.0128, -0.0558]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 82 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0
tensor([[-0.0410, -0.0465, -0.0270,  ...,  0.0712,  0.0660,  0.0674],
        [-0.0229, -0.0408, -0.0668,  ...,  0.0054,  0.0287,  0.0522],
        [ 0.0633,  0.0209,  0.0366,  ..., -0.0261, -0.0597, -0.0490],
        ...,
        [ 0.0549,  0.0260,  0.0736,  ...,  0.0002,  0.0133, -0.0574],
        [-0.0587, -0.0711, -0.0090,  ...,  0.0117,  0.0355,  0.0704],
        [-0.0092,  0.0378,  0.0183,  ..., -0.0475, -0.0128, -0.0558]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
batch input size: torch.Size([3, 20]) Device: 1
tensor([[-0.0410, -0.0465, -0.0270,  ...,  0.0712,  0.0660,  0.0674],
        [-0.0229, -0.0408, -0.0668,  ...,  0.0054,  0.0287,  0.0522],
        [ 0.0633,  0.0209,  0.0366,  ..., -0.0261, -0.0597, -0.0490],
        ...,
        [ 0.0549,  0.0260,  0.0736,  ...,  0.0002,  0.0133, -0.0574],
        [-0.0587, -0.0711, -0.0090,  ...,  0.0117,  0.0355,  0.0704],
        [-0.0092,  0.0378,  0.0183,  ..., -0.0475, -0.0128, -0.0558]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5215, 0.5177], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     883 MB |     881 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     883 MB |     881 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     883 MB |     881 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     883 MB |     881 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1118 MB |    1116 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1118 MB |    1116 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  178638    |  178237    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  178638    |  178237    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  178638    |  178237    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  178638    |  178237    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  105324    |  105318    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  105324    |  105318    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     801 MB |     799 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     801 MB |     799 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     801 MB |     799 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     801 MB |     799 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1125 MB |    1125 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1125 MB |    1125 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  172649    |  172307    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  172649    |  172307    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  172649    |  172307    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  172649    |  172307    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  108043    |  108036    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  108043    |  108036    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-4.1189e-02, -4.6695e-02, -2.7204e-02,  ...,  7.1351e-02,
          6.6214e-02,  6.7575e-02],
        [-2.2774e-02, -4.0878e-02, -6.6726e-02,  ...,  5.1867e-03,
          2.8527e-02,  5.1975e-02],
        [ 6.3451e-02,  2.1089e-02,  3.6764e-02,  ..., -2.6302e-02,
         -5.9862e-02, -4.9204e-02],
        ...,
        [ 5.5079e-02,  2.6153e-02,  7.3730e-02,  ...,  3.3643e-05,
          1.3123e-02, -5.7558e-02],
        [-5.8817e-02, -7.1295e-02, -9.1485e-03,  ...,  1.1805e-02,
          3.5657e-02,  7.0584e-02],
        [-9.0598e-03,  3.7980e-02,  1.8449e-02,  ..., -4.7629e-02,
         -1.3008e-02, -5.5995e-02]], device='cuda:0', requires_grad=True)
tensor([[-4.1189e-02, -4.6695e-02, -2.7204e-02,  ...,  7.1351e-02,
          6.6214e-02,  6.7575e-02],
        [-2.2774e-02, -4.0878e-02, -6.6726e-02,  ...,  5.1867e-03,
          2.8527e-02,  5.1975e-02],
        [ 6.3451e-02,  2.1089e-02,  3.6764e-02,  ..., -2.6302e-02,
         -5.9862e-02, -4.9204e-02],
        ...,
        [ 5.5079e-02,  2.6153e-02,  7.3730e-02,  ...,  3.3643e-05,
          1.3123e-02, -5.7558e-02],
        [-5.8817e-02, -7.1295e-02, -9.1485e-03,  ...,  1.1805e-02,
          3.5657e-02,  7.0584e-02],
        [-9.0598e-03,  3.7980e-02,  1.8449e-02,  ..., -4.7629e-02,
         -1.3008e-02, -5.5995e-02]], device='cuda:1')
  Average validation loss: 13.65
======== Epoch 83 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-4.1189e-02, -4.6695e-02, -2.7204e-02,  ...,  7.1351e-02,
          6.6214e-02,  6.7575e-02],
        [-2.2774e-02, -4.0878e-02, -6.6726e-02,  ...,  5.1867e-03,
          2.8527e-02,  5.1975e-02],
        [ 6.3451e-02,  2.1089e-02,  3.6764e-02,  ..., -2.6302e-02,
         -5.9862e-02, -4.9204e-02],
        ...,
        [ 5.5079e-02,  2.6153e-02,  7.3730e-02,  ...,  3.3643e-05,
          1.3123e-02, -5.7558e-02],
        [-5.8817e-02, -7.1295e-02, -9.1485e-03,  ...,  1.1805e-02,
          3.5657e-02,  7.0584e-02],
        [-9.0598e-03,  3.7980e-02,  1.8449e-02,  ..., -4.7629e-02,
         -1.3008e-02, -5.5995e-02]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[-4.1189e-02, -4.6695e-02, -2.7204e-02,  ...,  7.1351e-02,
          6.6214e-02,  6.7575e-02],
        [-2.2774e-02, -4.0878e-02, -6.6726e-02,  ...,  5.1867e-03,
          2.8527e-02,  5.1975e-02],
        [ 6.3451e-02,  2.1089e-02,  3.6764e-02,  ..., -2.6302e-02,
         -5.9862e-02, -4.9204e-02],
        ...,
        [ 5.5079e-02,  2.6153e-02,  7.3730e-02,  ...,  3.3643e-05,
          1.3123e-02, -5.7558e-02],
        [-5.8817e-02, -7.1295e-02, -9.1485e-03,  ...,  1.1805e-02,
          3.5657e-02,  7.0584e-02],
        [-9.0598e-03,  3.7980e-02,  1.8449e-02,  ..., -4.7629e-02,
         -1.3008e-02, -5.5995e-02]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.5204, 0.5167], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     898 MB |     895 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     898 MB |     895 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     898 MB |     895 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     898 MB |     895 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1134 MB |    1133 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1134 MB |    1133 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  181309    |  180908    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  181309    |  180908    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  181309    |  180908    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  181309    |  180908    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  106791    |  106785    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  106791    |  106785    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     815 MB |     813 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     815 MB |     813 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     815 MB |     813 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     815 MB |     813 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1143 MB |    1143 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1143 MB |    1143 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  175247    |  174905    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  175247    |  174905    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  175247    |  174905    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  175247    |  174905    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  109634    |  109627    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  109634    |  109627    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  10
Parameter containing:
tensor([[-0.0413, -0.0469, -0.0274,  ...,  0.0715,  0.0664,  0.0677],
        [-0.0227, -0.0410, -0.0666,  ...,  0.0050,  0.0283,  0.0518],
        [ 0.0636,  0.0212,  0.0369,  ..., -0.0265, -0.0600, -0.0494],
        ...,
        [ 0.0552,  0.0263,  0.0739,  ..., -0.0001,  0.0130, -0.0577],
        [-0.0590, -0.0714, -0.0093,  ...,  0.0119,  0.0358,  0.0707],
        [-0.0089,  0.0381,  0.0186,  ..., -0.0478, -0.0132, -0.0561]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0413, -0.0469, -0.0274,  ...,  0.0715,  0.0664,  0.0677],
        [-0.0227, -0.0410, -0.0666,  ...,  0.0050,  0.0283,  0.0518],
        [ 0.0636,  0.0212,  0.0369,  ..., -0.0265, -0.0600, -0.0494],
        ...,
        [ 0.0552,  0.0263,  0.0739,  ..., -0.0001,  0.0130, -0.0577],
        [-0.0590, -0.0714, -0.0093,  ...,  0.0119,  0.0358,  0.0707],
        [-0.0089,  0.0381,  0.0186,  ..., -0.0478, -0.0132, -0.0561]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 84 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0413, -0.0469, -0.0274,  ...,  0.0715,  0.0664,  0.0677],
        [-0.0227, -0.0410, -0.0666,  ...,  0.0050,  0.0283,  0.0518],
        [ 0.0636,  0.0212,  0.0369,  ..., -0.0265, -0.0600, -0.0494],
        ...,
        [ 0.0552,  0.0263,  0.0739,  ..., -0.0001,  0.0130, -0.0577],
        [-0.0590, -0.0714, -0.0093,  ...,  0.0119,  0.0358,  0.0707],
        [-0.0089,  0.0381,  0.0186,  ..., -0.0478, -0.0132, -0.0561]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0413, -0.0469, -0.0274,  ...,  0.0715,  0.0664,  0.0677],
        [-0.0227, -0.0410, -0.0666,  ...,  0.0050,  0.0283,  0.0518],
        [ 0.0636,  0.0212,  0.0369,  ..., -0.0265, -0.0600, -0.0494],
        ...,
        [ 0.0552,  0.0263,  0.0739,  ..., -0.0001,  0.0130, -0.0577],
        [-0.0590, -0.0714, -0.0093,  ...,  0.0119,  0.0358,  0.0707],
        [-0.0089,  0.0381,  0.0186,  ..., -0.0478, -0.0132, -0.0561]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5194, 0.5157], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     913 MB |     910 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     913 MB |     910 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     913 MB |     910 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     913 MB |     910 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1151 MB |    1150 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1151 MB |    1150 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  183984    |  183583    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  183984    |  183583    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  183984    |  183583    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  183984    |  183583    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  108252    |  108246    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  108252    |  108246    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     828 MB |     827 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     828 MB |     827 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     828 MB |     827 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     828 MB |     827 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1161 MB |    1160 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1161 MB |    1160 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  177849    |  177507    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  177849    |  177507    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  177849    |  177507    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  177849    |  177507    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  111225    |  111218    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  111225    |  111218    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0415, -0.0470, -0.0275,  ...,  0.0717,  0.0665,  0.0679],
        [-0.0226, -0.0410, -0.0665,  ...,  0.0048,  0.0282,  0.0516],
        [ 0.0638,  0.0214,  0.0371,  ..., -0.0266, -0.0602, -0.0495],
        ...,
        [ 0.0554,  0.0264,  0.0740,  ..., -0.0003,  0.0128, -0.0578],
        [-0.0591, -0.0716, -0.0095,  ...,  0.0121,  0.0360,  0.0708],
        [-0.0088,  0.0383,  0.0188,  ..., -0.0479, -0.0133, -0.0563]],
       device='cuda:0', requires_grad=True)tensor([[-0.0415, -0.0470, -0.0275,  ...,  0.0717,  0.0665,  0.0679],
        [-0.0226, -0.0410, -0.0665,  ...,  0.0048,  0.0282,  0.0516],
        [ 0.0638,  0.0214,  0.0371,  ..., -0.0266, -0.0602, -0.0495],
        ...,
        [ 0.0554,  0.0264,  0.0740,  ..., -0.0003,  0.0128, -0.0578],
        [-0.0591, -0.0716, -0.0095,  ...,  0.0121,  0.0360,  0.0708],
        [-0.0088,  0.0383,  0.0188,  ..., -0.0479, -0.0133, -0.0563]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 85 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0415, -0.0470, -0.0275,  ...,  0.0717,  0.0665,  0.0679],
        [-0.0226, -0.0410, -0.0665,  ...,  0.0048,  0.0282,  0.0516],
        [ 0.0638,  0.0214,  0.0371,  ..., -0.0266, -0.0602, -0.0495],
        ...,
        [ 0.0554,  0.0264,  0.0740,  ..., -0.0003,  0.0128, -0.0578],
        [-0.0591, -0.0716, -0.0095,  ...,  0.0121,  0.0360,  0.0708],
        [-0.0088,  0.0383,  0.0188,  ..., -0.0479, -0.0133, -0.0563]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0415, -0.0470, -0.0275,  ...,  0.0717,  0.0665,  0.0679],
        [-0.0226, -0.0410, -0.0665,  ...,  0.0048,  0.0282,  0.0516],
        [ 0.0638,  0.0214,  0.0371,  ..., -0.0266, -0.0602, -0.0495],
        ...,
        [ 0.0554,  0.0264,  0.0740,  ..., -0.0003,  0.0128, -0.0578],
        [-0.0591, -0.0716, -0.0095,  ...,  0.0121,  0.0360,  0.0708],
        [-0.0088,  0.0383,  0.0188,  ..., -0.0479, -0.0133, -0.0563]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5184, 0.5148], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     927 MB |     925 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     927 MB |     925 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     927 MB |     925 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     927 MB |     925 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1168 MB |    1166 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1168 MB |    1166 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  186659    |  186258    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  186659    |  186258    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  186659    |  186258    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  186659    |  186258    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  109721    |  109715    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  109721    |  109715    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     842 MB |     840 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     842 MB |     840 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     842 MB |     840 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     842 MB |     840 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1178 MB |    1178 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1178 MB |    1178 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  180451    |  180109    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  180451    |  180109    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  180451    |  180109    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  180451    |  180109    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  112816    |  112809    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  112816    |  112809    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0416, -0.0471, -0.0277,  ...,  0.0718,  0.0667,  0.0680],
        [-0.0225, -0.0411, -0.0664,  ...,  0.0047,  0.0280,  0.0515],
        [ 0.0639,  0.0215,  0.0372,  ..., -0.0268, -0.0603, -0.0496],
        ...,
        [ 0.0555,  0.0266,  0.0742,  ..., -0.0004,  0.0127, -0.0580],
        [-0.0592, -0.0717, -0.0096,  ...,  0.0122,  0.0361,  0.0709],
        [-0.0086,  0.0384,  0.0189,  ..., -0.0481, -0.0135, -0.0564]],
       device='cuda:0', requires_grad=True)tensor([[-0.0416, -0.0471, -0.0277,  ...,  0.0718,  0.0667,  0.0680],
        [-0.0225, -0.0411, -0.0664,  ...,  0.0047,  0.0280,  0.0515],
        [ 0.0639,  0.0215,  0.0372,  ..., -0.0268, -0.0603, -0.0496],
        ...,
        [ 0.0555,  0.0266,  0.0742,  ..., -0.0004,  0.0127, -0.0580],
        [-0.0592, -0.0717, -0.0096,  ...,  0.0122,  0.0361,  0.0709],
        [-0.0086,  0.0384,  0.0189,  ..., -0.0481, -0.0135, -0.0564]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 86 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) Device: 0
batch input size: torch.Size([3, 20]) Device: 1
tensor([[-0.0416, -0.0471, -0.0277,  ...,  0.0718,  0.0667,  0.0680],
        [-0.0225, -0.0411, -0.0664,  ...,  0.0047,  0.0280,  0.0515],
        [ 0.0639,  0.0215,  0.0372,  ..., -0.0268, -0.0603, -0.0496],
        ...,
        [ 0.0555,  0.0266,  0.0742,  ..., -0.0004,  0.0127, -0.0580],
        [-0.0592, -0.0717, -0.0096,  ...,  0.0122,  0.0361,  0.0709],
        [-0.0086,  0.0384,  0.0189,  ..., -0.0481, -0.0135, -0.0564]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0416, -0.0471, -0.0277,  ...,  0.0718,  0.0667,  0.0680],
        [-0.0225, -0.0411, -0.0664,  ...,  0.0047,  0.0280,  0.0515],
        [ 0.0639,  0.0215,  0.0372,  ..., -0.0268, -0.0603, -0.0496],
        ...,
        [ 0.0555,  0.0266,  0.0742,  ..., -0.0004,  0.0127, -0.0580],
        [-0.0592, -0.0717, -0.0096,  ...,  0.0122,  0.0361,  0.0709],
        [-0.0086,  0.0384,  0.0189,  ..., -0.0481, -0.0135, -0.0564]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5175, 0.5140], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     942 MB |     939 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     942 MB |     939 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     942 MB |     939 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     942 MB |     939 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1184 MB |    1183 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1184 MB |    1183 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  189334    |  188933    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  189334    |  188933    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  189334    |  188933    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  189334    |  188933    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  111189    |  111183    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  111189    |  111183    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     856 MB |     854 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     856 MB |     854 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     856 MB |     854 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     856 MB |     854 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1196 MB |    1196 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1196 MB |    1196 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  183053    |  182711    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  183053    |  182711    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  183053    |  182711    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  183053    |  182711    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  114407    |  114400    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  114407    |  114400    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.52
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0418, -0.0473, -0.0278,  ...,  0.0720,  0.0668,  0.0682],
        [-0.0224, -0.0412, -0.0663,  ...,  0.0045,  0.0279,  0.0513],
        [ 0.0641,  0.0217,  0.0374,  ..., -0.0269, -0.0604, -0.0498],
        ...,
        [ 0.0557,  0.0267,  0.0743,  ..., -0.0005,  0.0125, -0.0581],
        [-0.0594, -0.0718, -0.0097,  ...,  0.0123,  0.0362,  0.0710],
        [-0.0085,  0.0386,  0.0190,  ..., -0.0482, -0.0136, -0.0565]],
       device='cuda:0', requires_grad=True)tensor([[-0.0418, -0.0473, -0.0278,  ...,  0.0720,  0.0668,  0.0682],
        [-0.0224, -0.0412, -0.0663,  ...,  0.0045,  0.0279,  0.0513],
        [ 0.0641,  0.0217,  0.0374,  ..., -0.0269, -0.0604, -0.0498],
        ...,
        [ 0.0557,  0.0267,  0.0743,  ..., -0.0005,  0.0125, -0.0581],
        [-0.0594, -0.0718, -0.0097,  ...,  0.0123,  0.0362,  0.0710],
        [-0.0085,  0.0386,  0.0190,  ..., -0.0482, -0.0136, -0.0565]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 87 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0418, -0.0473, -0.0278,  ...,  0.0720,  0.0668,  0.0682],
        [-0.0224, -0.0412, -0.0663,  ...,  0.0045,  0.0279,  0.0513],
        [ 0.0641,  0.0217,  0.0374,  ..., -0.0269, -0.0604, -0.0498],
        ...,
        [ 0.0557,  0.0267,  0.0743,  ..., -0.0005,  0.0125, -0.0581],
        [-0.0594, -0.0718, -0.0097,  ...,  0.0123,  0.0362,  0.0710],
        [-0.0085,  0.0386,  0.0190,  ..., -0.0482, -0.0136, -0.0565]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0418, -0.0473, -0.0278,  ...,  0.0720,  0.0668,  0.0682],
        [-0.0224, -0.0412, -0.0663,  ...,  0.0045,  0.0279,  0.0513],
        [ 0.0641,  0.0217,  0.0374,  ..., -0.0269, -0.0604, -0.0498],
        ...,
        [ 0.0557,  0.0267,  0.0743,  ..., -0.0005,  0.0125, -0.0581],
        [-0.0594, -0.0718, -0.0097,  ...,  0.0123,  0.0362,  0.0710],
        [-0.0085,  0.0386,  0.0190,  ..., -0.0482, -0.0136, -0.0565]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5167, 0.5132], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     957 MB |     954 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     957 MB |     954 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     957 MB |     954 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     957 MB |     954 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1201 MB |    1200 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1201 MB |    1200 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  192009    |  191608    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  192009    |  191608    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  192009    |  191608    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  192009    |  191608    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  112648    |  112642    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  112648    |  112642    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     869 MB |     868 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     869 MB |     868 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     869 MB |     868 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     869 MB |     868 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1214 MB |    1213 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1214 MB |    1213 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  185655    |  185313    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  185655    |  185313    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  185655    |  185313    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  185655    |  185313    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  115998    |  115991    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  115998    |  115991    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: torch.Size([1, 20]) Device: 0
Parameter containing:
tensor([[-0.0419, -0.0474, -0.0279,  ...,  0.0721,  0.0670,  0.0683],
        [-0.0223, -0.0413, -0.0662,  ...,  0.0044,  0.0277,  0.0512],
        [ 0.0642,  0.0218,  0.0375,  ..., -0.0270, -0.0605, -0.0499],
        ...,
        [ 0.0558,  0.0268,  0.0744,  ..., -0.0007,  0.0124, -0.0582],
        [-0.0595, -0.0719, -0.0098,  ...,  0.0124,  0.0363,  0.0711],
        [-0.0084,  0.0387,  0.0192,  ..., -0.0483, -0.0137, -0.0567]],
       device='cuda:0', requires_grad=True)
batch input size: torch.Size([1, 20]) Device: 1
tensor([[-0.0419, -0.0474, -0.0279,  ...,  0.0721,  0.0670,  0.0683],
        [-0.0223, -0.0413, -0.0662,  ...,  0.0044,  0.0277,  0.0512],
        [ 0.0642,  0.0218,  0.0375,  ..., -0.0270, -0.0605, -0.0499],
        ...,
        [ 0.0558,  0.0268,  0.0744,  ..., -0.0007,  0.0124, -0.0582],
        [-0.0595, -0.0719, -0.0098,  ...,  0.0124,  0.0363,  0.0711],
        [-0.0084,  0.0387,  0.0192,  ..., -0.0483, -0.0137, -0.0567]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 88 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0419, -0.0474, -0.0279,  ...,  0.0721,  0.0670,  0.0683],
        [-0.0223, -0.0413, -0.0662,  ...,  0.0044,  0.0277,  0.0512],
        [ 0.0642,  0.0218,  0.0375,  ..., -0.0270, -0.0605, -0.0499],
        ...,
        [ 0.0558,  0.0268,  0.0744,  ..., -0.0007,  0.0124, -0.0582],
        [-0.0595, -0.0719, -0.0098,  ...,  0.0124,  0.0363,  0.0711],
        [-0.0084,  0.0387,  0.0192,  ..., -0.0483, -0.0137, -0.0567]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0419, -0.0474, -0.0279,  ...,  0.0721,  0.0670,  0.0683],
        [-0.0223, -0.0413, -0.0662,  ...,  0.0044,  0.0277,  0.0512],
        [ 0.0642,  0.0218,  0.0375,  ..., -0.0270, -0.0605, -0.0499],
        ...,
        [ 0.0558,  0.0268,  0.0744,  ..., -0.0007,  0.0124, -0.0582],
        [-0.0595, -0.0719, -0.0098,  ...,  0.0124,  0.0363,  0.0711],
        [-0.0084,  0.0387,  0.0192,  ..., -0.0483, -0.0137, -0.0567]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5159, 0.5124], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     971 MB |     969 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     971 MB |     969 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     971 MB |     969 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     971 MB |     969 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1218 MB |    1216 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1218 MB |    1216 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  194684    |  194283    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  194684    |  194283    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  194684    |  194283    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  194684    |  194283    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  114119    |  114113    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  114119    |  114113    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     883 MB |     881 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     883 MB |     881 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     883 MB |     881 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     883 MB |     881 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1231 MB |    1231 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1231 MB |    1231 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  188257    |  187915    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  188257    |  187915    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  188257    |  187915    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  188257    |  187915    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  117589    |  117582    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  117589    |  117582    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0420, -0.0475, -0.0280,  ...,  0.0722,  0.0671,  0.0684],
        [-0.0222, -0.0413, -0.0661,  ...,  0.0043,  0.0276,  0.0510],
        [ 0.0643,  0.0219,  0.0376,  ..., -0.0271, -0.0606, -0.0500],
        ...,
        [ 0.0559,  0.0269,  0.0746,  ..., -0.0008,  0.0123, -0.0583],
        [-0.0596, -0.0720, -0.0100,  ...,  0.0124,  0.0364,  0.0712],
        [-0.0082,  0.0388,  0.0193,  ..., -0.0484, -0.0138, -0.0568]],
       device='cuda:0', requires_grad=True)tensor([[-0.0420, -0.0475, -0.0280,  ...,  0.0722,  0.0671,  0.0684],
        [-0.0222, -0.0413, -0.0661,  ...,  0.0043,  0.0276,  0.0510],
        [ 0.0643,  0.0219,  0.0376,  ..., -0.0271, -0.0606, -0.0500],
        ...,
        [ 0.0559,  0.0269,  0.0746,  ..., -0.0008,  0.0123, -0.0583],
        [-0.0596, -0.0720, -0.0100,  ...,  0.0124,  0.0364,  0.0712],
        [-0.0082,  0.0388,  0.0193,  ..., -0.0484, -0.0138, -0.0568]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 89 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0420, -0.0475, -0.0280,  ...,  0.0722,  0.0671,  0.0684],
        [-0.0222, -0.0413, -0.0661,  ...,  0.0043,  0.0276,  0.0510],
        [ 0.0643,  0.0219,  0.0376,  ..., -0.0271, -0.0606, -0.0500],
        ...,
        [ 0.0559,  0.0269,  0.0746,  ..., -0.0008,  0.0123, -0.0583],
        [-0.0596, -0.0720, -0.0100,  ...,  0.0124,  0.0364,  0.0712],
        [-0.0082,  0.0388,  0.0193,  ..., -0.0484, -0.0138, -0.0568]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0420, -0.0475, -0.0280,  ...,  0.0722,  0.0671,  0.0684],
        [-0.0222, -0.0413, -0.0661,  ...,  0.0043,  0.0276,  0.0510],
        [ 0.0643,  0.0219,  0.0376,  ..., -0.0271, -0.0606, -0.0500],
        ...,
        [ 0.0559,  0.0269,  0.0746,  ..., -0.0008,  0.0123, -0.0583],
        [-0.0596, -0.0720, -0.0100,  ...,  0.0124,  0.0364,  0.0712],
        [-0.0082,  0.0388,  0.0193,  ..., -0.0484, -0.0138, -0.0568]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5152, 0.5118], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2878 KB |    3088 KB |     986 MB |     983 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     986 MB |     983 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2878 KB |    3088 KB |     986 MB |     983 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2878 KB |    3088 KB |     986 MB |     983 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1218 KB |    2749 KB |    1234 MB |    1233 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1218 KB |    2749 KB |    1234 MB |    1233 MB |
|---------------------------------------------------------------------------|
| Allocations           |     401    |     413    |  197359    |  196958    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  197359    |  196958    |
|---------------------------------------------------------------------------|
| Active allocs         |     401    |     413    |  197359    |  196958    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     401    |     413    |  197359    |  196958    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  115584    |  115578    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  115584    |  115578    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1738 KB |    1897 KB |     897 MB |     895 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     897 MB |     895 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1738 KB |    1897 KB |     897 MB |     895 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1738 KB |    1897 KB |     897 MB |     895 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  317440 B  |    2047 KB |    1249 MB |    1249 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  317440 B  |    2047 KB |    1249 MB |    1249 MB |
|---------------------------------------------------------------------------|
| Allocations           |     342    |     355    |  190859    |  190517    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  190859    |  190517    |
|---------------------------------------------------------------------------|
| Active allocs         |     342    |     355    |  190859    |  190517    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     342    |     355    |  190859    |  190517    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  119180    |  119173    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  119180    |  119173    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: torch.Size([1, 20]) Device: 0batch input size:
 torch.Size([1, 20]) Device: 1
Parameter containing:
tensor([[-0.0421, -0.0476, -0.0281,  ...,  0.0723,  0.0672,  0.0685],
        [-0.0221, -0.0414, -0.0660,  ...,  0.0041,  0.0275,  0.0509],
        [ 0.0644,  0.0220,  0.0377,  ..., -0.0272, -0.0607, -0.0501],
        ...,
        [ 0.0560,  0.0270,  0.0747,  ..., -0.0009,  0.0122, -0.0584],
        [-0.0597, -0.0721, -0.0101,  ...,  0.0125,  0.0365,  0.0713],
        [-0.0081,  0.0389,  0.0194,  ..., -0.0485, -0.0139, -0.0569]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0421, -0.0476, -0.0281,  ...,  0.0723,  0.0672,  0.0685],
        [-0.0221, -0.0414, -0.0660,  ...,  0.0041,  0.0275,  0.0509],
        [ 0.0644,  0.0220,  0.0377,  ..., -0.0272, -0.0607, -0.0501],
        ...,
        [ 0.0560,  0.0270,  0.0747,  ..., -0.0009,  0.0122, -0.0584],
        [-0.0597, -0.0721, -0.0101,  ...,  0.0125,  0.0365,  0.0713],
        [-0.0081,  0.0389,  0.0194,  ..., -0.0485, -0.0139, -0.0569]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 90 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0421, -0.0476, -0.0281,  ...,  0.0723,  0.0672,  0.0685],
        [-0.0221, -0.0414, -0.0660,  ...,  0.0041,  0.0275,  0.0509],
        [ 0.0644,  0.0220,  0.0377,  ..., -0.0272, -0.0607, -0.0501],
        ...,
        [ 0.0560,  0.0270,  0.0747,  ..., -0.0009,  0.0122, -0.0584],
        [-0.0597, -0.0721, -0.0101,  ...,  0.0125,  0.0365,  0.0713],
        [-0.0081,  0.0389,  0.0194,  ..., -0.0485, -0.0139, -0.0569]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0421, -0.0476, -0.0281,  ...,  0.0723,  0.0672,  0.0685],
        [-0.0221, -0.0414, -0.0660,  ...,  0.0041,  0.0275,  0.0509],
        [ 0.0644,  0.0220,  0.0377,  ..., -0.0272, -0.0607, -0.0501],
        ...,
        [ 0.0560,  0.0270,  0.0747,  ..., -0.0009,  0.0122, -0.0584],
        [-0.0597, -0.0721, -0.0101,  ...,  0.0125,  0.0365,  0.0713],
        [-0.0081,  0.0389,  0.0194,  ..., -0.0485, -0.0139, -0.0569]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5144, 0.5111], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1001 MB |     998 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1001 MB |     998 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1001 MB |     998 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1001 MB |     998 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1251 MB |    1250 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1251 MB |    1250 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  200054    |  199633    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  200054    |  199633    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  200054    |  199633    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  200054    |  199633    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  117045    |  117039    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  117045    |  117039    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     911 MB |     909 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     911 MB |     909 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     911 MB |     909 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     911 MB |     909 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1267 MB |    1266 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1267 MB |    1266 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  193481    |  193119    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  193481    |  193119    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  193481    |  193119    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  193481    |  193119    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  120771    |  120764    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  120771    |  120764    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0422, -0.0477, -0.0282,  ...,  0.0724,  0.0673,  0.0686],
        [-0.0220, -0.0414, -0.0659,  ...,  0.0040,  0.0274,  0.0508],
        [ 0.0645,  0.0221,  0.0378,  ..., -0.0273, -0.0608, -0.0502],
        ...,
        [ 0.0561,  0.0270,  0.0748,  ..., -0.0010,  0.0121, -0.0585],
        [-0.0598, -0.0722, -0.0102,  ...,  0.0126,  0.0366,  0.0714],
        [-0.0080,  0.0390,  0.0195,  ..., -0.0486, -0.0140, -0.0570]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0422, -0.0477, -0.0282,  ...,  0.0724,  0.0673,  0.0686],
        [-0.0220, -0.0414, -0.0659,  ...,  0.0040,  0.0274,  0.0508],
        [ 0.0645,  0.0221,  0.0378,  ..., -0.0273, -0.0608, -0.0502],
        ...,
        [ 0.0561,  0.0270,  0.0748,  ..., -0.0010,  0.0121, -0.0585],
        [-0.0598, -0.0722, -0.0102,  ...,  0.0126,  0.0366,  0.0714],
        [-0.0080,  0.0390,  0.0195,  ..., -0.0486, -0.0140, -0.0570]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 91 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0422, -0.0477, -0.0282,  ...,  0.0724,  0.0673,  0.0686],
        [-0.0220, -0.0414, -0.0659,  ...,  0.0040,  0.0274,  0.0508],
        [ 0.0645,  0.0221,  0.0378,  ..., -0.0273, -0.0608, -0.0502],
        ...,
        [ 0.0561,  0.0270,  0.0748,  ..., -0.0010,  0.0121, -0.0585],
        [-0.0598, -0.0722, -0.0102,  ...,  0.0126,  0.0366,  0.0714],
        [-0.0080,  0.0390,  0.0195,  ..., -0.0486, -0.0140, -0.0570]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0422, -0.0477, -0.0282,  ...,  0.0724,  0.0673,  0.0686],
        [-0.0220, -0.0414, -0.0659,  ...,  0.0040,  0.0274,  0.0508],
        [ 0.0645,  0.0221,  0.0378,  ..., -0.0273, -0.0608, -0.0502],
        ...,
        [ 0.0561,  0.0270,  0.0748,  ..., -0.0010,  0.0121, -0.0585],
        [-0.0598, -0.0722, -0.0102,  ...,  0.0126,  0.0366,  0.0714],
        [-0.0080,  0.0390,  0.0195,  ..., -0.0486, -0.0140, -0.0570]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5138, 0.5105], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1016 MB |    1014 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1016 MB |    1014 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1016 MB |    1014 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1016 MB |    1014 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1268 MB |    1267 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1268 MB |    1267 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  202839    |  202418    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  202839    |  202418    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  202839    |  202418    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  202839    |  202418    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  118557    |  118551    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  118557    |  118551    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     925 MB |     923 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     925 MB |     923 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     925 MB |     923 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     925 MB |     923 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1285 MB |    1285 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1285 MB |    1285 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  196193    |  195831    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  196193    |  195831    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  196193    |  195831    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  196193    |  195831    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  122422    |  122415    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  122422    |  122415    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0423, -0.0478, -0.0283,  ...,  0.0725,  0.0674,  0.0687],
        [-0.0219, -0.0415, -0.0659,  ...,  0.0039,  0.0273,  0.0507],
        [ 0.0646,  0.0222,  0.0379,  ..., -0.0274, -0.0609, -0.0503],
        ...,
        [ 0.0562,  0.0271,  0.0749,  ..., -0.0011,  0.0120, -0.0585],
        [-0.0598, -0.0723, -0.0102,  ...,  0.0126,  0.0367,  0.0714],
        [-0.0080,  0.0391,  0.0196,  ..., -0.0487, -0.0141, -0.0570]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0423, -0.0478, -0.0283,  ...,  0.0725,  0.0674,  0.0687],
        [-0.0219, -0.0415, -0.0659,  ...,  0.0039,  0.0273,  0.0507],
        [ 0.0646,  0.0222,  0.0379,  ..., -0.0274, -0.0609, -0.0503],
        ...,
        [ 0.0562,  0.0271,  0.0749,  ..., -0.0011,  0.0120, -0.0585],
        [-0.0598, -0.0723, -0.0102,  ...,  0.0126,  0.0367,  0.0714],
        [-0.0080,  0.0391,  0.0196,  ..., -0.0487, -0.0141, -0.0570]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 92 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0423, -0.0478, -0.0283,  ...,  0.0725,  0.0674,  0.0687],
        [-0.0219, -0.0415, -0.0659,  ...,  0.0039,  0.0273,  0.0507],
        [ 0.0646,  0.0222,  0.0379,  ..., -0.0274, -0.0609, -0.0503],
        ...,
        [ 0.0562,  0.0271,  0.0749,  ..., -0.0011,  0.0120, -0.0585],
        [-0.0598, -0.0723, -0.0102,  ...,  0.0126,  0.0367,  0.0714],
        [-0.0080,  0.0391,  0.0196,  ..., -0.0487, -0.0141, -0.0570]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0423, -0.0478, -0.0283,  ...,  0.0725,  0.0674,  0.0687],
        [-0.0219, -0.0415, -0.0659,  ...,  0.0039,  0.0273,  0.0507],
        [ 0.0646,  0.0222,  0.0379,  ..., -0.0274, -0.0609, -0.0503],
        ...,
        [ 0.0562,  0.0271,  0.0749,  ..., -0.0011,  0.0120, -0.0585],
        [-0.0598, -0.0723, -0.0102,  ...,  0.0126,  0.0367,  0.0714],
        [-0.0080,  0.0391,  0.0196,  ..., -0.0487, -0.0141, -0.0570]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5133, 0.5100], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1032 MB |    1029 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1032 MB |    1029 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1032 MB |    1029 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1032 MB |    1029 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1286 MB |    1285 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1286 MB |    1285 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  205624    |  205203    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  205624    |  205203    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  205624    |  205203    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  205624    |  205203    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  120060    |  120054    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  120060    |  120054    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     940 MB |     938 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     940 MB |     938 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     940 MB |     938 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     940 MB |     938 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1304 MB |    1303 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1304 MB |    1303 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  198905    |  198543    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  198905    |  198543    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  198905    |  198543    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  198905    |  198543    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  124073    |  124066    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  124073    |  124066    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: torch.Size([1, 20])batch input size:  Device:torch.Size([1, 20])  0Device:
 1
Parameter containing:
tensor([[-0.0424, -0.0479, -0.0284,  ...,  0.0726,  0.0675,  0.0688],
        [-0.0218, -0.0415, -0.0658,  ...,  0.0038,  0.0272,  0.0506],
        [ 0.0647,  0.0223,  0.0380,  ..., -0.0275, -0.0610, -0.0503],
        ...,
        [ 0.0563,  0.0272,  0.0749,  ..., -0.0011,  0.0120, -0.0586],
        [-0.0599, -0.0724, -0.0103,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0079,  0.0392,  0.0197,  ..., -0.0488, -0.0142, -0.0571]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0424, -0.0479, -0.0284,  ...,  0.0726,  0.0675,  0.0688],
        [-0.0218, -0.0415, -0.0658,  ...,  0.0038,  0.0272,  0.0506],
        [ 0.0647,  0.0223,  0.0380,  ..., -0.0275, -0.0610, -0.0503],
        ...,
        [ 0.0563,  0.0272,  0.0749,  ..., -0.0011,  0.0120, -0.0586],
        [-0.0599, -0.0724, -0.0103,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0079,  0.0392,  0.0197,  ..., -0.0488, -0.0142, -0.0571]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 93 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0424, -0.0479, -0.0284,  ...,  0.0726,  0.0675,  0.0688],
        [-0.0218, -0.0415, -0.0658,  ...,  0.0038,  0.0272,  0.0506],
        [ 0.0647,  0.0223,  0.0380,  ..., -0.0275, -0.0610, -0.0503],
        ...,
        [ 0.0563,  0.0272,  0.0749,  ..., -0.0011,  0.0120, -0.0586],
        [-0.0599, -0.0724, -0.0103,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0079,  0.0392,  0.0197,  ..., -0.0488, -0.0142, -0.0571]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[-0.0424, -0.0479, -0.0284,  ...,  0.0726,  0.0675,  0.0688],
        [-0.0218, -0.0415, -0.0658,  ...,  0.0038,  0.0272,  0.0506],
        [ 0.0647,  0.0223,  0.0380,  ..., -0.0275, -0.0610, -0.0503],
        ...,
        [ 0.0563,  0.0272,  0.0749,  ..., -0.0011,  0.0120, -0.0586],
        [-0.0599, -0.0724, -0.0103,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0079,  0.0392,  0.0197,  ..., -0.0488, -0.0142, -0.0571]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5127, 0.5095], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1048 MB |    1045 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1048 MB |    1045 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1048 MB |    1045 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1048 MB |    1045 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1303 MB |    1302 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1303 MB |    1302 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  208409    |  207988    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  208409    |  207988    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  208409    |  207988    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  208409    |  207988    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  121563    |  121557    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  121563    |  121557    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     954 MB |     952 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     954 MB |     952 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     954 MB |     952 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     954 MB |     952 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1322 MB |    1322 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1322 MB |    1322 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  201617    |  201255    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  201617    |  201255    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  201617    |  201255    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  201617    |  201255    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  125724    |  125717    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  125724    |  125717    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0424, -0.0479, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0218, -0.0415, -0.0657,  ...,  0.0038,  0.0271,  0.0505],
        [ 0.0648,  0.0223,  0.0381,  ..., -0.0276, -0.0611, -0.0504],
        ...,
        [ 0.0563,  0.0272,  0.0750,  ..., -0.0012,  0.0119, -0.0587],
        [-0.0600, -0.0724, -0.0104,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0078,  0.0393,  0.0197,  ..., -0.0488, -0.0143, -0.0572]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0424, -0.0479, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0218, -0.0415, -0.0657,  ...,  0.0038,  0.0271,  0.0505],
        [ 0.0648,  0.0223,  0.0381,  ..., -0.0276, -0.0611, -0.0504],
        ...,
        [ 0.0563,  0.0272,  0.0750,  ..., -0.0012,  0.0119, -0.0587],
        [-0.0600, -0.0724, -0.0104,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0078,  0.0393,  0.0197,  ..., -0.0488, -0.0143, -0.0572]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 94 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0424, -0.0479, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0218, -0.0415, -0.0657,  ...,  0.0038,  0.0271,  0.0505],
        [ 0.0648,  0.0223,  0.0381,  ..., -0.0276, -0.0611, -0.0504],
        ...,
        [ 0.0563,  0.0272,  0.0750,  ..., -0.0012,  0.0119, -0.0587],
        [-0.0600, -0.0724, -0.0104,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0078,  0.0393,  0.0197,  ..., -0.0488, -0.0143, -0.0572]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0424, -0.0479, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0218, -0.0415, -0.0657,  ...,  0.0038,  0.0271,  0.0505],
        [ 0.0648,  0.0223,  0.0381,  ..., -0.0276, -0.0611, -0.0504],
        ...,
        [ 0.0563,  0.0272,  0.0750,  ..., -0.0012,  0.0119, -0.0587],
        [-0.0600, -0.0724, -0.0104,  ...,  0.0127,  0.0368,  0.0715],
        [-0.0078,  0.0393,  0.0197,  ..., -0.0488, -0.0143, -0.0572]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5123, 0.5091], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1063 MB |    1060 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1063 MB |    1060 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1063 MB |    1060 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1063 MB |    1060 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1321 MB |    1320 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1321 MB |    1320 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  211194    |  210773    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  211194    |  210773    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  211194    |  210773    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  211194    |  210773    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  123072    |  123066    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  123072    |  123066    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     969 MB |     967 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     969 MB |     967 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     969 MB |     967 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     969 MB |     967 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1341 MB |    1341 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1341 MB |    1341 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  204329    |  203967    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  204329    |  203967    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  204329    |  203967    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  204329    |  203967    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  127375    |  127368    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  127375    |  127368    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
Parameter containing:
tensor([[-0.0425, -0.0480, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0217, -0.0416, -0.0657,  ...,  0.0037,  0.0270,  0.0505],
        [ 0.0649,  0.0224,  0.0381,  ..., -0.0276, -0.0611, -0.0505],
        ...,
        [ 0.0564,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0587],
        [-0.0600, -0.0725, -0.0104,  ...,  0.0127,  0.0369,  0.0715],
        [-0.0077,  0.0393,  0.0198,  ..., -0.0489, -0.0143, -0.0572]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0425, -0.0480, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0217, -0.0416, -0.0657,  ...,  0.0037,  0.0270,  0.0505],
        [ 0.0649,  0.0224,  0.0381,  ..., -0.0276, -0.0611, -0.0505],
        ...,
        [ 0.0564,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0587],
        [-0.0600, -0.0725, -0.0104,  ...,  0.0127,  0.0369,  0.0715],
        [-0.0077,  0.0393,  0.0198,  ..., -0.0489, -0.0143, -0.0572]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 95 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0425, -0.0480, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0217, -0.0416, -0.0657,  ...,  0.0037,  0.0270,  0.0505],
        [ 0.0649,  0.0224,  0.0381,  ..., -0.0276, -0.0611, -0.0505],
        ...,
        [ 0.0564,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0587],
        [-0.0600, -0.0725, -0.0104,  ...,  0.0127,  0.0369,  0.0715],
        [-0.0077,  0.0393,  0.0198,  ..., -0.0489, -0.0143, -0.0572]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[-0.0425, -0.0480, -0.0285,  ...,  0.0727,  0.0676,  0.0689],
        [-0.0217, -0.0416, -0.0657,  ...,  0.0037,  0.0270,  0.0505],
        [ 0.0649,  0.0224,  0.0381,  ..., -0.0276, -0.0611, -0.0505],
        ...,
        [ 0.0564,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0587],
        [-0.0600, -0.0725, -0.0104,  ...,  0.0127,  0.0369,  0.0715],
        [-0.0077,  0.0393,  0.0198,  ..., -0.0489, -0.0143, -0.0572]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5119, 0.5087], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1079 MB |    1076 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1079 MB |    1076 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1079 MB |    1076 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1079 MB |    1076 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1339 MB |    1337 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1339 MB |    1337 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  213979    |  213558    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  213979    |  213558    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  213979    |  213558    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  213979    |  213558    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  124577    |  124571    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  124577    |  124571    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     983 MB |     981 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     983 MB |     981 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     983 MB |     981 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     983 MB |     981 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1359 MB |    1359 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1359 MB |    1359 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  207041    |  206679    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  207041    |  206679    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  207041    |  206679    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  207041    |  206679    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  129026    |  129019    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  129026    |  129019    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
Parameter containing:
tensor([[-0.0425, -0.0480, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0217, -0.0416, -0.0656,  ...,  0.0036,  0.0270,  0.0504],
        [ 0.0649,  0.0224,  0.0382,  ..., -0.0277, -0.0612, -0.0505],
        ...,
        [ 0.0565,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0588],
        [-0.0601, -0.0725, -0.0105,  ...,  0.0128,  0.0369,  0.0715],
        [-0.0077,  0.0394,  0.0198,  ..., -0.0489, -0.0144, -0.0573]],
       device='cuda:0', requires_grad=True)
tensor([[-0.0425, -0.0480, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0217, -0.0416, -0.0656,  ...,  0.0036,  0.0270,  0.0504],
        [ 0.0649,  0.0224,  0.0382,  ..., -0.0277, -0.0612, -0.0505],
        ...,
        [ 0.0565,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0588],
        [-0.0601, -0.0725, -0.0105,  ...,  0.0128,  0.0369,  0.0715],
        [-0.0077,  0.0394,  0.0198,  ..., -0.0489, -0.0144, -0.0573]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 96 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0425, -0.0480, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0217, -0.0416, -0.0656,  ...,  0.0036,  0.0270,  0.0504],
        [ 0.0649,  0.0224,  0.0382,  ..., -0.0277, -0.0612, -0.0505],
        ...,
        [ 0.0565,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0588],
        [-0.0601, -0.0725, -0.0105,  ...,  0.0128,  0.0369,  0.0715],
        [-0.0077,  0.0394,  0.0198,  ..., -0.0489, -0.0144, -0.0573]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0425, -0.0480, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0217, -0.0416, -0.0656,  ...,  0.0036,  0.0270,  0.0504],
        [ 0.0649,  0.0224,  0.0382,  ..., -0.0277, -0.0612, -0.0505],
        ...,
        [ 0.0565,  0.0273,  0.0751,  ..., -0.0013,  0.0118, -0.0588],
        [-0.0601, -0.0725, -0.0105,  ...,  0.0128,  0.0369,  0.0715],
        [-0.0077,  0.0394,  0.0198,  ..., -0.0489, -0.0144, -0.0573]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5116, 0.5084], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1094 MB |    1091 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1094 MB |    1091 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1094 MB |    1091 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1094 MB |    1091 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1356 MB |    1355 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1356 MB |    1355 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  216764    |  216343    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  216764    |  216343    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  216764    |  216343    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  216764    |  216343    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  126081    |  126075    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  126081    |  126075    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |     998 MB |     996 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     998 MB |     996 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |     998 MB |     996 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |     998 MB |     996 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1378 MB |    1378 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1378 MB |    1378 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  209753    |  209391    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  209753    |  209391    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  209753    |  209391    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  209753    |  209391    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  130677    |  130670    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  130677    |  130670    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size:batch input size:  torch.Size([1, 20])torch.Size([1, 20])  Device:Device:  01
tensor([[-0.0426, -0.0481, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0036,  0.0269,  0.0504],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0105,  ...,  0.0128,  0.0370,  0.0715],
        [-0.0077,  0.0394,  0.0199,  ..., -0.0490, -0.0144, -0.0573]],
       device='cuda:1')Parameter containing:
tensor([[-0.0426, -0.0481, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0036,  0.0269,  0.0504],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0105,  ...,  0.0128,  0.0370,  0.0715],
        [-0.0077,  0.0394,  0.0199,  ..., -0.0490, -0.0144, -0.0573]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 97 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([4, 20])  torch.Size([3, 20])Device:  Device:0
1
tensor([[-0.0426, -0.0481, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0036,  0.0269,  0.0504],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0105,  ...,  0.0128,  0.0370,  0.0715],
        [-0.0077,  0.0394,  0.0199,  ..., -0.0490, -0.0144, -0.0573]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0426, -0.0481, -0.0286,  ...,  0.0728,  0.0677,  0.0690],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0036,  0.0269,  0.0504],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0105,  ...,  0.0128,  0.0370,  0.0715],
        [-0.0077,  0.0394,  0.0199,  ..., -0.0490, -0.0144, -0.0573]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5113, 0.5081], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1110 MB |    1107 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1110 MB |    1107 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1110 MB |    1107 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1110 MB |    1107 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1374 MB |    1373 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1374 MB |    1373 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  219549    |  219128    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  219549    |  219128    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  219549    |  219128    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  219549    |  219128    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  127588    |  127582    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  127588    |  127582    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |    1012 MB |    1011 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |    1012 MB |    1011 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |    1012 MB |    1011 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |    1012 MB |    1011 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1396 MB |    1396 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1396 MB |    1396 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  212465    |  212103    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  212465    |  212103    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  212465    |  212103    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  212465    |  212103    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  132328    |  132321    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  132328    |  132321    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
Parameter containing:
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0269,  0.0503],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:0', requires_grad=True)tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0269,  0.0503],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:1')
  Average validation loss: 13.65
======== Epoch 98 / 100 ========
Training...
Step: 0
batch input size: torch.Size([4, 20]) batch input size:Device:  torch.Size([3, 20])0
Device: 1
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0269,  0.0503],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0269,  0.0503],
        [ 0.0650,  0.0225,  0.0382,  ..., -0.0277, -0.0612, -0.0506],
        ...,
        [ 0.0565,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0588],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5111, 0.5079], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1125 MB |    1122 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1125 MB |    1122 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1125 MB |    1122 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1125 MB |    1122 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1391 MB |    1390 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1391 MB |    1390 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  222334    |  221913    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  222334    |  221913    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  222334    |  221913    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  222334    |  221913    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  129095    |  129089    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  129095    |  129089    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |    1027 MB |    1025 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |    1027 MB |    1025 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |    1027 MB |    1025 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |    1027 MB |    1025 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1415 MB |    1415 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1415 MB |    1415 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  215177    |  214815    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  215177    |  214815    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  215177    |  214815    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  215177    |  214815    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  133979    |  133972    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  133979    |  133972    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0225,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0225,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 99 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0225,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0216, -0.0416, -0.0656,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0225,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0601, -0.0726, -0.0106,  ...,  0.0128,  0.0370,  0.0716],
        [-0.0076,  0.0395,  0.0199,  ..., -0.0490, -0.0145, -0.0574]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5109, 0.5077], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2993 KB |    3203 KB |    1141 MB |    1138 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1141 MB |    1138 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2993 KB |    3203 KB |    1141 MB |    1138 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2993 KB |    3203 KB |    1141 MB |    1138 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1103 KB |    2749 KB |    1409 MB |    1408 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1103 KB |    2749 KB |    1409 MB |    1408 MB |
|---------------------------------------------------------------------------|
| Allocations           |     421    |     433    |  225119    |  224698    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  225119    |  224698    |
|---------------------------------------------------------------------------|
| Active allocs         |     421    |     433    |  225119    |  224698    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     421    |     433    |  225119    |  224698    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  130596    |  130590    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  130596    |  130590    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1853 KB |    2012 KB |    1041 MB |    1040 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |    1041 MB |    1040 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1853 KB |    2012 KB |    1041 MB |    1040 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1853 KB |    2012 KB |    1041 MB |    1040 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  199680 B  |    2047 KB |    1433 MB |    1433 MB |
|       from large pool |       0 B  |       0 KB |       0 MB |       0 MB |
|       from small pool |  199680 B  |    2047 KB |    1433 MB |    1433 MB |
|---------------------------------------------------------------------------|
| Allocations           |     362    |     375    |  217889    |  217527    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  217889    |  217527    |
|---------------------------------------------------------------------------|
| Active allocs         |     362    |     375    |  217889    |  217527    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     362    |     375    |  217889    |  217527    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  135630    |  135623    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  135630    |  135623    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0
1
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0215, -0.0416, -0.0655,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0226,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0602, -0.0726, -0.0106,  ...,  0.0128,  0.0371,  0.0716],
        [-0.0076,  0.0395,  0.0200,  ..., -0.0491, -0.0145, -0.0574]],
       device='cuda:1')
Parameter containing:
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0215, -0.0416, -0.0655,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0226,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0602, -0.0726, -0.0106,  ...,  0.0128,  0.0371,  0.0716],
        [-0.0076,  0.0395,  0.0200,  ..., -0.0491, -0.0145, -0.0574]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
======== Epoch 100 / 100 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([4, 20])torch.Size([3, 20])  Device:Device:  01
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0215, -0.0416, -0.0655,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0226,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0602, -0.0726, -0.0106,  ...,  0.0128,  0.0371,  0.0716],
        [-0.0076,  0.0395,  0.0200,  ..., -0.0491, -0.0145, -0.0574]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[-0.0426, -0.0481, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0215, -0.0416, -0.0655,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0650,  0.0226,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0602, -0.0726, -0.0106,  ...,  0.0128,  0.0371,  0.0716],
        [-0.0076,  0.0395,  0.0200,  ..., -0.0491, -0.0145, -0.0574]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.5107, 0.5076], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3108 KB |    3318 KB |    1156 MB |    1153 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    3108 KB |    3318 KB |    1156 MB |    1153 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3108 KB |    3318 KB |    1156 MB |    1153 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    3108 KB |    3318 KB |    1156 MB |    1153 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     988 KB |    2749 KB |    1426 MB |    1425 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |     988 KB |    2749 KB |    1426 MB |    1425 MB |
|---------------------------------------------------------------------------|
| Allocations           |     441    |     453    |  227924    |  227483    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     441    |     453    |  227924    |  227483    |
|---------------------------------------------------------------------------|
| Active allocs         |     441    |     453    |  227924    |  227483    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     441    |     453    |  227924    |  227483    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |  132105    |  132099    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |  132105    |  132099    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1968 KB |    2127 KB |    1056 MB |    1054 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1968 KB |    2127 KB |    1056 MB |    1054 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1968 KB |    2127 KB |    1056 MB |    1054 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1968 KB |    2127 KB |    1056 MB |    1054 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2128 KB |    2128 KB |    1454 MB |    1452 MB |
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    2128 KB |    2128 KB |    1454 MB |    1452 MB |
|---------------------------------------------------------------------------|
| Allocations           |     382    |     395    |  220621    |  220239    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     382    |     395    |  220621    |  220239    |
|---------------------------------------------------------------------------|
| Active allocs         |     382    |     395    |  220621    |  220239    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     382    |     395    |  220621    |  220239    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      25    |  137282    |  137275    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      25    |  137282    |  137275    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.51
batch input size: batch input size:torch.Size([1, 20])  torch.Size([1, 20])Device:  Device:0 1
tensor([[-0.0427, -0.0482, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0215, -0.0416, -0.0655,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0651,  0.0226,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0602, -0.0726, -0.0106,  ...,  0.0128,  0.0371,  0.0716],
        [-0.0076,  0.0395,  0.0200,  ..., -0.0491, -0.0145, -0.0574]],
       device='cuda:1')Parameter containing:
tensor([[-0.0427, -0.0482, -0.0287,  ...,  0.0729,  0.0678,  0.0691],
        [-0.0215, -0.0416, -0.0655,  ...,  0.0035,  0.0268,  0.0503],
        [ 0.0651,  0.0226,  0.0383,  ..., -0.0278, -0.0613, -0.0506],
        ...,
        [ 0.0566,  0.0274,  0.0752,  ..., -0.0014,  0.0117, -0.0589],
        [-0.0602, -0.0726, -0.0106,  ...,  0.0128,  0.0371,  0.0716],
        [-0.0076,  0.0395,  0.0200,  ..., -0.0491, -0.0145, -0.0574]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 13.65
Least Validation loss: 13.547842025756836
|       from large pool |       0 KB |       0 KB |       0 MB |       0 MB |
|       from small pool |    1333 KB |    2749 KB |    1021 MB |    1020 MB |
|---------------------------------------------------------------------------|
| Allocations           |     381    |     393    |  163008    |  162627    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  163008    |  162627    |
|---------------------------------------------------------------------------|
| Active allocs         |     381    |     393    |  163008    |  162627    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     381    |     393    |  163008    |  162627    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |      27    |   96693    |   96687    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       6    |      27    |   96693    |   96687    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |