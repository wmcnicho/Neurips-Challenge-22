PermutedDKT
Number of questions:  807
Number of students:  4
Number of concepts: 636
Using batch size: 32
Using batch size: 32
/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_small.py:474: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(dataset_tensor[:, 1, :].clone().detach(), dtype=torch.long)
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   14885 KB |   14885 KB |   14885 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2241 KB |    2241 KB |    2241 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   14885 KB |   14885 KB |   14885 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2241 KB |    2241 KB |    2241 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   24576 KB |   24576 KB |   24576 KB |       0 B  |
|       from large pool |   20480 KB |   20480 KB |   20480 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    9691 KB |   19456 KB |   21504 KB |   11813 KB |
|       from large pool |    7836 KB |   18899 KB |   18899 KB |   11063 KB |
|       from small pool |    1855 KB |    1859 KB |    2605 KB |     750 KB |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Successfull in data prepration!
Successfully loaded the optimizer
======== Epoch 1 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01
/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
tensor([[ 2.8974e-03,  3.4293e-03,  2.0447e-03,  ..., -1.1190e-03,
          2.1467e-05, -1.8264e-03],
        [ 3.3009e-03,  1.1693e-03, -3.3589e-03,  ...,  1.4252e-03,
         -1.5523e-03, -2.7005e-03],
        [-2.4899e-03,  2.4137e-03, -9.6183e-04,  ..., -7.8851e-04,
         -2.9701e-03,  1.5478e-03],
        ...,
        [-9.8903e-04, -3.5760e-03,  2.7765e-03,  ...,  1.7900e-03,
         -8.3554e-04, -2.1159e-03],
        [-1.6458e-03, -1.1593e-03, -1.2494e-03,  ..., -1.0617e-03,
         -2.3143e-03,  3.2158e-03],
        [ 2.0415e-03,  2.4007e-03, -3.3205e-03,  ..., -3.7045e-03,
          3.1192e-04,  2.5392e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.8974e-03,  3.4293e-03,  2.0447e-03,  ..., -1.1190e-03,
          2.1467e-05, -1.8264e-03],
        [ 3.3009e-03,  1.1693e-03, -3.3589e-03,  ...,  1.4252e-03,
         -1.5523e-03, -2.7005e-03],
        [-2.4899e-03,  2.4137e-03, -9.6183e-04,  ..., -7.8851e-04,
         -2.9701e-03,  1.5478e-03],
        ...,
        [-9.8903e-04, -3.5760e-03,  2.7765e-03,  ...,  1.7900e-03,
         -8.3554e-04, -2.1159e-03],
        [-1.6458e-03, -1.1593e-03, -1.2494e-03,  ..., -1.0617e-03,
         -2.3143e-03,  3.2158e-03],
        [ 2.0415e-03,  2.4007e-03, -3.3205e-03,  ..., -3.7045e-03,
          3.1192e-04,  2.5392e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6450], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7528 MB |    7535 MB |    7581 MB |   54143 KB |
|       from large pool |    7510 MB |    7515 MB |    7540 MB |   29962 KB |
|       from small pool |      17 MB |      19 MB |      41 MB |   24181 KB |
|---------------------------------------------------------------------------|
| Active memory         |    7528 MB |    7535 MB |    7581 MB |   54143 KB |
|       from large pool |    7510 MB |    7515 MB |    7540 MB |   29962 KB |
|       from small pool |      17 MB |      19 MB |      41 MB |   24181 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8152 MB |    8152 MB |    8152 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      20 MB |      20 MB |      20 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  617766 KB |  631787 KB |    7567 MB |    6964 MB |
|       from large pool |  615614 KB |  631545 KB |    7526 MB |    6925 MB |
|       from small pool |    2152 KB |    2152 KB |      41 MB |      39 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10540    |   10551    |   19501    |    8961    |
|       from large pool |    4865    |    4867    |    4875    |      10    |
|       from small pool |    5675    |    5685    |   14626    |    8951    |
|---------------------------------------------------------------------------|
| Active allocs         |   10540    |   10551    |   19501    |    8961    |
|       from large pool |    4865    |    4867    |    4875    |      10    |
|       from small pool |    5675    |    5685    |   14626    |    8951    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     417    |     417    |     417    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |      10    |      10    |      10    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     419    |     421    |    3705    |    3286    |
|       from large pool |     406    |     406    |     413    |       7    |
|       from small pool |      13    |      15    |    3292    |    3279    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |    7567 MB |   38196 KB |
|       from large pool |    7514 MB |    7518 MB |    7527 MB |   14032 KB |
|       from small pool |      15 MB |      17 MB |      39 MB |   24164 KB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |    7567 MB |   38196 KB |
|       from large pool |    7514 MB |    7518 MB |    7527 MB |   14032 KB |
|       from small pool |      15 MB |      17 MB |      39 MB |   24164 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  630490 KB |    7556 MB |    6956 MB |
|       from large pool |  612147 KB |  629041 KB |    7502 MB |    6904 MB |
|       from small pool |    2365 KB |    2365 KB |      54 MB |      52 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |   19465    |    8939    |
|       from large pool |    4859    |    4861    |    4867    |       8    |
|       from small pool |    5667    |    5679    |   14598    |    8931    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |   19465    |    8939    |
|       from large pool |    4859    |    4861    |    4867    |       8    |
|       from small pool |    5667    |    5679    |   14598    |    8931    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |     416    |    3872    |    3456    |
|       from large pool |     404    |     404    |     411    |       7    |
|       from small pool |      12    |      12    |    3461    |    3449    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01
Parameter containing:
tensor([[ 2.8976e-03,  3.4295e-03,  2.0449e-03,  ..., -1.1192e-03,
          2.1260e-05, -1.8266e-03],
        [ 3.3051e-03,  1.1735e-03, -3.3548e-03,  ...,  1.4211e-03,
         -1.5564e-03, -2.7047e-03],
        [-2.4989e-03,  2.4046e-03, -9.7081e-04,  ..., -7.7952e-04,
         -2.9611e-03,  1.5569e-03],
        ...,
        [-9.8319e-04, -3.5702e-03,  2.7823e-03,  ...,  1.7841e-03,
         -8.4135e-04, -2.1217e-03],
        [-1.6444e-03, -1.1580e-03, -1.2480e-03,  ..., -1.0630e-03,
         -2.3157e-03,  3.2144e-03],
        [ 1.9295e-03,  2.2888e-03, -3.4310e-03,  ..., -3.5940e-03,
          4.2336e-04,  2.6513e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.8976e-03,  3.4295e-03,  2.0449e-03,  ..., -1.1192e-03,
          2.1260e-05, -1.8266e-03],
        [ 3.3051e-03,  1.1735e-03, -3.3548e-03,  ...,  1.4211e-03,
         -1.5564e-03, -2.7047e-03],
        [-2.4989e-03,  2.4046e-03, -9.7081e-04,  ..., -7.7952e-04,
         -2.9611e-03,  1.5569e-03],
        ...,
        [-9.8319e-04, -3.5702e-03,  2.7823e-03,  ...,  1.7841e-03,
         -8.4135e-04, -2.1217e-03],
        [-1.6444e-03, -1.1580e-03, -1.2480e-03,  ..., -1.0630e-03,
         -2.3157e-03,  3.2144e-03],
        [ 1.9295e-03,  2.2888e-03, -3.4310e-03,  ..., -3.5940e-03,
          4.2336e-04,  2.6513e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 2 / 10 ========
Training...
Step: 0
batch input size: torch.Size([1, 807]) Device:batch input size:  0torch.Size([1, 807])
 Device: 1
tensor([[ 2.8976e-03,  3.4295e-03,  2.0449e-03,  ..., -1.1192e-03,
          2.1260e-05, -1.8266e-03],
        [ 3.3051e-03,  1.1735e-03, -3.3548e-03,  ...,  1.4211e-03,
         -1.5564e-03, -2.7047e-03],
        [-2.4989e-03,  2.4046e-03, -9.7081e-04,  ..., -7.7952e-04,
         -2.9611e-03,  1.5569e-03],
        ...,
        [-9.8319e-04, -3.5702e-03,  2.7823e-03,  ...,  1.7841e-03,
         -8.4135e-04, -2.1217e-03],
        [-1.6444e-03, -1.1580e-03, -1.2480e-03,  ..., -1.0630e-03,
         -2.3157e-03,  3.2144e-03],
        [ 1.9295e-03,  2.2888e-03, -3.4310e-03,  ..., -3.5940e-03,
          4.2336e-04,  2.6513e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.8976e-03,  3.4295e-03,  2.0449e-03,  ..., -1.1192e-03,
          2.1260e-05, -1.8266e-03],
        [ 3.3051e-03,  1.1735e-03, -3.3548e-03,  ...,  1.4211e-03,
         -1.5564e-03, -2.7047e-03],
        [-2.4989e-03,  2.4046e-03, -9.7081e-04,  ..., -7.7952e-04,
         -2.9611e-03,  1.5569e-03],
        ...,
        [-9.8319e-04, -3.5702e-03,  2.7823e-03,  ...,  1.7841e-03,
         -8.4135e-04, -2.1217e-03],
        [-1.6444e-03, -1.1580e-03, -1.2480e-03,  ..., -1.0630e-03,
         -2.3157e-03,  3.2144e-03],
        [ 1.9295e-03,  2.2888e-03, -3.4310e-03,  ..., -3.5940e-03,
          4.2336e-04,  2.6513e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6437], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |   61970 MB |   54385 MB |
|       from large pool |    7560 MB |    7564 MB |   61788 MB |   54228 MB |
|       from small pool |      24 MB |      26 MB |     181 MB |     156 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |   61970 MB |   54385 MB |
|       from large pool |    7560 MB |    7564 MB |   61788 MB |   54228 MB |
|       from small pool |      24 MB |      26 MB |     181 MB |     156 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |   68940 MB |   68324 MB |
|       from large pool |  626545 KB |  658091 KB |   68736 MB |   68124 MB |
|       from small pool |    3594 KB |   17027 KB |     203 MB |     200 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  101423    |   90838    |
|       from large pool |    4889    |    4891    |   38929    |   34040    |
|       from small pool |    5696    |    5707    |   62494    |   56798    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  101423    |   90838    |
|       from large pool |    4889    |    4891    |   38929    |   34040    |
|       from small pool |    5696    |    5707    |   62494    |   56798    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     425    |    1221    |   55779    |   55354    |
|       from large pool |     408    |     408    |   22506    |   22098    |
|       from small pool |      17    |     815    |   33273    |   33256    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |   60250 MB |   52720 MB |
|       from large pool |    7514 MB |    7519 MB |   60082 MB |   52567 MB |
|       from small pool |      15 MB |      17 MB |     168 MB |     152 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |   60250 MB |   52720 MB |
|       from large pool |    7514 MB |    7519 MB |   60082 MB |   52567 MB |
|       from small pool |      15 MB |      17 MB |     168 MB |     152 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |   67179 MB |   66579 MB |
|       from large pool |  612147 KB |  655020 KB |   66957 MB |   66359 MB |
|       from small pool |    2365 KB |   15232 KB |     221 MB |     219 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  101254    |   90728    |
|       from large pool |    4859    |    4862    |   38883    |   34024    |
|       from small pool |    5667    |    5679    |   62371    |   56704    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  101254    |   90728    |
|       from large pool |    4859    |    4862    |   38883    |   34024    |
|       from small pool |    5667    |    5679    |   62371    |   56704    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |   58329    |   57913    |
|       from large pool |     404    |     407    |   24649    |   24245    |
|       from small pool |      12    |     816    |   33680    |   33668    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[ 2.8980e-03,  3.4299e-03,  2.0453e-03,  ..., -1.1197e-03,
          2.0809e-05, -1.8271e-03],
        [ 3.3088e-03,  1.1772e-03, -3.3511e-03,  ...,  1.4174e-03,
         -1.5601e-03, -2.7083e-03],
        [-2.5003e-03,  2.4032e-03, -9.7224e-04,  ..., -7.7809e-04,
         -2.9597e-03,  1.5583e-03],
        ...,
        [-9.7335e-04, -3.5604e-03,  2.7921e-03,  ...,  1.7743e-03,
         -8.5115e-04, -2.1315e-03],
        [-1.6361e-03, -1.1496e-03, -1.2397e-03,  ..., -1.0713e-03,
         -2.3240e-03,  3.2060e-03],
        [ 1.7282e-03,  2.0877e-03, -3.6307e-03,  ..., -3.3944e-03,
          6.2406e-04,  2.8528e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.8980e-03,  3.4299e-03,  2.0453e-03,  ..., -1.1197e-03,
          2.0809e-05, -1.8271e-03],
        [ 3.3088e-03,  1.1772e-03, -3.3511e-03,  ...,  1.4174e-03,
         -1.5601e-03, -2.7083e-03],
        [-2.5003e-03,  2.4032e-03, -9.7224e-04,  ..., -7.7809e-04,
         -2.9597e-03,  1.5583e-03],
        ...,
        [-9.7335e-04, -3.5604e-03,  2.7921e-03,  ...,  1.7743e-03,
         -8.5115e-04, -2.1315e-03],
        [-1.6361e-03, -1.1496e-03, -1.2397e-03,  ..., -1.0713e-03,
         -2.3240e-03,  3.2060e-03],
        [ 1.7282e-03,  2.0877e-03, -3.6307e-03,  ..., -3.3944e-03,
          6.2406e-04,  2.8528e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 3 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01
tensor([[ 2.8980e-03,  3.4299e-03,  2.0453e-03,  ..., -1.1197e-03,
          2.0809e-05, -1.8271e-03],
        [ 3.3088e-03,  1.1772e-03, -3.3511e-03,  ...,  1.4174e-03,
         -1.5601e-03, -2.7083e-03],
        [-2.5003e-03,  2.4032e-03, -9.7224e-04,  ..., -7.7809e-04,
         -2.9597e-03,  1.5583e-03],
        ...,
        [-9.7335e-04, -3.5604e-03,  2.7921e-03,  ...,  1.7743e-03,
         -8.5115e-04, -2.1315e-03],
        [-1.6361e-03, -1.1496e-03, -1.2397e-03,  ..., -1.0713e-03,
         -2.3240e-03,  3.2060e-03],
        [ 1.7282e-03,  2.0877e-03, -3.6307e-03,  ..., -3.3944e-03,
          6.2406e-04,  2.8528e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.8980e-03,  3.4299e-03,  2.0453e-03,  ..., -1.1197e-03,
          2.0809e-05, -1.8271e-03],
        [ 3.3088e-03,  1.1772e-03, -3.3511e-03,  ...,  1.4174e-03,
         -1.5601e-03, -2.7083e-03],
        [-2.5003e-03,  2.4032e-03, -9.7224e-04,  ..., -7.7809e-04,
         -2.9597e-03,  1.5583e-03],
        ...,
        [-9.7335e-04, -3.5604e-03,  2.7921e-03,  ...,  1.7743e-03,
         -8.5115e-04, -2.1315e-03],
        [-1.6361e-03, -1.1496e-03, -1.2397e-03,  ..., -1.0713e-03,
         -2.3240e-03,  3.2060e-03],
        [ 1.7282e-03,  2.0877e-03, -3.6307e-03,  ..., -3.3944e-03,
          6.2406e-04,  2.8528e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6425], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  115220 MB |  107636 MB |
|       from large pool |    7560 MB |    7565 MB |  114906 MB |  107346 MB |
|       from small pool |      24 MB |      26 MB |     314 MB |     290 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  115220 MB |  107636 MB |
|       from large pool |    7560 MB |    7565 MB |  114906 MB |  107346 MB |
|       from small pool |      24 MB |      26 MB |     314 MB |     290 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  129132 MB |  128516 MB |
|       from large pool |  626545 KB |  658091 KB |  128773 MB |  128161 MB |
|       from small pool |    3594 KB |   17027 KB |     358 MB |     355 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  183305    |  172720    |
|       from large pool |    4889    |    4892    |   72961    |   68072    |
|       from small pool |    5696    |    5707    |  110344    |  104648    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  183305    |  172720    |
|       from large pool |    4889    |    4892    |   72961    |   68072    |
|       from small pool |    5696    |    5707    |  110344    |  104648    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     425    |    1227    |  105539    |  105114    |
|       from large pool |     408    |     410    |   44374    |   43966    |
|       from small pool |      17    |     819    |   61165    |   61148    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  112934 MB |  105404 MB |
|       from large pool |    7514 MB |    7519 MB |  112637 MB |  105122 MB |
|       from small pool |      15 MB |      17 MB |     297 MB |     281 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  112934 MB |  105404 MB |
|       from large pool |    7514 MB |    7519 MB |  112637 MB |  105122 MB |
|       from small pool |      15 MB |      17 MB |     297 MB |     281 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  126803 MB |  126202 MB |
|       from large pool |  612147 KB |  655020 KB |  126413 MB |  125815 MB |
|       from small pool |    2365 KB |   15232 KB |     389 MB |     387 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  183043    |  172517    |
|       from large pool |    4859    |    4862    |   72899    |   68040    |
|       from small pool |    5667    |    5679    |  110144    |  104477    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  183043    |  172517    |
|       from large pool |    4859    |    4862    |   72899    |   68040    |
|       from small pool |    5667    |    5679    |  110144    |  104477    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  109885    |  109469    |
|       from large pool |     404    |     407    |   48920    |   48516    |
|       from small pool |      12    |     816    |   60965    |   60953    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0
1
Parameter containing:
tensor([[ 2.8987e-03,  3.4306e-03,  2.0460e-03,  ..., -1.1203e-03,
          2.0156e-05, -1.8277e-03],
        [ 3.3121e-03,  1.1804e-03, -3.3479e-03,  ...,  1.4142e-03,
         -1.5633e-03, -2.7115e-03],
        [-2.4958e-03,  2.4078e-03, -9.6769e-04,  ..., -7.8264e-04,
         -2.9643e-03,  1.5537e-03],
        ...,
        [-9.6058e-04, -3.5478e-03,  2.8049e-03,  ...,  1.7616e-03,
         -8.6388e-04, -2.1442e-03],
        [-1.6225e-03, -1.1360e-03, -1.2262e-03,  ..., -1.0848e-03,
         -2.3375e-03,  3.1922e-03],
        [ 1.5011e-03,  1.8609e-03, -3.8563e-03,  ..., -3.1687e-03,
          8.5060e-04,  3.0799e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.8987e-03,  3.4306e-03,  2.0460e-03,  ..., -1.1203e-03,
          2.0156e-05, -1.8277e-03],
        [ 3.3121e-03,  1.1804e-03, -3.3479e-03,  ...,  1.4142e-03,
         -1.5633e-03, -2.7115e-03],
        [-2.4958e-03,  2.4078e-03, -9.6769e-04,  ..., -7.8264e-04,
         -2.9643e-03,  1.5537e-03],
        ...,
        [-9.6058e-04, -3.5478e-03,  2.8049e-03,  ...,  1.7616e-03,
         -8.6388e-04, -2.1442e-03],
        [-1.6225e-03, -1.1360e-03, -1.2262e-03,  ..., -1.0848e-03,
         -2.3375e-03,  3.1922e-03],
        [ 1.5011e-03,  1.8609e-03, -3.8563e-03,  ..., -3.1687e-03,
          8.5060e-04,  3.0799e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 4 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0
1
tensor([[ 2.8987e-03,  3.4306e-03,  2.0460e-03,  ..., -1.1203e-03,
          2.0156e-05, -1.8277e-03],
        [ 3.3121e-03,  1.1804e-03, -3.3479e-03,  ...,  1.4142e-03,
         -1.5633e-03, -2.7115e-03],
        [-2.4958e-03,  2.4078e-03, -9.6769e-04,  ..., -7.8264e-04,
         -2.9643e-03,  1.5537e-03],
        ...,
        [-9.6058e-04, -3.5478e-03,  2.8049e-03,  ...,  1.7616e-03,
         -8.6388e-04, -2.1442e-03],
        [-1.6225e-03, -1.1360e-03, -1.2262e-03,  ..., -1.0848e-03,
         -2.3375e-03,  3.1922e-03],
        [ 1.5011e-03,  1.8609e-03, -3.8563e-03,  ..., -3.1687e-03,
          8.5060e-04,  3.0799e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.8987e-03,  3.4306e-03,  2.0460e-03,  ..., -1.1203e-03,
          2.0156e-05, -1.8277e-03],
        [ 3.3121e-03,  1.1804e-03, -3.3479e-03,  ...,  1.4142e-03,
         -1.5633e-03, -2.7115e-03],
        [-2.4958e-03,  2.4078e-03, -9.6769e-04,  ..., -7.8264e-04,
         -2.9643e-03,  1.5537e-03],
        ...,
        [-9.6058e-04, -3.5478e-03,  2.8049e-03,  ...,  1.7616e-03,
         -8.6388e-04, -2.1442e-03],
        [-1.6225e-03, -1.1360e-03, -1.2262e-03,  ..., -1.0848e-03,
         -2.3375e-03,  3.1922e-03],
        [ 1.5011e-03,  1.8609e-03, -3.8563e-03,  ..., -3.1687e-03,
          8.5060e-04,  3.0799e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6415], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  168471 MB |  160887 MB |
|       from large pool |    7560 MB |    7565 MB |  168023 MB |  160463 MB |
|       from small pool |      24 MB |      26 MB |     448 MB |     423 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  168471 MB |  160887 MB |
|       from large pool |    7560 MB |    7565 MB |  168023 MB |  160463 MB |
|       from small pool |      24 MB |      26 MB |     448 MB |     423 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  189314 MB |  188699 MB |
|       from large pool |  626545 KB |  658091 KB |  188809 MB |  188197 MB |
|       from small pool |    3594 KB |   17027 KB |     505 MB |     501 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  265187    |  254602    |
|       from large pool |    4889    |    4892    |  106993    |  102104    |
|       from small pool |    5696    |    5707    |  158194    |  152498    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  265187    |  254602    |
|       from large pool |    4889    |    4892    |  106993    |  102104    |
|       from small pool |    5696    |    5707    |  158194    |  152498    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     425    |    1227    |  153993    |  153568    |
|       from large pool |     408    |     410    |   66247    |   65839    |
|       from small pool |      17    |     819    |   87746    |   87729    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  165618 MB |  158088 MB |
|       from large pool |    7514 MB |    7519 MB |  165192 MB |  157678 MB |
|       from small pool |      15 MB |      17 MB |     425 MB |     410 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  165618 MB |  158088 MB |
|       from large pool |    7514 MB |    7519 MB |  165192 MB |  157678 MB |
|       from small pool |      15 MB |      17 MB |     425 MB |     410 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  186427 MB |  185826 MB |
|       from large pool |  612147 KB |  655020 KB |  185869 MB |  185271 MB |
|       from small pool |    2365 KB |   15232 KB |     557 MB |     555 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  264832    |  254306    |
|       from large pool |    4859    |    4862    |  106915    |  102056    |
|       from small pool |    5667    |    5679    |  157917    |  152250    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  264832    |  254306    |
|       from large pool |    4859    |    4862    |  106915    |  102056    |
|       from small pool |    5667    |    5679    |  157917    |  152250    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  161441    |  161025    |
|       from large pool |     404    |     407    |   73191    |   72787    |
|       from small pool |      12    |     816    |   88250    |   88238    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01
Parameter containing:
tensor([[ 2.8995e-03,  3.4314e-03,  2.0467e-03,  ..., -1.1211e-03,
          1.9347e-05, -1.8285e-03],
        [ 3.3150e-03,  1.1832e-03, -3.3451e-03,  ...,  1.4113e-03,
         -1.5661e-03, -2.7144e-03],
        [-2.4867e-03,  2.4168e-03, -9.5872e-04,  ..., -7.9161e-04,
         -2.9732e-03,  1.5446e-03],
        ...,
        [-9.4589e-04, -3.5332e-03,  2.8195e-03,  ...,  1.7469e-03,
         -8.7853e-04, -2.1589e-03],
        [-1.6052e-03, -1.1188e-03, -1.2090e-03,  ..., -1.1020e-03,
         -2.3547e-03,  3.1747e-03],
        [ 1.2749e-03,  1.6348e-03, -4.0814e-03,  ..., -2.9436e-03,
          1.0764e-03,  3.3062e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.8995e-03,  3.4314e-03,  2.0467e-03,  ..., -1.1211e-03,
          1.9347e-05, -1.8285e-03],
        [ 3.3150e-03,  1.1832e-03, -3.3451e-03,  ...,  1.4113e-03,
         -1.5661e-03, -2.7144e-03],
        [-2.4867e-03,  2.4168e-03, -9.5872e-04,  ..., -7.9161e-04,
         -2.9732e-03,  1.5446e-03],
        ...,
        [-9.4589e-04, -3.5332e-03,  2.8195e-03,  ...,  1.7469e-03,
         -8.7853e-04, -2.1589e-03],
        [-1.6052e-03, -1.1188e-03, -1.2090e-03,  ..., -1.1020e-03,
         -2.3547e-03,  3.1747e-03],
        [ 1.2749e-03,  1.6348e-03, -4.0814e-03,  ..., -2.9436e-03,
          1.0764e-03,  3.3062e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 5 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  0Device:
 1
tensor([[ 2.8995e-03,  3.4314e-03,  2.0467e-03,  ..., -1.1211e-03,
          1.9347e-05, -1.8285e-03],
        [ 3.3150e-03,  1.1832e-03, -3.3451e-03,  ...,  1.4113e-03,
         -1.5661e-03, -2.7144e-03],
        [-2.4867e-03,  2.4168e-03, -9.5872e-04,  ..., -7.9161e-04,
         -2.9732e-03,  1.5446e-03],
        ...,
        [-9.4589e-04, -3.5332e-03,  2.8195e-03,  ...,  1.7469e-03,
         -8.7853e-04, -2.1589e-03],
        [-1.6052e-03, -1.1188e-03, -1.2090e-03,  ..., -1.1020e-03,
         -2.3547e-03,  3.1747e-03],
        [ 1.2749e-03,  1.6348e-03, -4.0814e-03,  ..., -2.9436e-03,
          1.0764e-03,  3.3062e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.8995e-03,  3.4314e-03,  2.0467e-03,  ..., -1.1211e-03,
          1.9347e-05, -1.8285e-03],
        [ 3.3150e-03,  1.1832e-03, -3.3451e-03,  ...,  1.4113e-03,
         -1.5661e-03, -2.7144e-03],
        [-2.4867e-03,  2.4168e-03, -9.5872e-04,  ..., -7.9161e-04,
         -2.9732e-03,  1.5446e-03],
        ...,
        [-9.4589e-04, -3.5332e-03,  2.8195e-03,  ...,  1.7469e-03,
         -8.7853e-04, -2.1589e-03],
        [-1.6052e-03, -1.1188e-03, -1.2090e-03,  ..., -1.1020e-03,
         -2.3547e-03,  3.1747e-03],
        [ 1.2749e-03,  1.6348e-03, -4.0814e-03,  ..., -2.9436e-03,
          1.0764e-03,  3.3062e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6405], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  221722 MB |  214137 MB |
|       from large pool |    7560 MB |    7565 MB |  221141 MB |  213580 MB |
|       from small pool |      24 MB |      26 MB |     581 MB |     556 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  221722 MB |  214137 MB |
|       from large pool |    7560 MB |    7565 MB |  221141 MB |  213580 MB |
|       from small pool |      24 MB |      26 MB |     581 MB |     556 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  249507 MB |  248892 MB |
|       from large pool |  626545 KB |  658091 KB |  248846 MB |  248234 MB |
|       from small pool |    3594 KB |   17027 KB |     661 MB |     657 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  347069    |  336484    |
|       from large pool |    4889    |    4892    |  141025    |  136136    |
|       from small pool |    5696    |    5707    |  206044    |  200348    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  347069    |  336484    |
|       from large pool |    4889    |    4892    |  141025    |  136136    |
|       from small pool |    5696    |    5707    |  206044    |  200348    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     426    |    1227    |  203689    |  203263    |
|       from large pool |     408    |     410    |   88120    |   87712    |
|       from small pool |      18    |     819    |  115569    |  115551    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  218302 MB |  210772 MB |
|       from large pool |    7514 MB |    7519 MB |  217747 MB |  210233 MB |
|       from small pool |      15 MB |      17 MB |     554 MB |     539 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  218302 MB |  210772 MB |
|       from large pool |    7514 MB |    7519 MB |  217747 MB |  210233 MB |
|       from small pool |      15 MB |      17 MB |     554 MB |     539 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  246051 MB |  245450 MB |
|       from large pool |  612147 KB |  655020 KB |  245325 MB |  244727 MB |
|       from small pool |    2365 KB |   15232 KB |     725 MB |     723 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  346621    |  336095    |
|       from large pool |    4859    |    4862    |  140931    |  136072    |
|       from small pool |    5667    |    5679    |  205690    |  200023    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  346621    |  336095    |
|       from large pool |    4859    |    4862    |  140931    |  136072    |
|       from small pool |    5667    |    5679    |  205690    |  200023    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  212997    |  212581    |
|       from large pool |     404    |     407    |   97462    |   97058    |
|       from small pool |      12    |     816    |  115535    |  115523    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807])batch input size:  Device:torch.Size([1, 807])  0Device:
 1
Parameter containing:
tensor([[ 2.9004e-03,  3.4323e-03,  2.0476e-03,  ..., -1.1220e-03,
          1.8438e-05, -1.8295e-03],
        [ 3.3174e-03,  1.1857e-03, -3.3427e-03,  ...,  1.4089e-03,
         -1.5685e-03, -2.7168e-03],
        [-2.4748e-03,  2.4288e-03, -9.4686e-04,  ..., -8.0348e-04,
         -2.9851e-03,  1.5326e-03],
        ...,
        [-9.3030e-04, -3.5177e-03,  2.8351e-03,  ...,  1.7313e-03,
         -8.9407e-04, -2.1744e-03],
        [-1.5859e-03, -1.0995e-03, -1.1898e-03,  ..., -1.1212e-03,
         -2.3739e-03,  3.1552e-03],
        [ 1.0638e-03,  1.4238e-03, -4.2916e-03,  ..., -2.7334e-03,
          1.2872e-03,  3.5174e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.9004e-03,  3.4323e-03,  2.0476e-03,  ..., -1.1220e-03,
          1.8438e-05, -1.8295e-03],
        [ 3.3174e-03,  1.1857e-03, -3.3427e-03,  ...,  1.4089e-03,
         -1.5685e-03, -2.7168e-03],
        [-2.4748e-03,  2.4288e-03, -9.4686e-04,  ..., -8.0348e-04,
         -2.9851e-03,  1.5326e-03],
        ...,
        [-9.3030e-04, -3.5177e-03,  2.8351e-03,  ...,  1.7313e-03,
         -8.9407e-04, -2.1744e-03],
        [-1.5859e-03, -1.0995e-03, -1.1898e-03,  ..., -1.1212e-03,
         -2.3739e-03,  3.1552e-03],
        [ 1.0638e-03,  1.4238e-03, -4.2916e-03,  ..., -2.7334e-03,
          1.2872e-03,  3.5174e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 6 / 10 ========
Training...
Step: 0
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
tensor([[ 2.9004e-03,  3.4323e-03,  2.0476e-03,  ..., -1.1220e-03,
          1.8438e-05, -1.8295e-03],
        [ 3.3174e-03,  1.1857e-03, -3.3427e-03,  ...,  1.4089e-03,
         -1.5685e-03, -2.7168e-03],
        [-2.4748e-03,  2.4288e-03, -9.4686e-04,  ..., -8.0348e-04,
         -2.9851e-03,  1.5326e-03],
        ...,
        [-9.3030e-04, -3.5177e-03,  2.8351e-03,  ...,  1.7313e-03,
         -8.9407e-04, -2.1744e-03],
        [-1.5859e-03, -1.0995e-03, -1.1898e-03,  ..., -1.1212e-03,
         -2.3739e-03,  3.1552e-03],
        [ 1.0638e-03,  1.4238e-03, -4.2916e-03,  ..., -2.7334e-03,
          1.2872e-03,  3.5174e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.9004e-03,  3.4323e-03,  2.0476e-03,  ..., -1.1220e-03,
          1.8438e-05, -1.8295e-03],
        [ 3.3174e-03,  1.1857e-03, -3.3427e-03,  ...,  1.4089e-03,
         -1.5685e-03, -2.7168e-03],
        [-2.4748e-03,  2.4288e-03, -9.4686e-04,  ..., -8.0348e-04,
         -2.9851e-03,  1.5326e-03],
        ...,
        [-9.3030e-04, -3.5177e-03,  2.8351e-03,  ...,  1.7313e-03,
         -8.9407e-04, -2.1744e-03],
        [-1.5859e-03, -1.0995e-03, -1.1898e-03,  ..., -1.1212e-03,
         -2.3739e-03,  3.1552e-03],
        [ 1.0638e-03,  1.4238e-03, -4.2916e-03,  ..., -2.7334e-03,
          1.2872e-03,  3.5174e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6396], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  274973 MB |  267388 MB |
|       from large pool |    7560 MB |    7565 MB |  274258 MB |  266698 MB |
|       from small pool |      24 MB |      26 MB |     714 MB |     690 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  274973 MB |  267388 MB |
|       from large pool |    7560 MB |    7565 MB |  274258 MB |  266698 MB |
|       from small pool |      24 MB |      26 MB |     714 MB |     690 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  309700 MB |  309084 MB |
|       from large pool |  626545 KB |  658091 KB |  308882 MB |  308270 MB |
|       from small pool |    3594 KB |   17027 KB |     817 MB |     814 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  428951    |  418366    |
|       from large pool |    4889    |    4892    |  175057    |  170168    |
|       from small pool |    5696    |    5707    |  253894    |  248198    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  428951    |  418366    |
|       from large pool |    4889    |    4892    |  175057    |  170168    |
|       from small pool |    5696    |    5707    |  253894    |  248198    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     426    |    1229    |  252514    |  252088    |
|       from large pool |     408    |     410    |  109993    |  109585    |
|       from small pool |      18    |     821    |  142521    |  142503    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  270986 MB |  263456 MB |
|       from large pool |    7514 MB |    7519 MB |  270302 MB |  262788 MB |
|       from small pool |      15 MB |      17 MB |     683 MB |     668 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  270986 MB |  263456 MB |
|       from large pool |    7514 MB |    7519 MB |  270302 MB |  262788 MB |
|       from small pool |      15 MB |      17 MB |     683 MB |     668 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  305675 MB |  305074 MB |
|       from large pool |  612147 KB |  655020 KB |  304781 MB |  304183 MB |
|       from small pool |    2365 KB |   15232 KB |     893 MB |     891 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  428410    |  417884    |
|       from large pool |    4859    |    4862    |  174947    |  170088    |
|       from small pool |    5667    |    5679    |  253463    |  247796    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  428410    |  417884    |
|       from large pool |    4859    |    4862    |  174947    |  170088    |
|       from small pool |    5667    |    5679    |  253463    |  247796    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  264553    |  264137    |
|       from large pool |     404    |     407    |  121733    |  121329    |
|       from small pool |      12    |     816    |  142820    |  142808    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807]) batch input size:Device:  torch.Size([1, 807])0
Device: 1
Parameter containing:
tensor([[ 2.9013e-03,  3.4332e-03,  2.0486e-03,  ..., -1.1229e-03,
          1.7493e-05, -1.8304e-03],
        [ 3.3195e-03,  1.1877e-03, -3.3407e-03,  ...,  1.4069e-03,
         -1.5706e-03, -2.7188e-03],
        [-2.4615e-03,  2.4422e-03, -9.3358e-04,  ..., -8.1676e-04,
         -2.9984e-03,  1.5191e-03],
        ...,
        [-9.1486e-04, -3.5024e-03,  2.8505e-03,  ...,  1.7159e-03,
         -9.0947e-04, -2.1899e-03],
        [-1.5661e-03, -1.0798e-03, -1.1702e-03,  ..., -1.1408e-03,
         -2.3936e-03,  3.1353e-03],
        [ 8.7656e-04,  1.2366e-03, -4.4782e-03,  ..., -2.5468e-03,
          1.4743e-03,  3.7048e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.9013e-03,  3.4332e-03,  2.0486e-03,  ..., -1.1229e-03,
          1.7493e-05, -1.8304e-03],
        [ 3.3195e-03,  1.1877e-03, -3.3407e-03,  ...,  1.4069e-03,
         -1.5706e-03, -2.7188e-03],
        [-2.4615e-03,  2.4422e-03, -9.3358e-04,  ..., -8.1676e-04,
         -2.9984e-03,  1.5191e-03],
        ...,
        [-9.1486e-04, -3.5024e-03,  2.8505e-03,  ...,  1.7159e-03,
         -9.0947e-04, -2.1899e-03],
        [-1.5661e-03, -1.0798e-03, -1.1702e-03,  ..., -1.1408e-03,
         -2.3936e-03,  3.1353e-03],
        [ 8.7656e-04,  1.2366e-03, -4.4782e-03,  ..., -2.5468e-03,
          1.4743e-03,  3.7048e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 7 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([1, 807])torch.Size([1, 807])  Device:Device:  01
tensor([[ 2.9013e-03,  3.4332e-03,  2.0486e-03,  ..., -1.1229e-03,
          1.7493e-05, -1.8304e-03],
        [ 3.3195e-03,  1.1877e-03, -3.3407e-03,  ...,  1.4069e-03,
         -1.5706e-03, -2.7188e-03],
        [-2.4615e-03,  2.4422e-03, -9.3358e-04,  ..., -8.1676e-04,
         -2.9984e-03,  1.5191e-03],
        ...,
        [-9.1486e-04, -3.5024e-03,  2.8505e-03,  ...,  1.7159e-03,
         -9.0947e-04, -2.1899e-03],
        [-1.5661e-03, -1.0798e-03, -1.1702e-03,  ..., -1.1408e-03,
         -2.3936e-03,  3.1353e-03],
        [ 8.7656e-04,  1.2366e-03, -4.4782e-03,  ..., -2.5468e-03,
          1.4743e-03,  3.7048e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.9013e-03,  3.4332e-03,  2.0486e-03,  ..., -1.1229e-03,
          1.7493e-05, -1.8304e-03],
        [ 3.3195e-03,  1.1877e-03, -3.3407e-03,  ...,  1.4069e-03,
         -1.5706e-03, -2.7188e-03],
        [-2.4615e-03,  2.4422e-03, -9.3358e-04,  ..., -8.1676e-04,
         -2.9984e-03,  1.5191e-03],
        ...,
        [-9.1486e-04, -3.5024e-03,  2.8505e-03,  ...,  1.7159e-03,
         -9.0947e-04, -2.1899e-03],
        [-1.5661e-03, -1.0798e-03, -1.1702e-03,  ..., -1.1408e-03,
         -2.3936e-03,  3.1353e-03],
        [ 8.7656e-04,  1.2366e-03, -4.4782e-03,  ..., -2.5468e-03,
          1.4743e-03,  3.7048e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6389], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  328224 MB |  320639 MB |
|       from large pool |    7560 MB |    7565 MB |  327376 MB |  319815 MB |
|       from small pool |      24 MB |      26 MB |     847 MB |     823 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  328224 MB |  320639 MB |
|       from large pool |    7560 MB |    7565 MB |  327376 MB |  319815 MB |
|       from small pool |      24 MB |      26 MB |     847 MB |     823 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  369892 MB |  369277 MB |
|       from large pool |  626545 KB |  658091 KB |  368919 MB |  368307 MB |
|       from small pool |    3594 KB |   17027 KB |     973 MB |     970 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  510833    |  500248    |
|       from large pool |    4889    |    4892    |  209089    |  204200    |
|       from small pool |    5696    |    5707    |  301744    |  296048    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  510833    |  500248    |
|       from large pool |    4889    |    4892    |  209089    |  204200    |
|       from small pool |    5696    |    5707    |  301744    |  296048    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     426    |    1229    |  301707    |  301281    |
|       from large pool |     408    |     410    |  131866    |  131458    |
|       from small pool |      18    |     821    |  169841    |  169823    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  323670 MB |  316140 MB |
|       from large pool |    7514 MB |    7519 MB |  322857 MB |  315343 MB |
|       from small pool |      15 MB |      17 MB |     812 MB |     796 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  323670 MB |  316140 MB |
|       from large pool |    7514 MB |    7519 MB |  322857 MB |  315343 MB |
|       from small pool |      15 MB |      17 MB |     812 MB |     796 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  365299 MB |  364698 MB |
|       from large pool |  612147 KB |  655020 KB |  364237 MB |  363639 MB |
|       from small pool |    2365 KB |   15232 KB |    1061 MB |    1059 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  510199    |  499673    |
|       from large pool |    4859    |    4862    |  208963    |  204104    |
|       from small pool |    5667    |    5679    |  301236    |  295569    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  510199    |  499673    |
|       from large pool |    4859    |    4862    |  208963    |  204104    |
|       from small pool |    5667    |    5679    |  301236    |  295569    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  316109    |  315693    |
|       from large pool |     404    |     407    |  146004    |  145600    |
|       from small pool |      12    |     816    |  170105    |  170093    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0batch input size:
 torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[ 2.9023e-03,  3.4342e-03,  2.0494e-03,  ..., -1.1238e-03,
          1.6583e-05, -1.8313e-03],
        [ 3.3211e-03,  1.1894e-03, -3.3391e-03,  ...,  1.4052e-03,
         -1.5722e-03, -2.7205e-03],
        [-2.4482e-03,  2.4556e-03, -9.2037e-04,  ..., -8.2998e-04,
         -3.0116e-03,  1.5057e-03],
        ...,
        [-9.0060e-04, -3.4882e-03,  2.8648e-03,  ...,  1.7017e-03,
         -9.2369e-04, -2.2041e-03],
        [-1.5475e-03, -1.0612e-03, -1.1517e-03,  ..., -1.1593e-03,
         -2.4121e-03,  3.1165e-03],
        [ 7.1928e-04,  1.0794e-03, -4.6350e-03,  ..., -2.3900e-03,
          1.6314e-03,  3.8621e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.9023e-03,  3.4342e-03,  2.0494e-03,  ..., -1.1238e-03,
          1.6583e-05, -1.8313e-03],
        [ 3.3211e-03,  1.1894e-03, -3.3391e-03,  ...,  1.4052e-03,
         -1.5722e-03, -2.7205e-03],
        [-2.4482e-03,  2.4556e-03, -9.2037e-04,  ..., -8.2998e-04,
         -3.0116e-03,  1.5057e-03],
        ...,
        [-9.0060e-04, -3.4882e-03,  2.8648e-03,  ...,  1.7017e-03,
         -9.2369e-04, -2.2041e-03],
        [-1.5475e-03, -1.0612e-03, -1.1517e-03,  ..., -1.1593e-03,
         -2.4121e-03,  3.1165e-03],
        [ 7.1928e-04,  1.0794e-03, -4.6350e-03,  ..., -2.3900e-03,
          1.6314e-03,  3.8621e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 8 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0
1
tensor([[ 2.9023e-03,  3.4342e-03,  2.0494e-03,  ..., -1.1238e-03,
          1.6583e-05, -1.8313e-03],
        [ 3.3211e-03,  1.1894e-03, -3.3391e-03,  ...,  1.4052e-03,
         -1.5722e-03, -2.7205e-03],
        [-2.4482e-03,  2.4556e-03, -9.2037e-04,  ..., -8.2998e-04,
         -3.0116e-03,  1.5057e-03],
        ...,
        [-9.0060e-04, -3.4882e-03,  2.8648e-03,  ...,  1.7017e-03,
         -9.2369e-04, -2.2041e-03],
        [-1.5475e-03, -1.0612e-03, -1.1517e-03,  ..., -1.1593e-03,
         -2.4121e-03,  3.1165e-03],
        [ 7.1928e-04,  1.0794e-03, -4.6350e-03,  ..., -2.3900e-03,
          1.6314e-03,  3.8621e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.9023e-03,  3.4342e-03,  2.0494e-03,  ..., -1.1238e-03,
          1.6583e-05, -1.8313e-03],
        [ 3.3211e-03,  1.1894e-03, -3.3391e-03,  ...,  1.4052e-03,
         -1.5722e-03, -2.7205e-03],
        [-2.4482e-03,  2.4556e-03, -9.2037e-04,  ..., -8.2998e-04,
         -3.0116e-03,  1.5057e-03],
        ...,
        [-9.0060e-04, -3.4882e-03,  2.8648e-03,  ...,  1.7017e-03,
         -9.2369e-04, -2.2041e-03],
        [-1.5475e-03, -1.0612e-03, -1.1517e-03,  ..., -1.1593e-03,
         -2.4121e-03,  3.1165e-03],
        [ 7.1928e-04,  1.0794e-03, -4.6350e-03,  ..., -2.3900e-03,
          1.6314e-03,  3.8621e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6383], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  381474 MB |  373890 MB |
|       from large pool |    7560 MB |    7565 MB |  380493 MB |  372933 MB |
|       from small pool |      24 MB |      26 MB |     981 MB |     956 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  381474 MB |  373890 MB |
|       from large pool |    7560 MB |    7565 MB |  380493 MB |  372933 MB |
|       from small pool |      24 MB |      26 MB |     981 MB |     956 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  430085 MB |  429470 MB |
|       from large pool |  626545 KB |  658091 KB |  428955 MB |  428343 MB |
|       from small pool |    3594 KB |   17027 KB |    1130 MB |    1126 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  592715    |  582130    |
|       from large pool |    4889    |    4892    |  243121    |  238232    |
|       from small pool |    5696    |    5707    |  349594    |  343898    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  592715    |  582130    |
|       from large pool |    4889    |    4892    |  243121    |  238232    |
|       from small pool |    5696    |    5707    |  349594    |  343898    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     426    |    1229    |  350055    |  349629    |
|       from large pool |     408    |     410    |  153739    |  153331    |
|       from small pool |      18    |     821    |  196316    |  196298    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  376353 MB |  368824 MB |
|       from large pool |    7514 MB |    7519 MB |  375412 MB |  367898 MB |
|       from small pool |      15 MB |      17 MB |     941 MB |     925 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  376353 MB |  368824 MB |
|       from large pool |    7514 MB |    7519 MB |  375412 MB |  367898 MB |
|       from small pool |      15 MB |      17 MB |     941 MB |     925 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  424922 MB |  424322 MB |
|       from large pool |  612147 KB |  655020 KB |  423693 MB |  423095 MB |
|       from small pool |    2365 KB |   15232 KB |    1229 MB |    1227 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  591988    |  581462    |
|       from large pool |    4859    |    4862    |  242979    |  238120    |
|       from small pool |    5667    |    5679    |  349009    |  343342    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  591988    |  581462    |
|       from large pool |    4859    |    4862    |  242979    |  238120    |
|       from small pool |    5667    |    5679    |  349009    |  343342    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  367665    |  367249    |
|       from large pool |     404    |     407    |  170275    |  169871    |
|       from small pool |      12    |     816    |  197390    |  197378    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: batch input size:0
torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[ 2.9031e-03,  3.4350e-03,  2.0502e-03,  ..., -1.1246e-03,
          1.5784e-05, -1.8321e-03],
        [ 3.3224e-03,  1.1906e-03, -3.3379e-03,  ...,  1.4040e-03,
         -1.5734e-03, -2.7217e-03],
        [-2.4364e-03,  2.4674e-03, -9.0863e-04,  ..., -8.4173e-04,
         -3.0233e-03,  1.4938e-03],
        ...,
        [-8.8856e-04, -3.4762e-03,  2.8768e-03,  ...,  1.6896e-03,
         -9.3570e-04, -2.2161e-03],
        [-1.5316e-03, -1.0453e-03, -1.1359e-03,  ..., -1.1752e-03,
         -2.4280e-03,  3.1005e-03],
        [ 5.9656e-04,  9.5675e-04, -4.7574e-03,  ..., -2.2676e-03,
          1.7540e-03,  3.9849e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.9031e-03,  3.4350e-03,  2.0502e-03,  ..., -1.1246e-03,
          1.5784e-05, -1.8321e-03],
        [ 3.3224e-03,  1.1906e-03, -3.3379e-03,  ...,  1.4040e-03,
         -1.5734e-03, -2.7217e-03],
        [-2.4364e-03,  2.4674e-03, -9.0863e-04,  ..., -8.4173e-04,
         -3.0233e-03,  1.4938e-03],
        ...,
        [-8.8856e-04, -3.4762e-03,  2.8768e-03,  ...,  1.6896e-03,
         -9.3570e-04, -2.2161e-03],
        [-1.5316e-03, -1.0453e-03, -1.1359e-03,  ..., -1.1752e-03,
         -2.4280e-03,  3.1005e-03],
        [ 5.9656e-04,  9.5675e-04, -4.7574e-03,  ..., -2.2676e-03,
          1.7540e-03,  3.9849e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 9 / 10 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([1, 807])  torch.Size([1, 807])Device:  Device:0
1
tensor([[ 2.9031e-03,  3.4350e-03,  2.0502e-03,  ..., -1.1246e-03,
          1.5784e-05, -1.8321e-03],
        [ 3.3224e-03,  1.1906e-03, -3.3379e-03,  ...,  1.4040e-03,
         -1.5734e-03, -2.7217e-03],
        [-2.4364e-03,  2.4674e-03, -9.0863e-04,  ..., -8.4173e-04,
         -3.0233e-03,  1.4938e-03],
        ...,
        [-8.8856e-04, -3.4762e-03,  2.8768e-03,  ...,  1.6896e-03,
         -9.3570e-04, -2.2161e-03],
        [-1.5316e-03, -1.0453e-03, -1.1359e-03,  ..., -1.1752e-03,
         -2.4280e-03,  3.1005e-03],
        [ 5.9656e-04,  9.5675e-04, -4.7574e-03,  ..., -2.2676e-03,
          1.7540e-03,  3.9849e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.9031e-03,  3.4350e-03,  2.0502e-03,  ..., -1.1246e-03,
          1.5784e-05, -1.8321e-03],
        [ 3.3224e-03,  1.1906e-03, -3.3379e-03,  ...,  1.4040e-03,
         -1.5734e-03, -2.7217e-03],
        [-2.4364e-03,  2.4674e-03, -9.0863e-04,  ..., -8.4173e-04,
         -3.0233e-03,  1.4938e-03],
        ...,
        [-8.8856e-04, -3.4762e-03,  2.8768e-03,  ...,  1.6896e-03,
         -9.3570e-04, -2.2161e-03],
        [-1.5316e-03, -1.0453e-03, -1.1359e-03,  ..., -1.1752e-03,
         -2.4280e-03,  3.1005e-03],
        [ 5.9656e-04,  9.5675e-04, -4.7574e-03,  ..., -2.2676e-03,
          1.7540e-03,  3.9849e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6379], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7584 MB |    7590 MB |  434725 MB |  427141 MB |
|       from large pool |    7560 MB |    7565 MB |  433611 MB |  426050 MB |
|       from small pool |      24 MB |      26 MB |    1114 MB |    1090 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7584 MB |    7590 MB |  434725 MB |  427141 MB |
|       from large pool |    7560 MB |    7565 MB |  433611 MB |  426050 MB |
|       from small pool |      24 MB |      26 MB |    1114 MB |    1090 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from large pool |    8172 MB |    8172 MB |    8172 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  630139 KB |  664576 KB |  490278 MB |  489663 MB |
|       from large pool |  626545 KB |  658091 KB |  488991 MB |  488380 MB |
|       from small pool |    3594 KB |   17027 KB |    1286 MB |    1282 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10585    |   10597    |  674597    |  664012    |
|       from large pool |    4889    |    4892    |  277153    |  272264    |
|       from small pool |    5696    |    5707    |  397444    |  391748    |
|---------------------------------------------------------------------------|
| Active allocs         |   10585    |   10597    |  674597    |  664012    |
|       from large pool |    4889    |    4892    |  277153    |  272264    |
|       from small pool |    5696    |    5707    |  397444    |  391748    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     423    |     423    |     423    |       0    |
|       from large pool |     409    |     409    |     409    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     426    |    1229    |  398888    |  398462    |
|       from large pool |     408    |     410    |  175612    |  175204    |
|       from small pool |      18    |     821    |  223276    |  223258    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7529 MB |    7536 MB |  429037 MB |  421508 MB |
|       from large pool |    7514 MB |    7519 MB |  427967 MB |  420453 MB |
|       from small pool |      15 MB |      17 MB |    1070 MB |    1054 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7529 MB |    7536 MB |  429037 MB |  421508 MB |
|       from large pool |    7514 MB |    7519 MB |  427967 MB |  420453 MB |
|       from small pool |      15 MB |      17 MB |    1070 MB |    1054 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  614512 KB |  659577 KB |  484546 MB |  483946 MB |
|       from large pool |  612147 KB |  655020 KB |  483148 MB |  482551 MB |
|       from small pool |    2365 KB |   15232 KB |    1397 MB |    1395 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10526    |   10539    |  673777    |  663251    |
|       from large pool |    4859    |    4862    |  276995    |  272136    |
|       from small pool |    5667    |    5679    |  396782    |  391115    |
|---------------------------------------------------------------------------|
| Active allocs         |   10526    |   10539    |  673777    |  663251    |
|       from large pool |    4859    |    4862    |  276995    |  272136    |
|       from small pool |    5667    |    5679    |  396782    |  391115    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     416    |    1220    |  419221    |  418805    |
|       from large pool |     404    |     407    |  194546    |  194142    |
|       from small pool |      12    |     816    |  224675    |  224663    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[ 2.9037e-03,  3.4356e-03,  2.0508e-03,  ..., -1.1252e-03,
          1.5178e-05, -1.8327e-03],
        [ 3.3232e-03,  1.1914e-03, -3.3371e-03,  ...,  1.4032e-03,
         -1.5743e-03, -2.7225e-03],
        [-2.4274e-03,  2.4765e-03, -8.9967e-04,  ..., -8.5069e-04,
         -3.0323e-03,  1.4848e-03],
        ...,
        [-8.7969e-04, -3.4674e-03,  2.8857e-03,  ...,  1.6808e-03,
         -9.4455e-04, -2.2250e-03],
        [-1.5198e-03, -1.0335e-03, -1.1241e-03,  ..., -1.1869e-03,
         -2.4398e-03,  3.0885e-03],
        [ 5.1200e-04,  8.7222e-04, -4.8417e-03,  ..., -2.1832e-03,
          1.8385e-03,  4.0695e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.9037e-03,  3.4356e-03,  2.0508e-03,  ..., -1.1252e-03,
          1.5178e-05, -1.8327e-03],
        [ 3.3232e-03,  1.1914e-03, -3.3371e-03,  ...,  1.4032e-03,
         -1.5743e-03, -2.7225e-03],
        [-2.4274e-03,  2.4765e-03, -8.9967e-04,  ..., -8.5069e-04,
         -3.0323e-03,  1.4848e-03],
        ...,
        [-8.7969e-04, -3.4674e-03,  2.8857e-03,  ...,  1.6808e-03,
         -9.4455e-04, -2.2250e-03],
        [-1.5198e-03, -1.0335e-03, -1.1241e-03,  ..., -1.1869e-03,
         -2.4398e-03,  3.0885e-03],
        [ 5.1200e-04,  8.7222e-04, -4.8417e-03,  ..., -2.1832e-03,
          1.8385e-03,  4.0695e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
======== Epoch 10 / 10 ========
Training...
Step: 0
batch input size: torch.Size([1, 807])batch input size:  Device:torch.Size([1, 807])  0Device: 1
tensor([[ 2.9037e-03,  3.4356e-03,  2.0508e-03,  ..., -1.1252e-03,
          1.5178e-05, -1.8327e-03],
        [ 3.3232e-03,  1.1914e-03, -3.3371e-03,  ...,  1.4032e-03,
         -1.5743e-03, -2.7225e-03],
        [-2.4274e-03,  2.4765e-03, -8.9967e-04,  ..., -8.5069e-04,
         -3.0323e-03,  1.4848e-03],
        ...,
        [-8.7969e-04, -3.4674e-03,  2.8857e-03,  ...,  1.6808e-03,
         -9.4455e-04, -2.2250e-03],
        [-1.5198e-03, -1.0335e-03, -1.1241e-03,  ..., -1.1869e-03,
         -2.4398e-03,  3.0885e-03],
        [ 5.1200e-04,  8.7222e-04, -4.8417e-03,  ..., -2.1832e-03,
          1.8385e-03,  4.0695e-03]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 2.9037e-03,  3.4356e-03,  2.0508e-03,  ..., -1.1252e-03,
          1.5178e-05, -1.8327e-03],
        [ 3.3232e-03,  1.1914e-03, -3.3371e-03,  ...,  1.4032e-03,
         -1.5743e-03, -2.7225e-03],
        [-2.4274e-03,  2.4765e-03, -8.9967e-04,  ..., -8.5069e-04,
         -3.0323e-03,  1.4848e-03],
        ...,
        [-8.7969e-04, -3.4674e-03,  2.8857e-03,  ...,  1.6808e-03,
         -9.4455e-04, -2.2250e-03],
        [-1.5198e-03, -1.0335e-03, -1.1241e-03,  ..., -1.1869e-03,
         -2.4398e-03,  3.0885e-03],
        [ 5.1200e-04,  8.7222e-04, -4.8417e-03,  ..., -2.1832e-03,
          1.8385e-03,  4.0695e-03]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
step loss: tensor([0.0009, 0.6376], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7600 MB |    7606 MB |  487991 MB |  480391 MB |
|       from large pool |    7575 MB |    7580 MB |  486743 MB |  479168 MB |
|       from small pool |      24 MB |      26 MB |    1247 MB |    1223 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7600 MB |    7606 MB |  487991 MB |  480391 MB |
|       from large pool |    7575 MB |    7580 MB |  486743 MB |  479168 MB |
|       from small pool |      24 MB |      26 MB |    1247 MB |    1223 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8220 MB |    8220 MB |    8220 MB |       0 B  |
|       from large pool |    8192 MB |    8192 MB |    8192 MB |       0 B  |
|       from small pool |      28 MB |      28 MB |      28 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  634789 KB |  664576 KB |  550462 MB |  549842 MB |
|       from large pool |  631220 KB |  658091 KB |  549029 MB |  548413 MB |
|       from small pool |    3569 KB |   17027 KB |    1432 MB |    1429 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10605    |   10617    |     756 K  |  745894    |
|       from large pool |    4899    |    4901    |     311 K  |  306296    |
|       from small pool |    5706    |    5717    |     445 K  |  439598    |
|---------------------------------------------------------------------------|
| Active allocs         |   10605    |   10617    |     756 K  |  745894    |
|       from large pool |    4899    |    4901    |     311 K  |  306296    |
|       from small pool |    5706    |    5717    |     445 K  |  439598    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     424    |     424    |     424    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     428    |    1229    |  446839    |  446411    |
|       from large pool |     409    |     410    |  197484    |  197075    |
|       from small pool |      19    |     821    |  249355    |  249336    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7544 MB |    7551 MB |  481736 MB |  474191 MB |
|       from large pool |    7528 MB |    7533 MB |  480537 MB |  473008 MB |
|       from small pool |      15 MB |      17 MB |    1199 MB |    1183 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7544 MB |    7551 MB |  481736 MB |  474191 MB |
|       from large pool |    7528 MB |    7533 MB |  480537 MB |  473008 MB |
|       from small pool |      15 MB |      17 MB |    1199 MB |    1183 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8150 MB |    8150 MB |    8150 MB |       0 B  |
|       from large pool |    8132 MB |    8132 MB |    8132 MB |       0 B  |
|       from small pool |      18 MB |      18 MB |      18 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  619824 KB |  659577 KB |  544160 MB |  543555 MB |
|       from large pool |  617484 KB |  655020 KB |  542608 MB |  542005 MB |
|       from small pool |    2340 KB |   15232 KB |    1552 MB |    1549 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10546    |   10559    |     755 K  |  745040    |
|       from large pool |    4869    |    4871    |     311 K  |  306152    |
|       from small pool |    5677    |    5689    |     444 K  |  438888    |
|---------------------------------------------------------------------------|
| Active allocs         |   10546    |   10559    |     755 K  |  745040    |
|       from large pool |    4869    |    4871    |     311 K  |  306152    |
|       from small pool |    5677    |    5689    |     444 K  |  438888    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     416    |     416    |     416    |       0    |
|       from large pool |     407    |     407    |     407    |       0    |
|       from small pool |       9    |       9    |       9    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     418    |    1220    |  470765    |  470347    |
|       from large pool |     406    |     407    |  218817    |  218411    |
|       from small pool |      12    |     816    |  251948    |  251936    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.32
batch input size: torch.Size([1, 807]) Device: 0
batch input size: torch.Size([1, 807]) Device: 1
Parameter containing:
tensor([[ 2.9041e-03,  3.4360e-03,  2.0512e-03,  ..., -1.1256e-03,
          1.4758e-05, -1.8331e-03],
        [ 3.3237e-03,  1.1919e-03, -3.3366e-03,  ...,  1.4027e-03,
         -1.5747e-03, -2.7230e-03],
        [-2.4214e-03,  2.4826e-03, -8.9367e-04,  ..., -8.5670e-04,
         -3.0383e-03,  1.4787e-03],
        ...,
        [-8.7395e-04, -3.4618e-03,  2.8914e-03,  ...,  1.6750e-03,
         -9.5027e-04, -2.2307e-03],
        [-1.5121e-03, -1.0259e-03, -1.1165e-03,  ..., -1.1946e-03,
         -2.4474e-03,  3.0808e-03],
        [ 4.6958e-04,  8.2981e-04, -4.8841e-03,  ..., -2.1408e-03,
          1.8809e-03,  4.1119e-03]], device='cuda:0', requires_grad=True)
tensor([[ 2.9041e-03,  3.4360e-03,  2.0512e-03,  ..., -1.1256e-03,
          1.4758e-05, -1.8331e-03],
        [ 3.3237e-03,  1.1919e-03, -3.3366e-03,  ...,  1.4027e-03,
         -1.5747e-03, -2.7230e-03],
        [-2.4214e-03,  2.4826e-03, -8.9367e-04,  ..., -8.5670e-04,
         -3.0383e-03,  1.4787e-03],
        ...,
        [-8.7395e-04, -3.4618e-03,  2.8914e-03,  ...,  1.6750e-03,
         -9.5027e-04, -2.2307e-03],
        [-1.5121e-03, -1.0259e-03, -1.1165e-03,  ..., -1.1946e-03,
         -2.4474e-03,  3.0808e-03],
        [ 4.6958e-04,  8.2981e-04, -4.8841e-03,  ..., -2.1408e-03,
          1.8809e-03,  4.1119e-03]], device='cuda:1')
torch.Size([807]) torch.Size([807])
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.36
Least Validation loss: 0.36185792088508606