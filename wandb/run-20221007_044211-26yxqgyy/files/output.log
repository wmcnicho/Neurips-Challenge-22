PermutedDKT
Number of questions:  807
Number of students:  4
Number of concepts: 636
Using batch size: 32
Using batch size: 32
/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_small.py:462: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(dataset_tensor[:, 1, :].clone().detach(), dtype=torch.long)
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   14885 KB |   14885 KB |   14885 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2241 KB |    2241 KB |    2241 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   14885 KB |   14885 KB |   14885 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2241 KB |    2241 KB |    2241 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   24576 KB |   24576 KB |   24576 KB |       0 B  |
|       from large pool |   20480 KB |   20480 KB |   20480 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    9691 KB |   19456 KB |   21504 KB |   11813 KB |
|       from large pool |    7836 KB |   18899 KB |   18899 KB |   11063 KB |
|       from small pool |    1855 KB |    1859 KB |    2605 KB |     750 KB |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       6    |       6    |       6    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Successfull in data prepration!
Successfully loaded the optimizer
======== Epoch 1 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   14923 KB |   14923 KB |   14923 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2279 KB |    2279 KB |    2279 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   14923 KB |   14923 KB |   14923 KB |       0 B  |
|       from large pool |   12644 KB |   12644 KB |   12644 KB |       0 B  |
|       from small pool |    2279 KB |    2279 KB |    2279 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   24576 KB |   24576 KB |   24576 KB |       0 B  |
|       from large pool |   20480 KB |   20480 KB |   20480 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    9653 KB |   19456 KB |   21504 KB |   11851 KB |
|       from large pool |    7836 KB |   18899 KB |   18899 KB |   11063 KB |
|       from small pool |    1817 KB |    1859 KB |    2605 KB |     788 KB |
|---------------------------------------------------------------------------|
| Allocations           |      16    |      16    |      16    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      16    |      16    |      16    |       0    |
|       from large pool |       8    |       8    |       8    |       0    |
|       from small pool |       8    |       8    |       8    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |       3    |       3    |       0    |
|       from large pool |       1    |       1    |       1    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8974e-03,  3.4293e-03,  2.0447e-03,  ..., -1.1190e-03,
          2.1467e-05, -1.8264e-03],
        [ 3.3009e-03,  1.1693e-03, -3.3589e-03,  ...,  1.4252e-03,
         -1.5523e-03, -2.7005e-03],
        [-2.4899e-03,  2.4137e-03, -9.6183e-04,  ..., -7.8851e-04,
         -2.9701e-03,  1.5478e-03],
        ...,
        [-9.8903e-04, -3.5760e-03,  2.7765e-03,  ...,  1.7900e-03,
         -8.3554e-04, -2.1159e-03],
        [-1.6458e-03, -1.1593e-03, -1.2494e-03,  ..., -1.0617e-03,
         -2.3143e-03,  3.2158e-03],
        [ 2.0415e-03,  2.4007e-03, -3.3205e-03,  ..., -3.7045e-03,
          3.1192e-04,  2.5392e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2253, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7575 MB |    7587 MB |    7662 MB |   88422 KB |
|       from large pool |    7532 MB |    7543 MB |    7553 MB |   21654 KB |
|       from small pool |      43 MB |      43 MB |     108 MB |   66768 KB |
|---------------------------------------------------------------------------|
| Active memory         |    7575 MB |    7587 MB |    7662 MB |   88422 KB |
|       from large pool |    7532 MB |    7543 MB |    7553 MB |   21654 KB |
|       from small pool |      43 MB |      43 MB |     108 MB |   66768 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8204 MB |    8204 MB |    8204 MB |       0 B  |
|       from large pool |    8160 MB |    8160 MB |    8160 MB |       0 B  |
|       from small pool |      44 MB |      44 MB |      44 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  643144 KB |  643144 KB |    7666 MB |    7037 MB |
|       from large pool |  642796 KB |  642796 KB |    7558 MB |    6930 MB |
|       from small pool |     348 KB |    2066 KB |     107 MB |     107 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10540    |   10551    |   19497    |    8957    |
|       from large pool |    4867    |    4870    |    4876    |       9    |
|       from small pool |    5673    |    5681    |   14621    |    8948    |
|---------------------------------------------------------------------------|
| Active allocs         |   10540    |   10551    |   19497    |    8957    |
|       from large pool |    4867    |    4870    |    4876    |       9    |
|       from small pool |    5673    |    5681    |   14621    |    8948    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     430    |     430    |     430    |       0    |
|       from large pool |     408    |     408    |     408    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     431    |     432    |    3724    |    3293    |
|       from large pool |     408    |     408    |     415    |       7    |
|       from small pool |      23    |      24    |    3309    |    3286    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   28709 KB |    7587 MB |   46798 MB |   46770 MB |
|       from large pool |   24188 KB |    7543 MB |   46551 MB |   46528 MB |
|       from small pool |    4520 KB |      43 MB |     247 MB |     242 MB |
|---------------------------------------------------------------------------|
| Active memory         |   28709 KB |    7587 MB |   46798 MB |   46770 MB |
|       from large pool |   24188 KB |    7543 MB |   46551 MB |   46528 MB |
|       from small pool |    4520 KB |      43 MB |     247 MB |     242 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8204 MB |    8204 MB |    8204 MB |       0 B  |
|       from large pool |    8160 MB |    8160 MB |    8160 MB |       0 B  |
|       from small pool |      44 MB |      44 MB |      44 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   40923 KB |  653633 KB |   53719 MB |   53679 MB |
|       from large pool |   37251 KB |  647064 KB |   53434 MB |   53397 MB |
|       from small pool |    3671 KB |   37521 KB |     284 MB |     281 MB |
|---------------------------------------------------------------------------|
| Allocations           |      30    |   10551    |   62355    |   62325    |
|       from large pool |      15    |    4870    |   29157    |   29142    |
|       from small pool |      15    |    5681    |   33198    |   33183    |
|---------------------------------------------------------------------------|
| Active allocs         |      30    |   10551    |   62355    |   62325    |
|       from large pool |      15    |    4870    |   29157    |   29142    |
|       from small pool |      15    |    5681    |   33198    |   33183    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     430    |     430    |     430    |       0    |
|       from large pool |     408    |     408    |     408    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      11    |    1234    |   41682    |   41671    |
|       from large pool |       6    |     409    |   19410    |   19404    |
|       from small pool |       5    |     827    |   22272    |   22267    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.23
Parameter containing:
tensor([[ 2.8974e-03,  3.4294e-03,  2.0448e-03,  ..., -1.1191e-03,
          2.1395e-05, -1.8265e-03],
        [ 3.3008e-03,  1.1691e-03, -3.3591e-03,  ...,  1.4254e-03,
         -1.5521e-03, -2.7004e-03],
        [-2.4920e-03,  2.4115e-03, -9.6395e-04,  ..., -7.8639e-04,
         -2.9680e-03,  1.5499e-03],
        ...,
        [-9.9058e-04, -3.5775e-03,  2.7749e-03,  ...,  1.7915e-03,
         -8.3398e-04, -2.1143e-03],
        [-1.6419e-03, -1.1554e-03, -1.2455e-03,  ..., -1.0655e-03,
         -2.3182e-03,  3.2118e-03],
        [ 2.0440e-03,  2.4032e-03, -3.3180e-03,  ..., -3.7069e-03,
          3.0943e-04,  2.5367e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 2 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7587 MB |   54751 MB |   54682 MB |
|       from large pool |   58959 KB |    7543 MB |   54453 MB |   54396 MB |
|       from small pool |   11257 KB |      43 MB |     297 MB |     286 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7587 MB |   54751 MB |   54682 MB |
|       from large pool |   58959 KB |    7543 MB |   54453 MB |   54396 MB |
|       from small pool |   11257 KB |      43 MB |     297 MB |     286 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8204 MB |    8204 MB |    8204 MB |       0 B  |
|       from large pool |    8160 MB |    8160 MB |    8160 MB |       0 B  |
|       from small pool |      44 MB |      44 MB |      44 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   28087 KB |  653633 KB |   75306 MB |   75278 MB |
|       from large pool |   22960 KB |  647064 KB |   74969 MB |   74947 MB |
|       from small pool |    5127 KB |   37521 KB |     336 MB |     331 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10551    |   81925    |   81852    |
|       from large pool |      37    |    4870    |   34058    |   34021    |
|       from small pool |      36    |    5681    |   47867    |   47831    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10551    |   81925    |   81852    |
|       from large pool |      37    |    4870    |   34058    |   34021    |
|       from small pool |      36    |    5681    |   47867    |   47831    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     430    |     430    |     430    |       0    |
|       from large pool |     408    |     408    |     408    |       0    |
|       from small pool |      22    |      22    |      22    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      14    |    1234    |   52370    |   52356    |
|       from large pool |       4    |     409    |   22656    |   22652    |
|       from small pool |      10    |     827    |   29714    |   29704    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8974e-03,  3.4294e-03,  2.0448e-03,  ..., -1.1191e-03,
          2.1395e-05, -1.8265e-03],
        [ 3.3008e-03,  1.1691e-03, -3.3591e-03,  ...,  1.4254e-03,
         -1.5521e-03, -2.7004e-03],
        [-2.4920e-03,  2.4115e-03, -9.6395e-04,  ..., -7.8639e-04,
         -2.9680e-03,  1.5499e-03],
        ...,
        [-9.9058e-04, -3.5775e-03,  2.7749e-03,  ...,  1.7915e-03,
         -8.3398e-04, -2.1143e-03],
        [-1.6419e-03, -1.1554e-03, -1.2455e-03,  ..., -1.0655e-03,
         -2.3182e-03,  3.2118e-03],
        [ 2.0440e-03,  2.4032e-03, -3.3180e-03,  ..., -3.7069e-03,
          3.0943e-04,  2.5367e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2248, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |   62398 MB |   54768 MB |
|       from large pool |    7577 MB |    7588 MB |   61994 MB |   54416 MB |
|       from small pool |      52 MB |      52 MB |     403 MB |     351 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |   62398 MB |   54768 MB |
|       from large pool |    7577 MB |    7588 MB |   61994 MB |   54416 MB |
|       from small pool |      52 MB |      52 MB |     403 MB |     351 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  653633 KB |   82917 MB |   82293 MB |
|       from large pool |  637358 KB |  647064 KB |   82478 MB |   81855 MB |
|       from small pool |    1610 KB |   37521 KB |     439 MB |     438 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  101406    |   90810    |
|       from large pool |    4896    |    4899    |   38926    |   34030    |
|       from small pool |    5700    |    5709    |   62480    |   56780    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  101406    |   90810    |
|       from large pool |    4896    |    4899    |   38926    |   34030    |
|       from small pool |    5700    |    5709    |   62480    |   56780    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     442    |    1234    |   56133    |   55691    |
|       from large pool |     410    |     410    |   23068    |   22658    |
|       from small pool |      32    |     827    |   33065    |   33033    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  100054 MB |   99985 MB |
|       from large pool |   58959 KB |    7588 MB |   99511 MB |   99454 MB |
|       from small pool |   11257 KB |      52 MB |     542 MB |     531 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  100054 MB |   99985 MB |
|       from large pool |   58959 KB |    7588 MB |   99511 MB |   99454 MB |
|       from small pool |   11257 KB |      52 MB |     542 MB |     531 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  127505 MB |  127476 MB |
|       from large pool |   22960 KB |  659485 KB |  126886 MB |  126864 MB |
|       from small pool |    7175 KB |   37521 KB |     619 MB |     612 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  144264    |  144191    |
|       from large pool |      37    |    4899    |   63207    |   63170    |
|       from small pool |      36    |    5709    |   81057    |   81021    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  144264    |  144191    |
|       from large pool |      37    |    4899    |   63207    |   63170    |
|       from small pool |      36    |    5709    |   81057    |   81021    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      15    |    1244    |   92771    |   92756    |
|       from large pool |       4    |     412    |   42460    |   42456    |
|       from small pool |      11    |     835    |   50311    |   50300    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.8976e-03,  3.4295e-03,  2.0449e-03,  ..., -1.1193e-03,
          2.1193e-05, -1.8267e-03],
        [ 3.3003e-03,  1.1686e-03, -3.3595e-03,  ...,  1.4259e-03,
         -1.5516e-03, -2.6998e-03],
        [-2.4895e-03,  2.4141e-03, -9.6142e-04,  ..., -7.8891e-04,
         -2.9705e-03,  1.5474e-03],
        ...,
        [-9.8901e-04, -3.5760e-03,  2.7764e-03,  ...,  1.7899e-03,
         -8.3554e-04, -2.1159e-03],
        [-1.6337e-03, -1.1472e-03, -1.2373e-03,  ..., -1.0737e-03,
         -2.3264e-03,  3.2035e-03],
        [ 2.0507e-03,  2.4099e-03, -3.3114e-03,  ..., -3.7135e-03,
          3.0274e-04,  2.5299e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 3 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  107631 MB |  107562 MB |
|       from large pool |   58959 KB |    7588 MB |  107045 MB |  106987 MB |
|       from small pool |   11257 KB |      52 MB |     585 MB |     574 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  107631 MB |  107562 MB |
|       from large pool |   58959 KB |    7588 MB |  107045 MB |  106987 MB |
|       from small pool |   11257 KB |      52 MB |     585 MB |     574 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  135082 MB |  135053 MB |
|       from large pool |   22960 KB |  659485 KB |  134420 MB |  134397 MB |
|       from small pool |    7175 KB |   37521 KB |     662 MB |     655 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  163794    |  163721    |
|       from large pool |      37    |    4899    |   68086    |   68049    |
|       from small pool |      36    |    5709    |   95708    |   95672    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  163794    |  163721    |
|       from large pool |      37    |    4899    |   68086    |   68049    |
|       from small pool |      36    |    5709    |   95708    |   95672    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1244    |  102274    |  102257    |
|       from large pool |       4    |     412    |   44091    |   44087    |
|       from small pool |      13    |     835    |   58183    |   58170    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8976e-03,  3.4295e-03,  2.0449e-03,  ..., -1.1193e-03,
          2.1193e-05, -1.8267e-03],
        [ 3.3003e-03,  1.1686e-03, -3.3595e-03,  ...,  1.4259e-03,
         -1.5516e-03, -2.6998e-03],
        [-2.4895e-03,  2.4141e-03, -9.6142e-04,  ..., -7.8891e-04,
         -2.9705e-03,  1.5474e-03],
        ...,
        [-9.8901e-04, -3.5760e-03,  2.7764e-03,  ...,  1.7899e-03,
         -8.3554e-04, -2.1159e-03],
        [-1.6337e-03, -1.1472e-03, -1.2373e-03,  ..., -1.0737e-03,
         -2.3264e-03,  3.2035e-03],
        [ 2.0507e-03,  2.4099e-03, -3.3114e-03,  ..., -3.7135e-03,
          3.0274e-04,  2.5299e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2243, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  115278 MB |  107648 MB |
|       from large pool |    7577 MB |    7588 MB |  114586 MB |  107008 MB |
|       from small pool |      52 MB |      52 MB |     692 MB |     640 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  115278 MB |  107648 MB |
|       from large pool |    7577 MB |    7588 MB |  114586 MB |  107008 MB |
|       from small pool |      52 MB |      52 MB |     692 MB |     640 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  142692 MB |  142068 MB |
|       from large pool |  637358 KB |  659485 KB |  141928 MB |  141306 MB |
|       from small pool |    1610 KB |   37521 KB |     763 MB |     762 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  183275    |  172679    |
|       from large pool |    4896    |    4899    |   72954    |   68058    |
|       from small pool |    5700    |    5709    |  110321    |  104621    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  183275    |  172679    |
|       from large pool |    4896    |    4899    |   72954    |   68058    |
|       from small pool |    5700    |    5709    |  110321    |  104621    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     441    |    1244    |  108051    |  107610    |
|       from large pool |     410    |     412    |   44503    |   44093    |
|       from small pool |      31    |     835    |   63548    |   63517    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  152934 MB |  152865 MB |
|       from large pool |   58959 KB |    7588 MB |  152103 MB |  152046 MB |
|       from small pool |   11257 KB |      52 MB |     830 MB |     819 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  152934 MB |  152865 MB |
|       from large pool |   58959 KB |    7588 MB |  152103 MB |  152046 MB |
|       from small pool |   11257 KB |      52 MB |     830 MB |     819 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  187280 MB |  187250 MB |
|       from large pool |   22960 KB |  659485 KB |  186336 MB |  186314 MB |
|       from small pool |    7175 KB |   37521 KB |     943 MB |     936 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  226133    |  226060    |
|       from large pool |      37    |    4899    |   97235    |   97198    |
|       from small pool |      36    |    5709    |  128898    |  128862    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  226133    |  226060    |
|       from large pool |      37    |    4899    |   97235    |   97198    |
|       from small pool |      36    |    5709    |  128898    |  128862    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1244    |  146514    |  146497    |
|       from large pool |       4    |     412    |   63896    |   63892    |
|       from small pool |      13    |     835    |   82618    |   82605    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.8979e-03,  3.4298e-03,  2.0452e-03,  ..., -1.1196e-03,
          2.0886e-05, -1.8270e-03],
        [ 3.2995e-03,  1.1679e-03, -3.3603e-03,  ...,  1.4266e-03,
         -1.5508e-03, -2.6991e-03],
        [-2.4834e-03,  2.4202e-03, -9.5533e-04,  ..., -7.9500e-04,
         -2.9766e-03,  1.5412e-03],
        ...,
        [-9.8500e-04, -3.5720e-03,  2.7804e-03,  ...,  1.7859e-03,
         -8.3953e-04, -2.1199e-03],
        [-1.6223e-03, -1.1358e-03, -1.2260e-03,  ..., -1.0851e-03,
         -2.3377e-03,  3.1920e-03],
        [ 2.0606e-03,  2.4197e-03, -3.3016e-03,  ..., -3.7233e-03,
          2.9288e-04,  2.5200e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 4 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  160511 MB |  160442 MB |
|       from large pool |   58959 KB |    7588 MB |  159637 MB |  159579 MB |
|       from small pool |   11257 KB |      52 MB |     874 MB |     863 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  160511 MB |  160442 MB |
|       from large pool |   58959 KB |    7588 MB |  159637 MB |  159579 MB |
|       from small pool |   11257 KB |      52 MB |     874 MB |     863 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  194857 MB |  194828 MB |
|       from large pool |   22960 KB |  659485 KB |  193870 MB |  193848 MB |
|       from small pool |    7175 KB |   37521 KB |     987 MB |     980 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  245663    |  245590    |
|       from large pool |      37    |    4899    |  102114    |  102077    |
|       from small pool |      36    |    5709    |  143549    |  143513    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  245663    |  245590    |
|       from large pool |      37    |    4899    |  102114    |  102077    |
|       from small pool |      36    |    5709    |  143549    |  143513    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1244    |  156270    |  156253    |
|       from large pool |       4    |     412    |   65527    |   65523    |
|       from small pool |      13    |     835    |   90743    |   90730    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8979e-03,  3.4298e-03,  2.0452e-03,  ..., -1.1196e-03,
          2.0886e-05, -1.8270e-03],
        [ 3.2995e-03,  1.1679e-03, -3.3603e-03,  ...,  1.4266e-03,
         -1.5508e-03, -2.6991e-03],
        [-2.4834e-03,  2.4202e-03, -9.5533e-04,  ..., -7.9500e-04,
         -2.9766e-03,  1.5412e-03],
        ...,
        [-9.8500e-04, -3.5720e-03,  2.7804e-03,  ...,  1.7859e-03,
         -8.3953e-04, -2.1199e-03],
        [-1.6223e-03, -1.1358e-03, -1.2260e-03,  ..., -1.0851e-03,
         -2.3377e-03,  3.1920e-03],
        [ 2.0606e-03,  2.4197e-03, -3.3016e-03,  ..., -3.7233e-03,
          2.9288e-04,  2.5200e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2239, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  168158 MB |  160528 MB |
|       from large pool |    7577 MB |    7588 MB |  167177 MB |  159600 MB |
|       from small pool |      52 MB |      52 MB |     980 MB |     928 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  168158 MB |  160528 MB |
|       from large pool |    7577 MB |    7588 MB |  167177 MB |  159600 MB |
|       from small pool |      52 MB |      52 MB |     980 MB |     928 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  202467 MB |  201843 MB |
|       from large pool |  637358 KB |  659485 KB |  201378 MB |  200756 MB |
|       from small pool |    1610 KB |   37521 KB |    1088 MB |    1086 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  265144    |  254548    |
|       from large pool |    4896    |    4899    |  106982    |  102086    |
|       from small pool |    5700    |    5709    |  158162    |  152462    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  265144    |  254548    |
|       from large pool |    4896    |    4899    |  106982    |  102086    |
|       from small pool |    5700    |    5709    |  158162    |  152462    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     441    |    1244    |  162088    |  161647    |
|       from large pool |     410    |     412    |   65939    |   65529    |
|       from small pool |      31    |     835    |   96149    |   96118    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  205814 MB |  205745 MB |
|       from large pool |   58959 KB |    7588 MB |  204695 MB |  204637 MB |
|       from small pool |   11257 KB |      52 MB |    1119 MB |    1108 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  205814 MB |  205745 MB |
|       from large pool |   58959 KB |    7588 MB |  204695 MB |  204637 MB |
|       from small pool |   11257 KB |      52 MB |    1119 MB |    1108 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  247055 MB |  247025 MB |
|       from large pool |   22960 KB |  659485 KB |  245787 MB |  245764 MB |
|       from small pool |    7175 KB |   37521 KB |    1267 MB |    1260 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  308002    |  307929    |
|       from large pool |      37    |    4899    |  131263    |  131226    |
|       from small pool |      36    |    5709    |  176739    |  176703    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  308002    |  307929    |
|       from large pool |      37    |    4899    |  131263    |  131226    |
|       from small pool |      36    |    5709    |  176739    |  176703    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1244    |  200290    |  200273    |
|       from large pool |       4    |     412    |   85332    |   85328    |
|       from small pool |      13    |     835    |  114958    |  114945    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.8983e-03,  3.4302e-03,  2.0456e-03,  ..., -1.1200e-03,
          2.0499e-05, -1.8274e-03],
        [ 3.2985e-03,  1.1669e-03, -3.3612e-03,  ...,  1.4276e-03,
         -1.5499e-03, -2.6981e-03],
        [-2.4747e-03,  2.4289e-03, -9.4670e-04,  ..., -8.0364e-04,
         -2.9852e-03,  1.5324e-03],
        ...,
        [-9.7923e-04, -3.5662e-03,  2.7862e-03,  ...,  1.7802e-03,
         -8.4528e-04, -2.1256e-03],
        [-1.6087e-03, -1.1223e-03, -1.2125e-03,  ..., -1.0985e-03,
         -2.3512e-03,  3.1783e-03],
        [ 2.0727e-03,  2.4318e-03, -3.2897e-03,  ..., -3.7351e-03,
          2.8088e-04,  2.5079e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 5 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  213391 MB |  213323 MB |
|       from large pool |   58959 KB |    7588 MB |  212228 MB |  212171 MB |
|       from small pool |   11257 KB |      52 MB |    1162 MB |    1151 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  213391 MB |  213323 MB |
|       from large pool |   58959 KB |    7588 MB |  212228 MB |  212171 MB |
|       from small pool |   11257 KB |      52 MB |    1162 MB |    1151 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  254632 MB |  254603 MB |
|       from large pool |   22960 KB |  659485 KB |  253320 MB |  253298 MB |
|       from small pool |    7175 KB |   37521 KB |    1311 MB |    1304 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  327532    |  327459    |
|       from large pool |      37    |    4899    |  136142    |  136105    |
|       from small pool |      36    |    5709    |  191390    |  191354    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  327532    |  327459    |
|       from large pool |      37    |    4899    |  136142    |  136105    |
|       from small pool |      36    |    5709    |  191390    |  191354    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |    1244    |  210040    |  210024    |
|       from large pool |       4    |     412    |   86963    |   86959    |
|       from small pool |      12    |     835    |  123077    |  123065    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8983e-03,  3.4302e-03,  2.0456e-03,  ..., -1.1200e-03,
          2.0499e-05, -1.8274e-03],
        [ 3.2985e-03,  1.1669e-03, -3.3612e-03,  ...,  1.4276e-03,
         -1.5499e-03, -2.6981e-03],
        [-2.4747e-03,  2.4289e-03, -9.4670e-04,  ..., -8.0364e-04,
         -2.9852e-03,  1.5324e-03],
        ...,
        [-9.7923e-04, -3.5662e-03,  2.7862e-03,  ...,  1.7802e-03,
         -8.4528e-04, -2.1256e-03],
        [-1.6087e-03, -1.1223e-03, -1.2125e-03,  ..., -1.0985e-03,
         -2.3512e-03,  3.1783e-03],
        [ 2.0727e-03,  2.4318e-03, -3.2897e-03,  ..., -3.7351e-03,
          2.8088e-04,  2.5079e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2236, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  221039 MB |  213409 MB |
|       from large pool |    7577 MB |    7588 MB |  219769 MB |  212192 MB |
|       from small pool |      52 MB |      52 MB |    1269 MB |    1217 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  221039 MB |  213409 MB |
|       from large pool |    7577 MB |    7588 MB |  219769 MB |  212192 MB |
|       from small pool |      52 MB |      52 MB |    1269 MB |    1217 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  262242 MB |  261618 MB |
|       from large pool |  637358 KB |  659485 KB |  260829 MB |  260206 MB |
|       from small pool |    1610 KB |   37521 KB |    1412 MB |    1411 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  347013    |  336417    |
|       from large pool |    4896    |    4899    |  141010    |  136114    |
|       from small pool |    5700    |    5709    |  206003    |  200303    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  347013    |  336417    |
|       from large pool |    4896    |    4899    |  141010    |  136114    |
|       from small pool |    5700    |    5709    |  206003    |  200303    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     441    |    1244    |  215817    |  215376    |
|       from large pool |     410    |     412    |   87375    |   86965    |
|       from small pool |      31    |     835    |  128442    |  128411    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  258694 MB |  258626 MB |
|       from large pool |   58959 KB |    7588 MB |  257287 MB |  257229 MB |
|       from small pool |   11257 KB |      52 MB |    1407 MB |    1396 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  258694 MB |  258626 MB |
|       from large pool |   58959 KB |    7588 MB |  257287 MB |  257229 MB |
|       from small pool |   11257 KB |      52 MB |    1407 MB |    1396 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  306830 MB |  306800 MB |
|       from large pool |   22960 KB |  659485 KB |  305237 MB |  305215 MB |
|       from small pool |    7175 KB |   37521 KB |    1592 MB |    1585 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  389871    |  389798    |
|       from large pool |      37    |    4899    |  165291    |  165254    |
|       from small pool |      36    |    5709    |  224580    |  224544    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  389871    |  389798    |
|       from large pool |      37    |    4899    |  165291    |  165254    |
|       from small pool |      36    |    5709    |  224580    |  224544    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      16    |    1244    |  254280    |  254264    |
|       from large pool |       4    |     412    |  106768    |  106764    |
|       from small pool |      12    |     835    |  147512    |  147500    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.8987e-03,  3.4307e-03,  2.0461e-03,  ..., -1.1204e-03,
          2.0058e-05, -1.8278e-03],
        [ 3.2975e-03,  1.1659e-03, -3.3622e-03,  ...,  1.4286e-03,
         -1.5489e-03, -2.6971e-03],
        [-2.4645e-03,  2.4392e-03, -9.3651e-04,  ..., -8.1383e-04,
         -2.9954e-03,  1.5221e-03],
        ...,
        [-9.7235e-04, -3.5594e-03,  2.7931e-03,  ...,  1.7733e-03,
         -8.5213e-04, -2.1325e-03],
        [-1.5941e-03, -1.1077e-03, -1.1979e-03,  ..., -1.1131e-03,
         -2.3658e-03,  3.1635e-03],
        [ 2.0859e-03,  2.4450e-03, -3.2767e-03,  ..., -3.7481e-03,
          2.6773e-04,  2.4947e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 6 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  266272 MB |  266203 MB |
|       from large pool |   58959 KB |    7588 MB |  264820 MB |  264763 MB |
|       from small pool |   11257 KB |      52 MB |    1451 MB |    1440 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  266272 MB |  266203 MB |
|       from large pool |   58959 KB |    7588 MB |  264820 MB |  264763 MB |
|       from small pool |   11257 KB |      52 MB |    1451 MB |    1440 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  314407 MB |  314377 MB |
|       from large pool |   22960 KB |  659485 KB |  312771 MB |  312748 MB |
|       from small pool |    7175 KB |   37521 KB |    1636 MB |    1629 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  409401    |  409328    |
|       from large pool |      37    |    4899    |  170170    |  170133    |
|       from small pool |      36    |    5709    |  239231    |  239195    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  409401    |  409328    |
|       from large pool |      37    |    4899    |  170170    |  170133    |
|       from small pool |      36    |    5709    |  239231    |  239195    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1244    |  263787    |  263770    |
|       from large pool |       4    |     412    |  108399    |  108395    |
|       from small pool |      13    |     835    |  155388    |  155375    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8987e-03,  3.4307e-03,  2.0461e-03,  ..., -1.1204e-03,
          2.0058e-05, -1.8278e-03],
        [ 3.2975e-03,  1.1659e-03, -3.3622e-03,  ...,  1.4286e-03,
         -1.5489e-03, -2.6971e-03],
        [-2.4645e-03,  2.4392e-03, -9.3651e-04,  ..., -8.1383e-04,
         -2.9954e-03,  1.5221e-03],
        ...,
        [-9.7235e-04, -3.5594e-03,  2.7931e-03,  ...,  1.7733e-03,
         -8.5213e-04, -2.1325e-03],
        [-1.5941e-03, -1.1077e-03, -1.1979e-03,  ..., -1.1131e-03,
         -2.3658e-03,  3.1635e-03],
        [ 2.0859e-03,  2.4450e-03, -3.2767e-03,  ..., -3.7481e-03,
          2.6773e-04,  2.4947e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2232, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  273919 MB |  266289 MB |
|       from large pool |    7577 MB |    7588 MB |  272361 MB |  264783 MB |
|       from small pool |      52 MB |      52 MB |    1557 MB |    1505 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  273919 MB |  266289 MB |
|       from large pool |    7577 MB |    7588 MB |  272361 MB |  264783 MB |
|       from small pool |      52 MB |      52 MB |    1557 MB |    1505 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  322016 MB |  321392 MB |
|       from large pool |  637358 KB |  659485 KB |  320279 MB |  319657 MB |
|       from small pool |    1610 KB |   37521 KB |    1737 MB |    1735 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  428882    |  418286    |
|       from large pool |    4896    |    4899    |  175038    |  170142    |
|       from small pool |    5700    |    5709    |  253844    |  248144    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  428882    |  418286    |
|       from large pool |    4896    |    4899    |  175038    |  170142    |
|       from small pool |    5700    |    5709    |  253844    |  248144    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     443    |    1244    |  269606    |  269163    |
|       from large pool |     410    |     412    |  108811    |  108401    |
|       from small pool |      33    |     835    |  160795    |  160762    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  311575 MB |  311506 MB |
|       from large pool |   58959 KB |    7588 MB |  309878 MB |  309821 MB |
|       from small pool |   11257 KB |      52 MB |    1696 MB |    1685 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  311575 MB |  311506 MB |
|       from large pool |   58959 KB |    7588 MB |  309878 MB |  309821 MB |
|       from small pool |   11257 KB |      52 MB |    1696 MB |    1685 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  366604 MB |  366575 MB |
|       from large pool |   22960 KB |  659485 KB |  364688 MB |  364665 MB |
|       from small pool |    7175 KB |   37521 KB |    1916 MB |    1909 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  471740    |  471667    |
|       from large pool |      37    |    4899    |  199319    |  199282    |
|       from small pool |      36    |    5709    |  272421    |  272385    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  471740    |  471667    |
|       from large pool |      37    |    4899    |  199319    |  199282    |
|       from small pool |      36    |    5709    |  272421    |  272385    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  307820    |  307803    |
|       from large pool |       4    |     412    |  128204    |  128200    |
|       from small pool |      13    |     838    |  179616    |  179603    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.8992e-03,  3.4311e-03,  2.0465e-03,  ..., -1.1208e-03,
          1.9598e-05, -1.8283e-03],
        [ 3.2964e-03,  1.1648e-03, -3.3633e-03,  ...,  1.4297e-03,
         -1.5478e-03, -2.6960e-03],
        [-2.4537e-03,  2.4501e-03, -9.2575e-04,  ..., -8.2459e-04,
         -3.0061e-03,  1.5113e-03],
        ...,
        [-9.6504e-04, -3.5522e-03,  2.8004e-03,  ...,  1.7660e-03,
         -8.5941e-04, -2.1397e-03],
        [-1.5794e-03, -1.0931e-03, -1.1834e-03,  ..., -1.1276e-03,
         -2.3804e-03,  3.1487e-03],
        [ 2.0993e-03,  2.4583e-03, -3.2635e-03,  ..., -3.7612e-03,
          2.5445e-04,  2.4813e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 7 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  319152 MB |  319083 MB |
|       from large pool |   58959 KB |    7588 MB |  317412 MB |  317354 MB |
|       from small pool |   11257 KB |      52 MB |    1739 MB |    1728 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  319152 MB |  319083 MB |
|       from large pool |   58959 KB |    7588 MB |  317412 MB |  317354 MB |
|       from small pool |   11257 KB |      52 MB |    1739 MB |    1728 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  374182 MB |  374152 MB |
|       from large pool |   22960 KB |  659485 KB |  372221 MB |  372199 MB |
|       from small pool |    7175 KB |   37521 KB |    1960 MB |    1953 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  491270    |  491197    |
|       from large pool |      37    |    4899    |  204198    |  204161    |
|       from small pool |      36    |    5709    |  287072    |  287036    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  491270    |  491197    |
|       from large pool |      37    |    4899    |  204198    |  204161    |
|       from small pool |      36    |    5709    |  287072    |  287036    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  317577    |  317560    |
|       from large pool |       4    |     412    |  129835    |  129831    |
|       from small pool |      13    |     838    |  187742    |  187729    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8992e-03,  3.4311e-03,  2.0465e-03,  ..., -1.1208e-03,
          1.9598e-05, -1.8283e-03],
        [ 3.2964e-03,  1.1648e-03, -3.3633e-03,  ...,  1.4297e-03,
         -1.5478e-03, -2.6960e-03],
        [-2.4537e-03,  2.4501e-03, -9.2575e-04,  ..., -8.2459e-04,
         -3.0061e-03,  1.5113e-03],
        ...,
        [-9.6504e-04, -3.5522e-03,  2.8004e-03,  ...,  1.7660e-03,
         -8.5941e-04, -2.1397e-03],
        [-1.5794e-03, -1.0931e-03, -1.1834e-03,  ..., -1.1276e-03,
         -2.3804e-03,  3.1487e-03],
        [ 2.0993e-03,  2.4583e-03, -3.2635e-03,  ..., -3.7612e-03,
          2.5445e-04,  2.4813e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2230, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  326799 MB |  319169 MB |
|       from large pool |    7577 MB |    7588 MB |  324953 MB |  317375 MB |
|       from small pool |      52 MB |      52 MB |    1846 MB |    1793 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  326799 MB |  319169 MB |
|       from large pool |    7577 MB |    7588 MB |  324953 MB |  317375 MB |
|       from small pool |      52 MB |      52 MB |    1846 MB |    1793 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  381791 MB |  381167 MB |
|       from large pool |  637358 KB |  659485 KB |  379730 MB |  379107 MB |
|       from small pool |    1610 KB |   37521 KB |    2061 MB |    2059 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  510751    |  500155    |
|       from large pool |    4896    |    4899    |  209066    |  204170    |
|       from small pool |    5700    |    5709    |  301685    |  295985    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  510751    |  500155    |
|       from large pool |    4896    |    4899    |  209066    |  204170    |
|       from small pool |    5700    |    5709    |  301685    |  295985    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     441    |    1247    |  323354    |  322913    |
|       from large pool |     410    |     412    |  130247    |  129837    |
|       from small pool |      31    |     838    |  193107    |  193076    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  364455 MB |  364386 MB |
|       from large pool |   58959 KB |    7588 MB |  362470 MB |  362413 MB |
|       from small pool |   11257 KB |      52 MB |    1984 MB |    1973 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  364455 MB |  364386 MB |
|       from large pool |   58959 KB |    7588 MB |  362470 MB |  362413 MB |
|       from small pool |   11257 KB |      52 MB |    1984 MB |    1973 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  426379 MB |  426350 MB |
|       from large pool |   22960 KB |  659485 KB |  424138 MB |  424116 MB |
|       from small pool |    7175 KB |   37521 KB |    2240 MB |    2233 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  553609    |  553536    |
|       from large pool |      37    |    4899    |  233347    |  233310    |
|       from small pool |      36    |    5709    |  320262    |  320226    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  553609    |  553536    |
|       from large pool |      37    |    4899    |  233347    |  233310    |
|       from small pool |      36    |    5709    |  320262    |  320226    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  361817    |  361800    |
|       from large pool |       4    |     412    |  149640    |  149636    |
|       from small pool |      13    |     838    |  212177    |  212164    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.8996e-03,  3.4315e-03,  2.0469e-03,  ..., -1.1213e-03,
          1.9152e-05, -1.8287e-03],
        [ 3.2954e-03,  1.1638e-03, -3.3642e-03,  ...,  1.4307e-03,
         -1.5468e-03, -2.6950e-03],
        [-2.4433e-03,  2.4605e-03, -9.1541e-04,  ..., -8.3493e-04,
         -3.0165e-03,  1.5008e-03],
        ...,
        [-9.5797e-04, -3.5451e-03,  2.8074e-03,  ...,  1.7589e-03,
         -8.6647e-04, -2.1468e-03],
        [-1.5658e-03, -1.0795e-03, -1.1699e-03,  ..., -1.1412e-03,
         -2.3939e-03,  3.1350e-03],
        [ 2.1118e-03,  2.4708e-03, -3.2512e-03,  ..., -3.7735e-03,
          2.4203e-04,  2.4688e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 8 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  372032 MB |  371963 MB |
|       from large pool |   58959 KB |    7588 MB |  370004 MB |  369946 MB |
|       from small pool |   11257 KB |      52 MB |    2028 MB |    2017 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  372032 MB |  371963 MB |
|       from large pool |   58959 KB |    7588 MB |  370004 MB |  369946 MB |
|       from small pool |   11257 KB |      52 MB |    2028 MB |    2017 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  433957 MB |  433927 MB |
|       from large pool |   22960 KB |  659485 KB |  431672 MB |  431649 MB |
|       from small pool |    7175 KB |   37521 KB |    2284 MB |    2277 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  573139    |  573066    |
|       from large pool |      37    |    4899    |  238226    |  238189    |
|       from small pool |      36    |    5709    |  334913    |  334877    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  573139    |  573066    |
|       from large pool |      37    |    4899    |  238226    |  238189    |
|       from small pool |      36    |    5709    |  334913    |  334877    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  371572    |  371555    |
|       from large pool |       4    |     412    |  151271    |  151267    |
|       from small pool |      13    |     838    |  220301    |  220288    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.8996e-03,  3.4315e-03,  2.0469e-03,  ..., -1.1213e-03,
          1.9152e-05, -1.8287e-03],
        [ 3.2954e-03,  1.1638e-03, -3.3642e-03,  ...,  1.4307e-03,
         -1.5468e-03, -2.6950e-03],
        [-2.4433e-03,  2.4605e-03, -9.1541e-04,  ..., -8.3493e-04,
         -3.0165e-03,  1.5008e-03],
        ...,
        [-9.5797e-04, -3.5451e-03,  2.8074e-03,  ...,  1.7589e-03,
         -8.6647e-04, -2.1468e-03],
        [-1.5658e-03, -1.0795e-03, -1.1699e-03,  ..., -1.1412e-03,
         -2.3939e-03,  3.1350e-03],
        [ 2.1118e-03,  2.4708e-03, -3.2512e-03,  ..., -3.7735e-03,
          2.4203e-04,  2.4688e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2227, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  379679 MB |  372049 MB |
|       from large pool |    7577 MB |    7588 MB |  377544 MB |  369967 MB |
|       from small pool |      52 MB |      52 MB |    2134 MB |    2082 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  379679 MB |  372049 MB |
|       from large pool |    7577 MB |    7588 MB |  377544 MB |  369967 MB |
|       from small pool |      52 MB |      52 MB |    2134 MB |    2082 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  441566 MB |  440942 MB |
|       from large pool |  637358 KB |  659485 KB |  439180 MB |  438558 MB |
|       from small pool |    1610 KB |   37521 KB |    2385 MB |    2384 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  592620    |  582024    |
|       from large pool |    4896    |    4899    |  243094    |  238198    |
|       from small pool |    5700    |    5709    |  349526    |  343826    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  592620    |  582024    |
|       from large pool |    4896    |    4899    |  243094    |  238198    |
|       from small pool |    5700    |    5709    |  349526    |  343826    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     443    |    1247    |  377391    |  376948    |
|       from large pool |     410    |     412    |  151683    |  151273    |
|       from small pool |      33    |     838    |  225708    |  225675    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  417335 MB |  417266 MB |
|       from large pool |   58959 KB |    7588 MB |  415062 MB |  415004 MB |
|       from small pool |   11257 KB |      52 MB |    2273 MB |    2262 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  417335 MB |  417266 MB |
|       from large pool |   58959 KB |    7588 MB |  415062 MB |  415004 MB |
|       from small pool |   11257 KB |      52 MB |    2273 MB |    2262 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  486154 MB |  486125 MB |
|       from large pool |   22960 KB |  659485 KB |  483589 MB |  483566 MB |
|       from small pool |    7175 KB |   37521 KB |    2565 MB |    2558 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  635478    |  635405    |
|       from large pool |      37    |    4899    |  267375    |  267338    |
|       from small pool |      36    |    5709    |  368103    |  368067    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  635478    |  635405    |
|       from large pool |      37    |    4899    |  267375    |  267338    |
|       from small pool |      36    |    5709    |  368103    |  368067    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  415609    |  415592    |
|       from large pool |       4    |     412    |  171076    |  171072    |
|       from small pool |      13    |     838    |  244533    |  244520    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.9000e-03,  3.4319e-03,  2.0473e-03,  ..., -1.1217e-03,
          1.8759e-05, -1.8291e-03],
        [ 3.2945e-03,  1.1630e-03, -3.3651e-03,  ...,  1.4315e-03,
         -1.5460e-03, -2.6942e-03],
        [-2.4343e-03,  2.4696e-03, -9.0641e-04,  ..., -8.4393e-04,
         -3.0255e-03,  1.4917e-03],
        ...,
        [-9.5179e-04, -3.5390e-03,  2.8136e-03,  ...,  1.7528e-03,
         -8.7263e-04, -2.1530e-03],
        [-1.5543e-03, -1.0680e-03, -1.1584e-03,  ..., -1.1526e-03,
         -2.4054e-03,  3.1234e-03],
        [ 2.1224e-03,  2.4814e-03, -3.2407e-03,  ..., -3.7840e-03,
          2.3145e-04,  2.4581e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 9 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  424912 MB |  424844 MB |
|       from large pool |   58959 KB |    7588 MB |  422595 MB |  422538 MB |
|       from small pool |   11257 KB |      52 MB |    2316 MB |    2305 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  424912 MB |  424844 MB |
|       from large pool |   58959 KB |    7588 MB |  422595 MB |  422538 MB |
|       from small pool |   11257 KB |      52 MB |    2316 MB |    2305 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  493731 MB |  493702 MB |
|       from large pool |   22960 KB |  659485 KB |  491122 MB |  491100 MB |
|       from small pool |    7175 KB |   37521 KB |    2609 MB |    2602 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  655008    |  654935    |
|       from large pool |      37    |    4899    |  272254    |  272217    |
|       from small pool |      36    |    5709    |  382754    |  382718    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  655008    |  654935    |
|       from large pool |      37    |    4899    |  272254    |  272217    |
|       from small pool |      36    |    5709    |  382754    |  382718    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  425112    |  425095    |
|       from large pool |       4    |     412    |  172707    |  172703    |
|       from small pool |      13    |     838    |  252405    |  252392    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.9000e-03,  3.4319e-03,  2.0473e-03,  ..., -1.1217e-03,
          1.8759e-05, -1.8291e-03],
        [ 3.2945e-03,  1.1630e-03, -3.3651e-03,  ...,  1.4315e-03,
         -1.5460e-03, -2.6942e-03],
        [-2.4343e-03,  2.4696e-03, -9.0641e-04,  ..., -8.4393e-04,
         -3.0255e-03,  1.4917e-03],
        ...,
        [-9.5179e-04, -3.5390e-03,  2.8136e-03,  ...,  1.7528e-03,
         -8.7263e-04, -2.1530e-03],
        [-1.5543e-03, -1.0680e-03, -1.1584e-03,  ..., -1.1526e-03,
         -2.4054e-03,  3.1234e-03],
        [ 2.1224e-03,  2.4814e-03, -3.2407e-03,  ..., -3.7840e-03,
          2.3145e-04,  2.4581e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2226, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7630 MB |    7641 MB |  432560 MB |  424930 MB |
|       from large pool |    7577 MB |    7588 MB |  430136 MB |  422559 MB |
|       from small pool |      52 MB |      52 MB |    2423 MB |    2370 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7630 MB |    7641 MB |  432560 MB |  424930 MB |
|       from large pool |    7577 MB |    7588 MB |  430136 MB |  422559 MB |
|       from small pool |      52 MB |      52 MB |    2423 MB |    2370 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  638968 KB |  667318 KB |  501341 MB |  500717 MB |
|       from large pool |  637358 KB |  659485 KB |  498631 MB |  498008 MB |
|       from small pool |    1610 KB |   37521 KB |    2710 MB |    2708 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10596    |   10608    |  674489    |  663893    |
|       from large pool |    4896    |    4899    |  277122    |  272226    |
|       from small pool |    5700    |    5709    |  397367    |  391667    |
|---------------------------------------------------------------------------|
| Active allocs         |   10596    |   10608    |  674489    |  663893    |
|       from large pool |    4896    |    4899    |  277122    |  272226    |
|       from small pool |    5700    |    5709    |  397367    |  391667    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     441    |    1247    |  430889    |  430448    |
|       from large pool |     410    |     412    |  173119    |  172709    |
|       from small pool |      31    |     838    |  257770    |  257739    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  470215 MB |  470147 MB |
|       from large pool |   58959 KB |    7588 MB |  467654 MB |  467596 MB |
|       from small pool |   11257 KB |      52 MB |    2561 MB |    2550 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  470215 MB |  470147 MB |
|       from large pool |   58959 KB |    7588 MB |  467654 MB |  467596 MB |
|       from small pool |   11257 KB |      52 MB |    2561 MB |    2550 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  545929 MB |  545899 MB |
|       from large pool |   22960 KB |  659485 KB |  543039 MB |  543017 MB |
|       from small pool |    7175 KB |   37521 KB |    2889 MB |    2882 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  717347    |  717274    |
|       from large pool |      37    |    4899    |  301403    |  301366    |
|       from small pool |      36    |    5709    |  415944    |  415908    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  717347    |  717274    |
|       from large pool |      37    |    4899    |  301403    |  301366    |
|       from small pool |      36    |    5709    |  415944    |  415908    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  469352    |  469335    |
|       from large pool |       4    |     412    |  192512    |  192508    |
|       from small pool |      13    |     838    |  276840    |  276827    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.9003e-03,  3.4322e-03,  2.0476e-03,  ..., -1.1220e-03,
          1.8460e-05, -1.8294e-03],
        [ 3.2939e-03,  1.1623e-03, -3.3657e-03,  ...,  1.4321e-03,
         -1.5453e-03, -2.6935e-03],
        [-2.4275e-03,  2.4764e-03, -8.9966e-04,  ..., -8.5069e-04,
         -3.0322e-03,  1.4849e-03],
        ...,
        [-9.4712e-04, -3.5344e-03,  2.8183e-03,  ...,  1.7481e-03,
         -8.7728e-04, -2.1576e-03],
        [-1.5458e-03, -1.0595e-03, -1.1499e-03,  ..., -1.1611e-03,
         -2.4139e-03,  3.1148e-03],
        [ 2.1303e-03,  2.4893e-03, -3.2330e-03,  ..., -3.7917e-03,
          2.2361e-04,  2.4502e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
======== Epoch 10 / 10 ========
Training...
Step: 0
AFTER LOADING DATA
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7641 MB |  477793 MB |  477724 MB |
|       from large pool |   58959 KB |    7588 MB |  475187 MB |  475130 MB |
|       from small pool |   11257 KB |      52 MB |    2605 MB |    2594 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7641 MB |  477793 MB |  477724 MB |
|       from large pool |   58959 KB |    7588 MB |  475187 MB |  475130 MB |
|       from small pool |   11257 KB |      52 MB |    2605 MB |    2594 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8254 MB |    8254 MB |    8254 MB |       0 B  |
|       from large pool |    8200 MB |    8200 MB |    8200 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  553506 MB |  553477 MB |
|       from large pool |   22960 KB |  659485 KB |  550573 MB |  550550 MB |
|       from small pool |    7175 KB |   37521 KB |    2933 MB |    2926 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10608    |  736877    |  736804    |
|       from large pool |      37    |    4899    |  306282    |  306245    |
|       from small pool |      36    |    5709    |  430595    |  430559    |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10608    |  736877    |  736804    |
|       from large pool |      37    |    4899    |  306282    |  306245    |
|       from small pool |      36    |    5709    |  430595    |  430559    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     437    |     437    |     437    |       0    |
|       from large pool |     410    |     410    |     410    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  479108    |  479091    |
|       from large pool |       4    |     412    |  194143    |  194139    |
|       from small pool |      13    |     838    |  284965    |  284952    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Parameter containing:
tensor([[ 2.9003e-03,  3.4322e-03,  2.0476e-03,  ..., -1.1220e-03,
          1.8460e-05, -1.8294e-03],
        [ 3.2939e-03,  1.1623e-03, -3.3657e-03,  ...,  1.4321e-03,
         -1.5453e-03, -2.6935e-03],
        [-2.4275e-03,  2.4764e-03, -8.9966e-04,  ..., -8.5069e-04,
         -3.0322e-03,  1.4849e-03],
        ...,
        [-9.4712e-04, -3.5344e-03,  2.8183e-03,  ...,  1.7481e-03,
         -8.7728e-04, -2.1576e-03],
        [-1.5458e-03, -1.0595e-03, -1.1499e-03,  ..., -1.1611e-03,
         -2.4139e-03,  3.1148e-03],
        [ 2.1303e-03,  2.4893e-03, -3.2330e-03,  ..., -3.7917e-03,
          2.2361e-04,  2.4502e-03]], device='cuda:0', requires_grad=True)
torch.Size([807, 3]) torch.Size([807, 3])
step loss: tensor(0.2225, device='cuda:0', grad_fn=<MeanBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    7645 MB |    7656 MB |  485455 MB |  477810 MB |
|       from large pool |    7593 MB |    7604 MB |  482743 MB |  475150 MB |
|       from small pool |      52 MB |      52 MB |    2711 MB |    2659 MB |
|---------------------------------------------------------------------------|
| Active memory         |    7645 MB |    7656 MB |  485455 MB |  477810 MB |
|       from large pool |    7593 MB |    7604 MB |  482743 MB |  475150 MB |
|       from small pool |      52 MB |      52 MB |    2711 MB |    2659 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8274 MB |    8274 MB |    8274 MB |       0 B  |
|       from large pool |    8220 MB |    8220 MB |    8220 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  643618 KB |  667318 KB |  561170 MB |  560541 MB |
|       from large pool |  642033 KB |  659485 KB |  558100 MB |  557473 MB |
|       from small pool |    1585 KB |   37521 KB |    3070 MB |    3068 MB |
|---------------------------------------------------------------------------|
| Allocations           |   10616    |   10628    |     756 K  |  745762    |
|       from large pool |    4906    |    4909    |     311 K  |  306254    |
|       from small pool |    5710    |    5719    |     445 K  |  439508    |
|---------------------------------------------------------------------------|
| Active allocs         |   10616    |   10628    |     756 K  |  745762    |
|       from large pool |    4906    |    4909    |     311 K  |  306254    |
|       from small pool |    5710    |    5719    |     445 K  |  439508    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     438    |     438    |     438    |       0    |
|       from large pool |     411    |     411    |     411    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     441    |    1247    |  482826    |  482385    |
|       from large pool |     410    |     412    |  194555    |  194145    |
|       from small pool |      31    |     838    |  288271    |  288240    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
AFTER BACKPROP STEP
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   70216 KB |    7656 MB |  524577 MB |  524508 MB |
|       from large pool |   58959 KB |    7604 MB |  521727 MB |  521669 MB |
|       from small pool |   11257 KB |      52 MB |    2850 MB |    2839 MB |
|---------------------------------------------------------------------------|
| Active memory         |   70216 KB |    7656 MB |  524577 MB |  524508 MB |
|       from large pool |   58959 KB |    7604 MB |  521727 MB |  521669 MB |
|       from small pool |   11257 KB |      52 MB |    2850 MB |    2839 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    8274 MB |    8274 MB |    8274 MB |       0 B  |
|       from large pool |    8220 MB |    8220 MB |    8220 MB |       0 B  |
|       from small pool |      54 MB |      54 MB |      54 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30135 KB |  667318 KB |  607296 MB |  607266 MB |
|       from large pool |   22960 KB |  659485 KB |  604046 MB |  604023 MB |
|       from small pool |    7175 KB |   37521 KB |    3249 MB |    3242 MB |
|---------------------------------------------------------------------------|
| Allocations           |      73    |   10628    |     799 K  |     799 K  |
|       from large pool |      37    |    4909    |     335 K  |     335 K  |
|       from small pool |      36    |    5719    |     463 K  |     463 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      73    |   10628    |     799 K  |     799 K  |
|       from large pool |      37    |    4909    |     335 K  |     335 K  |
|       from small pool |      36    |    5719    |     463 K  |     463 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     438    |     438    |     438    |       0    |
|       from large pool |     411    |     411    |     411    |       0    |
|       from small pool |      27    |      27    |      27    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |      17    |    1247    |  518689    |  518672    |
|       from large pool |       4    |     412    |  214400    |  214396    |
|       from small pool |      13    |     838    |  304289    |  304276    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.22
Parameter containing:
tensor([[ 2.9005e-03,  3.4324e-03,  2.0478e-03,  ..., -1.1222e-03,
          1.8252e-05, -1.8296e-03],
        [ 3.2934e-03,  1.1619e-03, -3.3661e-03,  ...,  1.4326e-03,
         -1.5449e-03, -2.6931e-03],
        [-2.4230e-03,  2.4809e-03, -8.9517e-04,  ..., -8.5518e-04,
         -3.0367e-03,  1.4803e-03],
        ...,
        [-9.4399e-04, -3.5313e-03,  2.8214e-03,  ...,  1.7450e-03,
         -8.8040e-04, -2.1607e-03],
        [-1.5403e-03, -1.0540e-03, -1.1444e-03,  ..., -1.1666e-03,
         -2.4194e-03,  3.1092e-03],
        [ 2.1355e-03,  2.4944e-03, -3.2279e-03,  ..., -3.7968e-03,
          2.1849e-04,  2.4450e-03]], device='cuda:0', requires_grad=True)
torch.Size([807]) torch.Size([807])
  Average validation loss: 0.69
Least Validation loss: 0.6936908960342407