/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_small.py:540: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(dataset_tensor[:, 1, :].clone().detach(), dtype=torch.long)
PermutedDKT
Number of questions:  1855
Number of students:  6468
Number of concepts: 1076
Using batch size: 32
Using batch size: 32
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   39973 KB |   39973 KB |   39973 KB |       0 B  |
|       from large pool |   39967 KB |   39967 KB |   39967 KB |       0 B  |
|       from small pool |       6 KB |       6 KB |       6 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   39973 KB |   39973 KB |   39973 KB |       0 B  |
|       from large pool |   39967 KB |   39967 KB |   39967 KB |       0 B  |
|       from small pool |       6 KB |       6 KB |       6 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   63488 KB |   63488 KB |   63488 KB |       0 B  |
|       from large pool |   61440 KB |   61440 KB |   61440 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   23514 KB |   23516 KB |   53176 KB |   29662 KB |
|       from large pool |   21473 KB |   21473 KB |   51133 KB |   29660 KB |
|       from small pool |    2041 KB |    2043 KB |    2043 KB |       2 KB |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |      11    |      11    |      11    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |      11    |      11    |      11    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       4    |       4    |       4    |       0    |
|       from large pool |       3    |       3    |       3    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |       4    |       4    |       0    |
|       from large pool |       3    |       3    |       3    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Successfull in data prepration!
Successfully loaded the optimizer
======== Epoch 1 / 10 ========
Training...
Step: 0
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0383, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1536 MB |    1727 MB |    3174 MB |    1638 MB |
|       from large pool |     679 MB |     869 MB |     970 MB |     291 MB |
|       from small pool |     857 MB |     858 MB |    2204 MB |    1346 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1536 MB |    1727 MB |    3174 MB |    1638 MB |
|       from large pool |     679 MB |     869 MB |     970 MB |     291 MB |
|       from small pool |     857 MB |     858 MB |    2204 MB |    1346 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1756 MB |    1756 MB |    1756 MB |       0 B  |
|       from large pool |     888 MB |     888 MB |     888 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   30426 KB |   31732 KB |    2755 MB |    2726 MB |
|       from large pool |   19422 KB |   31025 KB |     221 MB |     202 MB |
|       from small pool |   11003 KB |   12084 KB |    2533 MB |    2523 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13042    |   13052    |   33539    |   20497    |
|       from large pool |      36    |      39    |      51    |      15    |
|       from small pool |   13006    |   13013    |   33488    |   20482    |
|---------------------------------------------------------------------------|
| Active allocs         |   13042    |   13052    |   33539    |   20497    |
|       from large pool |      36    |      39    |      51    |      15    |
|       from small pool |   13006    |   13013    |   33488    |   20482    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     450    |     450    |     450    |       0    |
|       from large pool |      16    |      16    |      16    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |     447    |    7834    |    7389    |
|       from large pool |       8    |       8    |      13    |       5    |
|       from small pool |     437    |     439    |    7821    |    7384    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3136 MB |    1599 MB |
|       from large pool |     680 MB |     870 MB |     932 MB |     252 MB |
|       from small pool |     856 MB |     857 MB |    2203 MB |    1347 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3136 MB |    1599 MB |
|       from large pool |     680 MB |     870 MB |     932 MB |     252 MB |
|       from small pool |     856 MB |     857 MB |    2203 MB |    1347 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1758 MB |    1758 MB |    1758 MB |       0 B  |
|       from large pool |     890 MB |     890 MB |     890 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |   31638 KB |    2681 MB |    2650 MB |
|       from large pool |   19933 KB |   27012 KB |     147 MB |     128 MB |
|       from small pool |   11705 KB |   12080 KB |    2533 MB |    2522 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   33503    |   20473    |
|       from large pool |      28    |      31    |      40    |      12    |
|       from small pool |   13002    |   13011    |   33463    |   20461    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   33503    |   20473    |
|       from large pool |      28    |      31    |      40    |      12    |
|       from small pool |   13002    |   13011    |   33463    |   20461    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     451    |     451    |     451    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |     445    |    7827    |    7383    |
|       from large pool |       7    |       7    |      11    |       4    |
|       from small pool |     437    |     438    |    7816    |    7379    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 1
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0241, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  108814 MB |  107169 MB |
|       from large pool |     787 MB |     977 MB |  101593 MB |  100805 MB |
|       from small pool |     857 MB |     858 MB |    7220 MB |    6363 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  108814 MB |  107169 MB |
|       from large pool |     787 MB |     977 MB |  101593 MB |  100805 MB |
|       from small pool |     857 MB |     858 MB |    7220 MB |    6363 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1010 MB |    1010 MB |    1010 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |  148446 MB |  148403 MB |
|       from large pool |   32920 KB |     156 MB |  139739 MB |  139707 MB |
|       from small pool |   10990 KB |     708 MB |    8706 MB |    8695 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  132208    |  119135    |
|       from large pool |      61    |      64    |   22499    |   22438    |
|       from small pool |   13012    |   13020    |  109709    |   96697    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  132208    |  119135    |
|       from large pool |      61    |      64    |   22499    |   22438    |
|       from small pool |   13012    |   13020    |  109709    |   96697    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2237    |   78066    |   77618    |
|       from large pool |       9    |      12    |   19161    |   19152    |
|       from small pool |     439    |    2229    |   58905    |   58466    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  108604 MB |  107067 MB |
|       from large pool |     680 MB |     870 MB |  101385 MB |  100704 MB |
|       from small pool |     856 MB |     857 MB |    7219 MB |    6362 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  108604 MB |  107067 MB |
|       from large pool |     680 MB |     870 MB |  101385 MB |  100704 MB |
|       from small pool |     856 MB |     857 MB |    7219 MB |    6362 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  107960 MB |  107929 MB |
|       from large pool |   19933 KB |     149 MB |   99252 MB |   99233 MB |
|       from small pool |   11705 KB |     711 MB |    8707 MB |    8696 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  132051    |  119021    |
|       from large pool |      28    |      36    |   22443    |   22415    |
|       from small pool |   13002    |   13011    |  109608    |   96606    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  132051    |  119021    |
|       from large pool |      28    |      36    |   22443    |   22415    |
|       from small pool |   13002    |   13011    |  109608    |   96606    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |   76553    |   76109    |
|       from large pool |       7    |      11    |   17565    |   17558    |
|       from small pool |     437    |    2228    |   58988    |   58551    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 2
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0179, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  214384 MB |  212739 MB |
|       from large pool |     787 MB |     977 MB |  202147 MB |  201359 MB |
|       from small pool |     857 MB |     858 MB |   12237 MB |   11379 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  214384 MB |  212739 MB |
|       from large pool |     787 MB |     977 MB |  202147 MB |  201359 MB |
|       from small pool |     857 MB |     858 MB |   12237 MB |   11379 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |  294259 MB |  294216 MB |
|       from large pool |   32920 KB |     261 MB |  279379 MB |  279347 MB |
|       from small pool |   10990 KB |     708 MB |   14879 MB |   14868 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  230851    |  217778    |
|       from large pool |      61    |      69    |   44927    |   44866    |
|       from small pool |   13012    |   13020    |  185924    |  172912    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  230851    |  217778    |
|       from large pool |      61    |      69    |   44927    |   44866    |
|       from small pool |   13012    |   13020    |  185924    |  172912    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |  142267    |  141818    |
|       from large pool |       9    |      15    |   38326    |   38317    |
|       from small pool |     440    |    2231    |  103941    |  103501    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  214073 MB |  212536 MB |
|       from large pool |     680 MB |     870 MB |  201837 MB |  201157 MB |
|       from small pool |     856 MB |     857 MB |   12235 MB |   11378 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  214073 MB |  212536 MB |
|       from large pool |     680 MB |     870 MB |  201837 MB |  201157 MB |
|       from small pool |     856 MB |     857 MB |   12235 MB |   11378 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  213309 MB |  213278 MB |
|       from large pool |   19933 KB |     153 MB |  198427 MB |  198408 MB |
|       from small pool |   11705 KB |     711 MB |   14881 MB |   14870 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  230599    |  217569    |
|       from large pool |      28    |      36    |   44846    |   44818    |
|       from small pool |   13002    |   13011    |  185753    |  172751    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  230599    |  217569    |
|       from large pool |      28    |      36    |   44846    |   44818    |
|       from small pool |   13002    |   13011    |  185753    |  172751    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  139154    |  138710    |
|       from large pool |       7    |      11    |   35115    |   35108    |
|       from small pool |     437    |    2228    |  104039    |  103602    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 3
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  1
0
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0101, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  319955 MB |  318310 MB |
|       from large pool |     787 MB |     977 MB |  302701 MB |  301913 MB |
|       from small pool |     857 MB |     858 MB |   17253 MB |   16396 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  319955 MB |  318310 MB |
|       from large pool |     787 MB |     977 MB |  302701 MB |  301913 MB |
|       from small pool |     857 MB |     858 MB |   17253 MB |   16396 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |  440072 MB |  440029 MB |
|       from large pool |   32920 KB |     261 MB |  419019 MB |  418987 MB |
|       from small pool |   10990 KB |     708 MB |   21052 MB |   21041 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  329494    |  316421    |
|       from large pool |      61    |      69    |   67355    |   67294    |
|       from small pool |   13012    |   13020    |  262139    |  249127    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  329494    |  316421    |
|       from large pool |      61    |      69    |   67355    |   67294    |
|       from small pool |   13012    |   13020    |  262139    |  249127    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |  206476    |  206031    |
|       from large pool |       9    |      15    |   57491    |   57482    |
|       from small pool |     436    |    2231    |  148985    |  148549    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  319541 MB |  318004 MB |
|       from large pool |     680 MB |     870 MB |  302290 MB |  301609 MB |
|       from small pool |     856 MB |     857 MB |   17251 MB |   16394 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  319541 MB |  318004 MB |
|       from large pool |     680 MB |     870 MB |  302290 MB |  301609 MB |
|       from small pool |     856 MB |     857 MB |   17251 MB |   16394 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  318658 MB |  318628 MB |
|       from large pool |   19933 KB |     153 MB |  297603 MB |  297583 MB |
|       from small pool |   11705 KB |     711 MB |   21055 MB |   21044 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  329147    |  316117    |
|       from large pool |      28    |      36    |   67249    |   67221    |
|       from small pool |   13002    |   13011    |  261898    |  248896    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  329147    |  316117    |
|       from large pool |      28    |      36    |   67249    |   67221    |
|       from small pool |   13002    |   13011    |  261898    |  248896    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  201755    |  201311    |
|       from large pool |       7    |      11    |   52665    |   52658    |
|       from small pool |     437    |    2228    |  149090    |  148653    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 4
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0098, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  425525 MB |  423880 MB |
|       from large pool |     787 MB |     977 MB |  403255 MB |  402467 MB |
|       from small pool |     857 MB |     858 MB |   22270 MB |   21413 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  425525 MB |  423880 MB |
|       from large pool |     787 MB |     977 MB |  403255 MB |  402467 MB |
|       from small pool |     857 MB |     858 MB |   22270 MB |   21413 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |  585887 MB |  585844 MB |
|       from large pool |   32920 KB |     261 MB |  558660 MB |  558627 MB |
|       from small pool |   10990 KB |     708 MB |   27227 MB |   27216 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  428137    |  415064    |
|       from large pool |      61    |      69    |   89783    |   89722    |
|       from small pool |   13012    |   13020    |  338354    |  325342    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  428137    |  415064    |
|       from large pool |      61    |      69    |   89783    |   89722    |
|       from small pool |   13012    |   13020    |  338354    |  325342    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |  270729    |  270281    |
|       from large pool |       9    |      15    |   76656    |   76647    |
|       from small pool |     439    |    2231    |  194073    |  193634    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  425009 MB |  423472 MB |
|       from large pool |     680 MB |     870 MB |  402743 MB |  402062 MB |
|       from small pool |     856 MB |     857 MB |   22266 MB |   21410 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  425009 MB |  423472 MB |
|       from large pool |     680 MB |     870 MB |  402743 MB |  402062 MB |
|       from small pool |     856 MB |     857 MB |   22266 MB |   21410 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  424008 MB |  423977 MB |
|       from large pool |   19933 KB |     153 MB |  396778 MB |  396758 MB |
|       from small pool |   11705 KB |     711 MB |   27229 MB |   27218 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  427695    |  414665    |
|       from large pool |      28    |      36    |   89652    |   89624    |
|       from small pool |   13002    |   13011    |  338043    |  325041    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  427695    |  414665    |
|       from large pool |      28    |      36    |   89652    |   89624    |
|       from small pool |   13002    |   13011    |  338043    |  325041    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  264356    |  263912    |
|       from large pool |       7    |      11    |   70215    |   70208    |
|       from small pool |     437    |    2228    |  194141    |  193704    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 5
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0146, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  531096 MB |  529451 MB |
|       from large pool |     787 MB |     977 MB |  503809 MB |  503021 MB |
|       from small pool |     857 MB |     858 MB |   27286 MB |   26429 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  531096 MB |  529451 MB |
|       from large pool |     787 MB |     977 MB |  503809 MB |  503021 MB |
|       from small pool |     857 MB |     858 MB |   27286 MB |   26429 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |  731702 MB |  731659 MB |
|       from large pool |   32920 KB |     261 MB |  698300 MB |  698268 MB |
|       from small pool |   10990 KB |     708 MB |   33401 MB |   33391 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  526780    |  513707    |
|       from large pool |      61    |      69    |  112211    |  112150    |
|       from small pool |   13012    |   13020    |  414569    |  401557    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  526780    |  513707    |
|       from large pool |      61    |      69    |  112211    |  112150    |
|       from small pool |   13012    |   13020    |  414569    |  401557    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |  334990    |  334543    |
|       from large pool |       9    |      15    |   95821    |   95812    |
|       from small pool |     438    |    2231    |  239169    |  238731    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  530478 MB |  528941 MB |
|       from large pool |     680 MB |     870 MB |  503195 MB |  502515 MB |
|       from small pool |     856 MB |     857 MB |   27282 MB |   26426 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  530478 MB |  528941 MB |
|       from large pool |     680 MB |     870 MB |  503195 MB |  502515 MB |
|       from small pool |     856 MB |     857 MB |   27282 MB |   26426 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  529357 MB |  529326 MB |
|       from large pool |   19933 KB |     153 MB |  495953 MB |  495933 MB |
|       from small pool |   11705 KB |     711 MB |   33404 MB |   33392 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  526243    |  513213    |
|       from large pool |      28    |      36    |  112055    |  112027    |
|       from small pool |   13002    |   13011    |  414188    |  401186    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  526243    |  513213    |
|       from large pool |      28    |      36    |  112055    |  112027    |
|       from small pool |   13002    |   13011    |  414188    |  401186    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  326957    |  326513    |
|       from large pool |       7    |      11    |   87765    |   87758    |
|       from small pool |     437    |    2228    |  239192    |  238755    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 6
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0115, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  636666 MB |  635021 MB |
|       from large pool |     787 MB |     977 MB |  604363 MB |  603575 MB |
|       from small pool |     857 MB |     858 MB |   32303 MB |   31446 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  636666 MB |  635021 MB |
|       from large pool |     787 MB |     977 MB |  604363 MB |  603575 MB |
|       from small pool |     857 MB |     858 MB |   32303 MB |   31446 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |     856 GB |     856 GB |
|       from large pool |   32920 KB |     261 MB |     818 GB |     818 GB |
|       from small pool |   10990 KB |     708 MB |      38 GB |      38 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  625423    |  612350    |
|       from large pool |      61    |      69    |  134639    |  134578    |
|       from small pool |   13012    |   13020    |  490784    |  477772    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  625423    |  612350    |
|       from large pool |      61    |      69    |  134639    |  134578    |
|       from small pool |   13012    |   13020    |  490784    |  477772    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |  399242    |  398795    |
|       from large pool |       9    |      15    |  114986    |  114977    |
|       from small pool |     438    |    2231    |  284256    |  283818    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  635946 MB |  634409 MB |
|       from large pool |     680 MB |     870 MB |  603648 MB |  602967 MB |
|       from small pool |     856 MB |     857 MB |   32298 MB |   31442 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  635946 MB |  634409 MB |
|       from large pool |     680 MB |     870 MB |  603648 MB |  602967 MB |
|       from small pool |     856 MB |     857 MB |   32298 MB |   31442 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  634706 MB |  634675 MB |
|       from large pool |   19933 KB |     153 MB |  595128 MB |  595108 MB |
|       from small pool |   11705 KB |     711 MB |   39578 MB |   39566 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  624791    |  611761    |
|       from large pool |      28    |      36    |  134458    |  134430    |
|       from small pool |   13002    |   13011    |  490333    |  477331    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  624791    |  611761    |
|       from large pool |      28    |      36    |  134458    |  134430    |
|       from small pool |   13002    |   13011    |  490333    |  477331    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  389558    |  389114    |
|       from large pool |       7    |      11    |  105315    |  105308    |
|       from small pool |     437    |    2228    |  284243    |  283806    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 7
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device: 01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0174, 0.8821], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |  742237 MB |  740592 MB |
|       from large pool |     787 MB |     977 MB |  704917 MB |  704129 MB |
|       from small pool |     857 MB |     858 MB |   37319 MB |   36462 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |  742237 MB |  740592 MB |
|       from large pool |     787 MB |     977 MB |  704917 MB |  704129 MB |
|       from small pool |     857 MB |     858 MB |   37319 MB |   36462 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |     999 GB |     999 GB |
|       from large pool |   32920 KB |     261 MB |     954 GB |     954 GB |
|       from small pool |   10990 KB |     708 MB |      44 GB |      44 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |  724066    |  710993    |
|       from large pool |      61    |      69    |  157067    |  157006    |
|       from small pool |   13012    |   13020    |  566999    |  553987    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |  724066    |  710993    |
|       from large pool |      61    |      69    |  157067    |  157006    |
|       from small pool |   13012    |   13020    |  566999    |  553987    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |  463492    |  463045    |
|       from large pool |       9    |      15    |  134151    |  134142    |
|       from small pool |     438    |    2231    |  329341    |  328903    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |  741415 MB |  739877 MB |
|       from large pool |     680 MB |     870 MB |  704100 MB |  703420 MB |
|       from small pool |     856 MB |     857 MB |   37314 MB |   36457 MB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |  741415 MB |  739877 MB |
|       from large pool |     680 MB |     870 MB |  704100 MB |  703420 MB |
|       from small pool |     856 MB |     857 MB |   37314 MB |   36457 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |  740055 MB |  740024 MB |
|       from large pool |   19933 KB |     153 MB |  694303 MB |  694283 MB |
|       from small pool |   11705 KB |     711 MB |   45752 MB |   45740 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |  723339    |  710309    |
|       from large pool |      28    |      36    |  156861    |  156833    |
|       from small pool |   13002    |   13011    |  566478    |  553476    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |  723339    |  710309    |
|       from large pool |      28    |      36    |  156861    |  156833    |
|       from small pool |   13002    |   13011    |  566478    |  553476    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  452159    |  451715    |
|       from large pool |       7    |      11    |  122865    |  122858    |
|       from small pool |     437    |    2228    |  329294    |  328857    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 8
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0166, 0.8558], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |     827 GB |     826 GB |
|       from large pool |     787 MB |     977 MB |     786 GB |     785 GB |
|       from small pool |     857 MB |     858 MB |      41 GB |      40 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |     827 GB |     826 GB |
|       from large pool |     787 MB |     977 MB |     786 GB |     785 GB |
|       from small pool |     857 MB |     858 MB |      41 GB |      40 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1141 GB |    1141 GB |
|       from large pool |   32920 KB |     261 MB |    1091 GB |    1091 GB |
|       from small pool |   10990 KB |     708 MB |      50 GB |      50 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |     822 K  |     809 K  |
|       from large pool |      61    |      69    |     179 K  |     179 K  |
|       from small pool |   13012    |   13020    |     643 K  |     630 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |     822 K  |     809 K  |
|       from large pool |      61    |      69    |     179 K  |     179 K  |
|       from small pool |   13012    |   13020    |     643 K  |     630 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |  527751    |  527305    |
|       from large pool |       9    |      15    |  153316    |  153307    |
|       from small pool |     437    |    2231    |  374435    |  373998    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |     827 GB |     825 GB |
|       from large pool |     680 MB |     870 MB |     785 GB |     785 GB |
|       from small pool |     856 MB |     857 MB |      41 GB |      40 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |     827 GB |     825 GB |
|       from large pool |     680 MB |     870 MB |     785 GB |     785 GB |
|       from small pool |     856 MB |     857 MB |      41 GB |      40 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |     825 GB |     825 GB |
|       from large pool |   19933 KB |     153 MB |     774 GB |     774 GB |
|       from small pool |   11705 KB |     711 MB |      50 GB |      50 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |     821 K  |     808 K  |
|       from large pool |      28    |      36    |     179 K  |     179 K  |
|       from small pool |   13002    |   13011    |     642 K  |     629 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |     821 K  |     808 K  |
|       from large pool |      28    |      36    |     179 K  |     179 K  |
|       from small pool |   13002    |   13011    |     642 K  |     629 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  514760    |  514316    |
|       from large pool |       7    |      11    |  140415    |  140408    |
|       from small pool |     437    |    2228    |  374345    |  373908    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 9
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0094, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |     931 GB |     929 GB |
|       from large pool |     787 MB |     977 MB |     884 GB |     884 GB |
|       from small pool |     857 MB |     858 MB |      46 GB |      45 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |     931 GB |     929 GB |
|       from large pool |     787 MB |     977 MB |     884 GB |     884 GB |
|       from small pool |     857 MB |     858 MB |      46 GB |      45 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1284 GB |    1284 GB |
|       from large pool |   32920 KB |     261 MB |    1227 GB |    1227 GB |
|       from small pool |   10990 KB |     708 MB |      56 GB |      56 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |     921 K  |     908 K  |
|       from large pool |      61    |      69    |     201 K  |     201 K  |
|       from small pool |   13012    |   13020    |     719 K  |     706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |     921 K  |     908 K  |
|       from large pool |      61    |      69    |     201 K  |     201 K  |
|       from small pool |   13012    |   13020    |     719 K  |     706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |  591986    |  591540    |
|       from large pool |       9    |      15    |  172481    |  172472    |
|       from small pool |     437    |    2231    |  419505    |  419068    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |     930 GB |     928 GB |
|       from large pool |     680 MB |     870 MB |     883 GB |     883 GB |
|       from small pool |     856 MB |     857 MB |      46 GB |      45 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |     930 GB |     928 GB |
|       from large pool |     680 MB |     870 MB |     883 GB |     883 GB |
|       from small pool |     856 MB |     857 MB |      46 GB |      45 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |     928 GB |     928 GB |
|       from large pool |   19933 KB |     153 MB |     871 GB |     871 GB |
|       from small pool |   11705 KB |     711 MB |      56 GB |      56 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |     920 K  |     907 K  |
|       from large pool |      28    |      36    |     201 K  |     201 K  |
|       from small pool |   13002    |   13011    |     718 K  |     705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |     920 K  |     907 K  |
|       from large pool |      28    |      36    |     201 K  |     201 K  |
|       from small pool |   13002    |   13011    |     718 K  |     705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  577361    |  576917    |
|       from large pool |       7    |      11    |  157965    |  157958    |
|       from small pool |     437    |    2228    |  419396    |  418959    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 10
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0133, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1034 GB |    1032 GB |
|       from large pool |     787 MB |     977 MB |     982 GB |     982 GB |
|       from small pool |     857 MB |     858 MB |      51 GB |      50 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1034 GB |    1032 GB |
|       from large pool |     787 MB |     977 MB |     982 GB |     982 GB |
|       from small pool |     857 MB |     858 MB |      51 GB |      50 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1426 GB |    1426 GB |
|       from large pool |   32920 KB |     261 MB |    1363 GB |    1363 GB |
|       from small pool |   10990 KB |     708 MB |      62 GB |      62 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1019 K  |    1006 K  |
|       from large pool |      61    |      69    |     224 K  |     224 K  |
|       from small pool |   13012    |   13020    |     795 K  |     782 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1019 K  |    1006 K  |
|       from large pool |      61    |      69    |     224 K  |     224 K  |
|       from small pool |   13012    |   13020    |     795 K  |     782 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |  656197    |  655749    |
|       from large pool |       9    |      15    |  191646    |  191637    |
|       from small pool |     439    |    2231    |  464551    |  464112    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1033 GB |    1031 GB |
|       from large pool |     680 MB |     870 MB |     981 GB |     981 GB |
|       from small pool |     856 MB |     857 MB |      51 GB |      50 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1033 GB |    1031 GB |
|       from large pool |     680 MB |     870 MB |     981 GB |     981 GB |
|       from small pool |     856 MB |     857 MB |      51 GB |      50 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1031 GB |    1031 GB |
|       from large pool |   19933 KB |     153 MB |     968 GB |     968 GB |
|       from small pool |   11705 KB |     711 MB |      62 GB |      62 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1018 K  |    1005 K  |
|       from large pool |      28    |      36    |     224 K  |     224 K  |
|       from small pool |   13002    |   13011    |     794 K  |     781 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1018 K  |    1005 K  |
|       from large pool |      28    |      36    |     224 K  |     224 K  |
|       from small pool |   13002    |   13011    |     794 K  |     781 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  639962    |  639518    |
|       from large pool |       7    |      11    |  175515    |  175508    |
|       from small pool |     437    |    2228    |  464447    |  464010    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 11
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0509, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1137 GB |    1135 GB |
|       from large pool |     787 MB |     977 MB |    1081 GB |    1080 GB |
|       from small pool |     857 MB |     858 MB |      56 GB |      55 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1137 GB |    1135 GB |
|       from large pool |     787 MB |     977 MB |    1081 GB |    1080 GB |
|       from small pool |     857 MB |     858 MB |      56 GB |      55 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1568 GB |    1568 GB |
|       from large pool |   32920 KB |     261 MB |    1500 GB |    1500 GB |
|       from small pool |   10990 KB |     708 MB |      68 GB |      68 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1118 K  |    1105 K  |
|       from large pool |      61    |      69    |     246 K  |     246 K  |
|       from small pool |   13012    |   13020    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1118 K  |    1105 K  |
|       from large pool |      61    |      69    |     246 K  |     246 K  |
|       from small pool |   13012    |   13020    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |  720398    |  719949    |
|       from large pool |       9    |      15    |  210811    |  210802    |
|       from small pool |     440    |    2231    |  509587    |  509147    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1136 GB |    1134 GB |
|       from large pool |     680 MB |     870 MB |    1079 GB |    1079 GB |
|       from small pool |     856 MB |     857 MB |      56 GB |      55 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1136 GB |    1134 GB |
|       from large pool |     680 MB |     870 MB |    1079 GB |    1079 GB |
|       from small pool |     856 MB |     857 MB |      56 GB |      55 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1134 GB |    1134 GB |
|       from large pool |   19933 KB |     153 MB |    1065 GB |    1065 GB |
|       from small pool |   11705 KB |     711 MB |      68 GB |      68 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1117 K  |    1104 K  |
|       from large pool |      28    |      36    |     246 K  |     246 K  |
|       from small pool |   13002    |   13011    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1117 K  |    1104 K  |
|       from large pool |      28    |      36    |     246 K  |     246 K  |
|       from small pool |   13002    |   13011    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |  702563    |  702119    |
|       from large pool |       7    |      11    |  193065    |  193058    |
|       from small pool |     437    |    2228    |  509498    |  509061    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 12
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0109, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1240 GB |    1238 GB |
|       from large pool |     787 MB |     977 MB |    1179 GB |    1178 GB |
|       from small pool |     857 MB |     858 MB |      60 GB |      60 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1240 GB |    1238 GB |
|       from large pool |     787 MB |     977 MB |    1179 GB |    1178 GB |
|       from small pool |     857 MB |     858 MB |      60 GB |      60 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1711 GB |    1711 GB |
|       from large pool |   32920 KB |     261 MB |    1636 GB |    1636 GB |
|       from small pool |   10990 KB |     708 MB |      74 GB |      74 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1217 K  |    1204 K  |
|       from large pool |      61    |      69    |     269 K  |     269 K  |
|       from small pool |   13012    |   13020    |     948 K  |     935 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1217 K  |    1204 K  |
|       from large pool |      61    |      69    |     269 K  |     269 K  |
|       from small pool |   13012    |   13020    |     948 K  |     935 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |     784 K  |     784 K  |
|       from large pool |       9    |      15    |     229 K  |     229 K  |
|       from small pool |     436    |    2231    |     554 K  |     554 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1239 GB |    1237 GB |
|       from large pool |     680 MB |     870 MB |    1178 GB |    1177 GB |
|       from small pool |     856 MB |     857 MB |      60 GB |      60 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1239 GB |    1237 GB |
|       from large pool |     680 MB |     870 MB |    1178 GB |    1177 GB |
|       from small pool |     856 MB |     857 MB |      60 GB |      60 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1237 GB |    1237 GB |
|       from large pool |   19933 KB |     153 MB |    1162 GB |    1162 GB |
|       from small pool |   11705 KB |     711 MB |      74 GB |      74 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1216 K  |    1203 K  |
|       from large pool |      28    |      36    |     268 K  |     268 K  |
|       from small pool |   13002    |   13011    |     947 K  |     934 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1216 K  |    1203 K  |
|       from large pool |      28    |      36    |     268 K  |     268 K  |
|       from small pool |   13002    |   13011    |     947 K  |     934 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |     765 K  |     764 K  |
|       from large pool |       7    |      11    |     210 K  |     210 K  |
|       from small pool |     437    |    2228    |     554 K  |     554 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 13
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0264, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1343 GB |    1341 GB |
|       from large pool |     787 MB |     977 MB |    1277 GB |    1276 GB |
|       from small pool |     857 MB |     858 MB |      65 GB |      65 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1343 GB |    1341 GB |
|       from large pool |     787 MB |     977 MB |    1277 GB |    1276 GB |
|       from small pool |     857 MB |     858 MB |      65 GB |      65 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1853 GB |    1853 GB |
|       from large pool |   32920 KB |     261 MB |    1772 GB |    1772 GB |
|       from small pool |   10990 KB |     708 MB |      80 GB |      80 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1315 K  |    1302 K  |
|       from large pool |      61    |      69    |     291 K  |     291 K  |
|       from small pool |   13012    |   13020    |    1024 K  |    1011 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1315 K  |    1302 K  |
|       from large pool |      61    |      69    |     291 K  |     291 K  |
|       from small pool |   13012    |   13020    |    1024 K  |    1011 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |     848 K  |     848 K  |
|       from large pool |       9    |      15    |     249 K  |     249 K  |
|       from small pool |     439    |    2231    |     599 K  |     599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1342 GB |    1340 GB |
|       from large pool |     680 MB |     870 MB |    1276 GB |    1275 GB |
|       from small pool |     856 MB |     857 MB |      65 GB |      64 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1342 GB |    1340 GB |
|       from large pool |     680 MB |     870 MB |    1276 GB |    1275 GB |
|       from small pool |     856 MB |     857 MB |      65 GB |      64 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1339 GB |    1339 GB |
|       from large pool |   19933 KB |     153 MB |    1259 GB |    1259 GB |
|       from small pool |   11705 KB |     711 MB |      80 GB |      80 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1314 K  |    1301 K  |
|       from large pool |      28    |      36    |     291 K  |     291 K  |
|       from small pool |   13002    |   13011    |    1023 K  |    1010 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1314 K  |    1301 K  |
|       from large pool |      28    |      36    |     291 K  |     291 K  |
|       from small pool |   13002    |   13011    |    1023 K  |    1010 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |     827 K  |     827 K  |
|       from large pool |       7    |      11    |     228 K  |     228 K  |
|       from small pool |     437    |    2228    |     599 K  |     599 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 14
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0158, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1446 GB |    1444 GB |
|       from large pool |     787 MB |     977 MB |    1375 GB |    1375 GB |
|       from small pool |     857 MB |     858 MB |      70 GB |      69 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1446 GB |    1444 GB |
|       from large pool |     787 MB |     977 MB |    1375 GB |    1375 GB |
|       from small pool |     857 MB |     858 MB |      70 GB |      69 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    1996 GB |    1996 GB |
|       from large pool |   32920 KB |     261 MB |    1909 GB |    1909 GB |
|       from small pool |   10990 KB |     708 MB |      86 GB |      86 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1414 K  |    1401 K  |
|       from large pool |      61    |      69    |     314 K  |     314 K  |
|       from small pool |   13012    |   13020    |    1100 K  |    1087 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1414 K  |    1401 K  |
|       from large pool |      61    |      69    |     314 K  |     314 K  |
|       from small pool |   13012    |   13020    |    1100 K  |    1087 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |     913 K  |     912 K  |
|       from large pool |       9    |      15    |     268 K  |     268 K  |
|       from small pool |     438    |    2231    |     644 K  |     644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1445 GB |    1443 GB |
|       from large pool |     680 MB |     870 MB |    1374 GB |    1373 GB |
|       from small pool |     856 MB |     857 MB |      70 GB |      69 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1445 GB |    1443 GB |
|       from large pool |     680 MB |     870 MB |    1374 GB |    1373 GB |
|       from small pool |     856 MB |     857 MB |      70 GB |      69 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1442 GB |    1442 GB |
|       from large pool |   19933 KB |     153 MB |    1355 GB |    1355 GB |
|       from small pool |   11705 KB |     711 MB |      86 GB |      86 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1413 K  |    1400 K  |
|       from large pool |      28    |      36    |     313 K  |     313 K  |
|       from small pool |   13002    |   13011    |    1099 K  |    1086 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1413 K  |    1400 K  |
|       from large pool |      28    |      36    |     313 K  |     313 K  |
|       from small pool |   13002    |   13011    |    1099 K  |    1086 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |     890 K  |     889 K  |
|       from large pool |       7    |      11    |     245 K  |     245 K  |
|       from small pool |     437    |    2228    |     644 K  |     644 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 15
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0076, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1549 GB |    1548 GB |
|       from large pool |     787 MB |     977 MB |    1473 GB |    1473 GB |
|       from small pool |     857 MB |     858 MB |      75 GB |      74 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1549 GB |    1548 GB |
|       from large pool |     787 MB |     977 MB |    1473 GB |    1473 GB |
|       from small pool |     857 MB |     858 MB |      75 GB |      74 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2138 GB |    2138 GB |
|       from large pool |   32920 KB |     261 MB |    2045 GB |    2045 GB |
|       from small pool |   10990 KB |     708 MB |      92 GB |      92 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1513 K  |    1500 K  |
|       from large pool |      61    |      69    |     336 K  |     336 K  |
|       from small pool |   13012    |   13020    |    1176 K  |    1163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1513 K  |    1500 K  |
|       from large pool |      61    |      69    |     336 K  |     336 K  |
|       from small pool |   13012    |   13020    |    1176 K  |    1163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |     977 K  |     976 K  |
|       from large pool |       9    |      15    |     287 K  |     287 K  |
|       from small pool |     438    |    2231    |     689 K  |     689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1548 GB |    1546 GB |
|       from large pool |     680 MB |     870 MB |    1472 GB |    1471 GB |
|       from small pool |     856 MB |     857 MB |      75 GB |      74 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1548 GB |    1546 GB |
|       from large pool |     680 MB |     870 MB |    1472 GB |    1471 GB |
|       from small pool |     856 MB |     857 MB |      75 GB |      74 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1545 GB |    1545 GB |
|       from large pool |   19933 KB |     153 MB |    1452 GB |    1452 GB |
|       from small pool |   11705 KB |     711 MB |      92 GB |      92 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1511 K  |    1498 K  |
|       from large pool |      28    |      36    |     336 K  |     336 K  |
|       from small pool |   13002    |   13011    |    1175 K  |    1162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1511 K  |    1498 K  |
|       from large pool |      28    |      36    |     336 K  |     336 K  |
|       from small pool |   13002    |   13011    |    1175 K  |    1162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |     952 K  |     952 K  |
|       from large pool |       7    |      11    |     263 K  |     263 K  |
|       from small pool |     437    |    2228    |     689 K  |     689 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 16
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0230, 0.8821], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1652 GB |    1651 GB |
|       from large pool |     787 MB |     977 MB |    1572 GB |    1571 GB |
|       from small pool |     857 MB |     858 MB |      80 GB |      79 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1652 GB |    1651 GB |
|       from large pool |     787 MB |     977 MB |    1572 GB |    1571 GB |
|       from small pool |     857 MB |     858 MB |      80 GB |      79 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2280 GB |    2280 GB |
|       from large pool |   32920 KB |     261 MB |    2181 GB |    2181 GB |
|       from small pool |   10990 KB |     708 MB |      98 GB |      98 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1611 K  |    1598 K  |
|       from large pool |      61    |      69    |     358 K  |     358 K  |
|       from small pool |   13012    |   13020    |    1252 K  |    1239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1611 K  |    1598 K  |
|       from large pool |      61    |      69    |     358 K  |     358 K  |
|       from small pool |   13012    |   13020    |    1252 K  |    1239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    1041 K  |    1041 K  |
|       from large pool |       9    |      15    |     306 K  |     306 K  |
|       from small pool |     438    |    2231    |     734 K  |     734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1651 GB |    1649 GB |
|       from large pool |     680 MB |     870 MB |    1570 GB |    1569 GB |
|       from small pool |     856 MB |     857 MB |      80 GB |      79 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1651 GB |    1649 GB |
|       from large pool |     680 MB |     870 MB |    1570 GB |    1569 GB |
|       from small pool |     856 MB |     857 MB |      80 GB |      79 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1648 GB |    1648 GB |
|       from large pool |   19933 KB |     153 MB |    1549 GB |    1549 GB |
|       from small pool |   11705 KB |     711 MB |      98 GB |      98 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1610 K  |    1597 K  |
|       from large pool |      28    |      36    |     358 K  |     358 K  |
|       from small pool |   13002    |   13011    |    1251 K  |    1238 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1610 K  |    1597 K  |
|       from large pool |      28    |      36    |     358 K  |     358 K  |
|       from small pool |   13002    |   13011    |    1251 K  |    1238 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1015 K  |    1015 K  |
|       from large pool |       7    |      11    |     280 K  |     280 K  |
|       from small pool |     437    |    2228    |     734 K  |     734 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 17
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0288, 0.8558], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1755 GB |    1754 GB |
|       from large pool |     787 MB |     977 MB |    1670 GB |    1669 GB |
|       from small pool |     857 MB |     858 MB |      85 GB |      84 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1755 GB |    1754 GB |
|       from large pool |     787 MB |     977 MB |    1670 GB |    1669 GB |
|       from small pool |     857 MB |     858 MB |      85 GB |      84 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2423 GB |    2423 GB |
|       from large pool |   32920 KB |     261 MB |    2318 GB |    2318 GB |
|       from small pool |   10990 KB |     708 MB |     104 GB |     104 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1710 K  |    1697 K  |
|       from large pool |      61    |      69    |     381 K  |     381 K  |
|       from small pool |   13012    |   13020    |    1329 K  |    1316 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1710 K  |    1697 K  |
|       from large pool |      61    |      69    |     381 K  |     381 K  |
|       from small pool |   13012    |   13020    |    1329 K  |    1316 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    1105 K  |    1105 K  |
|       from large pool |       9    |      15    |     325 K  |     325 K  |
|       from small pool |     437    |    2231    |     780 K  |     779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1754 GB |    1752 GB |
|       from large pool |     680 MB |     870 MB |    1668 GB |    1667 GB |
|       from small pool |     856 MB |     857 MB |      85 GB |      84 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1754 GB |    1752 GB |
|       from large pool |     680 MB |     870 MB |    1668 GB |    1667 GB |
|       from small pool |     856 MB |     857 MB |      85 GB |      84 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1751 GB |    1751 GB |
|       from large pool |   19933 KB |     153 MB |    1646 GB |    1646 GB |
|       from small pool |   11705 KB |     711 MB |     104 GB |     104 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1708 K  |    1695 K  |
|       from large pool |      28    |      36    |     380 K  |     380 K  |
|       from small pool |   13002    |   13011    |    1327 K  |    1314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1708 K  |    1695 K  |
|       from large pool |      28    |      36    |     380 K  |     380 K  |
|       from small pool |   13002    |   13011    |    1327 K  |    1314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1078 K  |    1077 K  |
|       from large pool |       7    |      11    |     298 K  |     298 K  |
|       from small pool |     437    |    2228    |     779 K  |     779 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 18
batch input size: batch input size:torch.Size([16, 1855])  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0139, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1858 GB |    1857 GB |
|       from large pool |     787 MB |     977 MB |    1768 GB |    1767 GB |
|       from small pool |     857 MB |     858 MB |      90 GB |      89 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1858 GB |    1857 GB |
|       from large pool |     787 MB |     977 MB |    1768 GB |    1767 GB |
|       from small pool |     857 MB |     858 MB |      90 GB |      89 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2565 GB |    2565 GB |
|       from large pool |   32920 KB |     261 MB |    2454 GB |    2454 GB |
|       from small pool |   10990 KB |     708 MB |     110 GB |     110 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1809 K  |    1796 K  |
|       from large pool |      61    |      69    |     403 K  |     403 K  |
|       from small pool |   13012    |   13020    |    1405 K  |    1392 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1809 K  |    1796 K  |
|       from large pool |      61    |      69    |     403 K  |     403 K  |
|       from small pool |   13012    |   13020    |    1405 K  |    1392 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    1170 K  |    1169 K  |
|       from large pool |       9    |      15    |     344 K  |     344 K  |
|       from small pool |     437    |    2231    |     825 K  |     824 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1856 GB |    1855 GB |
|       from large pool |     680 MB |     870 MB |    1766 GB |    1766 GB |
|       from small pool |     856 MB |     857 MB |      90 GB |      89 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1856 GB |    1855 GB |
|       from large pool |     680 MB |     870 MB |    1766 GB |    1766 GB |
|       from small pool |     856 MB |     857 MB |      90 GB |      89 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1854 GB |    1854 GB |
|       from large pool |   19933 KB |     153 MB |    1743 GB |    1743 GB |
|       from small pool |   11705 KB |     711 MB |     111 GB |     110 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1807 K  |    1794 K  |
|       from large pool |      28    |      36    |     403 K  |     403 K  |
|       from small pool |   13002    |   13011    |    1404 K  |    1391 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1807 K  |    1794 K  |
|       from large pool |      28    |      36    |     403 K  |     403 K  |
|       from small pool |   13002    |   13011    |    1404 K  |    1391 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1140 K  |    1140 K  |
|       from large pool |       7    |      11    |     315 K  |     315 K  |
|       from small pool |     437    |    2228    |     824 K  |     824 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 19
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0125, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    1961 GB |    1960 GB |
|       from large pool |     787 MB |     977 MB |    1866 GB |    1865 GB |
|       from small pool |     857 MB |     858 MB |      95 GB |      94 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    1961 GB |    1960 GB |
|       from large pool |     787 MB |     977 MB |    1866 GB |    1865 GB |
|       from small pool |     857 MB |     858 MB |      95 GB |      94 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2708 GB |    2708 GB |
|       from large pool |   32920 KB |     261 MB |    2591 GB |    2591 GB |
|       from small pool |   10990 KB |     708 MB |     117 GB |     117 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    1907 K  |    1894 K  |
|       from large pool |      61    |      69    |     426 K  |     426 K  |
|       from small pool |   13012    |   13020    |    1481 K  |    1468 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    1907 K  |    1894 K  |
|       from large pool |      61    |      69    |     426 K  |     426 K  |
|       from small pool |   13012    |   13020    |    1481 K  |    1468 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    1234 K  |    1233 K  |
|       from large pool |       9    |      15    |     364 K  |     364 K  |
|       from small pool |     439    |    2231    |     870 K  |     869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    1959 GB |    1958 GB |
|       from large pool |     680 MB |     870 MB |    1864 GB |    1864 GB |
|       from small pool |     856 MB |     857 MB |      95 GB |      94 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    1959 GB |    1958 GB |
|       from large pool |     680 MB |     870 MB |    1864 GB |    1864 GB |
|       from small pool |     856 MB |     857 MB |      95 GB |      94 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    1957 GB |    1957 GB |
|       from large pool |   19933 KB |     153 MB |    1840 GB |    1840 GB |
|       from small pool |   11705 KB |     711 MB |     117 GB |     117 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    1905 K  |    1892 K  |
|       from large pool |      28    |      36    |     425 K  |     425 K  |
|       from small pool |   13002    |   13011    |    1480 K  |    1467 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    1905 K  |    1892 K  |
|       from large pool |      28    |      36    |     425 K  |     425 K  |
|       from small pool |   13002    |   13011    |    1480 K  |    1467 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1203 K  |    1202 K  |
|       from large pool |       7    |      11    |     333 K  |     333 K  |
|       from small pool |     437    |    2228    |     869 K  |     869 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 20
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device: 0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0315, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2065 GB |    2063 GB |
|       from large pool |     787 MB |     977 MB |    1964 GB |    1964 GB |
|       from small pool |     857 MB |     858 MB |     100 GB |      99 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2065 GB |    2063 GB |
|       from large pool |     787 MB |     977 MB |    1964 GB |    1964 GB |
|       from small pool |     857 MB |     858 MB |     100 GB |      99 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2850 GB |    2850 GB |
|       from large pool |   32920 KB |     261 MB |    2727 GB |    2727 GB |
|       from small pool |   10990 KB |     708 MB |     123 GB |     123 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2006 K  |    1993 K  |
|       from large pool |      61    |      69    |     448 K  |     448 K  |
|       from small pool |   13012    |   13020    |    1557 K  |    1544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2006 K  |    1993 K  |
|       from large pool |      61    |      69    |     448 K  |     448 K  |
|       from small pool |   13012    |   13020    |    1557 K  |    1544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    1298 K  |    1298 K  |
|       from large pool |       9    |      15    |     383 K  |     383 K  |
|       from small pool |     440    |    2231    |     915 K  |     914 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2062 GB |    2061 GB |
|       from large pool |     680 MB |     870 MB |    1962 GB |    1962 GB |
|       from small pool |     856 MB |     857 MB |     100 GB |      99 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2062 GB |    2061 GB |
|       from large pool |     680 MB |     870 MB |    1962 GB |    1962 GB |
|       from small pool |     856 MB |     857 MB |     100 GB |      99 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2060 GB |    2060 GB |
|       from large pool |   19933 KB |     153 MB |    1937 GB |    1937 GB |
|       from small pool |   11705 KB |     711 MB |     123 GB |     123 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2004 K  |    1991 K  |
|       from large pool |      28    |      36    |     448 K  |     448 K  |
|       from small pool |   13002    |   13011    |    1556 K  |    1543 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2004 K  |    1991 K  |
|       from large pool |      28    |      36    |     448 K  |     448 K  |
|       from small pool |   13002    |   13011    |    1556 K  |    1543 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1265 K  |    1265 K  |
|       from large pool |       7    |      11    |     351 K  |     351 K  |
|       from small pool |     437    |    2228    |     914 K  |     914 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 21
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0299, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2168 GB |    2166 GB |
|       from large pool |     787 MB |     977 MB |    2063 GB |    2062 GB |
|       from small pool |     857 MB |     858 MB |     105 GB |     104 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2168 GB |    2166 GB |
|       from large pool |     787 MB |     977 MB |    2063 GB |    2062 GB |
|       from small pool |     857 MB |     858 MB |     105 GB |     104 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    2992 GB |    2992 GB |
|       from large pool |   32920 KB |     261 MB |    2863 GB |    2863 GB |
|       from small pool |   10990 KB |     708 MB |     129 GB |     129 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2105 K  |    2091 K  |
|       from large pool |      61    |      69    |     471 K  |     470 K  |
|       from small pool |   13012    |   13020    |    1634 K  |    1620 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2105 K  |    2091 K  |
|       from large pool |      61    |      69    |     471 K  |     470 K  |
|       from small pool |   13012    |   13020    |    1634 K  |    1620 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    1362 K  |    1362 K  |
|       from large pool |       9    |      15    |     402 K  |     402 K  |
|       from small pool |     436    |    2231    |     960 K  |     959 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2165 GB |    2164 GB |
|       from large pool |     680 MB |     870 MB |    2060 GB |    2060 GB |
|       from small pool |     856 MB |     857 MB |     105 GB |     104 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2165 GB |    2164 GB |
|       from large pool |     680 MB |     870 MB |    2060 GB |    2060 GB |
|       from small pool |     856 MB |     857 MB |     105 GB |     104 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2163 GB |    2163 GB |
|       from large pool |   19933 KB |     153 MB |    2033 GB |    2033 GB |
|       from small pool |   11705 KB |     711 MB |     129 GB |     129 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2103 K  |    2089 K  |
|       from large pool |      28    |      36    |     470 K  |     470 K  |
|       from small pool |   13002    |   13011    |    1632 K  |    1619 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2103 K  |    2089 K  |
|       from large pool |      28    |      36    |     470 K  |     470 K  |
|       from small pool |   13002    |   13011    |    1632 K  |    1619 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1328 K  |    1328 K  |
|       from large pool |       7    |      11    |     368 K  |     368 K  |
|       from small pool |     437    |    2228    |     960 K  |     959 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 22
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0134, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2271 GB |    2269 GB |
|       from large pool |     787 MB |     977 MB |    2161 GB |    2160 GB |
|       from small pool |     857 MB |     858 MB |     109 GB |     109 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2271 GB |    2269 GB |
|       from large pool |     787 MB |     977 MB |    2161 GB |    2160 GB |
|       from small pool |     857 MB |     858 MB |     109 GB |     109 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3135 GB |    3135 GB |
|       from large pool |   32920 KB |     261 MB |    3000 GB |    3000 GB |
|       from small pool |   10990 KB |     708 MB |     135 GB |     135 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2203 K  |    2190 K  |
|       from large pool |      61    |      69    |     493 K  |     493 K  |
|       from small pool |   13012    |   13020    |    1710 K  |    1697 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2203 K  |    2190 K  |
|       from large pool |      61    |      69    |     493 K  |     493 K  |
|       from small pool |   13012    |   13020    |    1710 K  |    1697 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    1426 K  |    1426 K  |
|       from large pool |       9    |      15    |     421 K  |     421 K  |
|       from small pool |     439    |    2231    |    1005 K  |    1004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2268 GB |    2267 GB |
|       from large pool |     680 MB |     870 MB |    2159 GB |    2158 GB |
|       from small pool |     856 MB |     857 MB |     109 GB |     109 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2268 GB |    2267 GB |
|       from large pool |     680 MB |     870 MB |    2159 GB |    2158 GB |
|       from small pool |     856 MB |     857 MB |     109 GB |     109 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2265 GB |    2265 GB |
|       from large pool |   19933 KB |     153 MB |    2130 GB |    2130 GB |
|       from small pool |   11705 KB |     711 MB |     135 GB |     135 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2201 K  |    2188 K  |
|       from large pool |      28    |      36    |     492 K  |     492 K  |
|       from small pool |   13002    |   13011    |    1708 K  |    1695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2201 K  |    2188 K  |
|       from large pool |      28    |      36    |     492 K  |     492 K  |
|       from small pool |   13002    |   13011    |    1708 K  |    1695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1391 K  |    1390 K  |
|       from large pool |       7    |      11    |     386 K  |     386 K  |
|       from small pool |     437    |    2228    |    1005 K  |    1004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 23
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0167, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2374 GB |    2372 GB |
|       from large pool |     787 MB |     977 MB |    2259 GB |    2258 GB |
|       from small pool |     857 MB |     858 MB |     114 GB |     113 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2374 GB |    2372 GB |
|       from large pool |     787 MB |     977 MB |    2259 GB |    2258 GB |
|       from small pool |     857 MB |     858 MB |     114 GB |     113 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3277 GB |    3277 GB |
|       from large pool |   32920 KB |     261 MB |    3136 GB |    3136 GB |
|       from small pool |   10990 KB |     708 MB |     141 GB |     141 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2302 K  |    2289 K  |
|       from large pool |      61    |      69    |     515 K  |     515 K  |
|       from small pool |   13012    |   13020    |    1786 K  |    1773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2302 K  |    2289 K  |
|       from large pool |      61    |      69    |     515 K  |     515 K  |
|       from small pool |   13012    |   13020    |    1786 K  |    1773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    1491 K  |    1490 K  |
|       from large pool |       9    |      15    |     440 K  |     440 K  |
|       from small pool |     438    |    2231    |    1050 K  |    1050 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2371 GB |    2370 GB |
|       from large pool |     680 MB |     870 MB |    2257 GB |    2256 GB |
|       from small pool |     856 MB |     857 MB |     114 GB |     113 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2371 GB |    2370 GB |
|       from large pool |     680 MB |     870 MB |    2257 GB |    2256 GB |
|       from small pool |     856 MB |     857 MB |     114 GB |     113 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2368 GB |    2368 GB |
|       from large pool |   19933 KB |     153 MB |    2227 GB |    2227 GB |
|       from small pool |   11705 KB |     711 MB |     141 GB |     141 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2300 K  |    2287 K  |
|       from large pool |      28    |      36    |     515 K  |     515 K  |
|       from small pool |   13002    |   13011    |    1784 K  |    1771 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2300 K  |    2287 K  |
|       from large pool |      28    |      36    |     515 K  |     515 K  |
|       from small pool |   13002    |   13011    |    1784 K  |    1771 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1453 K  |    1453 K  |
|       from large pool |       7    |      11    |     403 K  |     403 K  |
|       from small pool |     437    |    2228    |    1050 K  |    1049 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 24
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0096, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2477 GB |    2475 GB |
|       from large pool |     787 MB |     977 MB |    2357 GB |    2356 GB |
|       from small pool |     857 MB |     858 MB |     119 GB |     118 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2477 GB |    2475 GB |
|       from large pool |     787 MB |     977 MB |    2357 GB |    2356 GB |
|       from small pool |     857 MB |     858 MB |     119 GB |     118 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3420 GB |    3420 GB |
|       from large pool |   32920 KB |     261 MB |    3272 GB |    3272 GB |
|       from small pool |   10990 KB |     708 MB |     147 GB |     147 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2400 K  |    2387 K  |
|       from large pool |      61    |      69    |     538 K  |     538 K  |
|       from small pool |   13012    |   13020    |    1862 K  |    1849 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2400 K  |    2387 K  |
|       from large pool |      61    |      69    |     538 K  |     538 K  |
|       from small pool |   13012    |   13020    |    1862 K  |    1849 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    1555 K  |    1555 K  |
|       from large pool |       9    |      15    |     459 K  |     459 K  |
|       from small pool |     438    |    2231    |    1095 K  |    1095 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2474 GB |    2473 GB |
|       from large pool |     680 MB |     870 MB |    2355 GB |    2354 GB |
|       from small pool |     856 MB |     857 MB |     119 GB |     118 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2474 GB |    2473 GB |
|       from large pool |     680 MB |     870 MB |    2355 GB |    2354 GB |
|       from small pool |     856 MB |     857 MB |     119 GB |     118 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2471 GB |    2471 GB |
|       from large pool |   19933 KB |     153 MB |    2324 GB |    2324 GB |
|       from small pool |   11705 KB |     711 MB |     147 GB |     147 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2398 K  |    2385 K  |
|       from large pool |      28    |      36    |     537 K  |     537 K  |
|       from small pool |   13002    |   13011    |    1860 K  |    1847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2398 K  |    2385 K  |
|       from large pool |      28    |      36    |     537 K  |     537 K  |
|       from small pool |   13002    |   13011    |    1860 K  |    1847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1516 K  |    1515 K  |
|       from large pool |       7    |      11    |     421 K  |     421 K  |
|       from small pool |     437    |    2228    |    1095 K  |    1094 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 25
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0201, 0.8822], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2580 GB |    2578 GB |
|       from large pool |     787 MB |     977 MB |    2455 GB |    2455 GB |
|       from small pool |     857 MB |     858 MB |     124 GB |     123 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2580 GB |    2578 GB |
|       from large pool |     787 MB |     977 MB |    2455 GB |    2455 GB |
|       from small pool |     857 MB |     858 MB |     124 GB |     123 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3562 GB |    3562 GB |
|       from large pool |   32920 KB |     261 MB |    3409 GB |    3409 GB |
|       from small pool |   10990 KB |     708 MB |     153 GB |     153 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2499 K  |    2486 K  |
|       from large pool |      61    |      69    |     560 K  |     560 K  |
|       from small pool |   13012    |   13020    |    1938 K  |    1925 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2499 K  |    2486 K  |
|       from large pool |      61    |      69    |     560 K  |     560 K  |
|       from small pool |   13012    |   13020    |    1938 K  |    1925 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    1619 K  |    1619 K  |
|       from large pool |       9    |      15    |     479 K  |     479 K  |
|       from small pool |     438    |    2231    |    1140 K  |    1140 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2577 GB |    2576 GB |
|       from large pool |     680 MB |     870 MB |    2453 GB |    2452 GB |
|       from small pool |     856 MB |     857 MB |     124 GB |     123 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2577 GB |    2576 GB |
|       from large pool |     680 MB |     870 MB |    2453 GB |    2452 GB |
|       from small pool |     856 MB |     857 MB |     124 GB |     123 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2574 GB |    2574 GB |
|       from large pool |   19933 KB |     153 MB |    2421 GB |    2421 GB |
|       from small pool |   11705 KB |     711 MB |     153 GB |     153 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2497 K  |    2484 K  |
|       from large pool |      28    |      36    |     560 K  |     560 K  |
|       from small pool |   13002    |   13011    |    1937 K  |    1924 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2497 K  |    2484 K  |
|       from large pool |      28    |      36    |     560 K  |     560 K  |
|       from small pool |   13002    |   13011    |    1937 K  |    1924 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1578 K  |    1578 K  |
|       from large pool |       7    |      11    |     438 K  |     438 K  |
|       from small pool |     437    |    2228    |    1140 K  |    1139 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 26
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0100, 0.8558], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2683 GB |    2682 GB |
|       from large pool |     787 MB |     977 MB |    2554 GB |    2553 GB |
|       from small pool |     857 MB |     858 MB |     129 GB |     128 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2683 GB |    2682 GB |
|       from large pool |     787 MB |     977 MB |    2554 GB |    2553 GB |
|       from small pool |     857 MB |     858 MB |     129 GB |     128 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3704 GB |    3704 GB |
|       from large pool |   32920 KB |     261 MB |    3545 GB |    3545 GB |
|       from small pool |   10990 KB |     708 MB |     159 GB |     159 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2598 K  |    2585 K  |
|       from large pool |      61    |      69    |     583 K  |     583 K  |
|       from small pool |   13012    |   13020    |    2015 K  |    2002 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2598 K  |    2585 K  |
|       from large pool |      61    |      69    |     583 K  |     583 K  |
|       from small pool |   13012    |   13020    |    2015 K  |    2002 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    1684 K  |    1683 K  |
|       from large pool |       9    |      15    |     498 K  |     498 K  |
|       from small pool |     437    |    2231    |    1185 K  |    1185 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2680 GB |    2679 GB |
|       from large pool |     680 MB |     870 MB |    2551 GB |    2550 GB |
|       from small pool |     856 MB |     857 MB |     129 GB |     128 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2680 GB |    2679 GB |
|       from large pool |     680 MB |     870 MB |    2551 GB |    2550 GB |
|       from small pool |     856 MB |     857 MB |     129 GB |     128 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2677 GB |    2677 GB |
|       from large pool |   19933 KB |     153 MB |    2518 GB |    2518 GB |
|       from small pool |   11705 KB |     711 MB |     159 GB |     159 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2595 K  |    2582 K  |
|       from large pool |      28    |      36    |     582 K  |     582 K  |
|       from small pool |   13002    |   13011    |    2013 K  |    2000 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2595 K  |    2582 K  |
|       from large pool |      28    |      36    |     582 K  |     582 K  |
|       from small pool |   13002    |   13011    |    2013 K  |    2000 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1641 K  |    1641 K  |
|       from large pool |       7    |      11    |     456 K  |     456 K  |
|       from small pool |     437    |    2228    |    1185 K  |    1184 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 27
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0163, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2786 GB |    2785 GB |
|       from large pool |     787 MB |     977 MB |    2652 GB |    2651 GB |
|       from small pool |     857 MB |     858 MB |     134 GB |     133 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2786 GB |    2785 GB |
|       from large pool |     787 MB |     977 MB |    2652 GB |    2651 GB |
|       from small pool |     857 MB |     858 MB |     134 GB |     133 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3847 GB |    3847 GB |
|       from large pool |   32920 KB |     261 MB |    3682 GB |    3681 GB |
|       from small pool |   10990 KB |     708 MB |     165 GB |     165 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2696 K  |    2683 K  |
|       from large pool |      61    |      69    |     605 K  |     605 K  |
|       from small pool |   13012    |   13020    |    2091 K  |    2078 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2696 K  |    2683 K  |
|       from large pool |      61    |      69    |     605 K  |     605 K  |
|       from small pool |   13012    |   13020    |    2091 K  |    2078 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    1748 K  |    1747 K  |
|       from large pool |       9    |      15    |     517 K  |     517 K  |
|       from small pool |     437    |    2231    |    1230 K  |    1230 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2783 GB |    2782 GB |
|       from large pool |     680 MB |     870 MB |    2649 GB |    2648 GB |
|       from small pool |     856 MB |     857 MB |     134 GB |     133 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2783 GB |    2782 GB |
|       from large pool |     680 MB |     870 MB |    2649 GB |    2648 GB |
|       from small pool |     856 MB |     857 MB |     134 GB |     133 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2780 GB |    2780 GB |
|       from large pool |   19933 KB |     153 MB |    2615 GB |    2615 GB |
|       from small pool |   11705 KB |     711 MB |     165 GB |     165 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2694 K  |    2681 K  |
|       from large pool |      28    |      36    |     604 K  |     604 K  |
|       from small pool |   13002    |   13011    |    2089 K  |    2076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2694 K  |    2681 K  |
|       from large pool |      28    |      36    |     604 K  |     604 K  |
|       from small pool |   13002    |   13011    |    2089 K  |    2076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1704 K  |    1703 K  |
|       from large pool |       7    |      11    |     473 K  |     473 K  |
|       from small pool |     437    |    2228    |    1230 K  |    1229 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 28
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0079, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2889 GB |    2888 GB |
|       from large pool |     787 MB |     977 MB |    2750 GB |    2749 GB |
|       from small pool |     857 MB |     858 MB |     139 GB |     138 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2889 GB |    2888 GB |
|       from large pool |     787 MB |     977 MB |    2750 GB |    2749 GB |
|       from small pool |     857 MB |     858 MB |     139 GB |     138 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    3989 GB |    3989 GB |
|       from large pool |   32920 KB |     261 MB |    3818 GB |    3818 GB |
|       from small pool |   10990 KB |     708 MB |     171 GB |     171 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2795 K  |    2782 K  |
|       from large pool |      61    |      69    |     628 K  |     627 K  |
|       from small pool |   13012    |   13020    |    2167 K  |    2154 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2795 K  |    2782 K  |
|       from large pool |      61    |      69    |     628 K  |     627 K  |
|       from small pool |   13012    |   13020    |    2167 K  |    2154 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    1812 K  |    1812 K  |
|       from large pool |       9    |      15    |     536 K  |     536 K  |
|       from small pool |     439    |    2231    |    1275 K  |    1275 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2886 GB |    2885 GB |
|       from large pool |     680 MB |     870 MB |    2747 GB |    2746 GB |
|       from small pool |     856 MB |     857 MB |     139 GB |     138 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2886 GB |    2885 GB |
|       from large pool |     680 MB |     870 MB |    2747 GB |    2746 GB |
|       from small pool |     856 MB |     857 MB |     139 GB |     138 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2883 GB |    2883 GB |
|       from large pool |   19933 KB |     153 MB |    2711 GB |    2711 GB |
|       from small pool |   11705 KB |     711 MB |     171 GB |     171 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2792 K  |    2779 K  |
|       from large pool |      28    |      36    |     627 K  |     627 K  |
|       from small pool |   13002    |   13011    |    2165 K  |    2152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2792 K  |    2779 K  |
|       from large pool |      28    |      36    |     627 K  |     627 K  |
|       from small pool |   13002    |   13011    |    2165 K  |    2152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1766 K  |    1766 K  |
|       from large pool |       7    |      11    |     491 K  |     491 K  |
|       from small pool |     437    |    2228    |    1275 K  |    1274 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 29
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0384, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    2992 GB |    2991 GB |
|       from large pool |     787 MB |     977 MB |    2848 GB |    2847 GB |
|       from small pool |     857 MB |     858 MB |     144 GB |     143 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    2992 GB |    2991 GB |
|       from large pool |     787 MB |     977 MB |    2848 GB |    2847 GB |
|       from small pool |     857 MB |     858 MB |     144 GB |     143 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4132 GB |    4132 GB |
|       from large pool |   32920 KB |     261 MB |    3954 GB |    3954 GB |
|       from small pool |   10990 KB |     708 MB |     177 GB |     177 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2894 K  |    2881 K  |
|       from large pool |      61    |      69    |     650 K  |     650 K  |
|       from small pool |   13012    |   13020    |    2243 K  |    2230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2894 K  |    2881 K  |
|       from large pool |      61    |      69    |     650 K  |     650 K  |
|       from small pool |   13012    |   13020    |    2243 K  |    2230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    1876 K  |    1876 K  |
|       from large pool |       9    |      15    |     555 K  |     555 K  |
|       from small pool |     440    |    2231    |    1320 K  |    1320 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    2989 GB |    2988 GB |
|       from large pool |     680 MB |     870 MB |    2845 GB |    2845 GB |
|       from small pool |     856 MB |     857 MB |     144 GB |     143 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    2989 GB |    2988 GB |
|       from large pool |     680 MB |     870 MB |    2845 GB |    2845 GB |
|       from small pool |     856 MB |     857 MB |     144 GB |     143 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    2986 GB |    2986 GB |
|       from large pool |   19933 KB |     153 MB |    2808 GB |    2808 GB |
|       from small pool |   11705 KB |     711 MB |     177 GB |     177 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2891 K  |    2878 K  |
|       from large pool |      28    |      36    |     649 K  |     649 K  |
|       from small pool |   13002    |   13011    |    2241 K  |    2228 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2891 K  |    2878 K  |
|       from large pool |      28    |      36    |     649 K  |     649 K  |
|       from small pool |   13002    |   13011    |    2241 K  |    2228 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1829 K  |    1828 K  |
|       from large pool |       7    |      11    |     508 K  |     508 K  |
|       from small pool |     437    |    2228    |    1320 K  |    1319 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 30
batch input size: torch.Size([16, 1855]) Device: batch input size:0
torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0087, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3096 GB |    3094 GB |
|       from large pool |     787 MB |     977 MB |    2946 GB |    2946 GB |
|       from small pool |     857 MB |     858 MB |     149 GB |     148 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3096 GB |    3094 GB |
|       from large pool |     787 MB |     977 MB |    2946 GB |    2946 GB |
|       from small pool |     857 MB |     858 MB |     149 GB |     148 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4274 GB |    4274 GB |
|       from large pool |   32920 KB |     261 MB |    4091 GB |    4091 GB |
|       from small pool |   10990 KB |     708 MB |     183 GB |     183 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    2992 K  |    2979 K  |
|       from large pool |      61    |      69    |     672 K  |     672 K  |
|       from small pool |   13012    |   13020    |    2319 K  |    2306 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    2992 K  |    2979 K  |
|       from large pool |      61    |      69    |     672 K  |     672 K  |
|       from small pool |   13012    |   13020    |    2319 K  |    2306 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    1940 K  |    1940 K  |
|       from large pool |       9    |      15    |     574 K  |     574 K  |
|       from small pool |     436    |    2231    |    1365 K  |    1365 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3092 GB |    3091 GB |
|       from large pool |     680 MB |     870 MB |    2943 GB |    2943 GB |
|       from small pool |     856 MB |     857 MB |     149 GB |     148 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3092 GB |    3091 GB |
|       from large pool |     680 MB |     870 MB |    2943 GB |    2943 GB |
|       from small pool |     856 MB |     857 MB |     149 GB |     148 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3088 GB |    3088 GB |
|       from large pool |   19933 KB |     153 MB |    2905 GB |    2905 GB |
|       from small pool |   11705 KB |     711 MB |     183 GB |     183 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    2989 K  |    2976 K  |
|       from large pool |      28    |      36    |     672 K  |     672 K  |
|       from small pool |   13002    |   13011    |    2317 K  |    2304 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    2989 K  |    2976 K  |
|       from large pool |      28    |      36    |     672 K  |     672 K  |
|       from small pool |   13002    |   13011    |    2317 K  |    2304 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1891 K  |    1891 K  |
|       from large pool |       7    |      11    |     526 K  |     526 K  |
|       from small pool |     437    |    2228    |    1365 K  |    1365 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 31
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0082, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3199 GB |    3197 GB |
|       from large pool |     787 MB |     977 MB |    3045 GB |    3044 GB |
|       from small pool |     857 MB |     858 MB |     154 GB |     153 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3199 GB |    3197 GB |
|       from large pool |     787 MB |     977 MB |    3045 GB |    3044 GB |
|       from small pool |     857 MB |     858 MB |     154 GB |     153 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4416 GB |    4416 GB |
|       from large pool |   32920 KB |     261 MB |    4227 GB |    4227 GB |
|       from small pool |   10990 KB |     708 MB |     189 GB |     189 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3091 K  |    3078 K  |
|       from large pool |      61    |      69    |     695 K  |     695 K  |
|       from small pool |   13012    |   13020    |    2396 K  |    2383 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3091 K  |    3078 K  |
|       from large pool |      61    |      69    |     695 K  |     695 K  |
|       from small pool |   13012    |   13020    |    2396 K  |    2383 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    2005 K  |    2004 K  |
|       from large pool |       9    |      15    |     594 K  |     594 K  |
|       from small pool |     439    |    2231    |    1411 K  |    1410 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3195 GB |    3194 GB |
|       from large pool |     680 MB |     870 MB |    3041 GB |    3041 GB |
|       from small pool |     856 MB |     857 MB |     153 GB |     153 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3195 GB |    3194 GB |
|       from large pool |     680 MB |     870 MB |    3041 GB |    3041 GB |
|       from small pool |     856 MB |     857 MB |     153 GB |     153 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3191 GB |    3191 GB |
|       from large pool |   19933 KB |     153 MB |    3002 GB |    3002 GB |
|       from small pool |   11705 KB |     711 MB |     189 GB |     189 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3088 K  |    3075 K  |
|       from large pool |      28    |      36    |     694 K  |     694 K  |
|       from small pool |   13002    |   13011    |    2393 K  |    2380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3088 K  |    3075 K  |
|       from large pool |      28    |      36    |     694 K  |     694 K  |
|       from small pool |   13002    |   13011    |    2393 K  |    2380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    1954 K  |    1954 K  |
|       from large pool |       7    |      11    |     544 K  |     544 K  |
|       from small pool |     437    |    2228    |    1410 K  |    1410 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 32
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0048, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3302 GB |    3300 GB |
|       from large pool |     787 MB |     977 MB |    3143 GB |    3142 GB |
|       from small pool |     857 MB |     858 MB |     158 GB |     158 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3302 GB |    3300 GB |
|       from large pool |     787 MB |     977 MB |    3143 GB |    3142 GB |
|       from small pool |     857 MB |     858 MB |     158 GB |     158 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4559 GB |    4559 GB |
|       from large pool |   32920 KB |     261 MB |    4363 GB |    4363 GB |
|       from small pool |   10990 KB |     708 MB |     195 GB |     195 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3190 K  |    3177 K  |
|       from large pool |      61    |      69    |     717 K  |     717 K  |
|       from small pool |   13012    |   13020    |    2472 K  |    2459 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3190 K  |    3177 K  |
|       from large pool |      61    |      69    |     717 K  |     717 K  |
|       from small pool |   13012    |   13020    |    2472 K  |    2459 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    2069 K  |    2068 K  |
|       from large pool |       9    |      15    |     613 K  |     613 K  |
|       from small pool |     438    |    2231    |    1456 K  |    1455 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3298 GB |    3297 GB |
|       from large pool |     680 MB |     870 MB |    3140 GB |    3139 GB |
|       from small pool |     856 MB |     857 MB |     158 GB |     158 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3298 GB |    3297 GB |
|       from large pool |     680 MB |     870 MB |    3140 GB |    3139 GB |
|       from small pool |     856 MB |     857 MB |     158 GB |     158 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3294 GB |    3294 GB |
|       from large pool |   19933 KB |     153 MB |    3099 GB |    3099 GB |
|       from small pool |   11705 KB |     711 MB |     195 GB |     195 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3187 K  |    3174 K  |
|       from large pool |      28    |      36    |     716 K  |     716 K  |
|       from small pool |   13002    |   13011    |    2470 K  |    2457 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3187 K  |    3174 K  |
|       from large pool |      28    |      36    |     716 K  |     716 K  |
|       from small pool |   13002    |   13011    |    2470 K  |    2457 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2017 K  |    2016 K  |
|       from large pool |       7    |      11    |     561 K  |     561 K  |
|       from small pool |     437    |    2228    |    1455 K  |    1455 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 33
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0264, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3405 GB |    3403 GB |
|       from large pool |     787 MB |     977 MB |    3241 GB |    3240 GB |
|       from small pool |     857 MB |     858 MB |     163 GB |     162 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3405 GB |    3403 GB |
|       from large pool |     787 MB |     977 MB |    3241 GB |    3240 GB |
|       from small pool |     857 MB |     858 MB |     163 GB |     162 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4701 GB |    4701 GB |
|       from large pool |   32920 KB |     261 MB |    4500 GB |    4500 GB |
|       from small pool |   10990 KB |     708 MB |     201 GB |     201 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3288 K  |    3275 K  |
|       from large pool |      61    |      69    |     740 K  |     740 K  |
|       from small pool |   13012    |   13020    |    2548 K  |    2535 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3288 K  |    3275 K  |
|       from large pool |      61    |      69    |     740 K  |     740 K  |
|       from small pool |   13012    |   13020    |    2548 K  |    2535 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    2133 K  |    2133 K  |
|       from large pool |       9    |      15    |     632 K  |     632 K  |
|       from small pool |     438    |    2231    |    1501 K  |    1500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3401 GB |    3400 GB |
|       from large pool |     680 MB |     870 MB |    3238 GB |    3237 GB |
|       from small pool |     856 MB |     857 MB |     163 GB |     162 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3401 GB |    3400 GB |
|       from large pool |     680 MB |     870 MB |    3238 GB |    3237 GB |
|       from small pool |     856 MB |     857 MB |     163 GB |     162 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3397 GB |    3397 GB |
|       from large pool |   19933 KB |     153 MB |    3196 GB |    3196 GB |
|       from small pool |   11705 KB |     711 MB |     201 GB |     201 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3285 K  |    3272 K  |
|       from large pool |      28    |      36    |     739 K  |     739 K  |
|       from small pool |   13002    |   13011    |    2546 K  |    2533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3285 K  |    3272 K  |
|       from large pool |      28    |      36    |     739 K  |     739 K  |
|       from small pool |   13002    |   13011    |    2546 K  |    2533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2079 K  |    2079 K  |
|       from large pool |       7    |      11    |     579 K  |     579 K  |
|       from small pool |     437    |    2228    |    1500 K  |    1500 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 34
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0138, 0.8822], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3508 GB |    3506 GB |
|       from large pool |     787 MB |     977 MB |    3339 GB |    3338 GB |
|       from small pool |     857 MB |     858 MB |     168 GB |     167 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3508 GB |    3506 GB |
|       from large pool |     787 MB |     977 MB |    3339 GB |    3338 GB |
|       from small pool |     857 MB |     858 MB |     168 GB |     167 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4844 GB |    4844 GB |
|       from large pool |   32920 KB |     261 MB |    4636 GB |    4636 GB |
|       from small pool |   10990 KB |     708 MB |     207 GB |     207 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3387 K  |    3374 K  |
|       from large pool |      61    |      69    |     762 K  |     762 K  |
|       from small pool |   13012    |   13020    |    2624 K  |    2611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3387 K  |    3374 K  |
|       from large pool |      61    |      69    |     762 K  |     762 K  |
|       from small pool |   13012    |   13020    |    2624 K  |    2611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    2197 K  |    2197 K  |
|       from large pool |       9    |      15    |     651 K  |     651 K  |
|       from small pool |     438    |    2231    |    1546 K  |    1545 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3504 GB |    3503 GB |
|       from large pool |     680 MB |     870 MB |    3336 GB |    3335 GB |
|       from small pool |     856 MB |     857 MB |     168 GB |     167 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3504 GB |    3503 GB |
|       from large pool |     680 MB |     870 MB |    3336 GB |    3335 GB |
|       from small pool |     856 MB |     857 MB |     168 GB |     167 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3500 GB |    3500 GB |
|       from large pool |   19933 KB |     153 MB |    3292 GB |    3292 GB |
|       from small pool |   11705 KB |     711 MB |     207 GB |     207 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3384 K  |    3371 K  |
|       from large pool |      28    |      36    |     761 K  |     761 K  |
|       from small pool |   13002    |   13011    |    2622 K  |    2609 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3384 K  |    3371 K  |
|       from large pool |      28    |      36    |     761 K  |     761 K  |
|       from small pool |   13002    |   13011    |    2622 K  |    2609 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2142 K  |    2141 K  |
|       from large pool |       7    |      11    |     596 K  |     596 K  |
|       from small pool |     437    |    2228    |    1545 K  |    1545 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 35
batch input size: torch.Size([16, 1855]) Device:batch input size:  0torch.Size([16, 1855])
 Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0290, 0.8559], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3611 GB |    3609 GB |
|       from large pool |     787 MB |     977 MB |    3437 GB |    3437 GB |
|       from small pool |     857 MB |     858 MB |     173 GB |     172 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3611 GB |    3609 GB |
|       from large pool |     787 MB |     977 MB |    3437 GB |    3437 GB |
|       from small pool |     857 MB |     858 MB |     173 GB |     172 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    4986 GB |    4986 GB |
|       from large pool |   32920 KB |     261 MB |    4772 GB |    4772 GB |
|       from small pool |   10990 KB |     708 MB |     213 GB |     213 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3486 K  |    3472 K  |
|       from large pool |      61    |      69    |     785 K  |     784 K  |
|       from small pool |   13012    |   13020    |    2701 K  |    2688 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3486 K  |    3472 K  |
|       from large pool |      61    |      69    |     785 K  |     784 K  |
|       from small pool |   13012    |   13020    |    2701 K  |    2688 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    2262 K  |    2261 K  |
|       from large pool |       9    |      15    |     670 K  |     670 K  |
|       from small pool |     437    |    2231    |    1591 K  |    1590 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3607 GB |    3606 GB |
|       from large pool |     680 MB |     870 MB |    3434 GB |    3433 GB |
|       from small pool |     856 MB |     857 MB |     173 GB |     172 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3607 GB |    3606 GB |
|       from large pool |     680 MB |     870 MB |    3434 GB |    3433 GB |
|       from small pool |     856 MB |     857 MB |     173 GB |     172 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3603 GB |    3603 GB |
|       from large pool |   19933 KB |     153 MB |    3389 GB |    3389 GB |
|       from small pool |   11705 KB |     711 MB |     213 GB |     213 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3482 K  |    3469 K  |
|       from large pool |      28    |      36    |     784 K  |     784 K  |
|       from small pool |   13002    |   13011    |    2698 K  |    2685 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3482 K  |    3469 K  |
|       from large pool |      28    |      36    |     784 K  |     784 K  |
|       from small pool |   13002    |   13011    |    2698 K  |    2685 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2204 K  |    2204 K  |
|       from large pool |       7    |      11    |     614 K  |     614 K  |
|       from small pool |     437    |    2228    |    1590 K  |    1590 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 36
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0107, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3714 GB |    3713 GB |
|       from large pool |     787 MB |     977 MB |    3536 GB |    3535 GB |
|       from small pool |     857 MB |     858 MB |     178 GB |     177 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3714 GB |    3713 GB |
|       from large pool |     787 MB |     977 MB |    3536 GB |    3535 GB |
|       from small pool |     857 MB |     858 MB |     178 GB |     177 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5128 GB |    5128 GB |
|       from large pool |   32920 KB |     261 MB |    4909 GB |    4909 GB |
|       from small pool |   10990 KB |     708 MB |     219 GB |     219 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3584 K  |    3571 K  |
|       from large pool |      61    |      69    |     807 K  |     807 K  |
|       from small pool |   13012    |   13020    |    2777 K  |    2764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3584 K  |    3571 K  |
|       from large pool |      61    |      69    |     807 K  |     807 K  |
|       from small pool |   13012    |   13020    |    2777 K  |    2764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    2326 K  |    2325 K  |
|       from large pool |       9    |      15    |     689 K  |     689 K  |
|       from small pool |     437    |    2231    |    1636 K  |    1636 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3710 GB |    3709 GB |
|       from large pool |     680 MB |     870 MB |    3532 GB |    3531 GB |
|       from small pool |     856 MB |     857 MB |     178 GB |     177 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3710 GB |    3709 GB |
|       from large pool |     680 MB |     870 MB |    3532 GB |    3531 GB |
|       from small pool |     856 MB |     857 MB |     178 GB |     177 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3706 GB |    3706 GB |
|       from large pool |   19933 KB |     153 MB |    3486 GB |    3486 GB |
|       from small pool |   11705 KB |     711 MB |     219 GB |     219 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3581 K  |    3568 K  |
|       from large pool |      28    |      36    |     806 K  |     806 K  |
|       from small pool |   13002    |   13011    |    2774 K  |    2761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3581 K  |    3568 K  |
|       from large pool |      28    |      36    |     806 K  |     806 K  |
|       from small pool |   13002    |   13011    |    2774 K  |    2761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2267 K  |    2267 K  |
|       from large pool |       7    |      11    |     631 K  |     631 K  |
|       from small pool |     437    |    2228    |    1635 K  |    1635 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 37
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0209, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3817 GB |    3816 GB |
|       from large pool |     787 MB |     977 MB |    3634 GB |    3633 GB |
|       from small pool |     857 MB |     858 MB |     183 GB |     182 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3817 GB |    3816 GB |
|       from large pool |     787 MB |     977 MB |    3634 GB |    3633 GB |
|       from small pool |     857 MB |     858 MB |     183 GB |     182 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5271 GB |    5271 GB |
|       from large pool |   32920 KB |     261 MB |    5045 GB |    5045 GB |
|       from small pool |   10990 KB |     708 MB |     225 GB |     225 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3683 K  |    3670 K  |
|       from large pool |      61    |      69    |     829 K  |     829 K  |
|       from small pool |   13012    |   13020    |    2853 K  |    2840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3683 K  |    3670 K  |
|       from large pool |      61    |      69    |     829 K  |     829 K  |
|       from small pool |   13012    |   13020    |    2853 K  |    2840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    2390 K  |    2390 K  |
|       from large pool |       9    |      15    |     709 K  |     709 K  |
|       from small pool |     439    |    2231    |    1681 K  |    1681 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3813 GB |    3812 GB |
|       from large pool |     680 MB |     870 MB |    3630 GB |    3629 GB |
|       from small pool |     856 MB |     857 MB |     183 GB |     182 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3813 GB |    3812 GB |
|       from large pool |     680 MB |     870 MB |    3630 GB |    3629 GB |
|       from small pool |     856 MB |     857 MB |     183 GB |     182 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3809 GB |    3809 GB |
|       from large pool |   19933 KB |     153 MB |    3583 GB |    3583 GB |
|       from small pool |   11705 KB |     711 MB |     225 GB |     225 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3679 K  |    3666 K  |
|       from large pool |      28    |      36    |     828 K  |     828 K  |
|       from small pool |   13002    |   13011    |    2850 K  |    2837 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3679 K  |    3666 K  |
|       from large pool |      28    |      36    |     828 K  |     828 K  |
|       from small pool |   13002    |   13011    |    2850 K  |    2837 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2330 K  |    2329 K  |
|       from large pool |       7    |      11    |     649 K  |     649 K  |
|       from small pool |     437    |    2228    |    1680 K  |    1680 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 38
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0071, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    3920 GB |    3919 GB |
|       from large pool |     787 MB |     977 MB |    3732 GB |    3731 GB |
|       from small pool |     857 MB |     858 MB |     188 GB |     187 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    3920 GB |    3919 GB |
|       from large pool |     787 MB |     977 MB |    3732 GB |    3731 GB |
|       from small pool |     857 MB |     858 MB |     188 GB |     187 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5413 GB |    5413 GB |
|       from large pool |   32920 KB |     261 MB |    5182 GB |    5182 GB |
|       from small pool |   10990 KB |     708 MB |     231 GB |     231 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3781 K  |    3768 K  |
|       from large pool |      61    |      69    |     852 K  |     852 K  |
|       from small pool |   13012    |   13020    |    2929 K  |    2916 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3781 K  |    3768 K  |
|       from large pool |      61    |      69    |     852 K  |     852 K  |
|       from small pool |   13012    |   13020    |    2929 K  |    2916 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    2454 K  |    2454 K  |
|       from large pool |       9    |      15    |     728 K  |     728 K  |
|       from small pool |     440    |    2231    |    1726 K  |    1726 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    3916 GB |    3915 GB |
|       from large pool |     680 MB |     870 MB |    3728 GB |    3727 GB |
|       from small pool |     856 MB |     857 MB |     188 GB |     187 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    3916 GB |    3915 GB |
|       from large pool |     680 MB |     870 MB |    3728 GB |    3727 GB |
|       from small pool |     856 MB |     857 MB |     188 GB |     187 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    3911 GB |    3911 GB |
|       from large pool |   19933 KB |     153 MB |    3680 GB |    3680 GB |
|       from small pool |   11705 KB |     711 MB |     231 GB |     231 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3778 K  |    3765 K  |
|       from large pool |      28    |      36    |     851 K  |     851 K  |
|       from small pool |   13002    |   13011    |    2926 K  |    2913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3778 K  |    3765 K  |
|       from large pool |      28    |      36    |     851 K  |     851 K  |
|       from small pool |   13002    |   13011    |    2926 K  |    2913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2392 K  |    2392 K  |
|       from large pool |       7    |      11    |     666 K  |     666 K  |
|       from small pool |     437    |    2228    |    1725 K  |    1725 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 39
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0519, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4023 GB |    4022 GB |
|       from large pool |     787 MB |     977 MB |    3830 GB |    3829 GB |
|       from small pool |     857 MB |     858 MB |     193 GB |     192 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4023 GB |    4022 GB |
|       from large pool |     787 MB |     977 MB |    3830 GB |    3829 GB |
|       from small pool |     857 MB |     858 MB |     193 GB |     192 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5556 GB |    5555 GB |
|       from large pool |   32920 KB |     261 MB |    5318 GB |    5318 GB |
|       from small pool |   10990 KB |     708 MB |     237 GB |     237 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3880 K  |    3867 K  |
|       from large pool |      61    |      69    |     874 K  |     874 K  |
|       from small pool |   13012    |   13020    |    3005 K  |    2992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3880 K  |    3867 K  |
|       from large pool |      61    |      69    |     874 K  |     874 K  |
|       from small pool |   13012    |   13020    |    3005 K  |    2992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    2519 K  |    2518 K  |
|       from large pool |       9    |      15    |     747 K  |     747 K  |
|       from small pool |     436    |    2231    |    1771 K  |    1771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4019 GB |    4018 GB |
|       from large pool |     680 MB |     870 MB |    3826 GB |    3826 GB |
|       from small pool |     856 MB |     857 MB |     193 GB |     192 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4019 GB |    4018 GB |
|       from large pool |     680 MB |     870 MB |    3826 GB |    3826 GB |
|       from small pool |     856 MB |     857 MB |     193 GB |     192 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4014 GB |    4014 GB |
|       from large pool |   19933 KB |     153 MB |    3777 GB |    3777 GB |
|       from small pool |   11705 KB |     711 MB |     237 GB |     237 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3876 K  |    3863 K  |
|       from large pool |      28    |      36    |     873 K  |     873 K  |
|       from small pool |   13002    |   13011    |    3003 K  |    2990 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3876 K  |    3863 K  |
|       from large pool |      28    |      36    |     873 K  |     873 K  |
|       from small pool |   13002    |   13011    |    3003 K  |    2990 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2455 K  |    2454 K  |
|       from large pool |       7    |      11    |     684 K  |     684 K  |
|       from small pool |     437    |    2228    |    1770 K  |    1770 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 40
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0168, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4127 GB |    4125 GB |
|       from large pool |     787 MB |     977 MB |    3928 GB |    3928 GB |
|       from small pool |     857 MB |     858 MB |     198 GB |     197 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4127 GB |    4125 GB |
|       from large pool |     787 MB |     977 MB |    3928 GB |    3928 GB |
|       from small pool |     857 MB |     858 MB |     198 GB |     197 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5698 GB |    5698 GB |
|       from large pool |   32920 KB |     261 MB |    5454 GB |    5454 GB |
|       from small pool |   10990 KB |     708 MB |     243 GB |     243 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    3979 K  |    3966 K  |
|       from large pool |      61    |      69    |     897 K  |     897 K  |
|       from small pool |   13012    |   13020    |    3082 K  |    3069 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    3979 K  |    3966 K  |
|       from large pool |      61    |      69    |     897 K  |     897 K  |
|       from small pool |   13012    |   13020    |    3082 K  |    3069 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    2583 K  |    2582 K  |
|       from large pool |       9    |      15    |     766 K  |     766 K  |
|       from small pool |     439    |    2231    |    1816 K  |    1816 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4122 GB |    4121 GB |
|       from large pool |     680 MB |     870 MB |    3924 GB |    3924 GB |
|       from small pool |     856 MB |     857 MB |     198 GB |     197 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4122 GB |    4121 GB |
|       from large pool |     680 MB |     870 MB |    3924 GB |    3924 GB |
|       from small pool |     856 MB |     857 MB |     198 GB |     197 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4117 GB |    4117 GB |
|       from large pool |   19933 KB |     153 MB |    3874 GB |    3874 GB |
|       from small pool |   11705 KB |     711 MB |     243 GB |     243 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    3975 K  |    3962 K  |
|       from large pool |      28    |      36    |     896 K  |     896 K  |
|       from small pool |   13002    |   13011    |    3079 K  |    3066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    3975 K  |    3962 K  |
|       from large pool |      28    |      36    |     896 K  |     896 K  |
|       from small pool |   13002    |   13011    |    3079 K  |    3066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2517 K  |    2517 K  |
|       from large pool |       7    |      11    |     702 K  |     702 K  |
|       from small pool |     437    |    2228    |    1815 K  |    1815 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 41
batch input size: torch.Size([16, 1855]) Device: batch input size:0
torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0099, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4230 GB |    4228 GB |
|       from large pool |     787 MB |     977 MB |    4027 GB |    4026 GB |
|       from small pool |     857 MB |     858 MB |     203 GB |     202 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4230 GB |    4228 GB |
|       from large pool |     787 MB |     977 MB |    4027 GB |    4026 GB |
|       from small pool |     857 MB |     858 MB |     203 GB |     202 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5840 GB |    5840 GB |
|       from large pool |   32920 KB |     261 MB |    5591 GB |    5591 GB |
|       from small pool |   10990 KB |     708 MB |     249 GB |     249 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4077 K  |    4064 K  |
|       from large pool |      61    |      69    |     919 K  |     919 K  |
|       from small pool |   13012    |   13020    |    3158 K  |    3145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4077 K  |    4064 K  |
|       from large pool |      61    |      69    |     919 K  |     919 K  |
|       from small pool |   13012    |   13020    |    3158 K  |    3145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    2647 K  |    2647 K  |
|       from large pool |       9    |      15    |     785 K  |     785 K  |
|       from small pool |     438    |    2231    |    1861 K  |    1861 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4225 GB |    4224 GB |
|       from large pool |     680 MB |     870 MB |    4022 GB |    4022 GB |
|       from small pool |     856 MB |     857 MB |     202 GB |     202 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4225 GB |    4224 GB |
|       from large pool |     680 MB |     870 MB |    4022 GB |    4022 GB |
|       from small pool |     856 MB |     857 MB |     202 GB |     202 GB |
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4220 GB |    4220 GB |
|       from large pool |   19933 KB |     153 MB |    3970 GB |    3970 GB |
|       from small pool |   11705 KB |     711 MB |     249 GB |     249 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4073 K  |    4060 K  |
|       from large pool |      28    |      36    |     918 K  |     918 K  |
|       from small pool |   13002    |   13011    |    3155 K  |    3142 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4073 K  |    4060 K  |
|       from large pool |      28    |      36    |     918 K  |     918 K  |
|       from small pool |   13002    |   13011    |    3155 K  |    3142 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2580 K  |    2580 K  |
|       from large pool |       7    |      11    |     719 K  |     719 K  |
|       from small pool |     437    |    2228    |    1861 K  |    1860 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 42
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0069, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4333 GB |    4331 GB |
|       from large pool |     787 MB |     977 MB |    4125 GB |    4124 GB |
|       from small pool |     857 MB |     858 MB |     207 GB |     207 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4333 GB |    4331 GB |
|       from large pool |     787 MB |     977 MB |    4125 GB |    4124 GB |
|       from small pool |     857 MB |     858 MB |     207 GB |     207 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    5983 GB |    5983 GB |
|       from large pool |   32920 KB |     261 MB |    5727 GB |    5727 GB |
|       from small pool |   10990 KB |     708 MB |     255 GB |     255 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4176 K  |    4163 K  |
|       from large pool |      61    |      69    |     942 K  |     941 K  |
|       from small pool |   13012    |   13020    |    3234 K  |    3221 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4176 K  |    4163 K  |
|       from large pool |      61    |      69    |     942 K  |     941 K  |
|       from small pool |   13012    |   13020    |    3234 K  |    3221 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    2711 K  |    2711 K  |
|       from large pool |       9    |      15    |     804 K  |     804 K  |
|       from small pool |     438    |    2231    |    1906 K  |    1906 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4328 GB |    4327 GB |
|       from large pool |     680 MB |     870 MB |    4121 GB |    4120 GB |
|       from small pool |     856 MB |     857 MB |     207 GB |     207 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4328 GB |    4327 GB |
|       from large pool |     680 MB |     870 MB |    4121 GB |    4120 GB |
|       from small pool |     856 MB |     857 MB |     207 GB |     207 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4323 GB |    4323 GB |
|       from large pool |   19933 KB |     153 MB |    4067 GB |    4067 GB |
|       from small pool |   11705 KB |     711 MB |     255 GB |     255 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4172 K  |    4159 K  |
|       from large pool |      28    |      36    |     940 K  |     940 K  |
|       from small pool |   13002    |   13011    |    3231 K  |    3218 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4172 K  |    4159 K  |
|       from large pool |      28    |      36    |     940 K  |     940 K  |
|       from small pool |   13002    |   13011    |    3231 K  |    3218 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2643 K  |    2642 K  |
|       from large pool |       7    |      11    |     737 K  |     737 K  |
|       from small pool |     437    |    2228    |    1906 K  |    1905 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 43
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0176, 0.8822], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4436 GB |    4434 GB |
|       from large pool |     787 MB |     977 MB |    4223 GB |    4222 GB |
|       from small pool |     857 MB |     858 MB |     212 GB |     211 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4436 GB |    4434 GB |
|       from large pool |     787 MB |     977 MB |    4223 GB |    4222 GB |
|       from small pool |     857 MB |     858 MB |     212 GB |     211 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6125 GB |    6125 GB |
|       from large pool |   32920 KB |     261 MB |    5863 GB |    5863 GB |
|       from small pool |   10990 KB |     708 MB |     261 GB |     261 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4275 K  |    4262 K  |
|       from large pool |      61    |      69    |     964 K  |     964 K  |
|       from small pool |   13012    |   13020    |    3310 K  |    3297 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4275 K  |    4262 K  |
|       from large pool |      61    |      69    |     964 K  |     964 K  |
|       from small pool |   13012    |   13020    |    3310 K  |    3297 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    2776 K  |    2775 K  |
|       from large pool |       9    |      15    |     824 K  |     824 K  |
|       from small pool |     438    |    2231    |    1951 K  |    1951 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4431 GB |    4430 GB |
|       from large pool |     680 MB |     870 MB |    4219 GB |    4218 GB |
|       from small pool |     856 MB |     857 MB |     212 GB |     211 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4431 GB |    4430 GB |
|       from large pool |     680 MB |     870 MB |    4219 GB |    4218 GB |
|       from small pool |     856 MB |     857 MB |     212 GB |     211 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4426 GB |    4426 GB |
|       from large pool |   19933 KB |     153 MB |    4164 GB |    4164 GB |
|       from small pool |   11705 KB |     711 MB |     261 GB |     261 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4271 K  |    4258 K  |
|       from large pool |      28    |      36    |     963 K  |     963 K  |
|       from small pool |   13002    |   13011    |    3307 K  |    3294 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4271 K  |    4258 K  |
|       from large pool |      28    |      36    |     963 K  |     963 K  |
|       from small pool |   13002    |   13011    |    3307 K  |    3294 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2705 K  |    2705 K  |
|       from large pool |       7    |      11    |     754 K  |     754 K  |
|       from small pool |     437    |    2228    |    1951 K  |    1950 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 44
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0081, 0.8560], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4539 GB |    4537 GB |
|       from large pool |     787 MB |     977 MB |    4321 GB |    4320 GB |
|       from small pool |     857 MB |     858 MB |     217 GB |     216 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4539 GB |    4537 GB |
|       from large pool |     787 MB |     977 MB |    4321 GB |    4320 GB |
|       from small pool |     857 MB |     858 MB |     217 GB |     216 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6268 GB |    6267 GB |
|       from large pool |   32920 KB |     261 MB |    6000 GB |    6000 GB |
|       from small pool |   10990 KB |     708 MB |     267 GB |     267 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4373 K  |    4360 K  |
|       from large pool |      61    |      69    |     986 K  |     986 K  |
|       from small pool |   13012    |   13020    |    3386 K  |    3373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4373 K  |    4360 K  |
|       from large pool |      61    |      69    |     986 K  |     986 K  |
|       from small pool |   13012    |   13020    |    3386 K  |    3373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    2840 K  |    2839 K  |
|       from large pool |       9    |      15    |     843 K  |     843 K  |
|       from small pool |     437    |    2231    |    1997 K  |    1996 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4534 GB |    4533 GB |
|       from large pool |     680 MB |     870 MB |    4317 GB |    4316 GB |
|       from small pool |     856 MB |     857 MB |     217 GB |     216 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4534 GB |    4533 GB |
|       from large pool |     680 MB |     870 MB |    4317 GB |    4316 GB |
|       from small pool |     856 MB |     857 MB |     217 GB |     216 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4529 GB |    4529 GB |
|       from large pool |   19933 KB |     153 MB |    4261 GB |    4261 GB |
|       from small pool |   11705 KB |     711 MB |     267 GB |     267 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4369 K  |    4356 K  |
|       from large pool |      28    |      36    |     985 K  |     985 K  |
|       from small pool |   13002    |   13011    |    3383 K  |    3370 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4369 K  |    4356 K  |
|       from large pool |      28    |      36    |     985 K  |     985 K  |
|       from small pool |   13002    |   13011    |    3383 K  |    3370 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2768 K  |    2767 K  |
|       from large pool |       7    |      11    |     772 K  |     772 K  |
|       from small pool |     437    |    2228    |    1996 K  |    1995 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 45
batch input size: torch.Size([16, 1855]) Device: batch input size:0
torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0153, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4642 GB |    4640 GB |
|       from large pool |     787 MB |     977 MB |    4419 GB |    4419 GB |
|       from small pool |     857 MB |     858 MB |     222 GB |     221 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4642 GB |    4640 GB |
|       from large pool |     787 MB |     977 MB |    4419 GB |    4419 GB |
|       from small pool |     857 MB |     858 MB |     222 GB |     221 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6410 GB |    6410 GB |
|       from large pool |   32920 KB |     261 MB |    6136 GB |    6136 GB |
|       from small pool |   10990 KB |     708 MB |     273 GB |     273 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4472 K  |    4459 K  |
|       from large pool |      61    |      69    |    1009 K  |    1009 K  |
|       from small pool |   13012    |   13020    |    3463 K  |    3450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4472 K  |    4459 K  |
|       from large pool |      61    |      69    |    1009 K  |    1009 K  |
|       from small pool |   13012    |   13020    |    3463 K  |    3450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    2904 K  |    2904 K  |
|       from large pool |       9    |      15    |     862 K  |     862 K  |
|       from small pool |     437    |    2231    |    2042 K  |    2041 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4637 GB |    4636 GB |
|       from large pool |     680 MB |     870 MB |    4415 GB |    4414 GB |
|       from small pool |     856 MB |     857 MB |     222 GB |     221 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4637 GB |    4636 GB |
|       from large pool |     680 MB |     870 MB |    4415 GB |    4414 GB |
|       from small pool |     856 MB |     857 MB |     222 GB |     221 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4632 GB |    4632 GB |
|       from large pool |   19933 KB |     153 MB |    4358 GB |    4358 GB |
|       from small pool |   11705 KB |     711 MB |     273 GB |     273 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4468 K  |    4455 K  |
|       from large pool |      28    |      36    |    1008 K  |    1008 K  |
|       from small pool |   13002    |   13011    |    3459 K  |    3446 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4468 K  |    4455 K  |
|       from large pool |      28    |      36    |    1008 K  |    1008 K  |
|       from small pool |   13002    |   13011    |    3459 K  |    3446 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2830 K  |    2830 K  |
|       from large pool |       7    |      11    |     789 K  |     789 K  |
|       from small pool |     437    |    2228    |    2041 K  |    2040 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 46
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0097, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4745 GB |    4743 GB |
|       from large pool |     787 MB |     977 MB |    4518 GB |    4517 GB |
|       from small pool |     857 MB |     858 MB |     227 GB |     226 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4745 GB |    4743 GB |
|       from large pool |     787 MB |     977 MB |    4518 GB |    4517 GB |
|       from small pool |     857 MB |     858 MB |     227 GB |     226 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6552 GB |    6552 GB |
|       from large pool |   32920 KB |     261 MB |    6272 GB |    6272 GB |
|       from small pool |   10990 KB |     708 MB |     279 GB |     279 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4571 K  |    4558 K  |
|       from large pool |      61    |      69    |    1031 K  |    1031 K  |
|       from small pool |   13012    |   13020    |    3539 K  |    3526 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4571 K  |    4558 K  |
|       from large pool |      61    |      69    |    1031 K  |    1031 K  |
|       from small pool |   13012    |   13020    |    3539 K  |    3526 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    2968 K  |    2968 K  |
|       from large pool |       9    |      15    |     881 K  |     881 K  |
|       from small pool |     439    |    2231    |    2087 K  |    2086 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4740 GB |    4739 GB |
|       from large pool |     680 MB |     870 MB |    4513 GB |    4512 GB |
|       from small pool |     856 MB |     857 MB |     227 GB |     226 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4740 GB |    4739 GB |
|       from large pool |     680 MB |     870 MB |    4513 GB |    4512 GB |
|       from small pool |     856 MB |     857 MB |     227 GB |     226 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4735 GB |    4735 GB |
|       from large pool |   19933 KB |     153 MB |    4455 GB |    4455 GB |
|       from small pool |   11705 KB |     711 MB |     279 GB |     279 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4566 K  |    4553 K  |
|       from large pool |      28    |      36    |    1030 K  |    1030 K  |
|       from small pool |   13002    |   13011    |    3536 K  |    3523 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4566 K  |    4553 K  |
|       from large pool |      28    |      36    |    1030 K  |    1030 K  |
|       from small pool |   13002    |   13011    |    3536 K  |    3523 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2893 K  |    2893 K  |
|       from large pool |       7    |      11    |     807 K  |     807 K  |
|       from small pool |     437    |    2228    |    2086 K  |    2085 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 47
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0248, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4848 GB |    4847 GB |
|       from large pool |     787 MB |     977 MB |    4616 GB |    4615 GB |
|       from small pool |     857 MB |     858 MB |     232 GB |     231 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4848 GB |    4847 GB |
|       from large pool |     787 MB |     977 MB |    4616 GB |    4615 GB |
|       from small pool |     857 MB |     858 MB |     232 GB |     231 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6695 GB |    6695 GB |
|       from large pool |   32920 KB |     261 MB |    6409 GB |    6409 GB |
|       from small pool |   10990 KB |     708 MB |     285 GB |     285 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4669 K  |    4656 K  |
|       from large pool |      61    |      69    |    1054 K  |    1054 K  |
|       from small pool |   13012    |   13020    |    3615 K  |    3602 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4669 K  |    4656 K  |
|       from large pool |      61    |      69    |    1054 K  |    1054 K  |
|       from small pool |   13012    |   13020    |    3615 K  |    3602 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    3032 K  |    3032 K  |
|       from large pool |       9    |      15    |     900 K  |     900 K  |
|       from small pool |     440    |    2231    |    2132 K  |    2131 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4843 GB |    4842 GB |
|       from large pool |     680 MB |     870 MB |    4611 GB |    4610 GB |
|       from small pool |     856 MB |     857 MB |     232 GB |     231 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4843 GB |    4842 GB |
|       from large pool |     680 MB |     870 MB |    4611 GB |    4610 GB |
|       from small pool |     856 MB |     857 MB |     232 GB |     231 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4837 GB |    4837 GB |
|       from large pool |   19933 KB |     153 MB |    4552 GB |    4552 GB |
|       from small pool |   11705 KB |     711 MB |     285 GB |     285 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4665 K  |    4652 K  |
|       from large pool |      28    |      36    |    1052 K  |    1052 K  |
|       from small pool |   13002    |   13011    |    3612 K  |    3599 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4665 K  |    4652 K  |
|       from large pool |      28    |      36    |    1052 K  |    1052 K  |
|       from small pool |   13002    |   13011    |    3612 K  |    3599 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    2956 K  |    2955 K  |
|       from large pool |       7    |      11    |     824 K  |     824 K  |
|       from small pool |     437    |    2228    |    2131 K  |    2130 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 48
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0135, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    4951 GB |    4950 GB |
|       from large pool |     787 MB |     977 MB |    4714 GB |    4713 GB |
|       from small pool |     857 MB |     858 MB |     237 GB |     236 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    4951 GB |    4950 GB |
|       from large pool |     787 MB |     977 MB |    4714 GB |    4713 GB |
|       from small pool |     857 MB |     858 MB |     237 GB |     236 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6837 GB |    6837 GB |
|       from large pool |   32920 KB |     261 MB |    6545 GB |    6545 GB |
|       from small pool |   10990 KB |     708 MB |     291 GB |     291 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4768 K  |    4755 K  |
|       from large pool |      61    |      69    |    1076 K  |    1076 K  |
|       from small pool |   13012    |   13020    |    3691 K  |    3678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4768 K  |    4755 K  |
|       from large pool |      61    |      69    |    1076 K  |    1076 K  |
|       from small pool |   13012    |   13020    |    3691 K  |    3678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    3097 K  |    3096 K  |
|       from large pool |       9    |      15    |     919 K  |     919 K  |
|       from small pool |     436    |    2231    |    2177 K  |    2176 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    4946 GB |    4945 GB |
|       from large pool |     680 MB |     870 MB |    4709 GB |    4708 GB |
|       from small pool |     856 MB |     857 MB |     237 GB |     236 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    4946 GB |    4945 GB |
|       from large pool |     680 MB |     870 MB |    4709 GB |    4708 GB |
|       from small pool |     856 MB |     857 MB |     237 GB |     236 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    4940 GB |    4940 GB |
|       from large pool |   19933 KB |     153 MB |    4648 GB |    4648 GB |
|       from small pool |   11705 KB |     711 MB |     291 GB |     291 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4763 K  |    4750 K  |
|       from large pool |      28    |      36    |    1075 K  |    1075 K  |
|       from small pool |   13002    |   13011    |    3688 K  |    3675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4763 K  |    4750 K  |
|       from large pool |      28    |      36    |    1075 K  |    1075 K  |
|       from small pool |   13002    |   13011    |    3688 K  |    3675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3018 K  |    3018 K  |
|       from large pool |       7    |      11    |     842 K  |     842 K  |
|       from small pool |     437    |    2228    |    2176 K  |    2175 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 49
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0214, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5054 GB |    5053 GB |
|       from large pool |     787 MB |     977 MB |    4812 GB |    4811 GB |
|       from small pool |     857 MB |     858 MB |     242 GB |     241 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5054 GB |    5053 GB |
|       from large pool |     787 MB |     977 MB |    4812 GB |    4811 GB |
|       from small pool |     857 MB |     858 MB |     242 GB |     241 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    6979 GB |    6979 GB |
|       from large pool |   32920 KB |     261 MB |    6682 GB |    6682 GB |
|       from small pool |   10990 KB |     708 MB |     297 GB |     297 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4867 K  |    4853 K  |
|       from large pool |      61    |      69    |    1099 K  |    1098 K  |
|       from small pool |   13012    |   13020    |    3768 K  |    3755 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4867 K  |    4853 K  |
|       from large pool |      61    |      69    |    1099 K  |    1098 K  |
|       from small pool |   13012    |   13020    |    3768 K  |    3755 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    3161 K  |    3160 K  |
|       from large pool |       9    |      15    |     939 K  |     939 K  |
|       from small pool |     439    |    2231    |    2222 K  |    2221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5049 GB |    5048 GB |
|       from large pool |     680 MB |     870 MB |    4807 GB |    4807 GB |
|       from small pool |     856 MB |     857 MB |     242 GB |     241 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5049 GB |    5048 GB |
|       from large pool |     680 MB |     870 MB |    4807 GB |    4807 GB |
|       from small pool |     856 MB |     857 MB |     242 GB |     241 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5043 GB |    5043 GB |
|       from large pool |   19933 KB |     153 MB |    4745 GB |    4745 GB |
|       from small pool |   11705 KB |     711 MB |     297 GB |     297 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4862 K  |    4849 K  |
|       from large pool |      28    |      36    |    1097 K  |    1097 K  |
|       from small pool |   13002    |   13011    |    3764 K  |    3751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4862 K  |    4849 K  |
|       from large pool |      28    |      36    |    1097 K  |    1097 K  |
|       from small pool |   13002    |   13011    |    3764 K  |    3751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3081 K  |    3080 K  |
|       from large pool |       7    |      11    |     859 K  |     859 K  |
|       from small pool |     437    |    2228    |    2221 K  |    2220 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 50
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0107, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5157 GB |    5156 GB |
|       from large pool |     787 MB |     977 MB |    4910 GB |    4910 GB |
|       from small pool |     857 MB |     858 MB |     247 GB |     246 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5157 GB |    5156 GB |
|       from large pool |     787 MB |     977 MB |    4910 GB |    4910 GB |
|       from small pool |     857 MB |     858 MB |     247 GB |     246 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7122 GB |    7122 GB |
|       from large pool |   32920 KB |     261 MB |    6818 GB |    6818 GB |
|       from small pool |   10990 KB |     708 MB |     303 GB |     303 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    4965 K  |    4952 K  |
|       from large pool |      61    |      69    |    1121 K  |    1121 K  |
|       from small pool |   13012    |   13020    |    3844 K  |    3831 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    4965 K  |    4952 K  |
|       from large pool |      61    |      69    |    1121 K  |    1121 K  |
|       from small pool |   13012    |   13020    |    3844 K  |    3831 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    3225 K  |    3225 K  |
|       from large pool |       9    |      15    |     958 K  |     958 K  |
|       from small pool |     438    |    2231    |    2267 K  |    2266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5152 GB |    5151 GB |
|       from large pool |     680 MB |     870 MB |    4905 GB |    4905 GB |
|       from small pool |     856 MB |     857 MB |     247 GB |     246 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5152 GB |    5151 GB |
|       from large pool |     680 MB |     870 MB |    4905 GB |    4905 GB |
|       from small pool |     856 MB |     857 MB |     247 GB |     246 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5146 GB |    5146 GB |
|       from large pool |   19933 KB |     153 MB |    4842 GB |    4842 GB |
|       from small pool |   11705 KB |     711 MB |     303 GB |     303 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    4960 K  |    4947 K  |
|       from large pool |      28    |      36    |    1120 K  |    1120 K  |
|       from small pool |   13002    |   13011    |    3840 K  |    3827 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    4960 K  |    4947 K  |
|       from large pool |      28    |      36    |    1120 K  |    1120 K  |
|       from small pool |   13002    |   13011    |    3840 K  |    3827 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3144 K  |    3143 K  |
|       from large pool |       7    |      11    |     877 K  |     877 K  |
|       from small pool |     437    |    2228    |    2266 K  |    2266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 51
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0125, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5261 GB |    5259 GB |
|       from large pool |     787 MB |     977 MB |    5009 GB |    5008 GB |
|       from small pool |     857 MB |     858 MB |     251 GB |     251 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5261 GB |    5259 GB |
|       from large pool |     787 MB |     977 MB |    5009 GB |    5008 GB |
|       from small pool |     857 MB |     858 MB |     251 GB |     251 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7264 GB |    7264 GB |
|       from large pool |   32920 KB |     261 MB |    6954 GB |    6954 GB |
|       from small pool |   10990 KB |     708 MB |     309 GB |     309 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5064 K  |    5051 K  |
|       from large pool |      61    |      69    |    1143 K  |    1143 K  |
|       from small pool |   13012    |   13020    |    3920 K  |    3907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5064 K  |    5051 K  |
|       from large pool |      61    |      69    |    1143 K  |    1143 K  |
|       from small pool |   13012    |   13020    |    3920 K  |    3907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    3289 K  |    3289 K  |
|       from large pool |       9    |      15    |     977 K  |     977 K  |
|       from small pool |     438    |    2231    |    2312 K  |    2312 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5255 GB |    5254 GB |
|       from large pool |     680 MB |     870 MB |    5003 GB |    5003 GB |
|       from small pool |     856 MB |     857 MB |     251 GB |     251 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5255 GB |    5254 GB |
|       from large pool |     680 MB |     870 MB |    5003 GB |    5003 GB |
|       from small pool |     856 MB |     857 MB |     251 GB |     251 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5249 GB |    5249 GB |
|       from large pool |   19933 KB |     153 MB |    4939 GB |    4939 GB |
|       from small pool |   11705 KB |     711 MB |     309 GB |     309 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5059 K  |    5046 K  |
|       from large pool |      28    |      36    |    1142 K  |    1142 K  |
|       from small pool |   13002    |   13011    |    3916 K  |    3903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5059 K  |    5046 K  |
|       from large pool |      28    |      36    |    1142 K  |    1142 K  |
|       from small pool |   13002    |   13011    |    3916 K  |    3903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3206 K  |    3206 K  |
|       from large pool |       7    |      11    |     895 K  |     895 K  |
|       from small pool |     437    |    2228    |    2311 K  |    2311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 52
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0080, 0.8821], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5364 GB |    5362 GB |
|       from large pool |     787 MB |     977 MB |    5107 GB |    5106 GB |
|       from small pool |     857 MB |     858 MB |     256 GB |     256 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5364 GB |    5362 GB |
|       from large pool |     787 MB |     977 MB |    5107 GB |    5106 GB |
|       from small pool |     857 MB |     858 MB |     256 GB |     256 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7407 GB |    7407 GB |
|       from large pool |   32920 KB |     261 MB |    7091 GB |    7091 GB |
|       from small pool |   10990 KB |     708 MB |     315 GB |     315 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5163 K  |    5149 K  |
|       from large pool |      61    |      69    |    1166 K  |    1166 K  |
|       from small pool |   13012    |   13020    |    3996 K  |    3983 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5163 K  |    5149 K  |
|       from large pool |      61    |      69    |    1166 K  |    1166 K  |
|       from small pool |   13012    |   13020    |    3996 K  |    3983 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    3354 K  |    3353 K  |
|       from large pool |       9    |      15    |     996 K  |     996 K  |
|       from small pool |     438    |    2231    |    2357 K  |    2357 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5358 GB |    5357 GB |
|       from large pool |     680 MB |     870 MB |    5102 GB |    5101 GB |
|       from small pool |     856 MB |     857 MB |     256 GB |     256 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5358 GB |    5357 GB |
|       from large pool |     680 MB |     870 MB |    5102 GB |    5101 GB |
|       from small pool |     856 MB |     857 MB |     256 GB |     256 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5352 GB |    5352 GB |
|       from large pool |   19933 KB |     153 MB |    5036 GB |    5036 GB |
|       from small pool |   11705 KB |     711 MB |     316 GB |     315 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5157 K  |    5144 K  |
|       from large pool |      28    |      36    |    1164 K  |    1164 K  |
|       from small pool |   13002    |   13011    |    3993 K  |    3980 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5157 K  |    5144 K  |
|       from large pool |      28    |      36    |    1164 K  |    1164 K  |
|       from small pool |   13002    |   13011    |    3993 K  |    3980 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3269 K  |    3268 K  |
|       from large pool |       7    |      11    |     912 K  |     912 K  |
|       from small pool |     437    |    2228    |    2356 K  |    2356 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 53
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0185, 0.8561], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5467 GB |    5465 GB |
|       from large pool |     787 MB |     977 MB |    5205 GB |    5204 GB |
|       from small pool |     857 MB |     858 MB |     261 GB |     260 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5467 GB |    5465 GB |
|       from large pool |     787 MB |     977 MB |    5205 GB |    5204 GB |
|       from small pool |     857 MB |     858 MB |     261 GB |     260 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7549 GB |    7549 GB |
|       from large pool |   32920 KB |     261 MB |    7227 GB |    7227 GB |
|       from small pool |   10990 KB |     708 MB |     322 GB |     322 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5261 K  |    5248 K  |
|       from large pool |      61    |      69    |    1188 K  |    1188 K  |
|       from small pool |   13012    |   13020    |    4072 K  |    4059 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5261 K  |    5248 K  |
|       from large pool |      61    |      69    |    1188 K  |    1188 K  |
|       from small pool |   13012    |   13020    |    4072 K  |    4059 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    3418 K  |    3417 K  |
|       from large pool |       9    |      15    |    1015 K  |    1015 K  |
|       from small pool |     437    |    2231    |    2402 K  |    2402 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5461 GB |    5460 GB |
|       from large pool |     680 MB |     870 MB |    5200 GB |    5199 GB |
|       from small pool |     856 MB |     857 MB |     261 GB |     260 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5461 GB |    5460 GB |
|       from large pool |     680 MB |     870 MB |    5200 GB |    5199 GB |
|       from small pool |     856 MB |     857 MB |     261 GB |     260 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5455 GB |    5455 GB |
|       from large pool |   19933 KB |     153 MB |    5133 GB |    5133 GB |
|       from small pool |   11705 KB |     711 MB |     322 GB |     322 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5256 K  |    5243 K  |
|       from large pool |      28    |      36    |    1187 K  |    1187 K  |
|       from small pool |   13002    |   13011    |    4069 K  |    4056 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5256 K  |    5243 K  |
|       from large pool |      28    |      36    |    1187 K  |    1187 K  |
|       from small pool |   13002    |   13011    |    4069 K  |    4056 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3331 K  |    3331 K  |
|       from large pool |       7    |      11    |     930 K  |     930 K  |
|       from small pool |     437    |    2228    |    2401 K  |    2401 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 54
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0066, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5570 GB |    5568 GB |
|       from large pool |     787 MB |     977 MB |    5303 GB |    5302 GB |
|       from small pool |     857 MB |     858 MB |     266 GB |     265 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5570 GB |    5568 GB |
|       from large pool |     787 MB |     977 MB |    5303 GB |    5302 GB |
|       from small pool |     857 MB |     858 MB |     266 GB |     265 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7691 GB |    7691 GB |
|       from large pool |   32920 KB |     261 MB |    7363 GB |    7363 GB |
|       from small pool |   10990 KB |     708 MB |     328 GB |     328 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5360 K  |    5347 K  |
|       from large pool |      61    |      69    |    1211 K  |    1211 K  |
|       from small pool |   13012    |   13020    |    4149 K  |    4136 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5360 K  |    5347 K  |
|       from large pool |      61    |      69    |    1211 K  |    1211 K  |
|       from small pool |   13012    |   13020    |    4149 K  |    4136 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    3482 K  |    3482 K  |
|       from large pool |       9    |      15    |    1034 K  |    1034 K  |
|       from small pool |     437    |    2231    |    2447 K  |    2447 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5564 GB |    5563 GB |
|       from large pool |     680 MB |     870 MB |    5298 GB |    5297 GB |
|       from small pool |     856 MB |     857 MB |     266 GB |     265 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5564 GB |    5563 GB |
|       from large pool |     680 MB |     870 MB |    5298 GB |    5297 GB |
|       from small pool |     856 MB |     857 MB |     266 GB |     265 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5558 GB |    5558 GB |
|       from large pool |   19933 KB |     153 MB |    5230 GB |    5229 GB |
|       from small pool |   11705 KB |     711 MB |     328 GB |     328 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5355 K  |    5342 K  |
|       from large pool |      28    |      36    |    1209 K  |    1209 K  |
|       from small pool |   13002    |   13011    |    4145 K  |    4132 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5355 K  |    5342 K  |
|       from large pool |      28    |      36    |    1209 K  |    1209 K  |
|       from small pool |   13002    |   13011    |    4145 K  |    4132 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3394 K  |    3393 K  |
|       from large pool |       7    |      11    |     947 K  |     947 K  |
|       from small pool |     437    |    2228    |    2446 K  |    2446 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 55
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0071, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5673 GB |    5671 GB |
|       from large pool |     787 MB |     977 MB |    5401 GB |    5401 GB |
|       from small pool |     857 MB |     858 MB |     271 GB |     270 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5673 GB |    5671 GB |
|       from large pool |     787 MB |     977 MB |    5401 GB |    5401 GB |
|       from small pool |     857 MB |     858 MB |     271 GB |     270 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7834 GB |    7834 GB |
|       from large pool |   32920 KB |     261 MB |    7500 GB |    7500 GB |
|       from small pool |   10990 KB |     708 MB |     334 GB |     334 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5458 K  |    5445 K  |
|       from large pool |      61    |      69    |    1233 K  |    1233 K  |
|       from small pool |   13012    |   13020    |    4225 K  |    4212 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5458 K  |    5445 K  |
|       from large pool |      61    |      69    |    1233 K  |    1233 K  |
|       from small pool |   13012    |   13020    |    4225 K  |    4212 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    3546 K  |    3546 K  |
|       from large pool |       9    |      15    |    1054 K  |    1054 K  |
|       from small pool |     439    |    2231    |    2492 K  |    2492 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5667 GB |    5666 GB |
|       from large pool |     680 MB |     870 MB |    5396 GB |    5395 GB |
|       from small pool |     856 MB |     857 MB |     271 GB |     270 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5667 GB |    5666 GB |
|       from large pool |     680 MB |     870 MB |    5396 GB |    5395 GB |
|       from small pool |     856 MB |     857 MB |     271 GB |     270 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5660 GB |    5660 GB |
|       from large pool |   19933 KB |     153 MB |    5326 GB |    5326 GB |
|       from small pool |   11705 KB |     711 MB |     334 GB |     334 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5453 K  |    5440 K  |
|       from large pool |      28    |      36    |    1232 K  |    1232 K  |
|       from small pool |   13002    |   13011    |    4221 K  |    4208 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5453 K  |    5440 K  |
|       from large pool |      28    |      36    |    1232 K  |    1232 K  |
|       from small pool |   13002    |   13011    |    4221 K  |    4208 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3457 K  |    3456 K  |
|       from large pool |       7    |      11    |     965 K  |     965 K  |
|       from small pool |     437    |    2228    |    2491 K  |    2491 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 56
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0066, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5776 GB |    5774 GB |
|       from large pool |     787 MB |     977 MB |    5500 GB |    5499 GB |
|       from small pool |     857 MB |     858 MB |     276 GB |     275 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5776 GB |    5774 GB |
|       from large pool |     787 MB |     977 MB |    5500 GB |    5499 GB |
|       from small pool |     857 MB |     858 MB |     276 GB |     275 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    7976 GB |    7976 GB |
|       from large pool |   32920 KB |     261 MB |    7636 GB |    7636 GB |
|       from small pool |   10990 KB |     708 MB |     340 GB |     340 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5557 K  |    5544 K  |
|       from large pool |      61    |      69    |    1256 K  |    1255 K  |
|       from small pool |   13012    |   13020    |    4301 K  |    4288 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5557 K  |    5544 K  |
|       from large pool |      61    |      69    |    1256 K  |    1255 K  |
|       from small pool |   13012    |   13020    |    4301 K  |    4288 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    3611 K  |    3610 K  |
|       from large pool |       9    |      15    |    1073 K  |    1073 K  |
|       from small pool |     440    |    2231    |    2537 K  |    2537 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5770 GB |    5769 GB |
|       from large pool |     680 MB |     870 MB |    5494 GB |    5493 GB |
|       from small pool |     856 MB |     857 MB |     276 GB |     275 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5770 GB |    5769 GB |
|       from large pool |     680 MB |     870 MB |    5494 GB |    5493 GB |
|       from small pool |     856 MB |     857 MB |     276 GB |     275 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5763 GB |    5763 GB |
|       from large pool |   19933 KB |     153 MB |    5423 GB |    5423 GB |
|       from small pool |   11705 KB |     711 MB |     340 GB |     340 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5552 K  |    5539 K  |
|       from large pool |      28    |      36    |    1254 K  |    1254 K  |
|       from small pool |   13002    |   13011    |    4297 K  |    4284 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5552 K  |    5539 K  |
|       from large pool |      28    |      36    |    1254 K  |    1254 K  |
|       from small pool |   13002    |   13011    |    4297 K  |    4284 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3519 K  |    3519 K  |
|       from large pool |       7    |      11    |     982 K  |     982 K  |
|       from small pool |     437    |    2228    |    2536 K  |    2536 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 57
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0148, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5879 GB |    5878 GB |
|       from large pool |     787 MB |     977 MB |    5598 GB |    5597 GB |
|       from small pool |     857 MB |     858 MB |     281 GB |     280 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5879 GB |    5878 GB |
|       from large pool |     787 MB |     977 MB |    5598 GB |    5597 GB |
|       from small pool |     857 MB |     858 MB |     281 GB |     280 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8119 GB |    8119 GB |
|       from large pool |   32920 KB |     261 MB |    7773 GB |    7773 GB |
|       from small pool |   10990 KB |     708 MB |     346 GB |     346 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5656 K  |    5643 K  |
|       from large pool |      61    |      69    |    1278 K  |    1278 K  |
|       from small pool |   13012    |   13020    |    4377 K  |    4364 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5656 K  |    5643 K  |
|       from large pool |      61    |      69    |    1278 K  |    1278 K  |
|       from small pool |   13012    |   13020    |    4377 K  |    4364 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    3675 K  |    3674 K  |
|       from large pool |       9    |      15    |    1092 K  |    1092 K  |
|       from small pool |     436    |    2231    |    2582 K  |    2582 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5873 GB |    5872 GB |
|       from large pool |     680 MB |     870 MB |    5592 GB |    5591 GB |
|       from small pool |     856 MB |     857 MB |     281 GB |     280 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5873 GB |    5872 GB |
|       from large pool |     680 MB |     870 MB |    5592 GB |    5591 GB |
|       from small pool |     856 MB |     857 MB |     281 GB |     280 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5866 GB |    5866 GB |
|       from large pool |   19933 KB |     153 MB |    5520 GB |    5520 GB |
|       from small pool |   11705 KB |     711 MB |     346 GB |     346 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5650 K  |    5637 K  |
|       from large pool |      28    |      36    |    1277 K  |    1276 K  |
|       from small pool |   13002    |   13011    |    4373 K  |    4360 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5650 K  |    5637 K  |
|       from large pool |      28    |      36    |    1277 K  |    1276 K  |
|       from small pool |   13002    |   13011    |    4373 K  |    4360 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3582 K  |    3581 K  |
|       from large pool |       7    |      11    |    1000 K  |    1000 K  |
|       from small pool |     437    |    2228    |    2581 K  |    2581 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 58
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0069, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    5982 GB |    5981 GB |
|       from large pool |     787 MB |     977 MB |    5696 GB |    5695 GB |
|       from small pool |     857 MB |     858 MB |     286 GB |     285 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    5982 GB |    5981 GB |
|       from large pool |     787 MB |     977 MB |    5696 GB |    5695 GB |
|       from small pool |     857 MB |     858 MB |     286 GB |     285 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8261 GB |    8261 GB |
|       from large pool |   32920 KB |     261 MB |    7909 GB |    7909 GB |
|       from small pool |   10990 KB |     708 MB |     352 GB |     352 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5754 K  |    5741 K  |
|       from large pool |      61    |      69    |    1300 K  |    1300 K  |
|       from small pool |   13012    |   13020    |    4453 K  |    4440 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5754 K  |    5741 K  |
|       from large pool |      61    |      69    |    1300 K  |    1300 K  |
|       from small pool |   13012    |   13020    |    4453 K  |    4440 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    3739 K  |    3739 K  |
|       from large pool |       9    |      15    |    1111 K  |    1111 K  |
|       from small pool |     439    |    2231    |    2627 K  |    2627 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    5976 GB |    5975 GB |
|       from large pool |     680 MB |     870 MB |    5690 GB |    5689 GB |
|       from small pool |     856 MB |     857 MB |     286 GB |     285 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    5976 GB |    5975 GB |
|       from large pool |     680 MB |     870 MB |    5690 GB |    5689 GB |
|       from small pool |     856 MB |     857 MB |     286 GB |     285 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    5969 GB |    5969 GB |
|       from large pool |   19933 KB |     153 MB |    5617 GB |    5617 GB |
|       from small pool |   11705 KB |     711 MB |     352 GB |     352 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5749 K  |    5736 K  |
|       from large pool |      28    |      36    |    1299 K  |    1299 K  |
|       from small pool |   13002    |   13011    |    4449 K  |    4436 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5749 K  |    5736 K  |
|       from large pool |      28    |      36    |    1299 K  |    1299 K  |
|       from small pool |   13002    |   13011    |    4449 K  |    4436 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3644 K  |    3644 K  |
|       from large pool |       7    |      11    |    1017 K  |    1017 K  |
|       from small pool |     437    |    2228    |    2626 K  |    2626 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 59
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0070, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6085 GB |    6084 GB |
|       from large pool |     787 MB |     977 MB |    5794 GB |    5793 GB |
|       from small pool |     857 MB |     858 MB |     291 GB |     290 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6085 GB |    6084 GB |
|       from large pool |     787 MB |     977 MB |    5794 GB |    5793 GB |
|       from small pool |     857 MB |     858 MB |     291 GB |     290 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8403 GB |    8403 GB |
|       from large pool |   32920 KB |     261 MB |    8045 GB |    8045 GB |
|       from small pool |   10990 KB |     708 MB |     358 GB |     358 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5853 K  |    5840 K  |
|       from large pool |      61    |      69    |    1323 K  |    1323 K  |
|       from small pool |   13012    |   13020    |    4530 K  |    4517 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5853 K  |    5840 K  |
|       from large pool |      61    |      69    |    1323 K  |    1323 K  |
|       from small pool |   13012    |   13020    |    4530 K  |    4517 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    3803 K  |    3803 K  |
|       from large pool |       9    |      15    |    1130 K  |    1130 K  |
|       from small pool |     438    |    2231    |    2673 K  |    2672 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6079 GB |    6078 GB |
|       from large pool |     680 MB |     870 MB |    5788 GB |    5788 GB |
|       from small pool |     856 MB |     857 MB |     291 GB |     290 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6079 GB |    6078 GB |
|       from large pool |     680 MB |     870 MB |    5788 GB |    5788 GB |
|       from small pool |     856 MB |     857 MB |     291 GB |     290 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6072 GB |    6072 GB |
|       from large pool |   19933 KB |     153 MB |    5714 GB |    5714 GB |
|       from small pool |   11705 KB |     711 MB |     358 GB |     358 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5847 K  |    5834 K  |
|       from large pool |      28    |      36    |    1321 K  |    1321 K  |
|       from small pool |   13002    |   13011    |    4526 K  |    4513 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5847 K  |    5834 K  |
|       from large pool |      28    |      36    |    1321 K  |    1321 K  |
|       from small pool |   13002    |   13011    |    4526 K  |    4513 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3707 K  |    3706 K  |
|       from large pool |       7    |      11    |    1035 K  |    1035 K  |
|       from small pool |     437    |    2228    |    2671 K  |    2671 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 60
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0225, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6188 GB |    6187 GB |
|       from large pool |     787 MB |     977 MB |    5892 GB |    5892 GB |
|       from small pool |     857 MB |     858 MB |     296 GB |     295 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6188 GB |    6187 GB |
|       from large pool |     787 MB |     977 MB |    5892 GB |    5892 GB |
|       from small pool |     857 MB |     858 MB |     296 GB |     295 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8546 GB |    8546 GB |
|       from large pool |   32920 KB |     261 MB |    8182 GB |    8182 GB |
|       from small pool |   10990 KB |     708 MB |     364 GB |     364 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    5952 K  |    5939 K  |
|       from large pool |      61    |      69    |    1345 K  |    1345 K  |
|       from small pool |   13012    |   13020    |    4606 K  |    4593 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    5952 K  |    5939 K  |
|       from large pool |      61    |      69    |    1345 K  |    1345 K  |
|       from small pool |   13012    |   13020    |    4606 K  |    4593 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    3868 K  |    3867 K  |
|       from large pool |       9    |      15    |    1149 K  |    1149 K  |
|       from small pool |     438    |    2231    |    2718 K  |    2717 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6182 GB |    6181 GB |
|       from large pool |     680 MB |     870 MB |    5886 GB |    5886 GB |
|       from small pool |     856 MB |     857 MB |     296 GB |     295 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6182 GB |    6181 GB |
|       from large pool |     680 MB |     870 MB |    5886 GB |    5886 GB |
|       from small pool |     856 MB |     857 MB |     296 GB |     295 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6175 GB |    6175 GB |
|       from large pool |   19933 KB |     153 MB |    5811 GB |    5811 GB |
|       from small pool |   11705 KB |     711 MB |     364 GB |     364 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    5946 K  |    5933 K  |
|       from large pool |      28    |      36    |    1344 K  |    1344 K  |
|       from small pool |   13002    |   13011    |    4602 K  |    4589 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    5946 K  |    5933 K  |
|       from large pool |      28    |      36    |    1344 K  |    1344 K  |
|       from small pool |   13002    |   13011    |    4602 K  |    4589 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3770 K  |    3769 K  |
|       from large pool |       7    |      11    |    1053 K  |    1053 K  |
|       from small pool |     437    |    2228    |    2716 K  |    2716 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 61
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0199, 0.8823], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6292 GB |    6290 GB |
|       from large pool |     787 MB |     977 MB |    5991 GB |    5990 GB |
|       from small pool |     857 MB |     858 MB |     300 GB |     300 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6292 GB |    6290 GB |
|       from large pool |     787 MB |     977 MB |    5991 GB |    5990 GB |
|       from small pool |     857 MB |     858 MB |     300 GB |     300 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8688 GB |    8688 GB |
|       from large pool |   32920 KB |     261 MB |    8318 GB |    8318 GB |
|       from small pool |   10990 KB |     708 MB |     370 GB |     370 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6050 K  |    6037 K  |
|       from large pool |      61    |      69    |    1368 K  |    1368 K  |
|       from small pool |   13012    |   13020    |    4682 K  |    4669 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6050 K  |    6037 K  |
|       from large pool |      61    |      69    |    1368 K  |    1368 K  |
|       from small pool |   13012    |   13020    |    4682 K  |    4669 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    3932 K  |    3931 K  |
|       from large pool |       9    |      15    |    1169 K  |    1169 K  |
|       from small pool |     438    |    2231    |    2763 K  |    2762 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6285 GB |    6284 GB |
|       from large pool |     680 MB |     870 MB |    5984 GB |    5984 GB |
|       from small pool |     856 MB |     857 MB |     300 GB |     300 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6285 GB |    6284 GB |
|       from large pool |     680 MB |     870 MB |    5984 GB |    5984 GB |
|       from small pool |     856 MB |     857 MB |     300 GB |     300 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6278 GB |    6278 GB |
|       from large pool |   19933 KB |     153 MB |    5907 GB |    5907 GB |
|       from small pool |   11705 KB |     711 MB |     370 GB |     370 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6044 K  |    6031 K  |
|       from large pool |      28    |      36    |    1366 K  |    1366 K  |
|       from small pool |   13002    |   13011    |    4678 K  |    4665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6044 K  |    6031 K  |
|       from large pool |      28    |      36    |    1366 K  |    1366 K  |
|       from small pool |   13002    |   13011    |    4678 K  |    4665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3832 K  |    3832 K  |
|       from large pool |       7    |      11    |    1070 K  |    1070 K  |
|       from small pool |     437    |    2228    |    2762 K  |    2761 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 62
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0212, 0.8558], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6395 GB |    6393 GB |
|       from large pool |     787 MB |     977 MB |    6089 GB |    6088 GB |
|       from small pool |     857 MB |     858 MB |     305 GB |     305 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6395 GB |    6393 GB |
|       from large pool |     787 MB |     977 MB |    6089 GB |    6088 GB |
|       from small pool |     857 MB |     858 MB |     305 GB |     305 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8831 GB |    8831 GB |
|       from large pool |   32920 KB |     261 MB |    8454 GB |    8454 GB |
|       from small pool |   10990 KB |     708 MB |     376 GB |     376 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6149 K  |    6136 K  |
|       from large pool |      61    |      69    |    1390 K  |    1390 K  |
|       from small pool |   13012    |   13020    |    4758 K  |    4745 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6149 K  |    6136 K  |
|       from large pool |      61    |      69    |    1390 K  |    1390 K  |
|       from small pool |   13012    |   13020    |    4758 K  |    4745 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    3996 K  |    3996 K  |
|       from large pool |       9    |      15    |    1188 K  |    1188 K  |
|       from small pool |     437    |    2231    |    2808 K  |    2807 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6388 GB |    6387 GB |
|       from large pool |     680 MB |     870 MB |    6082 GB |    6082 GB |
|       from small pool |     856 MB |     857 MB |     305 GB |     305 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6388 GB |    6387 GB |
|       from large pool |     680 MB |     870 MB |    6082 GB |    6082 GB |
|       from small pool |     856 MB |     857 MB |     305 GB |     305 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6381 GB |    6381 GB |
|       from large pool |   19933 KB |     153 MB |    6004 GB |    6004 GB |
|       from small pool |   11705 KB |     711 MB |     376 GB |     376 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6143 K  |    6130 K  |
|       from large pool |      28    |      36    |    1389 K  |    1388 K  |
|       from small pool |   13002    |   13011    |    4754 K  |    4741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6143 K  |    6130 K  |
|       from large pool |      28    |      36    |    1389 K  |    1388 K  |
|       from small pool |   13002    |   13011    |    4754 K  |    4741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3895 K  |    3894 K  |
|       from large pool |       7    |      11    |    1088 K  |    1088 K  |
|       from small pool |     437    |    2228    |    2807 K  |    2806 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 63
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0409, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6498 GB |    6496 GB |
|       from large pool |     787 MB |     977 MB |    6187 GB |    6186 GB |
|       from small pool |     857 MB |     858 MB |     310 GB |     309 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6498 GB |    6496 GB |
|       from large pool |     787 MB |     977 MB |    6187 GB |    6186 GB |
|       from small pool |     857 MB |     858 MB |     310 GB |     309 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    8973 GB |    8973 GB |
|       from large pool |   32920 KB |     261 MB |    8591 GB |    8591 GB |
|       from small pool |   10990 KB |     708 MB |     382 GB |     382 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6248 K  |    6235 K  |
|       from large pool |      61    |      69    |    1413 K  |    1412 K  |
|       from small pool |   13012    |   13020    |    4835 K  |    4822 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6248 K  |    6235 K  |
|       from large pool |      61    |      69    |    1413 K  |    1412 K  |
|       from small pool |   13012    |   13020    |    4835 K  |    4822 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    4060 K  |    4060 K  |
|       from large pool |       9    |      15    |    1207 K  |    1207 K  |
|       from small pool |     437    |    2231    |    2853 K  |    2852 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6491 GB |    6490 GB |
|       from large pool |     680 MB |     870 MB |    6181 GB |    6180 GB |
|       from small pool |     856 MB |     857 MB |     310 GB |     309 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6491 GB |    6490 GB |
|       from large pool |     680 MB |     870 MB |    6181 GB |    6180 GB |
|       from small pool |     856 MB |     857 MB |     310 GB |     309 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6483 GB |    6483 GB |
|       from large pool |   19933 KB |     153 MB |    6101 GB |    6101 GB |
|       from small pool |   11705 KB |     711 MB |     382 GB |     382 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6242 K  |    6228 K  |
|       from large pool |      28    |      36    |    1411 K  |    1411 K  |
|       from small pool |   13002    |   13011    |    4830 K  |    4817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6242 K  |    6228 K  |
|       from large pool |      28    |      36    |    1411 K  |    1411 K  |
|       from small pool |   13002    |   13011    |    4830 K  |    4817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    3957 K  |    3957 K  |
|       from large pool |       7    |      11    |    1105 K  |    1105 K  |
|       from small pool |     437    |    2228    |    2852 K  |    2851 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 64
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0188, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6601 GB |    6599 GB |
|       from large pool |     787 MB |     977 MB |    6285 GB |    6284 GB |
|       from small pool |     857 MB |     858 MB |     315 GB |     314 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6601 GB |    6599 GB |
|       from large pool |     787 MB |     977 MB |    6285 GB |    6284 GB |
|       from small pool |     857 MB |     858 MB |     315 GB |     314 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9115 GB |    9115 GB |
|       from large pool |   32920 KB |     261 MB |    8727 GB |    8727 GB |
|       from small pool |   10990 KB |     708 MB |     388 GB |     388 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6346 K  |    6333 K  |
|       from large pool |      61    |      69    |    1435 K  |    1435 K  |
|       from small pool |   13012    |   13020    |    4911 K  |    4898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6346 K  |    6333 K  |
|       from large pool |      61    |      69    |    1435 K  |    1435 K  |
|       from small pool |   13012    |   13020    |    4911 K  |    4898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    4124 K  |    4124 K  |
|       from large pool |       9    |      15    |    1226 K  |    1226 K  |
|       from small pool |     439    |    2231    |    2898 K  |    2897 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6594 GB |    6593 GB |
|       from large pool |     680 MB |     870 MB |    6279 GB |    6278 GB |
|       from small pool |     856 MB |     857 MB |     315 GB |     314 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6594 GB |    6593 GB |
|       from large pool |     680 MB |     870 MB |    6279 GB |    6278 GB |
|       from small pool |     856 MB |     857 MB |     315 GB |     314 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6586 GB |    6586 GB |
|       from large pool |   19933 KB |     153 MB |    6198 GB |    6198 GB |
|       from small pool |   11705 KB |     711 MB |     388 GB |     388 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6340 K  |    6327 K  |
|       from large pool |      28    |      36    |    1433 K  |    1433 K  |
|       from small pool |   13002    |   13011    |    4906 K  |    4893 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6340 K  |    6327 K  |
|       from large pool |      28    |      36    |    1433 K  |    1433 K  |
|       from small pool |   13002    |   13011    |    4906 K  |    4893 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4020 K  |    4019 K  |
|       from large pool |       7    |      11    |    1123 K  |    1123 K  |
|       from small pool |     437    |    2228    |    2897 K  |    2896 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 65
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0124, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6704 GB |    6702 GB |
|       from large pool |     787 MB |     977 MB |    6383 GB |    6383 GB |
|       from small pool |     857 MB |     858 MB |     320 GB |     319 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6704 GB |    6702 GB |
|       from large pool |     787 MB |     977 MB |    6383 GB |    6383 GB |
|       from small pool |     857 MB |     858 MB |     320 GB |     319 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9258 GB |    9258 GB |
|       from large pool |   32920 KB |     261 MB |    8863 GB |    8863 GB |
|       from small pool |   10990 KB |     708 MB |     394 GB |     394 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6445 K  |    6432 K  |
|       from large pool |      61    |      69    |    1457 K  |    1457 K  |
|       from small pool |   13012    |   13020    |    4987 K  |    4974 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6445 K  |    6432 K  |
|       from large pool |      61    |      69    |    1457 K  |    1457 K  |
|       from small pool |   13012    |   13020    |    4987 K  |    4974 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    4189 K  |    4188 K  |
|       from large pool |       9    |      15    |    1245 K  |    1245 K  |
|       from small pool |     440    |    2231    |    2943 K  |    2943 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6697 GB |    6696 GB |
|       from large pool |     680 MB |     870 MB |    6377 GB |    6376 GB |
|       from small pool |     856 MB |     857 MB |     320 GB |     319 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6697 GB |    6696 GB |
|       from large pool |     680 MB |     870 MB |    6377 GB |    6376 GB |
|       from small pool |     856 MB |     857 MB |     320 GB |     319 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6689 GB |    6689 GB |
|       from large pool |   19933 KB |     153 MB |    6295 GB |    6295 GB |
|       from small pool |   11705 KB |     711 MB |     394 GB |     394 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6439 K  |    6426 K  |
|       from large pool |      28    |      36    |    1456 K  |    1456 K  |
|       from small pool |   13002    |   13011    |    4982 K  |    4969 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6439 K  |    6426 K  |
|       from large pool |      28    |      36    |    1456 K  |    1456 K  |
|       from small pool |   13002    |   13011    |    4982 K  |    4969 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4083 K  |    4082 K  |
|       from large pool |       7    |      11    |    1140 K  |    1140 K  |
|       from small pool |     437    |    2228    |    2942 K  |    2941 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 66
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0143, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6807 GB |    6805 GB |
|       from large pool |     787 MB |     977 MB |    6482 GB |    6481 GB |
|       from small pool |     857 MB |     858 MB |     325 GB |     324 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6807 GB |    6805 GB |
|       from large pool |     787 MB |     977 MB |    6482 GB |    6481 GB |
|       from small pool |     857 MB |     858 MB |     325 GB |     324 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9400 GB |    9400 GB |
|       from large pool |   32920 KB |     261 MB |    9000 GB |    9000 GB |
|       from small pool |   10990 KB |     708 MB |     400 GB |     400 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6544 K  |    6530 K  |
|       from large pool |      61    |      69    |    1480 K  |    1480 K  |
|       from small pool |   13012    |   13020    |    5063 K  |    5050 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6544 K  |    6530 K  |
|       from large pool |      61    |      69    |    1480 K  |    1480 K  |
|       from small pool |   13012    |   13020    |    5063 K  |    5050 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    4253 K  |    4252 K  |
|       from large pool |       9    |      15    |    1264 K  |    1264 K  |
|       from small pool |     436    |    2231    |    2988 K  |    2988 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6800 GB |    6799 GB |
|       from large pool |     680 MB |     870 MB |    6475 GB |    6474 GB |
|       from small pool |     856 MB |     857 MB |     325 GB |     324 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6800 GB |    6799 GB |
|       from large pool |     680 MB |     870 MB |    6475 GB |    6474 GB |
|       from small pool |     856 MB |     857 MB |     325 GB |     324 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6792 GB |    6792 GB |
|       from large pool |   19933 KB |     153 MB |    6392 GB |    6392 GB |
|       from small pool |   11705 KB |     711 MB |     400 GB |     400 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6537 K  |    6524 K  |
|       from large pool |      28    |      36    |    1478 K  |    1478 K  |
|       from small pool |   13002    |   13011    |    5059 K  |    5046 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6537 K  |    6524 K  |
|       from large pool |      28    |      36    |    1478 K  |    1478 K  |
|       from small pool |   13002    |   13011    |    5059 K  |    5046 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4145 K  |    4145 K  |
|       from large pool |       7    |      11    |    1158 K  |    1158 K  |
|       from small pool |     437    |    2228    |    2987 K  |    2986 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 67
batch input size: torch.Size([16, 1855]) Device: batch input size:0
torch.Size([16, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0519, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    6910 GB |    6909 GB |
|       from large pool |     787 MB |     977 MB |    6580 GB |    6579 GB |
|       from small pool |     857 MB |     858 MB |     330 GB |     329 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    6910 GB |    6909 GB |
|       from large pool |     787 MB |     977 MB |    6580 GB |    6579 GB |
|       from small pool |     857 MB |     858 MB |     330 GB |     329 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9543 GB |    9543 GB |
|       from large pool |   32920 KB |     261 MB |    9136 GB |    9136 GB |
|       from small pool |   10990 KB |     708 MB |     406 GB |     406 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6642 K  |    6629 K  |
|       from large pool |      61    |      69    |    1502 K  |    1502 K  |
|       from small pool |   13012    |   13020    |    5139 K  |    5126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6642 K  |    6629 K  |
|       from large pool |      61    |      69    |    1502 K  |    1502 K  |
|       from small pool |   13012    |   13020    |    5139 K  |    5126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    4317 K  |    4317 K  |
|       from large pool |       9    |      15    |    1284 K  |    1284 K  |
|       from small pool |     439    |    2231    |    3033 K  |    3033 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    6903 GB |    6902 GB |
|       from large pool |     680 MB |     870 MB |    6573 GB |    6572 GB |
|       from small pool |     856 MB |     857 MB |     330 GB |     329 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    6903 GB |    6902 GB |
|       from large pool |     680 MB |     870 MB |    6573 GB |    6572 GB |
|       from small pool |     856 MB |     857 MB |     330 GB |     329 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6895 GB |    6895 GB |
|       from large pool |   19933 KB |     153 MB |    6489 GB |    6489 GB |
|       from small pool |   11705 KB |     711 MB |     406 GB |     406 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6636 K  |    6623 K  |
|       from large pool |      28    |      36    |    1501 K  |    1501 K  |
|       from small pool |   13002    |   13011    |    5135 K  |    5122 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6636 K  |    6623 K  |
|       from large pool |      28    |      36    |    1501 K  |    1501 K  |
|       from small pool |   13002    |   13011    |    5135 K  |    5122 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4208 K  |    4207 K  |
|       from large pool |       7    |      11    |    1175 K  |    1175 K  |
|       from small pool |     437    |    2228    |    3032 K  |    3031 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 68
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0128, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7013 GB |    7012 GB |
|       from large pool |     787 MB |     977 MB |    6678 GB |    6677 GB |
|       from small pool |     857 MB |     858 MB |     335 GB |     334 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7013 GB |    7012 GB |
|       from large pool |     787 MB |     977 MB |    6678 GB |    6677 GB |
|       from small pool |     857 MB |     858 MB |     335 GB |     334 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9685 GB |    9685 GB |
|       from large pool |   32920 KB |     261 MB |    9273 GB |    9273 GB |
|       from small pool |   10990 KB |     708 MB |     412 GB |     412 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6741 K  |    6728 K  |
|       from large pool |      61    |      69    |    1525 K  |    1525 K  |
|       from small pool |   13012    |   13020    |    5216 K  |    5203 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6741 K  |    6728 K  |
|       from large pool |      61    |      69    |    1525 K  |    1525 K  |
|       from small pool |   13012    |   13020    |    5216 K  |    5203 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    4381 K  |    4381 K  |
|       from large pool |       9    |      15    |    1303 K  |    1303 K  |
|       from small pool |     438    |    2231    |    3078 K  |    3078 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7006 GB |    7005 GB |
|       from large pool |     680 MB |     870 MB |    6671 GB |    6670 GB |
|       from small pool |     856 MB |     857 MB |     335 GB |     334 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7006 GB |    7005 GB |
|       from large pool |     680 MB |     870 MB |    6671 GB |    6670 GB |
|       from small pool |     856 MB |     857 MB |     335 GB |     334 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    6998 GB |    6998 GB |
|       from large pool |   19933 KB |     153 MB |    6585 GB |    6585 GB |
|       from small pool |   11705 KB |     711 MB |     412 GB |     412 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6734 K  |    6721 K  |
|       from large pool |      28    |      36    |    1523 K  |    1523 K  |
|       from small pool |   13002    |   13011    |    5211 K  |    5198 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6734 K  |    6721 K  |
|       from large pool |      28    |      36    |    1523 K  |    1523 K  |
|       from small pool |   13002    |   13011    |    5211 K  |    5198 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4270 K  |    4270 K  |
|       from large pool |       7    |      11    |    1193 K  |    1193 K  |
|       from small pool |     437    |    2228    |    3077 K  |    3076 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 69
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0088, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7116 GB |    7115 GB |
|       from large pool |     787 MB |     977 MB |    6776 GB |    6775 GB |
|       from small pool |     857 MB |     858 MB |     340 GB |     339 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7116 GB |    7115 GB |
|       from large pool |     787 MB |     977 MB |    6776 GB |    6775 GB |
|       from small pool |     857 MB |     858 MB |     340 GB |     339 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9827 GB |    9827 GB |
|       from large pool |   32920 KB |     261 MB |    9409 GB |    9409 GB |
|       from small pool |   10990 KB |     708 MB |     418 GB |     418 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6839 K  |    6826 K  |
|       from large pool |      61    |      69    |    1547 K  |    1547 K  |
|       from small pool |   13012    |   13020    |    5292 K  |    5279 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6839 K  |    6826 K  |
|       from large pool |      61    |      69    |    1547 K  |    1547 K  |
|       from small pool |   13012    |   13020    |    5292 K  |    5279 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    4446 K  |    4445 K  |
|       from large pool |       9    |      15    |    1322 K  |    1322 K  |
|       from small pool |     438    |    2231    |    3123 K  |    3123 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7109 GB |    7108 GB |
|       from large pool |     680 MB |     870 MB |    6769 GB |    6769 GB |
|       from small pool |     856 MB |     857 MB |     340 GB |     339 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7109 GB |    7108 GB |
|       from large pool |     680 MB |     870 MB |    6769 GB |    6769 GB |
|       from small pool |     856 MB |     857 MB |     340 GB |     339 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7101 GB |    7101 GB |
|       from large pool |   19933 KB |     153 MB |    6682 GB |    6682 GB |
|       from small pool |   11705 KB |     711 MB |     418 GB |     418 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6833 K  |    6820 K  |
|       from large pool |      28    |      36    |    1545 K  |    1545 K  |
|       from small pool |   13002    |   13011    |    5287 K  |    5274 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6833 K  |    6820 K  |
|       from large pool |      28    |      36    |    1545 K  |    1545 K  |
|       from small pool |   13002    |   13011    |    5287 K  |    5274 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4333 K  |    4332 K  |
|       from large pool |       7    |      11    |    1210 K  |    1210 K  |
|       from small pool |     437    |    2228    |    3122 K  |    3122 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 70
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0182, 0.8824], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7219 GB |    7218 GB |
|       from large pool |     787 MB |     977 MB |    6874 GB |    6874 GB |
|       from small pool |     857 MB |     858 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7219 GB |    7218 GB |
|       from large pool |     787 MB |     977 MB |    6874 GB |    6874 GB |
|       from small pool |     857 MB |     858 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |    9970 GB |    9970 GB |
|       from large pool |   32920 KB |     261 MB |    9545 GB |    9545 GB |
|       from small pool |   10990 KB |     708 MB |     424 GB |     424 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    6938 K  |    6925 K  |
|       from large pool |      61    |      69    |    1570 K  |    1569 K  |
|       from small pool |   13012    |   13020    |    5368 K  |    5355 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    6938 K  |    6925 K  |
|       from large pool |      61    |      69    |    1570 K  |    1569 K  |
|       from small pool |   13012    |   13020    |    5368 K  |    5355 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    4510 K  |    4509 K  |
|       from large pool |       9    |      15    |    1341 K  |    1341 K  |
|       from small pool |     438    |    2231    |    3168 K  |    3168 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7212 GB |    7211 GB |
|       from large pool |     680 MB |     870 MB |    6867 GB |    6867 GB |
|       from small pool |     856 MB |     857 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7212 GB |    7211 GB |
|       from large pool |     680 MB |     870 MB |    6867 GB |    6867 GB |
|       from small pool |     856 MB |     857 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7204 GB |    7204 GB |
|       from large pool |   19933 KB |     153 MB |    6779 GB |    6779 GB |
|       from small pool |   11705 KB |     711 MB |     424 GB |     424 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    6931 K  |    6918 K  |
|       from large pool |      28    |      36    |    1568 K  |    1568 K  |
|       from small pool |   13002    |   13011    |    5363 K  |    5350 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    6931 K  |    6918 K  |
|       from large pool |      28    |      36    |    1568 K  |    1568 K  |
|       from small pool |   13002    |   13011    |    5363 K  |    5350 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4396 K  |    4395 K  |
|       from large pool |       7    |      11    |    1228 K  |    1228 K  |
|       from small pool |     437    |    2228    |    3167 K  |    3167 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 71
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0440, 0.8531], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7323 GB |    7321 GB |
|       from large pool |     787 MB |     977 MB |    6973 GB |    6972 GB |
|       from small pool |     857 MB |     858 MB |     349 GB |     349 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7323 GB |    7321 GB |
|       from large pool |     787 MB |     977 MB |    6973 GB |    6972 GB |
|       from small pool |     857 MB |     858 MB |     349 GB |     349 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10112 GB |   10112 GB |
|       from large pool |   32920 KB |     261 MB |    9682 GB |    9682 GB |
|       from small pool |   10990 KB |     708 MB |     430 GB |     430 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7037 K  |    7024 K  |
|       from large pool |      61    |      69    |    1592 K  |    1592 K  |
|       from small pool |   13012    |   13020    |    5444 K  |    5431 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7037 K  |    7024 K  |
|       from large pool |      61    |      69    |    1592 K  |    1592 K  |
|       from small pool |   13012    |   13020    |    5444 K  |    5431 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    4574 K  |    4574 K  |
|       from large pool |       9    |      15    |    1360 K  |    1360 K  |
|       from small pool |     437    |    2231    |    3213 K  |    3213 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7315 GB |    7314 GB |
|       from large pool |     680 MB |     870 MB |    6965 GB |    6965 GB |
|       from small pool |     856 MB |     857 MB |     349 GB |     349 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7315 GB |    7314 GB |
|       from large pool |     680 MB |     870 MB |    6965 GB |    6965 GB |
|       from small pool |     856 MB |     857 MB |     349 GB |     349 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7307 GB |    7307 GB |
|       from large pool |   19933 KB |     153 MB |    6876 GB |    6876 GB |
|       from small pool |   11705 KB |     711 MB |     430 GB |     430 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7030 K  |    7017 K  |
|       from large pool |      28    |      36    |    1590 K  |    1590 K  |
|       from small pool |   13002    |   13011    |    5439 K  |    5426 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7030 K  |    7017 K  |
|       from large pool |      28    |      36    |    1590 K  |    1590 K  |
|       from small pool |   13002    |   13011    |    5439 K  |    5426 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4458 K  |    4458 K  |
|       from large pool |       7    |      11    |    1246 K  |    1246 K  |
|       from small pool |     437    |    2228    |    3212 K  |    3212 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 72
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0223, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7426 GB |    7424 GB |
|       from large pool |     787 MB |     977 MB |    7071 GB |    7070 GB |
|       from small pool |     857 MB |     858 MB |     354 GB |     354 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7426 GB |    7424 GB |
|       from large pool |     787 MB |     977 MB |    7071 GB |    7070 GB |
|       from small pool |     857 MB |     858 MB |     354 GB |     354 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10255 GB |   10255 GB |
|       from large pool |   32920 KB |     261 MB |    9818 GB |    9818 GB |
|       from small pool |   10990 KB |     708 MB |     436 GB |     436 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7135 K  |    7122 K  |
|       from large pool |      61    |      69    |    1614 K  |    1614 K  |
|       from small pool |   13012    |   13020    |    5520 K  |    5507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7135 K  |    7122 K  |
|       from large pool |      61    |      69    |    1614 K  |    1614 K  |
|       from small pool |   13012    |   13020    |    5520 K  |    5507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    4638 K  |    4638 K  |
|       from large pool |       9    |      15    |    1379 K  |    1379 K  |
|       from small pool |     437    |    2231    |    3259 K  |    3258 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7418 GB |    7417 GB |
|       from large pool |     680 MB |     870 MB |    7063 GB |    7063 GB |
|       from small pool |     856 MB |     857 MB |     354 GB |     353 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7418 GB |    7417 GB |
|       from large pool |     680 MB |     870 MB |    7063 GB |    7063 GB |
|       from small pool |     856 MB |     857 MB |     354 GB |     353 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7409 GB |    7409 GB |
|       from large pool |   19933 KB |     153 MB |    6973 GB |    6973 GB |
|       from small pool |   11705 KB |     711 MB |     436 GB |     436 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7128 K  |    7115 K  |
|       from large pool |      28    |      36    |    1613 K  |    1613 K  |
|       from small pool |   13002    |   13011    |    5515 K  |    5502 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7128 K  |    7115 K  |
|       from large pool |      28    |      36    |    1613 K  |    1613 K  |
|       from small pool |   13002    |   13011    |    5515 K  |    5502 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4521 K  |    4520 K  |
|       from large pool |       7    |      11    |    1263 K  |    1263 K  |
|       from small pool |     437    |    2228    |    3257 K  |    3257 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 73
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0083, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7529 GB |    7527 GB |
|       from large pool |     787 MB |     977 MB |    7169 GB |    7168 GB |
|       from small pool |     857 MB |     858 MB |     359 GB |     358 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7529 GB |    7527 GB |
|       from large pool |     787 MB |     977 MB |    7169 GB |    7168 GB |
|       from small pool |     857 MB |     858 MB |     359 GB |     358 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10397 GB |   10397 GB |
|       from large pool |   32920 KB |     261 MB |    9954 GB |    9954 GB |
|       from small pool |   10990 KB |     708 MB |     442 GB |     442 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7234 K  |    7221 K  |
|       from large pool |      61    |      69    |    1637 K  |    1637 K  |
|       from small pool |   13012    |   13020    |    5597 K  |    5584 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7234 K  |    7221 K  |
|       from large pool |      61    |      69    |    1637 K  |    1637 K  |
|       from small pool |   13012    |   13020    |    5597 K  |    5584 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    4703 K  |    4702 K  |
|       from large pool |       9    |      15    |    1399 K  |    1399 K  |
|       from small pool |     439    |    2231    |    3304 K  |    3303 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7521 GB |    7520 GB |
|       from large pool |     680 MB |     870 MB |    7162 GB |    7161 GB |
|       from small pool |     856 MB |     857 MB |     359 GB |     358 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7521 GB |    7520 GB |
|       from large pool |     680 MB |     870 MB |    7162 GB |    7161 GB |
|       from small pool |     856 MB |     857 MB |     359 GB |     358 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7512 GB |    7512 GB |
|       from large pool |   19933 KB |     153 MB |    7070 GB |    7070 GB |
|       from small pool |   11705 KB |     711 MB |     442 GB |     442 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7227 K  |    7214 K  |
|       from large pool |      28    |      36    |    1635 K  |    1635 K  |
|       from small pool |   13002    |   13011    |    5592 K  |    5579 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7227 K  |    7214 K  |
|       from large pool |      28    |      36    |    1635 K  |    1635 K  |
|       from small pool |   13002    |   13011    |    5592 K  |    5579 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4583 K  |    4583 K  |
|       from large pool |       7    |      11    |    1281 K  |    1281 K  |
|       from small pool |     437    |    2228    |    3302 K  |    3302 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 74
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0234, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7632 GB |    7630 GB |
|       from large pool |     787 MB |     977 MB |    7267 GB |    7266 GB |
|       from small pool |     857 MB |     858 MB |     364 GB |     363 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7632 GB |    7630 GB |
|       from large pool |     787 MB |     977 MB |    7267 GB |    7266 GB |
|       from small pool |     857 MB |     858 MB |     364 GB |     363 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10539 GB |   10539 GB |
|       from large pool |   32920 KB |     261 MB |   10091 GB |   10091 GB |
|       from small pool |   10990 KB |     708 MB |     448 GB |     448 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7333 K  |    7320 K  |
|       from large pool |      61    |      69    |    1659 K  |    1659 K  |
|       from small pool |   13012    |   13020    |    5673 K  |    5660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7333 K  |    7320 K  |
|       from large pool |      61    |      69    |    1659 K  |    1659 K  |
|       from small pool |   13012    |   13020    |    5673 K  |    5660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    4767 K  |    4766 K  |
|       from large pool |       9    |      15    |    1418 K  |    1418 K  |
|       from small pool |     440    |    2231    |    3349 K  |    3348 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7624 GB |    7623 GB |
|       from large pool |     680 MB |     870 MB |    7260 GB |    7259 GB |
|       from small pool |     856 MB |     857 MB |     364 GB |     363 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7624 GB |    7623 GB |
|       from large pool |     680 MB |     870 MB |    7260 GB |    7259 GB |
|       from small pool |     856 MB |     857 MB |     364 GB |     363 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7615 GB |    7615 GB |
|       from large pool |   19933 KB |     153 MB |    7167 GB |    7167 GB |
|       from small pool |   11705 KB |     711 MB |     448 GB |     448 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7326 K  |    7313 K  |
|       from large pool |      28    |      36    |    1657 K  |    1657 K  |
|       from small pool |   13002    |   13011    |    5668 K  |    5655 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7326 K  |    7313 K  |
|       from large pool |      28    |      36    |    1657 K  |    1657 K  |
|       from small pool |   13002    |   13011    |    5668 K  |    5655 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4646 K  |    4645 K  |
|       from large pool |       7    |      11    |    1298 K  |    1298 K  |
|       from small pool |     437    |    2228    |    3347 K  |    3347 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 75
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0140, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7735 GB |    7733 GB |
|       from large pool |     787 MB |     977 MB |    7365 GB |    7365 GB |
|       from small pool |     857 MB |     858 MB |     369 GB |     368 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7735 GB |    7733 GB |
|       from large pool |     787 MB |     977 MB |    7365 GB |    7365 GB |
|       from small pool |     857 MB |     858 MB |     369 GB |     368 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10682 GB |   10682 GB |
|       from large pool |   32920 KB |     261 MB |   10227 GB |   10227 GB |
|       from small pool |   10990 KB |     708 MB |     454 GB |     454 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7431 K  |    7418 K  |
|       from large pool |      61    |      69    |    1682 K  |    1682 K  |
|       from small pool |   13012    |   13020    |    5749 K  |    5736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7431 K  |    7418 K  |
|       from large pool |      61    |      69    |    1682 K  |    1682 K  |
|       from small pool |   13012    |   13020    |    5749 K  |    5736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    4831 K  |    4831 K  |
|       from large pool |       9    |      15    |    1437 K  |    1437 K  |
|       from small pool |     436    |    2231    |    3394 K  |    3393 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7727 GB |    7726 GB |
|       from large pool |     680 MB |     870 MB |    7358 GB |    7357 GB |
|       from small pool |     856 MB |     857 MB |     369 GB |     368 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7727 GB |    7726 GB |
|       from large pool |     680 MB |     870 MB |    7358 GB |    7357 GB |
|       from small pool |     856 MB |     857 MB |     369 GB |     368 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7718 GB |    7718 GB |
|       from large pool |   19933 KB |     153 MB |    7263 GB |    7263 GB |
|       from small pool |   11705 KB |     711 MB |     454 GB |     454 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7424 K  |    7411 K  |
|       from large pool |      28    |      36    |    1680 K  |    1680 K  |
|       from small pool |   13002    |   13011    |    5744 K  |    5731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7424 K  |    7411 K  |
|       from large pool |      28    |      36    |    1680 K  |    1680 K  |
|       from small pool |   13002    |   13011    |    5744 K  |    5731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4709 K  |    4708 K  |
|       from large pool |       7    |      11    |    1316 K  |    1316 K  |
|       from small pool |     437    |    2228    |    3392 K  |    3392 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 76
batch input size: torch.Size([16, 1855]) Device:batch input size:  0torch.Size([16, 1855])
 Device: 1
tensor([[ 0.0016, -0.0004,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0004,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0382, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7838 GB |    7836 GB |
|       from large pool |     787 MB |     977 MB |    7464 GB |    7463 GB |
|       from small pool |     857 MB |     858 MB |     374 GB |     373 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7838 GB |    7836 GB |
|       from large pool |     787 MB |     977 MB |    7464 GB |    7463 GB |
|       from small pool |     857 MB |     858 MB |     374 GB |     373 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10824 GB |   10824 GB |
|       from large pool |   32920 KB |     261 MB |   10364 GB |   10363 GB |
|       from small pool |   10990 KB |     708 MB |     460 GB |     460 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7530 K  |    7517 K  |
|       from large pool |      61    |      69    |    1704 K  |    1704 K  |
|       from small pool |   13012    |   13020    |    5825 K  |    5812 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7530 K  |    7517 K  |
|       from large pool |      61    |      69    |    1704 K  |    1704 K  |
|       from small pool |   13012    |   13020    |    5825 K  |    5812 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    4895 K  |    4895 K  |
|       from large pool |       9    |      15    |    1456 K  |    1456 K  |
|       from small pool |     439    |    2231    |    3439 K  |    3438 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7830 GB |    7829 GB |
|       from large pool |     680 MB |     870 MB |    7456 GB |    7455 GB |
|       from small pool |     856 MB |     857 MB |     374 GB |     373 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7830 GB |    7829 GB |
|       from large pool |     680 MB |     870 MB |    7456 GB |    7455 GB |
|       from small pool |     856 MB |     857 MB |     374 GB |     373 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7821 GB |    7821 GB |
|       from large pool |   19933 KB |     153 MB |    7360 GB |    7360 GB |
|       from small pool |   11705 KB |     711 MB |     460 GB |     460 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7523 K  |    7510 K  |
|       from large pool |      28    |      36    |    1702 K  |    1702 K  |
|       from small pool |   13002    |   13011    |    5820 K  |    5807 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7523 K  |    7510 K  |
|       from large pool |      28    |      36    |    1702 K  |    1702 K  |
|       from small pool |   13002    |   13011    |    5820 K  |    5807 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4771 K  |    4771 K  |
|       from large pool |       7    |      11    |    1333 K  |    1333 K  |
|       from small pool |     437    |    2228    |    3437 K  |    3437 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 77
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0004,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0004,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0097, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    7941 GB |    7939 GB |
|       from large pool |     787 MB |     977 MB |    7562 GB |    7561 GB |
|       from small pool |     857 MB |     858 MB |     379 GB |     378 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    7941 GB |    7939 GB |
|       from large pool |     787 MB |     977 MB |    7562 GB |    7561 GB |
|       from small pool |     857 MB |     858 MB |     379 GB |     378 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   10967 GB |   10967 GB |
|       from large pool |   32920 KB |     261 MB |   10500 GB |   10500 GB |
|       from small pool |   10990 KB |     708 MB |     466 GB |     466 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7629 K  |    7616 K  |
|       from large pool |      61    |      69    |    1727 K  |    1726 K  |
|       from small pool |   13012    |   13020    |    5902 K  |    5889 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7629 K  |    7616 K  |
|       from large pool |      61    |      69    |    1727 K  |    1726 K  |
|       from small pool |   13012    |   13020    |    5902 K  |    5889 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    4960 K  |    4959 K  |
|       from large pool |       9    |      15    |    1475 K  |    1475 K  |
|       from small pool |     438    |    2231    |    3484 K  |    3483 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    7933 GB |    7932 GB |
|       from large pool |     680 MB |     870 MB |    7554 GB |    7553 GB |
|       from small pool |     856 MB |     857 MB |     379 GB |     378 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    7933 GB |    7932 GB |
|       from large pool |     680 MB |     870 MB |    7554 GB |    7553 GB |
|       from small pool |     856 MB |     857 MB |     379 GB |     378 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    7924 GB |    7924 GB |
|       from large pool |   19933 KB |     153 MB |    7457 GB |    7457 GB |
|       from small pool |   11705 KB |     711 MB |     466 GB |     466 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7621 K  |    7608 K  |
|       from large pool |      28    |      36    |    1725 K  |    1725 K  |
|       from small pool |   13002    |   13011    |    5896 K  |    5883 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7621 K  |    7608 K  |
|       from large pool |      28    |      36    |    1725 K  |    1725 K  |
|       from small pool |   13002    |   13011    |    5896 K  |    5883 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4834 K  |    4833 K  |
|       from large pool |       7    |      11    |    1351 K  |    1351 K  |
|       from small pool |     437    |    2228    |    3482 K  |    3482 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 78
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0004,  0.0017,  ..., -0.0018, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0004,  0.0017,  ..., -0.0018, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0408, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8044 GB |    8043 GB |
|       from large pool |     787 MB |     977 MB |    7660 GB |    7659 GB |
|       from small pool |     857 MB |     858 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8044 GB |    8043 GB |
|       from large pool |     787 MB |     977 MB |    7660 GB |    7659 GB |
|       from small pool |     857 MB |     858 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11109 GB |   11109 GB |
|       from large pool |   32920 KB |     261 MB |   10636 GB |   10636 GB |
|       from small pool |   10990 KB |     708 MB |     472 GB |     472 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7727 K  |    7714 K  |
|       from large pool |      61    |      69    |    1749 K  |    1749 K  |
|       from small pool |   13012    |   13020    |    5978 K  |    5965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7727 K  |    7714 K  |
|       from large pool |      61    |      69    |    1749 K  |    1749 K  |
|       from small pool |   13012    |   13020    |    5978 K  |    5965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    5024 K  |    5023 K  |
|       from large pool |       9    |      15    |    1494 K  |    1494 K  |
|       from small pool |     438    |    2231    |    3529 K  |    3528 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8036 GB |    8035 GB |
|       from large pool |     680 MB |     870 MB |    7652 GB |    7651 GB |
|       from small pool |     856 MB |     857 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8036 GB |    8035 GB |
|       from large pool |     680 MB |     870 MB |    7652 GB |    7651 GB |
|       from small pool |     856 MB |     857 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8027 GB |    8027 GB |
|       from large pool |   19933 KB |     153 MB |    7554 GB |    7554 GB |
|       from small pool |   11705 KB |     711 MB |     472 GB |     472 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7720 K  |    7707 K  |
|       from large pool |      28    |      36    |    1747 K  |    1747 K  |
|       from small pool |   13002    |   13011    |    5972 K  |    5959 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7720 K  |    7707 K  |
|       from large pool |      28    |      36    |    1747 K  |    1747 K  |
|       from small pool |   13002    |   13011    |    5972 K  |    5959 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4896 K  |    4896 K  |
|       from large pool |       7    |      11    |    1368 K  |    1368 K  |
|       from small pool |     437    |    2228    |    3527 K  |    3527 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 79
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 0.0016, -0.0004,  0.0017,  ..., -0.0018, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0004,  0.0017,  ..., -0.0018, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0014, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0208, 0.8824], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8147 GB |    8146 GB |
|       from large pool |     787 MB |     977 MB |    7758 GB |    7757 GB |
|       from small pool |     857 MB |     858 MB |     389 GB |     388 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8147 GB |    8146 GB |
|       from large pool |     787 MB |     977 MB |    7758 GB |    7757 GB |
|       from small pool |     857 MB |     858 MB |     389 GB |     388 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11251 GB |   11251 GB |
|       from large pool |   32920 KB |     261 MB |   10773 GB |   10773 GB |
|       from small pool |   10990 KB |     708 MB |     478 GB |     478 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7826 K  |    7813 K  |
|       from large pool |      61    |      69    |    1771 K  |    1771 K  |
|       from small pool |   13012    |   13020    |    6054 K  |    6041 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7826 K  |    7813 K  |
|       from large pool |      61    |      69    |    1771 K  |    1771 K  |
|       from small pool |   13012    |   13020    |    6054 K  |    6041 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    5088 K  |    5088 K  |
|       from large pool |       9    |      15    |    1514 K  |    1514 K  |
|       from small pool |     438    |    2231    |    3574 K  |    3574 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8139 GB |    8138 GB |
|       from large pool |     680 MB |     870 MB |    7750 GB |    7750 GB |
|       from small pool |     856 MB |     857 MB |     389 GB |     388 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8139 GB |    8138 GB |
|       from large pool |     680 MB |     870 MB |    7750 GB |    7750 GB |
|       from small pool |     856 MB |     857 MB |     389 GB |     388 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8130 GB |    8130 GB |
|       from large pool |   19933 KB |     153 MB |    7651 GB |    7651 GB |
|       from small pool |   11705 KB |     711 MB |     478 GB |     478 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7818 K  |    7805 K  |
|       from large pool |      28    |      36    |    1769 K  |    1769 K  |
|       from small pool |   13002    |   13011    |    6048 K  |    6035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7818 K  |    7805 K  |
|       from large pool |      28    |      36    |    1769 K  |    1769 K  |
|       from small pool |   13002    |   13011    |    6048 K  |    6035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    4959 K  |    4958 K  |
|       from large pool |       7    |      11    |    1386 K  |    1386 K  |
|       from small pool |     437    |    2228    |    3572 K  |    3572 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 80
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5500e-03, -3.7696e-04,  1.7344e-03,  ..., -1.8359e-03,
         -1.7664e-03,  1.0210e-03],
        [ 1.7081e-04, -1.3168e-03, -8.2737e-04,  ..., -7.7317e-04,
          9.7704e-05,  1.0916e-03],
        [ 9.8546e-04, -5.2749e-04,  2.1837e-03,  ..., -1.0157e-03,
         -9.1830e-04, -1.7012e-03],
        ...,
        [ 2.1799e-03, -1.2250e-03, -1.7530e-03,  ..., -1.3059e-03,
          6.5388e-04, -1.8636e-03],
        [ 2.1808e-03, -9.0158e-04,  1.6146e-03,  ..., -2.7083e-04,
          1.8156e-03,  1.7105e-03],
        [-1.5184e-03, -1.8021e-03, -1.7622e-03,  ...,  1.5756e-03,
         -1.3608e-03, -4.3204e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5500e-03, -3.7696e-04,  1.7344e-03,  ..., -1.8359e-03,
         -1.7664e-03,  1.0210e-03],
        [ 1.7081e-04, -1.3168e-03, -8.2737e-04,  ..., -7.7317e-04,
          9.7704e-05,  1.0916e-03],
        [ 9.8546e-04, -5.2749e-04,  2.1837e-03,  ..., -1.0157e-03,
         -9.1830e-04, -1.7012e-03],
        ...,
        [ 2.1799e-03, -1.2250e-03, -1.7530e-03,  ..., -1.3059e-03,
          6.5388e-04, -1.8636e-03],
        [ 2.1808e-03, -9.0158e-04,  1.6146e-03,  ..., -2.7083e-04,
          1.8156e-03,  1.7105e-03],
        [-1.5184e-03, -1.8021e-03, -1.7622e-03,  ...,  1.5756e-03,
         -1.3608e-03, -4.3204e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0177, 0.8492], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8250 GB |    8249 GB |
|       from large pool |     787 MB |     977 MB |    7856 GB |    7856 GB |
|       from small pool |     857 MB |     858 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8250 GB |    8249 GB |
|       from large pool |     787 MB |     977 MB |    7856 GB |    7856 GB |
|       from small pool |     857 MB |     858 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11394 GB |   11394 GB |
|       from large pool |   32920 KB |     261 MB |   10909 GB |   10909 GB |
|       from small pool |   10990 KB |     708 MB |     484 GB |     484 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    7925 K  |    7911 K  |
|       from large pool |      61    |      69    |    1794 K  |    1794 K  |
|       from small pool |   13012    |   13020    |    6130 K  |    6117 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    7925 K  |    7911 K  |
|       from large pool |      61    |      69    |    1794 K  |    1794 K  |
|       from small pool |   13012    |   13020    |    6130 K  |    6117 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    5152 K  |    5152 K  |
|       from large pool |       9    |      15    |    1533 K  |    1533 K  |
|       from small pool |     437    |    2231    |    3619 K  |    3619 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8242 GB |    8241 GB |
|       from large pool |     680 MB |     870 MB |    7848 GB |    7848 GB |
|       from small pool |     856 MB |     857 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8242 GB |    8241 GB |
|       from large pool |     680 MB |     870 MB |    7848 GB |    7848 GB |
|       from small pool |     856 MB |     857 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8232 GB |    8232 GB |
|       from large pool |   19933 KB |     153 MB |    7748 GB |    7748 GB |
|       from small pool |   11705 KB |     711 MB |     484 GB |     484 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    7917 K  |    7904 K  |
|       from large pool |      28    |      36    |    1792 K  |    1792 K  |
|       from small pool |   13002    |   13011    |    6125 K  |    6112 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    7917 K  |    7904 K  |
|       from large pool |      28    |      36    |    1792 K  |    1792 K  |
|       from small pool |   13002    |   13011    |    6125 K  |    6112 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5022 K  |    5021 K  |
|       from large pool |       7    |      11    |    1404 K  |    1404 K  |
|       from small pool |     437    |    2228    |    3618 K  |    3617 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 81
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5437e-03, -3.8319e-04,  1.7281e-03,  ..., -1.8297e-03,
         -1.7602e-03,  1.0273e-03],
        [ 1.8176e-04, -1.3059e-03, -8.1647e-04,  ..., -7.8406e-04,
          8.6771e-05,  1.0807e-03],
        [ 9.8753e-04, -5.2542e-04,  2.1858e-03,  ..., -1.0178e-03,
         -9.2036e-04, -1.7032e-03],
        ...,
        [ 2.1803e-03, -1.2246e-03, -1.7526e-03,  ..., -1.3063e-03,
          6.5346e-04, -1.8640e-03],
        [ 2.1820e-03, -9.0040e-04,  1.6157e-03,  ..., -2.7200e-04,
          1.8144e-03,  1.7093e-03],
        [-1.5168e-03, -1.8005e-03, -1.7606e-03,  ...,  1.5740e-03,
         -1.3625e-03, -4.3367e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5437e-03, -3.8319e-04,  1.7281e-03,  ..., -1.8297e-03,
         -1.7602e-03,  1.0273e-03],
        [ 1.8176e-04, -1.3059e-03, -8.1647e-04,  ..., -7.8406e-04,
          8.6771e-05,  1.0807e-03],
        [ 9.8753e-04, -5.2542e-04,  2.1858e-03,  ..., -1.0178e-03,
         -9.2036e-04, -1.7032e-03],
        ...,
        [ 2.1803e-03, -1.2246e-03, -1.7526e-03,  ..., -1.3063e-03,
          6.5346e-04, -1.8640e-03],
        [ 2.1820e-03, -9.0040e-04,  1.6157e-03,  ..., -2.7200e-04,
          1.8144e-03,  1.7093e-03],
        [-1.5168e-03, -1.8005e-03, -1.7606e-03,  ...,  1.5740e-03,
         -1.3625e-03, -4.3367e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0214, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8353 GB |    8352 GB |
|       from large pool |     787 MB |     977 MB |    7954 GB |    7954 GB |
|       from small pool |     857 MB |     858 MB |     398 GB |     398 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8353 GB |    8352 GB |
|       from large pool |     787 MB |     977 MB |    7954 GB |    7954 GB |
|       from small pool |     857 MB |     858 MB |     398 GB |     398 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11536 GB |   11536 GB |
|       from large pool |   32920 KB |     261 MB |   11045 GB |   11045 GB |
|       from small pool |   10990 KB |     708 MB |     490 GB |     490 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8023 K  |    8010 K  |
|       from large pool |      61    |      69    |    1816 K  |    1816 K  |
|       from small pool |   13012    |   13020    |    6206 K  |    6193 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8023 K  |    8010 K  |
|       from large pool |      61    |      69    |    1816 K  |    1816 K  |
|       from small pool |   13012    |   13020    |    6206 K  |    6193 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    5217 K  |    5216 K  |
|       from large pool |       9    |      15    |    1552 K  |    1552 K  |
|       from small pool |     437    |    2231    |    3664 K  |    3664 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8345 GB |    8344 GB |
|       from large pool |     680 MB |     870 MB |    7946 GB |    7946 GB |
|       from small pool |     856 MB |     857 MB |     398 GB |     398 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8345 GB |    8344 GB |
|       from large pool |     680 MB |     870 MB |    7946 GB |    7946 GB |
|       from small pool |     856 MB |     857 MB |     398 GB |     398 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8335 GB |    8335 GB |
|       from large pool |   19933 KB |     153 MB |    7844 GB |    7844 GB |
|       from small pool |   11705 KB |     711 MB |     490 GB |     490 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8015 K  |    8002 K  |
|       from large pool |      28    |      36    |    1814 K  |    1814 K  |
|       from small pool |   13002    |   13011    |    6201 K  |    6188 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8015 K  |    8002 K  |
|       from large pool |      28    |      36    |    1814 K  |    1814 K  |
|       from small pool |   13002    |   13011    |    6201 K  |    6188 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5084 K  |    5084 K  |
|       from large pool |       7    |      11    |    1421 K  |    1421 K  |
|       from small pool |     437    |    2228    |    3663 K  |    3662 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 82
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5389e-03, -3.8793e-04,  1.7234e-03,  ..., -1.8250e-03,
         -1.7554e-03,  1.0321e-03],
        [ 1.9039e-04, -1.2973e-03, -8.0788e-04,  ..., -7.9264e-04,
          7.8149e-05,  1.0720e-03],
        [ 9.8868e-04, -5.2427e-04,  2.1869e-03,  ..., -1.0189e-03,
         -9.2150e-04, -1.7044e-03],
        ...,
        [ 2.1807e-03, -1.2242e-03, -1.7521e-03,  ..., -1.3067e-03,
          6.5303e-04, -1.8644e-03],
        [ 2.1832e-03, -8.9914e-04,  1.6170e-03,  ..., -2.7325e-04,
          1.8131e-03,  1.7081e-03],
        [-1.5151e-03, -1.7989e-03, -1.7590e-03,  ...,  1.5723e-03,
         -1.3641e-03, -4.3531e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5389e-03, -3.8793e-04,  1.7234e-03,  ..., -1.8250e-03,
         -1.7554e-03,  1.0321e-03],
        [ 1.9039e-04, -1.2973e-03, -8.0788e-04,  ..., -7.9264e-04,
          7.8149e-05,  1.0720e-03],
        [ 9.8868e-04, -5.2427e-04,  2.1869e-03,  ..., -1.0189e-03,
         -9.2150e-04, -1.7044e-03],
        ...,
        [ 2.1807e-03, -1.2242e-03, -1.7521e-03,  ..., -1.3067e-03,
          6.5303e-04, -1.8644e-03],
        [ 2.1832e-03, -8.9914e-04,  1.6170e-03,  ..., -2.7325e-04,
          1.8131e-03,  1.7081e-03],
        [-1.5151e-03, -1.7989e-03, -1.7590e-03,  ...,  1.5723e-03,
         -1.3641e-03, -4.3531e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0222, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8457 GB |    8455 GB |
|       from large pool |     787 MB |     977 MB |    8053 GB |    8052 GB |
|       from small pool |     857 MB |     858 MB |     403 GB |     403 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8457 GB |    8455 GB |
|       from large pool |     787 MB |     977 MB |    8053 GB |    8052 GB |
|       from small pool |     857 MB |     858 MB |     403 GB |     403 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11679 GB |   11679 GB |
|       from large pool |   32920 KB |     261 MB |   11182 GB |   11182 GB |
|       from small pool |   10990 KB |     708 MB |     496 GB |     496 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8122 K  |    8109 K  |
|       from large pool |      61    |      69    |    1839 K  |    1839 K  |
|       from small pool |   13012    |   13020    |    6283 K  |    6270 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8122 K  |    8109 K  |
|       from large pool |      61    |      69    |    1839 K  |    1839 K  |
|       from small pool |   13012    |   13020    |    6283 K  |    6270 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    5281 K  |    5280 K  |
|       from large pool |       9    |      15    |    1571 K  |    1571 K  |
|       from small pool |     439    |    2231    |    3709 K  |    3709 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8448 GB |    8447 GB |
|       from large pool |     680 MB |     870 MB |    8044 GB |    8044 GB |
|       from small pool |     856 MB |     857 MB |     403 GB |     402 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8448 GB |    8447 GB |
|       from large pool |     680 MB |     870 MB |    8044 GB |    8044 GB |
|       from small pool |     856 MB |     857 MB |     403 GB |     402 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8438 GB |    8438 GB |
|       from large pool |   19933 KB |     153 MB |    7941 GB |    7941 GB |
|       from small pool |   11705 KB |     711 MB |     496 GB |     496 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8114 K  |    8101 K  |
|       from large pool |      28    |      36    |    1837 K  |    1837 K  |
|       from small pool |   13002    |   13011    |    6277 K  |    6264 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8114 K  |    8101 K  |
|       from large pool |      28    |      36    |    1837 K  |    1837 K  |
|       from small pool |   13002    |   13011    |    6277 K  |    6264 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5147 K  |    5146 K  |
|       from large pool |       7    |      11    |    1439 K  |    1439 K  |
|       from small pool |     437    |    2228    |    3708 K  |    3707 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 83
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5339e-03, -3.9295e-04,  1.7183e-03,  ..., -1.8200e-03,
         -1.7504e-03,  1.0371e-03],
        [ 1.9867e-04, -1.2891e-03, -7.9965e-04,  ..., -8.0087e-04,
          6.9886e-05,  1.0637e-03],
        [ 9.8788e-04, -5.2506e-04,  2.1861e-03,  ..., -1.0181e-03,
         -9.2070e-04, -1.7036e-03],
        ...,
        [ 2.1811e-03, -1.2237e-03, -1.7517e-03,  ..., -1.3071e-03,
          6.5261e-04, -1.8648e-03],
        [ 2.1844e-03, -8.9796e-04,  1.6181e-03,  ..., -2.7443e-04,
          1.8119e-03,  1.7069e-03],
        [-1.5136e-03, -1.7973e-03, -1.7575e-03,  ...,  1.5708e-03,
         -1.3656e-03, -4.3684e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5339e-03, -3.9295e-04,  1.7183e-03,  ..., -1.8200e-03,
         -1.7504e-03,  1.0371e-03],
        [ 1.9867e-04, -1.2891e-03, -7.9965e-04,  ..., -8.0087e-04,
          6.9886e-05,  1.0637e-03],
        [ 9.8788e-04, -5.2506e-04,  2.1861e-03,  ..., -1.0181e-03,
         -9.2070e-04, -1.7036e-03],
        ...,
        [ 2.1811e-03, -1.2237e-03, -1.7517e-03,  ..., -1.3071e-03,
          6.5261e-04, -1.8648e-03],
        [ 2.1844e-03, -8.9796e-04,  1.6181e-03,  ..., -2.7443e-04,
          1.8119e-03,  1.7069e-03],
        [-1.5136e-03, -1.7973e-03, -1.7575e-03,  ...,  1.5708e-03,
         -1.3656e-03, -4.3684e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0231, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8560 GB |    8558 GB |
|       from large pool |     787 MB |     977 MB |    8151 GB |    8150 GB |
|       from small pool |     857 MB |     858 MB |     408 GB |     407 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8560 GB |    8558 GB |
|       from large pool |     787 MB |     977 MB |    8151 GB |    8150 GB |
|       from small pool |     857 MB |     858 MB |     408 GB |     407 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11821 GB |   11821 GB |
|       from large pool |   32920 KB |     261 MB |   11318 GB |   11318 GB |
|       from small pool |   10990 KB |     708 MB |     502 GB |     502 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8220 K  |    8207 K  |
|       from large pool |      61    |      69    |    1861 K  |    1861 K  |
|       from small pool |   13012    |   13020    |    6359 K  |    6346 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8220 K  |    8207 K  |
|       from large pool |      61    |      69    |    1861 K  |    1861 K  |
|       from small pool |   13012    |   13020    |    6359 K  |    6346 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    5345 K  |    5344 K  |
|       from large pool |       9    |      15    |    1590 K  |    1590 K  |
|       from small pool |     440    |    2231    |    3754 K  |    3754 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8551 GB |    8550 GB |
|       from large pool |     680 MB |     870 MB |    8143 GB |    8142 GB |
|       from small pool |     856 MB |     857 MB |     408 GB |     407 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8551 GB |    8550 GB |
|       from large pool |     680 MB |     870 MB |    8143 GB |    8142 GB |
|       from small pool |     856 MB |     857 MB |     408 GB |     407 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8541 GB |    8541 GB |
|       from large pool |   19933 KB |     153 MB |    8038 GB |    8038 GB |
|       from small pool |   11705 KB |     711 MB |     502 GB |     502 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8212 K  |    8199 K  |
|       from large pool |      28    |      36    |    1859 K  |    1859 K  |
|       from small pool |   13002    |   13011    |    6353 K  |    6340 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8212 K  |    8199 K  |
|       from large pool |      28    |      36    |    1859 K  |    1859 K  |
|       from small pool |   13002    |   13011    |    6353 K  |    6340 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5209 K  |    5209 K  |
|       from large pool |       7    |      11    |    1456 K  |    1456 K  |
|       from small pool |     437    |    2228    |    3753 K  |    3752 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 84
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5296e-03, -3.9720e-04,  1.7141e-03,  ..., -1.8158e-03,
         -1.7462e-03,  1.0414e-03],
        [ 2.0635e-04, -1.2814e-03, -7.9200e-04,  ..., -8.0851e-04,
          6.2216e-05,  1.0560e-03],
        [ 9.9204e-04, -5.2091e-04,  2.1902e-03,  ..., -1.0222e-03,
         -9.2484e-04, -1.7077e-03],
        ...,
        [ 2.1815e-03, -1.2233e-03, -1.7513e-03,  ..., -1.3075e-03,
          6.5219e-04, -1.8652e-03],
        [ 2.1856e-03, -8.9675e-04,  1.6193e-03,  ..., -2.7563e-04,
          1.8107e-03,  1.7057e-03],
        [-1.5121e-03, -1.7958e-03, -1.7560e-03,  ...,  1.5693e-03,
         -1.3671e-03, -4.3833e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5296e-03, -3.9720e-04,  1.7141e-03,  ..., -1.8158e-03,
         -1.7462e-03,  1.0414e-03],
        [ 2.0635e-04, -1.2814e-03, -7.9200e-04,  ..., -8.0851e-04,
          6.2216e-05,  1.0560e-03],
        [ 9.9204e-04, -5.2091e-04,  2.1902e-03,  ..., -1.0222e-03,
         -9.2484e-04, -1.7077e-03],
        ...,
        [ 2.1815e-03, -1.2233e-03, -1.7513e-03,  ..., -1.3075e-03,
          6.5219e-04, -1.8652e-03],
        [ 2.1856e-03, -8.9675e-04,  1.6193e-03,  ..., -2.7563e-04,
          1.8107e-03,  1.7057e-03],
        [-1.5121e-03, -1.7958e-03, -1.7560e-03,  ...,  1.5693e-03,
         -1.3671e-03, -4.3833e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0098, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8663 GB |    8661 GB |
|       from large pool |     787 MB |     977 MB |    8249 GB |    8248 GB |
|       from small pool |     857 MB |     858 MB |     413 GB |     412 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8663 GB |    8661 GB |
|       from large pool |     787 MB |     977 MB |    8249 GB |    8248 GB |
|       from small pool |     857 MB |     858 MB |     413 GB |     412 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   11963 GB |   11963 GB |
|       from large pool |   32920 KB |     261 MB |   11454 GB |   11454 GB |
|       from small pool |   10990 KB |     708 MB |     508 GB |     508 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8319 K  |    8306 K  |
|       from large pool |      61    |      69    |    1884 K  |    1883 K  |
|       from small pool |   13012    |   13020    |    6435 K  |    6422 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8319 K  |    8306 K  |
|       from large pool |      61    |      69    |    1884 K  |    1883 K  |
|       from small pool |   13012    |   13020    |    6435 K  |    6422 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    5409 K  |    5409 K  |
|       from large pool |       9    |      15    |    1609 K  |    1609 K  |
|       from small pool |     436    |    2231    |    3799 K  |    3799 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8654 GB |    8653 GB |
|       from large pool |     680 MB |     870 MB |    8241 GB |    8240 GB |
|       from small pool |     856 MB |     857 MB |     413 GB |     412 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8654 GB |    8653 GB |
|       from large pool |     680 MB |     870 MB |    8241 GB |    8240 GB |
|       from small pool |     856 MB |     857 MB |     413 GB |     412 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8644 GB |    8644 GB |
|       from large pool |   19933 KB |     153 MB |    8135 GB |    8135 GB |
|       from small pool |   11705 KB |     711 MB |     508 GB |     508 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8311 K  |    8298 K  |
|       from large pool |      28    |      36    |    1881 K  |    1881 K  |
|       from small pool |   13002    |   13011    |    6429 K  |    6416 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8311 K  |    8298 K  |
|       from large pool |      28    |      36    |    1881 K  |    1881 K  |
|       from small pool |   13002    |   13011    |    6429 K  |    6416 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5272 K  |    5271 K  |
|       from large pool |       7    |      11    |    1474 K  |    1474 K  |
|       from small pool |     437    |    2228    |    3798 K  |    3797 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 85
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 1.5256e-03, -4.0117e-04,  1.7101e-03,  ..., -1.8118e-03,
         -1.7422e-03,  1.0453e-03],
        [ 2.0932e-04, -1.2785e-03, -7.8904e-04,  ..., -8.1147e-04,
          5.9242e-05,  1.0530e-03],
        [ 9.9591e-04, -5.1705e-04,  2.1941e-03,  ..., -1.0261e-03,
         -9.2869e-04, -1.7116e-03],
        ...,
        [ 2.1819e-03, -1.2229e-03, -1.7509e-03,  ..., -1.3079e-03,
          6.5179e-04, -1.8656e-03],
        [ 2.1868e-03, -8.9562e-04,  1.6205e-03,  ..., -2.7676e-04,
          1.8096e-03,  1.7045e-03],
        [-1.5107e-03, -1.7945e-03, -1.7546e-03,  ...,  1.5679e-03,
         -1.3685e-03, -4.3971e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5256e-03, -4.0117e-04,  1.7101e-03,  ..., -1.8118e-03,
         -1.7422e-03,  1.0453e-03],
        [ 2.0932e-04, -1.2785e-03, -7.8904e-04,  ..., -8.1147e-04,
          5.9242e-05,  1.0530e-03],
        [ 9.9591e-04, -5.1705e-04,  2.1941e-03,  ..., -1.0261e-03,
         -9.2869e-04, -1.7116e-03],
        ...,
        [ 2.1819e-03, -1.2229e-03, -1.7509e-03,  ..., -1.3079e-03,
          6.5179e-04, -1.8656e-03],
        [ 2.1868e-03, -8.9562e-04,  1.6205e-03,  ..., -2.7676e-04,
          1.8096e-03,  1.7045e-03],
        [-1.5107e-03, -1.7945e-03, -1.7546e-03,  ...,  1.5679e-03,
         -1.3685e-03, -4.3971e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0051, 0.0024], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8766 GB |    8764 GB |
|       from large pool |     787 MB |     977 MB |    8347 GB |    8347 GB |
|       from small pool |     857 MB |     858 MB |     418 GB |     417 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8766 GB |    8764 GB |
|       from large pool |     787 MB |     977 MB |    8347 GB |    8347 GB |
|       from small pool |     857 MB |     858 MB |     418 GB |     417 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12106 GB |   12106 GB |
|       from large pool |   32920 KB |     261 MB |   11591 GB |   11591 GB |
|       from small pool |   10990 KB |     708 MB |     514 GB |     514 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8418 K  |    8405 K  |
|       from large pool |      61    |      69    |    1906 K  |    1906 K  |
|       from small pool |   13012    |   13020    |    6511 K  |    6498 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8418 K  |    8405 K  |
|       from large pool |      61    |      69    |    1906 K  |    1906 K  |
|       from small pool |   13012    |   13020    |    6511 K  |    6498 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    5473 K  |    5473 K  |
|       from large pool |       9    |      15    |    1629 K  |    1629 K  |
|       from small pool |     439    |    2231    |    3844 K  |    3844 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8757 GB |    8756 GB |
|       from large pool |     680 MB |     870 MB |    8339 GB |    8338 GB |
|       from small pool |     856 MB |     857 MB |     418 GB |     417 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8757 GB |    8756 GB |
|       from large pool |     680 MB |     870 MB |    8339 GB |    8338 GB |
|       from small pool |     856 MB |     857 MB |     418 GB |     417 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8747 GB |    8747 GB |
|       from large pool |   19933 KB |     153 MB |    8232 GB |    8232 GB |
|       from small pool |   11705 KB |     711 MB |     514 GB |     514 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8410 K  |    8397 K  |
|       from large pool |      28    |      36    |    1904 K  |    1904 K  |
|       from small pool |   13002    |   13011    |    6505 K  |    6492 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8410 K  |    8397 K  |
|       from large pool |      28    |      36    |    1904 K  |    1904 K  |
|       from small pool |   13002    |   13011    |    6505 K  |    6492 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5335 K  |    5334 K  |
|       from large pool |       7    |      11    |    1491 K  |    1491 K  |
|       from small pool |     437    |    2228    |    3843 K  |    3842 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 86
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5221e-03, -4.0460e-04,  1.7066e-03,  ..., -1.8084e-03,
         -1.7388e-03,  1.0488e-03],
        [ 2.1204e-04, -1.2757e-03, -7.8634e-04,  ..., -8.1417e-04,
          5.6530e-05,  1.0503e-03],
        [ 9.9947e-04, -5.1351e-04,  2.1976e-03,  ..., -1.0296e-03,
         -9.3223e-04, -1.7151e-03],
        ...,
        [ 2.1823e-03, -1.2226e-03, -1.7505e-03,  ..., -1.3083e-03,
          6.5143e-04, -1.8660e-03],
        [ 2.1878e-03, -8.9457e-04,  1.6215e-03,  ..., -2.7780e-04,
          1.8085e-03,  1.7034e-03],
        [-1.5094e-03, -1.7932e-03, -1.7533e-03,  ...,  1.5666e-03,
         -1.3697e-03, -4.4098e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5221e-03, -4.0460e-04,  1.7066e-03,  ..., -1.8084e-03,
         -1.7388e-03,  1.0488e-03],
        [ 2.1204e-04, -1.2757e-03, -7.8634e-04,  ..., -8.1417e-04,
          5.6530e-05,  1.0503e-03],
        [ 9.9947e-04, -5.1351e-04,  2.1976e-03,  ..., -1.0296e-03,
         -9.3223e-04, -1.7151e-03],
        ...,
        [ 2.1823e-03, -1.2226e-03, -1.7505e-03,  ..., -1.3083e-03,
          6.5143e-04, -1.8660e-03],
        [ 2.1878e-03, -8.9457e-04,  1.6215e-03,  ..., -2.7780e-04,
          1.8085e-03,  1.7034e-03],
        [-1.5094e-03, -1.7932e-03, -1.7533e-03,  ...,  1.5666e-03,
         -1.3697e-03, -4.4098e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0078, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8869 GB |    8867 GB |
|       from large pool |     787 MB |     977 MB |    8445 GB |    8445 GB |
|       from small pool |     857 MB |     858 MB |     423 GB |     422 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8869 GB |    8867 GB |
|       from large pool |     787 MB |     977 MB |    8445 GB |    8445 GB |
|       from small pool |     857 MB |     858 MB |     423 GB |     422 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12248 GB |   12248 GB |
|       from large pool |   32920 KB |     261 MB |   11727 GB |   11727 GB |
|       from small pool |   10990 KB |     708 MB |     520 GB |     520 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8516 K  |    8503 K  |
|       from large pool |      61    |      69    |    1928 K  |    1928 K  |
|       from small pool |   13012    |   13020    |    6587 K  |    6574 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8516 K  |    8503 K  |
|       from large pool |      61    |      69    |    1928 K  |    1928 K  |
|       from small pool |   13012    |   13020    |    6587 K  |    6574 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    5538 K  |    5537 K  |
|       from large pool |       9    |      15    |    1648 K  |    1648 K  |
|       from small pool |     438    |    2231    |    3889 K  |    3889 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8860 GB |    8859 GB |
|       from large pool |     680 MB |     870 MB |    8437 GB |    8436 GB |
|       from small pool |     856 MB |     857 MB |     423 GB |     422 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8860 GB |    8859 GB |
|       from large pool |     680 MB |     870 MB |    8437 GB |    8436 GB |
|       from small pool |     856 MB |     857 MB |     423 GB |     422 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8850 GB |    8850 GB |
|       from large pool |   19933 KB |     153 MB |    8329 GB |    8329 GB |
|       from small pool |   11705 KB |     711 MB |     520 GB |     520 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8508 K  |    8495 K  |
|       from large pool |      28    |      36    |    1926 K  |    1926 K  |
|       from small pool |   13002    |   13011    |    6581 K  |    6568 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8508 K  |    8495 K  |
|       from large pool |      28    |      36    |    1926 K  |    1926 K  |
|       from small pool |   13002    |   13011    |    6581 K  |    6568 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5397 K  |    5397 K  |
|       from large pool |       7    |      11    |    1509 K  |    1509 K  |
|       from small pool |     437    |    2228    |    3888 K  |    3887 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 87
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0 1
tensor([[ 1.5192e-03, -4.0753e-04,  1.7037e-03,  ..., -1.8055e-03,
         -1.7358e-03,  1.0517e-03],
        [ 2.1453e-04, -1.2733e-03, -7.8386e-04,  ..., -8.1664e-04,
          5.4044e-05,  1.0478e-03],
        [ 1.0028e-03, -5.1020e-04,  2.2010e-03,  ..., -1.0329e-03,
         -9.3553e-04, -1.7184e-03],
        ...,
        [ 2.1826e-03, -1.2222e-03, -1.7502e-03,  ..., -1.3086e-03,
          6.5109e-04, -1.8663e-03],
        [ 2.1888e-03, -8.9361e-04,  1.6225e-03,  ..., -2.7876e-04,
          1.8075e-03,  1.7025e-03],
        [-1.5083e-03, -1.7920e-03, -1.7521e-03,  ...,  1.5654e-03,
         -1.3709e-03, -4.4214e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5192e-03, -4.0753e-04,  1.7037e-03,  ..., -1.8055e-03,
         -1.7358e-03,  1.0517e-03],
        [ 2.1453e-04, -1.2733e-03, -7.8386e-04,  ..., -8.1664e-04,
          5.4044e-05,  1.0478e-03],
        [ 1.0028e-03, -5.1020e-04,  2.2010e-03,  ..., -1.0329e-03,
         -9.3553e-04, -1.7184e-03],
        ...,
        [ 2.1826e-03, -1.2222e-03, -1.7502e-03,  ..., -1.3086e-03,
          6.5109e-04, -1.8663e-03],
        [ 2.1888e-03, -8.9361e-04,  1.6225e-03,  ..., -2.7876e-04,
          1.8075e-03,  1.7025e-03],
        [-1.5083e-03, -1.7920e-03, -1.7521e-03,  ...,  1.5654e-03,
         -1.3709e-03, -4.4214e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0209, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    8972 GB |    8970 GB |
|       from large pool |     787 MB |     977 MB |    8544 GB |    8543 GB |
|       from small pool |     857 MB |     858 MB |     428 GB |     427 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    8972 GB |    8970 GB |
|       from large pool |     787 MB |     977 MB |    8544 GB |    8543 GB |
|       from small pool |     857 MB |     858 MB |     428 GB |     427 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12391 GB |   12391 GB |
|       from large pool |   32920 KB |     261 MB |   11864 GB |   11864 GB |
|       from small pool |   10990 KB |     708 MB |     526 GB |     526 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8615 K  |    8602 K  |
|       from large pool |      61    |      69    |    1951 K  |    1951 K  |
|       from small pool |   13012    |   13020    |    6664 K  |    6651 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8615 K  |    8602 K  |
|       from large pool |      61    |      69    |    1951 K  |    1951 K  |
|       from small pool |   13012    |   13020    |    6664 K  |    6651 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    5602 K  |    5601 K  |
|       from large pool |       9    |      15    |    1667 K  |    1667 K  |
|       from small pool |     438    |    2231    |    3935 K  |    3934 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    8963 GB |    8962 GB |
|       from large pool |     680 MB |     870 MB |    8535 GB |    8534 GB |
|       from small pool |     856 MB |     857 MB |     428 GB |     427 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    8963 GB |    8962 GB |
|       from large pool |     680 MB |     870 MB |    8535 GB |    8534 GB |
|       from small pool |     856 MB |     857 MB |     428 GB |     427 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    8953 GB |    8953 GB |
|       from large pool |   19933 KB |     153 MB |    8426 GB |    8426 GB |
|       from small pool |   11705 KB |     711 MB |     527 GB |     527 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8607 K  |    8594 K  |
|       from large pool |      28    |      36    |    1949 K  |    1949 K  |
|       from small pool |   13002    |   13011    |    6658 K  |    6645 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8607 K  |    8594 K  |
|       from large pool |      28    |      36    |    1949 K  |    1949 K  |
|       from small pool |   13002    |   13011    |    6658 K  |    6645 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5460 K  |    5459 K  |
|       from large pool |       7    |      11    |    1526 K  |    1526 K  |
|       from small pool |     437    |    2228    |    3933 K  |    3932 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 88
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 1.5167e-03, -4.1001e-04,  1.7012e-03,  ..., -1.8030e-03,
         -1.7334e-03,  1.0542e-03],
        [ 2.1926e-04, -1.2685e-03, -7.7914e-04,  ..., -8.2135e-04,
          4.9314e-05,  1.0430e-03],
        [ 1.0059e-03, -5.0711e-04,  2.2040e-03,  ..., -1.0360e-03,
         -9.3861e-04, -1.7215e-03],
        ...,
        [ 2.1829e-03, -1.2219e-03, -1.7499e-03,  ..., -1.3089e-03,
          6.5077e-04, -1.8666e-03],
        [ 2.1896e-03, -8.9272e-04,  1.6234e-03,  ..., -2.7964e-04,
          1.8066e-03,  1.7016e-03],
        [-1.5072e-03, -1.7910e-03, -1.7511e-03,  ...,  1.5644e-03,
         -1.3719e-03, -4.4320e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5167e-03, -4.1001e-04,  1.7012e-03,  ..., -1.8030e-03,
         -1.7334e-03,  1.0542e-03],
        [ 2.1926e-04, -1.2685e-03, -7.7914e-04,  ..., -8.2135e-04,
          4.9314e-05,  1.0430e-03],
        [ 1.0059e-03, -5.0711e-04,  2.2040e-03,  ..., -1.0360e-03,
         -9.3861e-04, -1.7215e-03],
        ...,
        [ 2.1829e-03, -1.2219e-03, -1.7499e-03,  ..., -1.3089e-03,
          6.5077e-04, -1.8666e-03],
        [ 2.1896e-03, -8.9272e-04,  1.6234e-03,  ..., -2.7964e-04,
          1.8066e-03,  1.7016e-03],
        [-1.5072e-03, -1.7910e-03, -1.7511e-03,  ...,  1.5644e-03,
         -1.3719e-03, -4.4320e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0057, 0.8830], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9075 GB |    9074 GB |
|       from large pool |     787 MB |     977 MB |    8642 GB |    8641 GB |
|       from small pool |     857 MB |     858 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9075 GB |    9074 GB |
|       from large pool |     787 MB |     977 MB |    8642 GB |    8641 GB |
|       from small pool |     857 MB |     858 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12533 GB |   12533 GB |
|       from large pool |   32920 KB |     261 MB |   12000 GB |   12000 GB |
|       from small pool |   10990 KB |     708 MB |     533 GB |     533 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8714 K  |    8701 K  |
|       from large pool |      61    |      69    |    1973 K  |    1973 K  |
|       from small pool |   13012    |   13020    |    6740 K  |    6727 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8714 K  |    8701 K  |
|       from large pool |      61    |      69    |    1973 K  |    1973 K  |
|       from small pool |   13012    |   13020    |    6740 K  |    6727 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    5666 K  |    5666 K  |
|       from large pool |       9    |      15    |    1686 K  |    1686 K  |
|       from small pool |     438    |    2231    |    3980 K  |    3979 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9066 GB |    9065 GB |
|       from large pool |     680 MB |     870 MB |    8633 GB |    8632 GB |
|       from small pool |     856 MB |     857 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9066 GB |    9065 GB |
|       from large pool |     680 MB |     870 MB |    8633 GB |    8632 GB |
|       from small pool |     856 MB |     857 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9055 GB |    9055 GB |
|       from large pool |   19933 KB |     153 MB |    8522 GB |    8522 GB |
|       from small pool |   11705 KB |     711 MB |     533 GB |     533 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8705 K  |    8692 K  |
|       from large pool |      28    |      36    |    1971 K  |    1971 K  |
|       from small pool |   13002    |   13011    |    6734 K  |    6721 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8705 K  |    8692 K  |
|       from large pool |      28    |      36    |    1971 K  |    1971 K  |
|       from small pool |   13002    |   13011    |    6734 K  |    6721 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5522 K  |    5522 K  |
|       from large pool |       7    |      11    |    1544 K  |    1544 K  |
|       from small pool |     437    |    2228    |    3978 K  |    3977 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 89
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 1.5146e-03, -4.1205e-04,  1.6991e-03,  ..., -1.8009e-03,
         -1.7313e-03,  1.0563e-03],
        [ 2.2360e-04, -1.2642e-03, -7.7482e-04,  ..., -8.2566e-04,
          4.4982e-05,  1.0387e-03],
        [ 1.0088e-03, -5.0420e-04,  2.2069e-03,  ..., -1.0389e-03,
         -9.4151e-04, -1.7244e-03],
        ...,
        [ 2.1832e-03, -1.2216e-03, -1.7496e-03,  ..., -1.3092e-03,
          6.5047e-04, -1.8669e-03],
        [ 2.1905e-03, -8.9187e-04,  1.6242e-03,  ..., -2.8048e-04,
          1.8058e-03,  1.7007e-03],
        [-1.5062e-03, -1.7899e-03, -1.7501e-03,  ...,  1.5633e-03,
         -1.3729e-03, -4.4420e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5146e-03, -4.1205e-04,  1.6991e-03,  ..., -1.8009e-03,
         -1.7313e-03,  1.0563e-03],
        [ 2.2360e-04, -1.2642e-03, -7.7482e-04,  ..., -8.2566e-04,
          4.4982e-05,  1.0387e-03],
        [ 1.0088e-03, -5.0420e-04,  2.2069e-03,  ..., -1.0389e-03,
         -9.4151e-04, -1.7244e-03],
        ...,
        [ 2.1832e-03, -1.2216e-03, -1.7496e-03,  ..., -1.3092e-03,
          6.5047e-04, -1.8669e-03],
        [ 2.1905e-03, -8.9187e-04,  1.6242e-03,  ..., -2.8048e-04,
          1.8058e-03,  1.7007e-03],
        [-1.5062e-03, -1.7899e-03, -1.7501e-03,  ...,  1.5633e-03,
         -1.3729e-03, -4.4420e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0074, 0.8469], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9178 GB |    9177 GB |
|       from large pool |     787 MB |     977 MB |    8740 GB |    8739 GB |
|       from small pool |     857 MB |     858 MB |     438 GB |     437 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9178 GB |    9177 GB |
|       from large pool |     787 MB |     977 MB |    8740 GB |    8739 GB |
|       from small pool |     857 MB |     858 MB |     438 GB |     437 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12675 GB |   12675 GB |
|       from large pool |   32920 KB |     261 MB |   12136 GB |   12136 GB |
|       from small pool |   10990 KB |     708 MB |     539 GB |     539 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8812 K  |    8799 K  |
|       from large pool |      61    |      69    |    1996 K  |    1996 K  |
|       from small pool |   13012    |   13020    |    6816 K  |    6803 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8812 K  |    8799 K  |
|       from large pool |      61    |      69    |    1996 K  |    1996 K  |
|       from small pool |   13012    |   13020    |    6816 K  |    6803 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    5730 K  |    5730 K  |
|       from large pool |       9    |      15    |    1705 K  |    1705 K  |
|       from small pool |     437    |    2231    |    4025 K  |    4024 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9169 GB |    9168 GB |
|       from large pool |     680 MB |     870 MB |    8731 GB |    8730 GB |
|       from small pool |     856 MB |     857 MB |     438 GB |     437 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9169 GB |    9168 GB |
|       from large pool |     680 MB |     870 MB |    8731 GB |    8730 GB |
|       from small pool |     856 MB |     857 MB |     438 GB |     437 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9158 GB |    9158 GB |
|       from large pool |   19933 KB |     153 MB |    8619 GB |    8619 GB |
|       from small pool |   11705 KB |     711 MB |     539 GB |     539 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8804 K  |    8791 K  |
|       from large pool |      28    |      36    |    1993 K  |    1993 K  |
|       from small pool |   13002    |   13011    |    6810 K  |    6797 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8804 K  |    8791 K  |
|       from large pool |      28    |      36    |    1993 K  |    1993 K  |
|       from small pool |   13002    |   13011    |    6810 K  |    6797 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5585 K  |    5584 K  |
|       from large pool |       7    |      11    |    1561 K  |    1561 K  |
|       from small pool |     437    |    2228    |    4023 K  |    4023 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 90
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
 1
tensor([[ 1.5129e-03, -4.1374e-04,  1.6974e-03,  ..., -1.7992e-03,
         -1.7296e-03,  1.0580e-03],
        [ 2.2755e-04, -1.2603e-03, -7.7089e-04,  ..., -8.2958e-04,
          4.1040e-05,  1.0347e-03],
        [ 1.0115e-03, -5.0150e-04,  2.2096e-03,  ..., -1.0416e-03,
         -9.4421e-04, -1.7270e-03],
        ...,
        [ 2.1835e-03, -1.2213e-03, -1.7493e-03,  ..., -1.3095e-03,
          6.5018e-04, -1.8672e-03],
        [ 2.1912e-03, -8.9109e-04,  1.6250e-03,  ..., -2.8126e-04,
          1.8050e-03,  1.6999e-03],
        [-1.5053e-03, -1.7890e-03, -1.7492e-03,  ...,  1.5624e-03,
         -1.3738e-03, -4.4512e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5129e-03, -4.1374e-04,  1.6974e-03,  ..., -1.7992e-03,
         -1.7296e-03,  1.0580e-03],
        [ 2.2755e-04, -1.2603e-03, -7.7089e-04,  ..., -8.2958e-04,
          4.1040e-05,  1.0347e-03],
        [ 1.0115e-03, -5.0150e-04,  2.2096e-03,  ..., -1.0416e-03,
         -9.4421e-04, -1.7270e-03],
        ...,
        [ 2.1835e-03, -1.2213e-03, -1.7493e-03,  ..., -1.3095e-03,
          6.5018e-04, -1.8672e-03],
        [ 2.1912e-03, -8.9109e-04,  1.6250e-03,  ..., -2.8126e-04,
          1.8050e-03,  1.6999e-03],
        [-1.5053e-03, -1.7890e-03, -1.7492e-03,  ...,  1.5624e-03,
         -1.3738e-03, -4.4512e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0063, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9281 GB |    9280 GB |
|       from large pool |     787 MB |     977 MB |    8838 GB |    8838 GB |
|       from small pool |     857 MB |     858 MB |     443 GB |     442 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9281 GB |    9280 GB |
|       from large pool |     787 MB |     977 MB |    8838 GB |    8838 GB |
|       from small pool |     857 MB |     858 MB |     443 GB |     442 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12818 GB |   12818 GB |
|       from large pool |   32920 KB |     261 MB |   12273 GB |   12273 GB |
|       from small pool |   10990 KB |     708 MB |     545 GB |     545 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    8911 K  |    8898 K  |
|       from large pool |      61    |      69    |    2018 K  |    2018 K  |
|       from small pool |   13012    |   13020    |    6892 K  |    6879 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    8911 K  |    8898 K  |
|       from large pool |      61    |      69    |    2018 K  |    2018 K  |
|       from small pool |   13012    |   13020    |    6892 K  |    6879 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    5795 K  |    5794 K  |
|       from large pool |       9    |      15    |    1724 K  |    1724 K  |
|       from small pool |     437    |    2231    |    4070 K  |    4069 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9272 GB |    9271 GB |
|       from large pool |     680 MB |     870 MB |    8829 GB |    8829 GB |
|       from small pool |     856 MB |     857 MB |     442 GB |     442 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9272 GB |    9271 GB |
|       from large pool |     680 MB |     870 MB |    8829 GB |    8829 GB |
|       from small pool |     856 MB |     857 MB |     442 GB |     442 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9261 GB |    9261 GB |
|       from large pool |   19933 KB |     153 MB |    8716 GB |    8716 GB |
|       from small pool |   11705 KB |     711 MB |     545 GB |     545 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    8902 K  |    8889 K  |
|       from large pool |      28    |      36    |    2016 K  |    2016 K  |
|       from small pool |   13002    |   13011    |    6886 K  |    6873 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    8902 K  |    8889 K  |
|       from large pool |      28    |      36    |    2016 K  |    2016 K  |
|       from small pool |   13002    |   13011    |    6886 K  |    6873 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5648 K  |    5647 K  |
|       from large pool |       7    |      11    |    1579 K  |    1579 K  |
|       from small pool |     437    |    2228    |    4068 K  |    4068 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 91
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5115e-03, -4.1516e-04,  1.6960e-03,  ..., -1.7978e-03,
         -1.7282e-03,  1.0594e-03],
        [ 2.3113e-04, -1.2567e-03, -7.6732e-04,  ..., -8.3315e-04,
          3.7458e-05,  1.0311e-03],
        [ 1.0140e-03, -4.9898e-04,  2.2122e-03,  ..., -1.0441e-03,
         -9.4672e-04, -1.7296e-03],
        ...,
        [ 2.1837e-03, -1.2210e-03, -1.7490e-03,  ..., -1.3097e-03,
          6.4991e-04, -1.8674e-03],
        [ 2.1920e-03, -8.9036e-04,  1.6257e-03,  ..., -2.8198e-04,
          1.8042e-03,  1.6992e-03],
        [-1.5044e-03, -1.7882e-03, -1.7483e-03,  ...,  1.5616e-03,
         -1.3747e-03, -4.4596e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5115e-03, -4.1516e-04,  1.6960e-03,  ..., -1.7978e-03,
         -1.7282e-03,  1.0594e-03],
        [ 2.3113e-04, -1.2567e-03, -7.6732e-04,  ..., -8.3315e-04,
          3.7458e-05,  1.0311e-03],
        [ 1.0140e-03, -4.9898e-04,  2.2122e-03,  ..., -1.0441e-03,
         -9.4672e-04, -1.7296e-03],
        ...,
        [ 2.1837e-03, -1.2210e-03, -1.7490e-03,  ..., -1.3097e-03,
          6.4991e-04, -1.8674e-03],
        [ 2.1920e-03, -8.9036e-04,  1.6257e-03,  ..., -2.8198e-04,
          1.8042e-03,  1.6992e-03],
        [-1.5044e-03, -1.7882e-03, -1.7483e-03,  ...,  1.5616e-03,
         -1.3747e-03, -4.4596e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0183, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9384 GB |    9383 GB |
|       from large pool |     787 MB |     977 MB |    8936 GB |    8936 GB |
|       from small pool |     857 MB |     858 MB |     447 GB |     447 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9384 GB |    9383 GB |
|       from large pool |     787 MB |     977 MB |    8936 GB |    8936 GB |
|       from small pool |     857 MB |     858 MB |     447 GB |     447 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   12960 GB |   12960 GB |
|       from large pool |   32920 KB |     261 MB |   12409 GB |   12409 GB |
|       from small pool |   10990 KB |     708 MB |     551 GB |     551 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9010 K  |    8997 K  |
|       from large pool |      61    |      69    |    2041 K  |    2040 K  |
|       from small pool |   13012    |   13020    |    6969 K  |    6956 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9010 K  |    8997 K  |
|       from large pool |      61    |      69    |    2041 K  |    2040 K  |
|       from small pool |   13012    |   13020    |    6969 K  |    6956 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    5859 K  |    5858 K  |
|       from large pool |       9    |      15    |    1744 K  |    1744 K  |
|       from small pool |     439    |    2231    |    4115 K  |    4114 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9375 GB |    9374 GB |
|       from large pool |     680 MB |     870 MB |    8927 GB |    8927 GB |
|       from small pool |     856 MB |     857 MB |     447 GB |     447 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9375 GB |    9374 GB |
|       from large pool |     680 MB |     870 MB |    8927 GB |    8927 GB |
|       from small pool |     856 MB |     857 MB |     447 GB |     447 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9364 GB |    9364 GB |
|       from large pool |   19933 KB |     153 MB |    8813 GB |    8813 GB |
|       from small pool |   11705 KB |     711 MB |     551 GB |     551 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9001 K  |    8988 K  |
|       from large pool |      28    |      36    |    2038 K  |    2038 K  |
|       from small pool |   13002    |   13011    |    6962 K  |    6949 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9001 K  |    8988 K  |
|       from large pool |      28    |      36    |    2038 K  |    2038 K  |
|       from small pool |   13002    |   13011    |    6962 K  |    6949 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5710 K  |    5710 K  |
|       from large pool |       7    |      11    |    1597 K  |    1597 K  |
|       from small pool |     437    |    2228    |    4113 K  |    4113 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 92
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 1.5104e-03, -4.1617e-04,  1.6950e-03,  ..., -1.7968e-03,
         -1.7272e-03,  1.0604e-03],
        [ 2.3488e-04, -1.2530e-03, -7.6359e-04,  ..., -8.3687e-04,
          3.3712e-05,  1.0274e-03],
        [ 1.0185e-03, -4.9455e-04,  2.2166e-03,  ..., -1.0485e-03,
         -9.5114e-04, -1.7340e-03],
        ...,
        [ 2.1840e-03, -1.2208e-03, -1.7487e-03,  ..., -1.3100e-03,
          6.4966e-04, -1.8677e-03],
        [ 2.1927e-03, -8.8966e-04,  1.6264e-03,  ..., -2.8267e-04,
          1.8035e-03,  1.6985e-03],
        [-1.5036e-03, -1.7874e-03, -1.7475e-03,  ...,  1.5608e-03,
         -1.3755e-03, -4.4674e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5104e-03, -4.1617e-04,  1.6950e-03,  ..., -1.7968e-03,
         -1.7272e-03,  1.0604e-03],
        [ 2.3488e-04, -1.2530e-03, -7.6359e-04,  ..., -8.3687e-04,
          3.3712e-05,  1.0274e-03],
        [ 1.0185e-03, -4.9455e-04,  2.2166e-03,  ..., -1.0485e-03,
         -9.5114e-04, -1.7340e-03],
        ...,
        [ 2.1840e-03, -1.2208e-03, -1.7487e-03,  ..., -1.3100e-03,
          6.4966e-04, -1.8677e-03],
        [ 2.1927e-03, -8.8966e-04,  1.6264e-03,  ..., -2.8267e-04,
          1.8035e-03,  1.6985e-03],
        [-1.5036e-03, -1.7874e-03, -1.7475e-03,  ...,  1.5608e-03,
         -1.3755e-03, -4.4674e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0120, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9488 GB |    9486 GB |
|       from large pool |     787 MB |     977 MB |    9035 GB |    9034 GB |
|       from small pool |     857 MB |     858 MB |     452 GB |     452 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9488 GB |    9486 GB |
|       from large pool |     787 MB |     977 MB |    9035 GB |    9034 GB |
|       from small pool |     857 MB |     858 MB |     452 GB |     452 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13103 GB |   13102 GB |
|       from large pool |   32920 KB |     261 MB |   12545 GB |   12545 GB |
|       from small pool |   10990 KB |     708 MB |     557 GB |     557 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9108 K  |    9095 K  |
|       from large pool |      61    |      69    |    2063 K  |    2063 K  |
|       from small pool |   13012    |   13020    |    7045 K  |    7032 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9108 K  |    9095 K  |
|       from large pool |      61    |      69    |    2063 K  |    2063 K  |
|       from small pool |   13012    |   13020    |    7045 K  |    7032 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    5923 K  |    5923 K  |
|       from large pool |       9    |      15    |    1763 K  |    1763 K  |
|       from small pool |     440    |    2231    |    4160 K  |    4159 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9478 GB |    9477 GB |
|       from large pool |     680 MB |     870 MB |    9025 GB |    9025 GB |
|       from small pool |     856 MB |     857 MB |     452 GB |     451 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9478 GB |    9477 GB |
|       from large pool |     680 MB |     870 MB |    9025 GB |    9025 GB |
|       from small pool |     856 MB |     857 MB |     452 GB |     451 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9467 GB |    9467 GB |
|       from large pool |   19933 KB |     153 MB |    8910 GB |    8910 GB |
|       from small pool |   11705 KB |     711 MB |     557 GB |     557 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9099 K  |    9086 K  |
|       from large pool |      28    |      36    |    2061 K  |    2061 K  |
|       from small pool |   13002    |   13011    |    7038 K  |    7025 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9099 K  |    9086 K  |
|       from large pool |      28    |      36    |    2061 K  |    2061 K  |
|       from small pool |   13002    |   13011    |    7038 K  |    7025 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5773 K  |    5772 K  |
|       from large pool |       7    |      11    |    1614 K  |    1614 K  |
|       from small pool |     437    |    2228    |    4158 K  |    4158 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 93
batch input size: torch.Size([16, 1855]) Device:batch input size:  0torch.Size([16, 1855])
 Device: 1
tensor([[ 1.5097e-03, -4.1689e-04,  1.6942e-03,  ..., -1.7961e-03,
         -1.7265e-03,  1.0611e-03],
        [ 2.3881e-04, -1.2491e-03, -7.5968e-04,  ..., -8.4078e-04,
          2.9788e-05,  1.0234e-03],
        [ 1.0227e-03, -4.9035e-04,  2.2208e-03,  ..., -1.0527e-03,
         -9.5533e-04, -1.7382e-03],
        ...,
        [ 2.1842e-03, -1.2205e-03, -1.7485e-03,  ..., -1.3102e-03,
          6.4939e-04, -1.8679e-03],
        [ 2.1933e-03, -8.8896e-04,  1.6271e-03,  ..., -2.8336e-04,
          1.8028e-03,  1.6978e-03],
        [-1.5029e-03, -1.7866e-03, -1.7468e-03,  ...,  1.5600e-03,
         -1.3762e-03, -4.4750e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5097e-03, -4.1689e-04,  1.6942e-03,  ..., -1.7961e-03,
         -1.7265e-03,  1.0611e-03],
        [ 2.3881e-04, -1.2491e-03, -7.5968e-04,  ..., -8.4078e-04,
          2.9788e-05,  1.0234e-03],
        [ 1.0227e-03, -4.9035e-04,  2.2208e-03,  ..., -1.0527e-03,
         -9.5533e-04, -1.7382e-03],
        ...,
        [ 2.1842e-03, -1.2205e-03, -1.7485e-03,  ..., -1.3102e-03,
          6.4939e-04, -1.8679e-03],
        [ 2.1933e-03, -8.8896e-04,  1.6271e-03,  ..., -2.8336e-04,
          1.8028e-03,  1.6978e-03],
        [-1.5029e-03, -1.7866e-03, -1.7468e-03,  ...,  1.5600e-03,
         -1.3762e-03, -4.4750e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0073, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9591 GB |    9589 GB |
|       from large pool |     787 MB |     977 MB |    9133 GB |    9132 GB |
|       from small pool |     857 MB |     858 MB |     457 GB |     456 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9591 GB |    9589 GB |
|       from large pool |     787 MB |     977 MB |    9133 GB |    9132 GB |
|       from small pool |     857 MB |     858 MB |     457 GB |     456 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13245 GB |   13245 GB |
|       from large pool |   32920 KB |     261 MB |   12682 GB |   12682 GB |
|       from small pool |   10990 KB |     708 MB |     563 GB |     563 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9207 K  |    9194 K  |
|       from large pool |      61    |      69    |    2085 K  |    2085 K  |
|       from small pool |   13012    |   13020    |    7121 K  |    7108 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9207 K  |    9194 K  |
|       from large pool |      61    |      69    |    2085 K  |    2085 K  |
|       from small pool |   13012    |   13020    |    7121 K  |    7108 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    5987 K  |    5987 K  |
|       from large pool |       9    |      15    |    1782 K  |    1782 K  |
|       from small pool |     436    |    2231    |    4205 K  |    4205 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9581 GB |    9580 GB |
|       from large pool |     680 MB |     870 MB |    9124 GB |    9123 GB |
|       from small pool |     856 MB |     857 MB |     457 GB |     456 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9581 GB |    9580 GB |
|       from large pool |     680 MB |     870 MB |    9124 GB |    9123 GB |
|       from small pool |     856 MB |     857 MB |     457 GB |     456 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9570 GB |    9570 GB |
|       from large pool |   19933 KB |     153 MB |    9007 GB |    9007 GB |
|       from small pool |   11705 KB |     711 MB |     563 GB |     563 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9198 K  |    9185 K  |
|       from large pool |      28    |      36    |    2083 K  |    2083 K  |
|       from small pool |   13002    |   13011    |    7114 K  |    7101 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9198 K  |    9185 K  |
|       from large pool |      28    |      36    |    2083 K  |    2083 K  |
|       from small pool |   13002    |   13011    |    7114 K  |    7101 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5835 K  |    5835 K  |
|       from large pool |       7    |      11    |    1632 K  |    1632 K  |
|       from small pool |     437    |    2228    |    4203 K  |    4203 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 94
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 1.5090e-03, -4.1753e-04,  1.6936e-03,  ..., -1.7954e-03,
         -1.7258e-03,  1.0618e-03],
        [ 2.4240e-04, -1.2455e-03, -7.5610e-04,  ..., -8.4434e-04,
          2.6206e-05,  1.0198e-03],
        [ 1.0272e-03, -4.8588e-04,  2.2253e-03,  ..., -1.0571e-03,
         -9.5979e-04, -1.7426e-03],
        ...,
        [ 2.1844e-03, -1.2203e-03, -1.7482e-03,  ..., -1.3105e-03,
          6.4914e-04, -1.8682e-03],
        [ 2.1940e-03, -8.8830e-04,  1.6277e-03,  ..., -2.8402e-04,
          1.8022e-03,  1.6971e-03],
        [-1.5021e-03, -1.7859e-03, -1.7460e-03,  ...,  1.5593e-03,
         -1.3769e-03, -4.4821e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5090e-03, -4.1753e-04,  1.6936e-03,  ..., -1.7954e-03,
         -1.7258e-03,  1.0618e-03],
        [ 2.4240e-04, -1.2455e-03, -7.5610e-04,  ..., -8.4434e-04,
          2.6206e-05,  1.0198e-03],
        [ 1.0272e-03, -4.8588e-04,  2.2253e-03,  ..., -1.0571e-03,
         -9.5979e-04, -1.7426e-03],
        ...,
        [ 2.1844e-03, -1.2203e-03, -1.7482e-03,  ..., -1.3105e-03,
          6.4914e-04, -1.8682e-03],
        [ 2.1940e-03, -8.8830e-04,  1.6277e-03,  ..., -2.8402e-04,
          1.8022e-03,  1.6971e-03],
        [-1.5021e-03, -1.7859e-03, -1.7460e-03,  ...,  1.5593e-03,
         -1.3769e-03, -4.4821e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0138, 0.0024], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9694 GB |    9692 GB |
|       from large pool |     787 MB |     977 MB |    9231 GB |    9230 GB |
|       from small pool |     857 MB |     858 MB |     462 GB |     461 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9694 GB |    9692 GB |
|       from large pool |     787 MB |     977 MB |    9231 GB |    9230 GB |
|       from small pool |     857 MB |     858 MB |     462 GB |     461 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13387 GB |   13387 GB |
|       from large pool |   32920 KB |     261 MB |   12818 GB |   12818 GB |
|       from small pool |   10990 KB |     708 MB |     569 GB |     569 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9306 K  |    9292 K  |
|       from large pool |      61    |      69    |    2108 K  |    2108 K  |
|       from small pool |   13012    |   13020    |    7197 K  |    7184 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9306 K  |    9292 K  |
|       from large pool |      61    |      69    |    2108 K  |    2108 K  |
|       from small pool |   13012    |   13020    |    7197 K  |    7184 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    6052 K  |    6051 K  |
|       from large pool |       9    |      15    |    1801 K  |    1801 K  |
|       from small pool |     439    |    2231    |    4250 K  |    4250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9684 GB |    9683 GB |
|       from large pool |     680 MB |     870 MB |    9222 GB |    9221 GB |
|       from small pool |     856 MB |     857 MB |     462 GB |     461 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9684 GB |    9683 GB |
|       from large pool |     680 MB |     870 MB |    9222 GB |    9221 GB |
|       from small pool |     856 MB |     857 MB |     462 GB |     461 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9673 GB |    9673 GB |
|       from large pool |   19933 KB |     153 MB |    9104 GB |    9104 GB |
|       from small pool |   11705 KB |     711 MB |     569 GB |     569 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9297 K  |    9283 K  |
|       from large pool |      28    |      36    |    2105 K  |    2105 K  |
|       from small pool |   13002    |   13011    |    7191 K  |    7178 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9297 K  |    9283 K  |
|       from large pool |      28    |      36    |    2105 K  |    2105 K  |
|       from small pool |   13002    |   13011    |    7191 K  |    7178 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5898 K  |    5898 K  |
|       from large pool |       7    |      11    |    1649 K  |    1649 K  |
|       from small pool |     437    |    2228    |    4248 K  |    4248 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 95
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5092e-03, -4.1740e-04,  1.6937e-03,  ..., -1.7956e-03,
         -1.7259e-03,  1.0616e-03],
        [ 2.4572e-04, -1.2422e-03, -7.5280e-04,  ..., -8.4764e-04,
          2.2893e-05,  1.0165e-03],
        [ 1.0314e-03, -4.8166e-04,  2.2295e-03,  ..., -1.0613e-03,
         -9.6400e-04, -1.7468e-03],
        ...,
        [ 2.1847e-03, -1.2200e-03, -1.7480e-03,  ..., -1.3107e-03,
          6.4889e-04, -1.8684e-03],
        [ 2.1947e-03, -8.8764e-04,  1.6284e-03,  ..., -2.8467e-04,
          1.8015e-03,  1.6964e-03],
        [-1.5015e-03, -1.7852e-03, -1.7454e-03,  ...,  1.5586e-03,
         -1.3776e-03, -4.4889e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5092e-03, -4.1740e-04,  1.6937e-03,  ..., -1.7956e-03,
         -1.7259e-03,  1.0616e-03],
        [ 2.4572e-04, -1.2422e-03, -7.5280e-04,  ..., -8.4764e-04,
          2.2893e-05,  1.0165e-03],
        [ 1.0314e-03, -4.8166e-04,  2.2295e-03,  ..., -1.0613e-03,
         -9.6400e-04, -1.7468e-03],
        ...,
        [ 2.1847e-03, -1.2200e-03, -1.7480e-03,  ..., -1.3107e-03,
          6.4889e-04, -1.8684e-03],
        [ 2.1947e-03, -8.8764e-04,  1.6284e-03,  ..., -2.8467e-04,
          1.8015e-03,  1.6964e-03],
        [-1.5015e-03, -1.7852e-03, -1.7454e-03,  ...,  1.5586e-03,
         -1.3776e-03, -4.4889e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0445, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9797 GB |    9795 GB |
|       from large pool |     787 MB |     977 MB |    9329 GB |    9328 GB |
|       from small pool |     857 MB |     858 MB |     467 GB |     466 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9797 GB |    9795 GB |
|       from large pool |     787 MB |     977 MB |    9329 GB |    9328 GB |
|       from small pool |     857 MB |     858 MB |     467 GB |     466 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13530 GB |   13530 GB |
|       from large pool |   32920 KB |     261 MB |   12954 GB |   12954 GB |
|       from small pool |   10990 KB |     708 MB |     575 GB |     575 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9404 K  |    9391 K  |
|       from large pool |      61    |      69    |    2130 K  |    2130 K  |
|       from small pool |   13012    |   13020    |    7273 K  |    7260 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9404 K  |    9391 K  |
|       from large pool |      61    |      69    |    2130 K  |    2130 K  |
|       from small pool |   13012    |   13020    |    7273 K  |    7260 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    6116 K  |    6115 K  |
|       from large pool |       9    |      15    |    1820 K  |    1820 K  |
|       from small pool |     438    |    2231    |    4295 K  |    4295 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9787 GB |    9786 GB |
|       from large pool |     680 MB |     870 MB |    9320 GB |    9319 GB |
|       from small pool |     856 MB |     857 MB |     467 GB |     466 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9787 GB |    9786 GB |
|       from large pool |     680 MB |     870 MB |    9320 GB |    9319 GB |
|       from small pool |     856 MB |     857 MB |     467 GB |     466 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9776 GB |    9776 GB |
|       from large pool |   19933 KB |     153 MB |    9200 GB |    9200 GB |
|       from small pool |   11705 KB |     711 MB |     575 GB |     575 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9395 K  |    9382 K  |
|       from large pool |      28    |      36    |    2128 K  |    2128 K  |
|       from small pool |   13002    |   13011    |    7267 K  |    7254 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9395 K  |    9382 K  |
|       from large pool |      28    |      36    |    2128 K  |    2128 K  |
|       from small pool |   13002    |   13011    |    7267 K  |    7254 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    5961 K  |    5960 K  |
|       from large pool |       7    |      11    |    1667 K  |    1667 K  |
|       from small pool |     437    |    2228    |    4293 K  |    4293 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 96
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 1.5093e-03, -4.1720e-04,  1.6939e-03,  ..., -1.7957e-03,
         -1.7261e-03,  1.0614e-03],
        [ 2.4275e-04, -1.2451e-03, -7.5575e-04,  ..., -8.4468e-04,
          2.5857e-05,  1.0195e-03],
        [ 1.0353e-03, -4.7776e-04,  2.2334e-03,  ..., -1.0652e-03,
         -9.6789e-04, -1.7507e-03],
        ...,
        [ 2.1827e-03, -1.2220e-03, -1.7499e-03,  ..., -1.3087e-03,
          6.5087e-04, -1.8664e-03],
        [ 2.1953e-03, -8.8701e-04,  1.6290e-03,  ..., -2.8530e-04,
          1.8009e-03,  1.6958e-03],
        [-1.5008e-03, -1.7846e-03, -1.7447e-03,  ...,  1.5580e-03,
         -1.3782e-03, -4.4951e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5093e-03, -4.1720e-04,  1.6939e-03,  ..., -1.7957e-03,
         -1.7261e-03,  1.0614e-03],
        [ 2.4275e-04, -1.2451e-03, -7.5575e-04,  ..., -8.4468e-04,
          2.5857e-05,  1.0195e-03],
        [ 1.0353e-03, -4.7776e-04,  2.2334e-03,  ..., -1.0652e-03,
         -9.6789e-04, -1.7507e-03],
        ...,
        [ 2.1827e-03, -1.2220e-03, -1.7499e-03,  ..., -1.3087e-03,
          6.5087e-04, -1.8664e-03],
        [ 2.1953e-03, -8.8701e-04,  1.6290e-03,  ..., -2.8530e-04,
          1.8009e-03,  1.6958e-03],
        [-1.5008e-03, -1.7846e-03, -1.7447e-03,  ...,  1.5580e-03,
         -1.3782e-03, -4.4951e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0134, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |    9900 GB |    9898 GB |
|       from large pool |     787 MB |     977 MB |    9427 GB |    9427 GB |
|       from small pool |     857 MB |     858 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |    9900 GB |    9898 GB |
|       from large pool |     787 MB |     977 MB |    9427 GB |    9427 GB |
|       from small pool |     857 MB |     858 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13672 GB |   13672 GB |
|       from large pool |   32920 KB |     261 MB |   13091 GB |   13091 GB |
|       from small pool |   10990 KB |     708 MB |     581 GB |     581 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9503 K  |    9490 K  |
|       from large pool |      61    |      69    |    2153 K  |    2153 K  |
|       from small pool |   13012    |   13020    |    7350 K  |    7337 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9503 K  |    9490 K  |
|       from large pool |      61    |      69    |    2153 K  |    2153 K  |
|       from small pool |   13012    |   13020    |    7350 K  |    7337 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    6180 K  |    6180 K  |
|       from large pool |       9    |      15    |    1839 K  |    1839 K  |
|       from small pool |     438    |    2231    |    4340 K  |    4340 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9890 GB |    9889 GB |
|       from large pool |     680 MB |     870 MB |    9418 GB |    9417 GB |
|       from small pool |     856 MB |     857 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9890 GB |    9889 GB |
|       from large pool |     680 MB |     870 MB |    9418 GB |    9417 GB |
|       from small pool |     856 MB |     857 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9879 GB |    9879 GB |
|       from large pool |   19933 KB |     153 MB |    9297 GB |    9297 GB |
|       from small pool |   11705 KB |     711 MB |     581 GB |     581 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9494 K  |    9481 K  |
|       from large pool |      28    |      36    |    2150 K  |    2150 K  |
|       from small pool |   13002    |   13011    |    7343 K  |    7330 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9494 K  |    9481 K  |
|       from large pool |      28    |      36    |    2150 K  |    2150 K  |
|       from small pool |   13002    |   13011    |    7343 K  |    7330 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6023 K  |    6023 K  |
|       from large pool |       7    |      11    |    1684 K  |    1684 K  |
|       from small pool |     437    |    2228    |    4338 K  |    4338 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 97
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5096e-03, -4.1691e-04,  1.6942e-03,  ..., -1.7960e-03,
         -1.7264e-03,  1.0611e-03],
        [ 2.4012e-04, -1.2477e-03, -7.5836e-04,  ..., -8.4207e-04,
          2.8475e-05,  1.0221e-03],
        [ 1.0383e-03, -4.7478e-04,  2.2364e-03,  ..., -1.0682e-03,
         -9.7087e-04, -1.7537e-03],
        ...,
        [ 2.1809e-03, -1.2238e-03, -1.7517e-03,  ..., -1.3069e-03,
          6.5265e-04, -1.8646e-03],
        [ 2.1959e-03, -8.8642e-04,  1.6296e-03,  ..., -2.8589e-04,
          1.8003e-03,  1.6952e-03],
        [-1.5002e-03, -1.7840e-03, -1.7441e-03,  ...,  1.5574e-03,
         -1.3788e-03, -4.5010e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5096e-03, -4.1691e-04,  1.6942e-03,  ..., -1.7960e-03,
         -1.7264e-03,  1.0611e-03],
        [ 2.4012e-04, -1.2477e-03, -7.5836e-04,  ..., -8.4207e-04,
          2.8475e-05,  1.0221e-03],
        [ 1.0383e-03, -4.7478e-04,  2.2364e-03,  ..., -1.0682e-03,
         -9.7087e-04, -1.7537e-03],
        ...,
        [ 2.1809e-03, -1.2238e-03, -1.7517e-03,  ..., -1.3069e-03,
          6.5265e-04, -1.8646e-03],
        [ 2.1959e-03, -8.8642e-04,  1.6296e-03,  ..., -2.8589e-04,
          1.8003e-03,  1.6952e-03],
        [-1.5002e-03, -1.7840e-03, -1.7441e-03,  ...,  1.5574e-03,
         -1.3788e-03, -4.5010e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0151, 0.8841], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10003 GB |   10001 GB |
|       from large pool |     787 MB |     977 MB |    9526 GB |    9525 GB |
|       from small pool |     857 MB |     858 MB |     477 GB |     476 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10003 GB |   10001 GB |
|       from large pool |     787 MB |     977 MB |    9526 GB |    9525 GB |
|       from small pool |     857 MB |     858 MB |     477 GB |     476 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13815 GB |   13814 GB |
|       from large pool |   32920 KB |     261 MB |   13227 GB |   13227 GB |
|       from small pool |   10990 KB |     708 MB |     587 GB |     587 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9601 K  |    9588 K  |
|       from large pool |      61    |      69    |    2175 K  |    2175 K  |
|       from small pool |   13012    |   13020    |    7426 K  |    7413 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9601 K  |    9588 K  |
|       from large pool |      61    |      69    |    2175 K  |    2175 K  |
|       from small pool |   13012    |   13020    |    7426 K  |    7413 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    6244 K  |    6244 K  |
|       from large pool |       9    |      15    |    1859 K  |    1858 K  |
|       from small pool |     438    |    2231    |    4385 K  |    4385 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |    9993 GB |    9992 GB |
|       from large pool |     680 MB |     870 MB |    9516 GB |    9515 GB |
|       from small pool |     856 MB |     857 MB |     477 GB |     476 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |    9993 GB |    9992 GB |
|       from large pool |     680 MB |     870 MB |    9516 GB |    9515 GB |
|       from small pool |     856 MB |     857 MB |     477 GB |     476 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |    9981 GB |    9981 GB |
|       from large pool |   19933 KB |     153 MB |    9394 GB |    9394 GB |
|       from small pool |   11705 KB |     711 MB |     587 GB |     587 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9592 K  |    9579 K  |
|       from large pool |      28    |      36    |    2173 K  |    2173 K  |
|       from small pool |   13002    |   13011    |    7419 K  |    7406 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9592 K  |    9579 K  |
|       from large pool |      28    |      36    |    2173 K  |    2173 K  |
|       from small pool |   13002    |   13011    |    7419 K  |    7406 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6086 K  |    6085 K  |
|       from large pool |       7    |      11    |    1702 K  |    1702 K  |
|       from small pool |     437    |    2228    |    4383 K  |    4383 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 98
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5092e-03, -4.1733e-04,  1.6937e-03,  ..., -1.7956e-03,
         -1.7260e-03,  1.0615e-03],
        [ 2.3781e-04, -1.2500e-03, -7.6065e-04,  ..., -8.3977e-04,
          3.0783e-05,  1.0244e-03],
        [ 1.0415e-03, -4.7159e-04,  2.2396e-03,  ..., -1.0713e-03,
         -9.7404e-04, -1.7569e-03],
        ...,
        [ 2.1793e-03, -1.2253e-03, -1.7532e-03,  ..., -1.3054e-03,
          6.5421e-04, -1.8631e-03],
        [ 2.1964e-03, -8.8584e-04,  1.6301e-03,  ..., -2.8646e-04,
          1.7997e-03,  1.6946e-03],
        [-1.4997e-03, -1.7834e-03, -1.7436e-03,  ...,  1.5568e-03,
         -1.3793e-03, -4.5064e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5092e-03, -4.1733e-04,  1.6937e-03,  ..., -1.7956e-03,
         -1.7260e-03,  1.0615e-03],
        [ 2.3781e-04, -1.2500e-03, -7.6065e-04,  ..., -8.3977e-04,
          3.0783e-05,  1.0244e-03],
        [ 1.0415e-03, -4.7159e-04,  2.2396e-03,  ..., -1.0713e-03,
         -9.7404e-04, -1.7569e-03],
        ...,
        [ 2.1793e-03, -1.2253e-03, -1.7532e-03,  ..., -1.3054e-03,
          6.5421e-04, -1.8631e-03],
        [ 2.1964e-03, -8.8584e-04,  1.6301e-03,  ..., -2.8646e-04,
          1.7997e-03,  1.6946e-03],
        [-1.4997e-03, -1.7834e-03, -1.7436e-03,  ...,  1.5568e-03,
         -1.3793e-03, -4.5064e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0178, 0.8466], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10106 GB |   10104 GB |
|       from large pool |     787 MB |     977 MB |    9624 GB |    9623 GB |
|       from small pool |     857 MB |     858 MB |     482 GB |     481 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10106 GB |   10104 GB |
|       from large pool |     787 MB |     977 MB |    9624 GB |    9623 GB |
|       from small pool |     857 MB |     858 MB |     482 GB |     481 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   13957 GB |   13957 GB |
|       from large pool |   32920 KB |     261 MB |   13364 GB |   13364 GB |
|       from small pool |   10990 KB |     708 MB |     593 GB |     593 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9700 K  |    9687 K  |
|       from large pool |      61    |      69    |    2198 K  |    2197 K  |
|       from small pool |   13012    |   13020    |    7502 K  |    7489 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9700 K  |    9687 K  |
|       from large pool |      61    |      69    |    2198 K  |    2197 K  |
|       from small pool |   13012    |   13020    |    7502 K  |    7489 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    6309 K  |    6308 K  |
|       from large pool |       9    |      15    |    1878 K  |    1878 K  |
|       from small pool |     437    |    2231    |    4430 K  |    4430 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10096 GB |   10095 GB |
|       from large pool |     680 MB |     870 MB |    9614 GB |    9613 GB |
|       from small pool |     856 MB |     857 MB |     482 GB |     481 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10096 GB |   10095 GB |
|       from large pool |     680 MB |     870 MB |    9614 GB |    9613 GB |
|       from small pool |     856 MB |     857 MB |     482 GB |     481 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10084 GB |   10084 GB |
|       from large pool |   19933 KB |     153 MB |    9491 GB |    9491 GB |
|       from small pool |   11705 KB |     711 MB |     593 GB |     593 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9691 K  |    9678 K  |
|       from large pool |      28    |      36    |    2195 K  |    2195 K  |
|       from small pool |   13002    |   13011    |    7495 K  |    7482 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9691 K  |    9678 K  |
|       from large pool |      28    |      36    |    2195 K  |    2195 K  |
|       from small pool |   13002    |   13011    |    7495 K  |    7482 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6148 K  |    6148 K  |
|       from large pool |       7    |      11    |    1719 K  |    1719 K  |
|       from small pool |     437    |    2228    |    4428 K  |    4428 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 99
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5092e-03, -4.1737e-04,  1.6937e-03,  ..., -1.7955e-03,
         -1.7259e-03,  1.0616e-03],
        [ 2.3578e-04, -1.2520e-03, -7.6267e-04,  ..., -8.3775e-04,
          3.2806e-05,  1.0264e-03],
        [ 1.0440e-03, -4.6913e-04,  2.2420e-03,  ..., -1.0738e-03,
         -9.7650e-04, -1.7593e-03],
        ...,
        [ 2.1779e-03, -1.2267e-03, -1.7546e-03,  ..., -1.3040e-03,
          6.5560e-04, -1.8617e-03],
        [ 2.1970e-03, -8.8529e-04,  1.6307e-03,  ..., -2.8700e-04,
          1.7991e-03,  1.6941e-03],
        [-1.4991e-03, -1.7829e-03, -1.7431e-03,  ...,  1.5563e-03,
         -1.3798e-03, -4.5116e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5092e-03, -4.1737e-04,  1.6937e-03,  ..., -1.7955e-03,
         -1.7259e-03,  1.0616e-03],
        [ 2.3578e-04, -1.2520e-03, -7.6267e-04,  ..., -8.3775e-04,
          3.2806e-05,  1.0264e-03],
        [ 1.0440e-03, -4.6913e-04,  2.2420e-03,  ..., -1.0738e-03,
         -9.7650e-04, -1.7593e-03],
        ...,
        [ 2.1779e-03, -1.2267e-03, -1.7546e-03,  ..., -1.3040e-03,
          6.5560e-04, -1.8617e-03],
        [ 2.1970e-03, -8.8529e-04,  1.6307e-03,  ..., -2.8700e-04,
          1.7991e-03,  1.6941e-03],
        [-1.4991e-03, -1.7829e-03, -1.7431e-03,  ...,  1.5563e-03,
         -1.3798e-03, -4.5116e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0110, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10209 GB |   10208 GB |
|       from large pool |     787 MB |     977 MB |    9722 GB |    9721 GB |
|       from small pool |     857 MB |     858 MB |     487 GB |     486 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10209 GB |   10208 GB |
|       from large pool |     787 MB |     977 MB |    9722 GB |    9721 GB |
|       from small pool |     857 MB |     858 MB |     487 GB |     486 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14099 GB |   14099 GB |
|       from large pool |   32920 KB |     261 MB |   13500 GB |   13500 GB |
|       from small pool |   10990 KB |     708 MB |     599 GB |     599 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9799 K  |    9786 K  |
|       from large pool |      61    |      69    |    2220 K  |    2220 K  |
|       from small pool |   13012    |   13020    |    7578 K  |    7565 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9799 K  |    9786 K  |
|       from large pool |      61    |      69    |    2220 K  |    2220 K  |
|       from small pool |   13012    |   13020    |    7578 K  |    7565 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    6373 K  |    6372 K  |
|       from large pool |       9    |      15    |    1897 K  |    1897 K  |
|       from small pool |     437    |    2231    |    4475 K  |    4475 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10199 GB |   10198 GB |
|       from large pool |     680 MB |     870 MB |    9712 GB |    9711 GB |
|       from small pool |     856 MB |     857 MB |     487 GB |     486 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10199 GB |   10198 GB |
|       from large pool |     680 MB |     870 MB |    9712 GB |    9711 GB |
|       from small pool |     856 MB |     857 MB |     487 GB |     486 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10187 GB |   10187 GB |
|       from large pool |   19933 KB |     153 MB |    9588 GB |    9588 GB |
|       from small pool |   11705 KB |     711 MB |     599 GB |     599 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9789 K  |    9776 K  |
|       from large pool |      28    |      36    |    2217 K  |    2217 K  |
|       from small pool |   13002    |   13011    |    7571 K  |    7558 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9789 K  |    9776 K  |
|       from large pool |      28    |      36    |    2217 K  |    2217 K  |
|       from small pool |   13002    |   13011    |    7571 K  |    7558 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6211 K  |    6211 K  |
|       from large pool |       7    |      11    |    1737 K  |    1737 K  |
|       from small pool |     437    |    2228    |    4473 K  |    4473 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 100
batch input size: batch input size:torch.Size([16, 1855]) torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5093e-03, -4.1721e-04,  1.6938e-03,  ..., -1.7957e-03,
         -1.7261e-03,  1.0614e-03],
        [ 2.3246e-04, -1.2553e-03, -7.6597e-04,  ..., -8.3444e-04,
          3.6120e-05,  1.0297e-03],
        [ 1.0463e-03, -4.6683e-04,  2.2443e-03,  ..., -1.0761e-03,
         -9.7879e-04, -1.7616e-03],
        ...,
        [ 2.1767e-03, -1.2279e-03, -1.7558e-03,  ..., -1.3028e-03,
          6.5682e-04, -1.8604e-03],
        [ 2.1975e-03, -8.8476e-04,  1.6312e-03,  ..., -2.8753e-04,
          1.7986e-03,  1.6935e-03],
        [-1.4986e-03, -1.7824e-03, -1.7425e-03,  ...,  1.5558e-03,
         -1.3803e-03, -4.5168e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5093e-03, -4.1721e-04,  1.6938e-03,  ..., -1.7957e-03,
         -1.7261e-03,  1.0614e-03],
        [ 2.3246e-04, -1.2553e-03, -7.6597e-04,  ..., -8.3444e-04,
          3.6120e-05,  1.0297e-03],
        [ 1.0463e-03, -4.6683e-04,  2.2443e-03,  ..., -1.0761e-03,
         -9.7879e-04, -1.7616e-03],
        ...,
        [ 2.1767e-03, -1.2279e-03, -1.7558e-03,  ..., -1.3028e-03,
          6.5682e-04, -1.8604e-03],
        [ 2.1975e-03, -8.8476e-04,  1.6312e-03,  ..., -2.8753e-04,
          1.7986e-03,  1.6935e-03],
        [-1.4986e-03, -1.7824e-03, -1.7425e-03,  ...,  1.5558e-03,
         -1.3803e-03, -4.5168e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0084, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10312 GB |   10311 GB |
|       from large pool |     787 MB |     977 MB |    9820 GB |    9819 GB |
|       from small pool |     857 MB |     858 MB |     492 GB |     491 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10312 GB |   10311 GB |
|       from large pool |     787 MB |     977 MB |    9820 GB |    9819 GB |
|       from small pool |     857 MB |     858 MB |     492 GB |     491 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14242 GB |   14242 GB |
|       from large pool |   32920 KB |     261 MB |   13636 GB |   13636 GB |
|       from small pool |   10990 KB |     708 MB |     605 GB |     605 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9897 K  |    9884 K  |
|       from large pool |      61    |      69    |    2242 K  |    2242 K  |
|       from small pool |   13012    |   13020    |    7654 K  |    7641 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9897 K  |    9884 K  |
|       from large pool |      61    |      69    |    2242 K  |    2242 K  |
|       from small pool |   13012    |   13020    |    7654 K  |    7641 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    6437 K  |    6437 K  |
|       from large pool |       9    |      15    |    1916 K  |    1916 K  |
|       from small pool |     439    |    2231    |    4521 K  |    4520 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10302 GB |   10301 GB |
|       from large pool |     680 MB |     870 MB |    9810 GB |    9810 GB |
|       from small pool |     856 MB |     857 MB |     491 GB |     491 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10302 GB |   10301 GB |
|       from large pool |     680 MB |     870 MB |    9810 GB |    9810 GB |
|       from small pool |     856 MB |     857 MB |     491 GB |     491 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10290 GB |   10290 GB |
|       from large pool |   19933 KB |     153 MB |    9685 GB |    9685 GB |
|       from small pool |   11705 KB |     711 MB |     605 GB |     605 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9888 K  |    9875 K  |
|       from large pool |      28    |      36    |    2240 K  |    2240 K  |
|       from small pool |   13002    |   13011    |    7647 K  |    7634 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9888 K  |    9875 K  |
|       from large pool |      28    |      36    |    2240 K  |    2240 K  |
|       from small pool |   13002    |   13011    |    7647 K  |    7634 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6274 K  |    6273 K  |
|       from large pool |       7    |      11    |    1755 K  |    1755 K  |
|       from small pool |     437    |    2228    |    4519 K  |    4518 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 101
batch input size: torch.Size([16, 1855]) Device: batch input size:0
torch.Size([16, 1855]) Device: 1
tensor([[ 1.5096e-03, -4.1689e-04,  1.6941e-03,  ..., -1.7960e-03,
         -1.7264e-03,  1.0611e-03],
        [ 2.2954e-04, -1.2582e-03, -7.6886e-04,  ..., -8.3154e-04,
          3.9027e-05,  1.0327e-03],
        [ 1.0467e-03, -4.6637e-04,  2.2448e-03,  ..., -1.0765e-03,
         -9.7924e-04, -1.7620e-03],
        ...,
        [ 2.1756e-03, -1.2289e-03, -1.7569e-03,  ..., -1.3017e-03,
          6.5787e-04, -1.8594e-03],
        [ 2.1980e-03, -8.8422e-04,  1.6317e-03,  ..., -2.8807e-04,
          1.7980e-03,  1.6930e-03],
        [-1.4981e-03, -1.7819e-03, -1.7420e-03,  ...,  1.5553e-03,
         -1.3808e-03, -4.5218e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5096e-03, -4.1689e-04,  1.6941e-03,  ..., -1.7960e-03,
         -1.7264e-03,  1.0611e-03],
        [ 2.2954e-04, -1.2582e-03, -7.6886e-04,  ..., -8.3154e-04,
          3.9027e-05,  1.0327e-03],
        [ 1.0467e-03, -4.6637e-04,  2.2448e-03,  ..., -1.0765e-03,
         -9.7924e-04, -1.7620e-03],
        ...,
        [ 2.1756e-03, -1.2289e-03, -1.7569e-03,  ..., -1.3017e-03,
          6.5787e-04, -1.8594e-03],
        [ 2.1980e-03, -8.8422e-04,  1.6317e-03,  ..., -2.8807e-04,
          1.7980e-03,  1.6930e-03],
        [-1.4981e-03, -1.7819e-03, -1.7420e-03,  ...,  1.5553e-03,
         -1.3808e-03, -4.5218e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0231, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10415 GB |   10414 GB |
|       from large pool |     787 MB |     977 MB |    9918 GB |    9918 GB |
|       from small pool |     857 MB |     858 MB |     496 GB |     496 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10415 GB |   10414 GB |
|       from large pool |     787 MB |     977 MB |    9918 GB |    9918 GB |
|       from small pool |     857 MB |     858 MB |     496 GB |     496 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14384 GB |   14384 GB |
|       from large pool |   32920 KB |     261 MB |   13773 GB |   13773 GB |
|       from small pool |   10990 KB |     708 MB |     611 GB |     611 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |    9996 K  |    9983 K  |
|       from large pool |      61    |      69    |    2265 K  |    2265 K  |
|       from small pool |   13012    |   13020    |    7731 K  |    7718 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |    9996 K  |    9983 K  |
|       from large pool |      61    |      69    |    2265 K  |    2265 K  |
|       from small pool |   13012    |   13020    |    7731 K  |    7718 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    6501 K  |    6501 K  |
|       from large pool |       9    |      15    |    1935 K  |    1935 K  |
|       from small pool |     440    |    2231    |    4566 K  |    4565 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10405 GB |   10404 GB |
|       from large pool |     680 MB |     870 MB |    9908 GB |    9908 GB |
|       from small pool |     856 MB |     857 MB |     496 GB |     496 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10405 GB |   10404 GB |
|       from large pool |     680 MB |     870 MB |    9908 GB |    9908 GB |
|       from small pool |     856 MB |     857 MB |     496 GB |     496 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10393 GB |   10393 GB |
|       from large pool |   19933 KB |     153 MB |    9781 GB |    9781 GB |
|       from small pool |   11705 KB |     711 MB |     611 GB |     611 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |    9986 K  |    9973 K  |
|       from large pool |      28    |      36    |    2262 K  |    2262 K  |
|       from small pool |   13002    |   13011    |    7724 K  |    7711 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |    9986 K  |    9973 K  |
|       from large pool |      28    |      36    |    2262 K  |    2262 K  |
|       from small pool |   13002    |   13011    |    7724 K  |    7711 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6336 K  |    6336 K  |
|       from large pool |       7    |      11    |    1772 K  |    1772 K  |
|       from small pool |     437    |    2228    |    4564 K  |    4563 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 102
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 1.5101e-03, -4.1641e-04,  1.6946e-03,  ..., -1.7965e-03,
         -1.7268e-03,  1.0606e-03],
        [ 2.2919e-04, -1.2586e-03, -7.6921e-04,  ..., -8.3119e-04,
          3.9378e-05,  1.0330e-03],
        [ 1.0473e-03, -4.6576e-04,  2.2454e-03,  ..., -1.0771e-03,
         -9.7984e-04, -1.7626e-03],
        ...,
        [ 2.1747e-03, -1.2298e-03, -1.7578e-03,  ..., -1.3008e-03,
          6.5878e-04, -1.8585e-03],
        [ 2.1985e-03, -8.8368e-04,  1.6322e-03,  ..., -2.8860e-04,
          1.7975e-03,  1.6924e-03],
        [-1.4976e-03, -1.7814e-03, -1.7415e-03,  ...,  1.5547e-03,
         -1.3813e-03, -4.5269e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5101e-03, -4.1641e-04,  1.6946e-03,  ..., -1.7965e-03,
         -1.7268e-03,  1.0606e-03],
        [ 2.2919e-04, -1.2586e-03, -7.6921e-04,  ..., -8.3119e-04,
          3.9378e-05,  1.0330e-03],
        [ 1.0473e-03, -4.6576e-04,  2.2454e-03,  ..., -1.0771e-03,
         -9.7984e-04, -1.7626e-03],
        ...,
        [ 2.1747e-03, -1.2298e-03, -1.7578e-03,  ..., -1.3008e-03,
          6.5878e-04, -1.8585e-03],
        [ 2.1985e-03, -8.8368e-04,  1.6322e-03,  ..., -2.8860e-04,
          1.7975e-03,  1.6924e-03],
        [-1.4976e-03, -1.7814e-03, -1.7415e-03,  ...,  1.5547e-03,
         -1.3813e-03, -4.5269e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0139, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10518 GB |   10517 GB |
|       from large pool |     787 MB |     977 MB |   10017 GB |   10016 GB |
|       from small pool |     857 MB |     858 MB |     501 GB |     501 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10518 GB |   10517 GB |
|       from large pool |     787 MB |     977 MB |   10017 GB |   10016 GB |
|       from small pool |     857 MB |     858 MB |     501 GB |     501 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14526 GB |   14526 GB |
|       from large pool |   32920 KB |     261 MB |   13909 GB |   13909 GB |
|       from small pool |   10990 KB |     708 MB |     617 GB |     617 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10095 K  |   10082 K  |
|       from large pool |      61    |      69    |    2287 K  |    2287 K  |
|       from small pool |   13012    |   13020    |    7807 K  |    7794 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10095 K  |   10082 K  |
|       from large pool |      61    |      69    |    2287 K  |    2287 K  |
|       from small pool |   13012    |   13020    |    7807 K  |    7794 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    6565 K  |    6565 K  |
|       from large pool |       9    |      15    |    1954 K  |    1954 K  |
|       from small pool |     436    |    2231    |    4611 K  |    4610 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10508 GB |   10507 GB |
|       from large pool |     680 MB |     870 MB |   10006 GB |   10006 GB |
|       from small pool |     856 MB |     857 MB |     501 GB |     500 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10508 GB |   10507 GB |
|       from large pool |     680 MB |     870 MB |   10006 GB |   10006 GB |
|       from small pool |     856 MB |     857 MB |     501 GB |     500 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10496 GB |   10496 GB |
|       from large pool |   19933 KB |     153 MB |    9878 GB |    9878 GB |
|       from small pool |   11705 KB |     711 MB |     617 GB |     617 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10085 K  |   10072 K  |
|       from large pool |      28    |      36    |    2285 K  |    2285 K  |
|       from small pool |   13002    |   13011    |    7800 K  |    7787 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10085 K  |   10072 K  |
|       from large pool |      28    |      36    |    2285 K  |    2285 K  |
|       from small pool |   13002    |   13011    |    7800 K  |    7787 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6399 K  |    6398 K  |
|       from large pool |       7    |      11    |    1790 K  |    1790 K  |
|       from small pool |     437    |    2228    |    4609 K  |    4608 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 103
batch input size: torch.Size([16, 1855]) batch input size:Device:  torch.Size([16, 1855])0
Device: 1
tensor([[ 1.5106e-03, -4.1590e-04,  1.6951e-03,  ..., -1.7970e-03,
         -1.7274e-03,  1.0601e-03],
        [ 2.2891e-04, -1.2588e-03, -7.6948e-04,  ..., -8.3091e-04,
          3.9654e-05,  1.0333e-03],
        [ 1.0470e-03, -4.6611e-04,  2.2450e-03,  ..., -1.0768e-03,
         -9.7949e-04, -1.7623e-03],
        ...,
        [ 2.1738e-03, -1.2307e-03, -1.7586e-03,  ..., -1.3000e-03,
          6.5961e-04, -1.8576e-03],
        [ 2.1991e-03, -8.8315e-04,  1.6328e-03,  ..., -2.8912e-04,
          1.7969e-03,  1.6919e-03],
        [-1.4971e-03, -1.7809e-03, -1.7410e-03,  ...,  1.5542e-03,
         -1.3818e-03, -4.5319e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5106e-03, -4.1590e-04,  1.6951e-03,  ..., -1.7970e-03,
         -1.7274e-03,  1.0601e-03],
        [ 2.2891e-04, -1.2588e-03, -7.6948e-04,  ..., -8.3091e-04,
          3.9654e-05,  1.0333e-03],
        [ 1.0470e-03, -4.6611e-04,  2.2450e-03,  ..., -1.0768e-03,
         -9.7949e-04, -1.7623e-03],
        ...,
        [ 2.1738e-03, -1.2307e-03, -1.7586e-03,  ..., -1.3000e-03,
          6.5961e-04, -1.8576e-03],
        [ 2.1991e-03, -8.8315e-04,  1.6328e-03,  ..., -2.8912e-04,
          1.7969e-03,  1.6919e-03],
        [-1.4971e-03, -1.7809e-03, -1.7410e-03,  ...,  1.5542e-03,
         -1.3818e-03, -4.5319e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0122, 0.0024], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10622 GB |   10620 GB |
|       from large pool |     787 MB |     977 MB |   10115 GB |   10114 GB |
|       from small pool |     857 MB |     858 MB |     506 GB |     505 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10622 GB |   10620 GB |
|       from large pool |     787 MB |     977 MB |   10115 GB |   10114 GB |
|       from small pool |     857 MB |     858 MB |     506 GB |     505 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14669 GB |   14669 GB |
|       from large pool |   32920 KB |     261 MB |   14045 GB |   14045 GB |
|       from small pool |   10990 KB |     708 MB |     623 GB |     623 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10193 K  |   10180 K  |
|       from large pool |      61    |      69    |    2310 K  |    2310 K  |
|       from small pool |   13012    |   13020    |    7883 K  |    7870 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10193 K  |   10180 K  |
|       from large pool |      61    |      69    |    2310 K  |    2310 K  |
|       from small pool |   13012    |   13020    |    7883 K  |    7870 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    6630 K  |    6629 K  |
|       from large pool |       9    |      15    |    1973 K  |    1973 K  |
|       from small pool |     439    |    2231    |    4656 K  |    4655 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10611 GB |   10610 GB |
|       from large pool |     680 MB |     870 MB |   10105 GB |   10104 GB |
|       from small pool |     856 MB |     857 MB |     506 GB |     505 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10611 GB |   10610 GB |
|       from large pool |     680 MB |     870 MB |   10105 GB |   10104 GB |
|       from small pool |     856 MB |     857 MB |     506 GB |     505 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10599 GB |   10599 GB |
|       from large pool |   19933 KB |     153 MB |    9975 GB |    9975 GB |
|       from small pool |   11705 KB |     711 MB |     623 GB |     623 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10183 K  |   10170 K  |
|       from large pool |      28    |      36    |    2307 K  |    2307 K  |
|       from small pool |   13002    |   13011    |    7876 K  |    7863 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10183 K  |   10170 K  |
|       from large pool |      28    |      36    |    2307 K  |    2307 K  |
|       from small pool |   13002    |   13011    |    7876 K  |    7863 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6461 K  |    6461 K  |
|       from large pool |       7    |      11    |    1807 K  |    1807 K  |
|       from small pool |     437    |    2228    |    4654 K  |    4653 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 104
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5111e-03, -4.1535e-04,  1.6957e-03,  ..., -1.7975e-03,
         -1.7279e-03,  1.0595e-03],
        [ 2.3072e-04, -1.2570e-03, -7.6768e-04,  ..., -8.3270e-04,
          3.7849e-05,  1.0315e-03],
        [ 1.0479e-03, -4.6518e-04,  2.2459e-03,  ..., -1.0777e-03,
         -9.8041e-04, -1.7632e-03],
        ...,
        [ 2.1730e-03, -1.2314e-03, -1.7593e-03,  ..., -1.2992e-03,
          6.6037e-04, -1.8569e-03],
        [ 2.1995e-03, -8.8267e-04,  1.6332e-03,  ..., -2.8960e-04,
          1.7965e-03,  1.6914e-03],
        [-1.4966e-03, -1.7804e-03, -1.7405e-03,  ...,  1.5537e-03,
         -1.3823e-03, -4.5366e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5111e-03, -4.1535e-04,  1.6957e-03,  ..., -1.7975e-03,
         -1.7279e-03,  1.0595e-03],
        [ 2.3072e-04, -1.2570e-03, -7.6768e-04,  ..., -8.3270e-04,
          3.7849e-05,  1.0315e-03],
        [ 1.0479e-03, -4.6518e-04,  2.2459e-03,  ..., -1.0777e-03,
         -9.8041e-04, -1.7632e-03],
        ...,
        [ 2.1730e-03, -1.2314e-03, -1.7593e-03,  ..., -1.2992e-03,
          6.6037e-04, -1.8569e-03],
        [ 2.1995e-03, -8.8267e-04,  1.6332e-03,  ..., -2.8960e-04,
          1.7965e-03,  1.6914e-03],
        [-1.4966e-03, -1.7804e-03, -1.7405e-03,  ...,  1.5537e-03,
         -1.3823e-03, -4.5366e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0152, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10725 GB |   10723 GB |
|       from large pool |     787 MB |     977 MB |   10213 GB |   10212 GB |
|       from small pool |     857 MB |     858 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10725 GB |   10723 GB |
|       from large pool |     787 MB |     977 MB |   10213 GB |   10212 GB |
|       from small pool |     857 MB |     858 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14811 GB |   14811 GB |
|       from large pool |   32920 KB |     261 MB |   14182 GB |   14182 GB |
|       from small pool |   10990 KB |     708 MB |     629 GB |     629 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10292 K  |   10279 K  |
|       from large pool |      61    |      69    |    2332 K  |    2332 K  |
|       from small pool |   13012    |   13020    |    7959 K  |    7946 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10292 K  |   10279 K  |
|       from large pool |      61    |      69    |    2332 K  |    2332 K  |
|       from small pool |   13012    |   13020    |    7959 K  |    7946 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    6694 K  |    6693 K  |
|       from large pool |       9    |      15    |    1993 K  |    1993 K  |
|       from small pool |     438    |    2231    |    4701 K  |    4700 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10714 GB |   10713 GB |
|       from large pool |     680 MB |     870 MB |   10203 GB |   10202 GB |
|       from small pool |     856 MB |     857 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10714 GB |   10713 GB |
|       from large pool |     680 MB |     870 MB |   10203 GB |   10202 GB |
|       from small pool |     856 MB |     857 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10702 GB |   10702 GB |
|       from large pool |   19933 KB |     153 MB |   10072 GB |   10072 GB |
|       from small pool |   11705 KB |     711 MB |     629 GB |     629 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10282 K  |   10269 K  |
|       from large pool |      28    |      36    |    2329 K  |    2329 K  |
|       from small pool |   13002    |   13011    |    7952 K  |    7939 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10282 K  |   10269 K  |
|       from large pool |      28    |      36    |    2329 K  |    2329 K  |
|       from small pool |   13002    |   13011    |    7952 K  |    7939 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6524 K  |    6524 K  |
|       from large pool |       7    |      11    |    1825 K  |    1825 K  |
|       from small pool |     437    |    2228    |    4699 K  |    4698 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 105
batch input size: torch.Size([16, 1855]) Device:batch input size:  0torch.Size([16, 1855])
 Device: 1
tensor([[ 1.5118e-03, -4.1470e-04,  1.6963e-03,  ..., -1.7981e-03,
         -1.7285e-03,  1.0589e-03],
        [ 2.2868e-04, -1.2591e-03, -7.6970e-04,  ..., -8.3067e-04,
          3.9885e-05,  1.0335e-03],
        [ 1.0481e-03, -4.6501e-04,  2.2461e-03,  ..., -1.0778e-03,
         -9.8057e-04, -1.7634e-03],
        ...,
        [ 2.1747e-03, -1.2298e-03, -1.7577e-03,  ..., -1.3009e-03,
          6.5869e-04, -1.8585e-03],
        [ 2.2000e-03, -8.8221e-04,  1.6337e-03,  ..., -2.9005e-04,
          1.7960e-03,  1.6909e-03],
        [-1.4962e-03, -1.7799e-03, -1.7401e-03,  ...,  1.5533e-03,
         -1.3827e-03, -4.5410e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5118e-03, -4.1470e-04,  1.6963e-03,  ..., -1.7981e-03,
         -1.7285e-03,  1.0589e-03],
        [ 2.2868e-04, -1.2591e-03, -7.6970e-04,  ..., -8.3067e-04,
          3.9885e-05,  1.0335e-03],
        [ 1.0481e-03, -4.6501e-04,  2.2461e-03,  ..., -1.0778e-03,
         -9.8057e-04, -1.7634e-03],
        ...,
        [ 2.1747e-03, -1.2298e-03, -1.7577e-03,  ..., -1.3009e-03,
          6.5869e-04, -1.8585e-03],
        [ 2.2000e-03, -8.8221e-04,  1.6337e-03,  ..., -2.9005e-04,
          1.7960e-03,  1.6909e-03],
        [-1.4962e-03, -1.7799e-03, -1.7401e-03,  ...,  1.5533e-03,
         -1.3827e-03, -4.5410e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0082, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10828 GB |   10826 GB |
|       from large pool |     787 MB |     977 MB |   10311 GB |   10310 GB |
|       from small pool |     857 MB |     858 MB |     516 GB |     515 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10828 GB |   10826 GB |
|       from large pool |     787 MB |     977 MB |   10311 GB |   10310 GB |
|       from small pool |     857 MB |     858 MB |     516 GB |     515 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   14954 GB |   14954 GB |
|       from large pool |   32920 KB |     261 MB |   14318 GB |   14318 GB |
|       from small pool |   10990 KB |     708 MB |     635 GB |     635 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10391 K  |   10378 K  |
|       from large pool |      61    |      69    |    2355 K  |    2354 K  |
|       from small pool |   13012    |   13020    |    8036 K  |    8023 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10391 K  |   10378 K  |
|       from large pool |      61    |      69    |    2355 K  |    2354 K  |
|       from small pool |   13012    |   13020    |    8036 K  |    8023 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    6758 K  |    6758 K  |
|       from large pool |       9    |      15    |    2012 K  |    2012 K  |
|       from small pool |     438    |    2231    |    4746 K  |    4745 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10817 GB |   10816 GB |
|       from large pool |     680 MB |     870 MB |   10301 GB |   10300 GB |
|       from small pool |     856 MB |     857 MB |     516 GB |     515 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10817 GB |   10816 GB |
|       from large pool |     680 MB |     870 MB |   10301 GB |   10300 GB |
|       from small pool |     856 MB |     857 MB |     516 GB |     515 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10804 GB |   10804 GB |
|       from large pool |   19933 KB |     153 MB |   10169 GB |   10169 GB |
|       from small pool |   11705 KB |     711 MB |     635 GB |     635 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10381 K  |   10368 K  |
|       from large pool |      28    |      36    |    2352 K  |    2352 K  |
|       from small pool |   13002    |   13011    |    8028 K  |    8015 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10381 K  |   10368 K  |
|       from large pool |      28    |      36    |    2352 K  |    2352 K  |
|       from small pool |   13002    |   13011    |    8028 K  |    8015 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6587 K  |    6586 K  |
|       from large pool |       7    |      11    |    1842 K  |    1842 K  |
|       from small pool |     437    |    2228    |    4744 K  |    4743 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 106
batch input size:batch input size:  torch.Size([16, 1855])torch.Size([16, 1855])  Device:Device:  01
tensor([[ 1.5126e-03, -4.1392e-04,  1.6971e-03,  ..., -1.7989e-03,
         -1.7293e-03,  1.0581e-03],
        [ 2.2694e-04, -1.2608e-03, -7.7143e-04,  ..., -8.2894e-04,
          4.1617e-05,  1.0352e-03],
        [ 1.0483e-03, -4.6476e-04,  2.2463e-03,  ..., -1.0781e-03,
         -9.8082e-04, -1.7636e-03],
        ...,
        [ 2.1762e-03, -1.2282e-03, -1.7561e-03,  ..., -1.3024e-03,
          6.5715e-04, -1.8600e-03],
        [ 2.2004e-03, -8.8174e-04,  1.6341e-03,  ..., -2.9052e-04,
          1.7955e-03,  1.6904e-03],
        [-1.4957e-03, -1.7795e-03, -1.7396e-03,  ...,  1.5528e-03,
         -1.3832e-03, -4.5454e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5126e-03, -4.1392e-04,  1.6971e-03,  ..., -1.7989e-03,
         -1.7293e-03,  1.0581e-03],
        [ 2.2694e-04, -1.2608e-03, -7.7143e-04,  ..., -8.2894e-04,
          4.1617e-05,  1.0352e-03],
        [ 1.0483e-03, -4.6476e-04,  2.2463e-03,  ..., -1.0781e-03,
         -9.8082e-04, -1.7636e-03],
        ...,
        [ 2.1762e-03, -1.2282e-03, -1.7561e-03,  ..., -1.3024e-03,
          6.5715e-04, -1.8600e-03],
        [ 2.2004e-03, -8.8174e-04,  1.6341e-03,  ..., -2.9052e-04,
          1.7955e-03,  1.6904e-03],
        [-1.4957e-03, -1.7795e-03, -1.7396e-03,  ...,  1.5528e-03,
         -1.3832e-03, -4.5454e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0310, 0.8844], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   10931 GB |   10929 GB |
|       from large pool |     787 MB |     977 MB |   10409 GB |   10409 GB |
|       from small pool |     857 MB |     858 MB |     521 GB |     520 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   10931 GB |   10929 GB |
|       from large pool |     787 MB |     977 MB |   10409 GB |   10409 GB |
|       from small pool |     857 MB |     858 MB |     521 GB |     520 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15096 GB |   15096 GB |
|       from large pool |   32920 KB |     261 MB |   14455 GB |   14455 GB |
|       from small pool |   10990 KB |     708 MB |     641 GB |     641 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10489 K  |   10476 K  |
|       from large pool |      61    |      69    |    2377 K  |    2377 K  |
|       from small pool |   13012    |   13020    |    8112 K  |    8099 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10489 K  |   10476 K  |
|       from large pool |      61    |      69    |    2377 K  |    2377 K  |
|       from small pool |   13012    |   13020    |    8112 K  |    8099 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    6822 K  |    6822 K  |
|       from large pool |       9    |      15    |    2031 K  |    2031 K  |
|       from small pool |     438    |    2231    |    4791 K  |    4791 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   10920 GB |   10919 GB |
|       from large pool |     680 MB |     870 MB |   10399 GB |   10398 GB |
|       from small pool |     856 MB |     857 MB |     521 GB |     520 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   10920 GB |   10919 GB |
|       from large pool |     680 MB |     870 MB |   10399 GB |   10398 GB |
|       from small pool |     856 MB |     857 MB |     521 GB |     520 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   10907 GB |   10907 GB |
|       from large pool |   19933 KB |     153 MB |   10266 GB |   10266 GB |
|       from small pool |   11705 KB |     711 MB |     641 GB |     641 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10479 K  |   10466 K  |
|       from large pool |      28    |      36    |    2374 K  |    2374 K  |
|       from small pool |   13002    |   13011    |    8104 K  |    8091 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10479 K  |   10466 K  |
|       from large pool |      28    |      36    |    2374 K  |    2374 K  |
|       from small pool |   13002    |   13011    |    8104 K  |    8091 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6649 K  |    6649 K  |
|       from large pool |       7    |      11    |    1860 K  |    1860 K  |
|       from small pool |     437    |    2228    |    4789 K  |    4788 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 107
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5132e-03, -4.1323e-04,  1.6978e-03,  ..., -1.7996e-03,
         -1.7300e-03,  1.0574e-03],
        [ 2.2411e-04, -1.2636e-03, -7.7424e-04,  ..., -8.2612e-04,
          4.4447e-05,  1.0381e-03],
        [ 1.0478e-03, -4.6524e-04,  2.2458e-03,  ..., -1.0776e-03,
         -9.8033e-04, -1.7631e-03],
        ...,
        [ 2.1776e-03, -1.2268e-03, -1.7547e-03,  ..., -1.3038e-03,
          6.5576e-04, -1.8614e-03],
        [ 2.2009e-03, -8.8128e-04,  1.6346e-03,  ..., -2.9097e-04,
          1.7950e-03,  1.6900e-03],
        [-1.4953e-03, -1.7791e-03, -1.7392e-03,  ...,  1.5524e-03,
         -1.3836e-03, -4.5495e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5132e-03, -4.1323e-04,  1.6978e-03,  ..., -1.7996e-03,
         -1.7300e-03,  1.0574e-03],
        [ 2.2411e-04, -1.2636e-03, -7.7424e-04,  ..., -8.2612e-04,
          4.4447e-05,  1.0381e-03],
        [ 1.0478e-03, -4.6524e-04,  2.2458e-03,  ..., -1.0776e-03,
         -9.8033e-04, -1.7631e-03],
        ...,
        [ 2.1776e-03, -1.2268e-03, -1.7547e-03,  ..., -1.3038e-03,
          6.5576e-04, -1.8614e-03],
        [ 2.2009e-03, -8.8128e-04,  1.6346e-03,  ..., -2.9097e-04,
          1.7950e-03,  1.6900e-03],
        [-1.4953e-03, -1.7791e-03, -1.7392e-03,  ...,  1.5524e-03,
         -1.3836e-03, -4.5495e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0127, 0.8468], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11034 GB |   11032 GB |
|       from large pool |     787 MB |     977 MB |   10508 GB |   10507 GB |
|       from small pool |     857 MB |     858 MB |     526 GB |     525 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11034 GB |   11032 GB |
|       from large pool |     787 MB |     977 MB |   10508 GB |   10507 GB |
|       from small pool |     857 MB |     858 MB |     526 GB |     525 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15238 GB |   15238 GB |
|       from large pool |   32920 KB |     261 MB |   14591 GB |   14591 GB |
|       from small pool |   10990 KB |     708 MB |     647 GB |     647 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10588 K  |   10575 K  |
|       from large pool |      61    |      69    |    2399 K  |    2399 K  |
|       from small pool |   13012    |   13020    |    8188 K  |    8175 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10588 K  |   10575 K  |
|       from large pool |      61    |      69    |    2399 K  |    2399 K  |
|       from small pool |   13012    |   13020    |    8188 K  |    8175 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    6887 K  |    6886 K  |
|       from large pool |       9    |      15    |    2050 K  |    2050 K  |
|       from small pool |     437    |    2231    |    4836 K  |    4836 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11023 GB |   11022 GB |
|       from large pool |     680 MB |     870 MB |   10497 GB |   10496 GB |
|       from small pool |     856 MB |     857 MB |     526 GB |     525 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11023 GB |   11022 GB |
|       from large pool |     680 MB |     870 MB |   10497 GB |   10496 GB |
|       from small pool |     856 MB |     857 MB |     526 GB |     525 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11010 GB |   11010 GB |
|       from large pool |   19933 KB |     153 MB |   10363 GB |   10363 GB |
|       from small pool |   11705 KB |     711 MB |     647 GB |     647 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10578 K  |   10565 K  |
|       from large pool |      28    |      36    |    2397 K  |    2397 K  |
|       from small pool |   13002    |   13011    |    8180 K  |    8167 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10578 K  |   10565 K  |
|       from large pool |      28    |      36    |    2397 K  |    2397 K  |
|       from small pool |   13002    |   13011    |    8180 K  |    8167 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6712 K  |    6711 K  |
|       from large pool |       7    |      11    |    1877 K  |    1877 K  |
|       from small pool |     437    |    2228    |    4834 K  |    4833 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 108
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5140e-03, -4.1248e-04,  1.6985e-03,  ..., -1.8003e-03,
         -1.7307e-03,  1.0566e-03],
        [ 2.2009e-04, -1.2676e-03, -7.7823e-04,  ..., -8.2212e-04,
          4.8450e-05,  1.0421e-03],
        [ 1.0461e-03, -4.6694e-04,  2.2441e-03,  ..., -1.0759e-03,
         -9.7863e-04, -1.7614e-03],
        ...,
        [ 2.1789e-03, -1.2256e-03, -1.7535e-03,  ..., -1.3050e-03,
          6.5449e-04, -1.8627e-03],
        [ 2.2013e-03, -8.8083e-04,  1.6350e-03,  ..., -2.9141e-04,
          1.7946e-03,  1.6895e-03],
        [-1.4949e-03, -1.7787e-03, -1.7388e-03,  ...,  1.5520e-03,
         -1.3840e-03, -4.5534e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5140e-03, -4.1248e-04,  1.6985e-03,  ..., -1.8003e-03,
         -1.7307e-03,  1.0566e-03],
        [ 2.2009e-04, -1.2676e-03, -7.7823e-04,  ..., -8.2212e-04,
          4.8450e-05,  1.0421e-03],
        [ 1.0461e-03, -4.6694e-04,  2.2441e-03,  ..., -1.0759e-03,
         -9.7863e-04, -1.7614e-03],
        ...,
        [ 2.1789e-03, -1.2256e-03, -1.7535e-03,  ..., -1.3050e-03,
          6.5449e-04, -1.8627e-03],
        [ 2.2013e-03, -8.8083e-04,  1.6350e-03,  ..., -2.9141e-04,
          1.7946e-03,  1.6895e-03],
        [-1.4949e-03, -1.7787e-03, -1.7388e-03,  ...,  1.5520e-03,
         -1.3840e-03, -4.5534e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0160, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11137 GB |   11135 GB |
|       from large pool |     787 MB |     977 MB |   10606 GB |   10605 GB |
|       from small pool |     857 MB |     858 MB |     531 GB |     530 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11137 GB |   11135 GB |
|       from large pool |     787 MB |     977 MB |   10606 GB |   10605 GB |
|       from small pool |     857 MB |     858 MB |     531 GB |     530 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15381 GB |   15381 GB |
|       from large pool |   32920 KB |     261 MB |   14727 GB |   14727 GB |
|       from small pool |   10990 KB |     708 MB |     653 GB |     653 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10687 K  |   10673 K  |
|       from large pool |      61    |      69    |    2422 K  |    2422 K  |
|       from small pool |   13012    |   13020    |    8264 K  |    8251 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10687 K  |   10673 K  |
|       from large pool |      61    |      69    |    2422 K  |    2422 K  |
|       from small pool |   13012    |   13020    |    8264 K  |    8251 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     446    |    2241    |    6951 K  |    6950 K  |
|       from large pool |       9    |      15    |    2069 K  |    2069 K  |
|       from small pool |     437    |    2231    |    4881 K  |    4881 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11126 GB |   11125 GB |
|       from large pool |     680 MB |     870 MB |   10595 GB |   10594 GB |
|       from small pool |     856 MB |     857 MB |     531 GB |     530 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11126 GB |   11125 GB |
|       from large pool |     680 MB |     870 MB |   10595 GB |   10594 GB |
|       from small pool |     856 MB |     857 MB |     531 GB |     530 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11113 GB |   11113 GB |
|       from large pool |   19933 KB |     153 MB |   10459 GB |   10459 GB |
|       from small pool |   11705 KB |     711 MB |     653 GB |     653 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10676 K  |   10663 K  |
|       from large pool |      28    |      36    |    2419 K  |    2419 K  |
|       from small pool |   13002    |   13011    |    8257 K  |    8244 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10676 K  |   10663 K  |
|       from large pool |      28    |      36    |    2419 K  |    2419 K  |
|       from small pool |   13002    |   13011    |    8257 K  |    8244 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6774 K  |    6774 K  |
|       from large pool |       7    |      11    |    1895 K  |    1895 K  |
|       from small pool |     437    |    2228    |    4879 K  |    4879 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 109
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5148e-03, -4.1166e-04,  1.6993e-03,  ..., -1.8011e-03,
         -1.7315e-03,  1.0558e-03],
        [ 2.1828e-04, -1.2694e-03, -7.8003e-04,  ..., -8.2031e-04,
          5.0262e-05,  1.0439e-03],
        [ 1.0447e-03, -4.6835e-04,  2.2427e-03,  ..., -1.0745e-03,
         -9.7721e-04, -1.7600e-03],
        ...,
        [ 2.1801e-03, -1.2244e-03, -1.7523e-03,  ..., -1.3062e-03,
          6.5332e-04, -1.8638e-03],
        [ 2.2018e-03, -8.8039e-04,  1.6355e-03,  ..., -2.9185e-04,
          1.7941e-03,  1.6891e-03],
        [-1.4945e-03, -1.7783e-03, -1.7384e-03,  ...,  1.5516e-03,
         -1.3843e-03, -4.5570e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5148e-03, -4.1166e-04,  1.6993e-03,  ..., -1.8011e-03,
         -1.7315e-03,  1.0558e-03],
        [ 2.1828e-04, -1.2694e-03, -7.8003e-04,  ..., -8.2031e-04,
          5.0262e-05,  1.0439e-03],
        [ 1.0447e-03, -4.6835e-04,  2.2427e-03,  ..., -1.0745e-03,
         -9.7721e-04, -1.7600e-03],
        ...,
        [ 2.1801e-03, -1.2244e-03, -1.7523e-03,  ..., -1.3062e-03,
          6.5332e-04, -1.8638e-03],
        [ 2.2018e-03, -8.8039e-04,  1.6355e-03,  ..., -2.9185e-04,
          1.7941e-03,  1.6891e-03],
        [-1.4945e-03, -1.7783e-03, -1.7384e-03,  ...,  1.5516e-03,
         -1.3843e-03, -4.5570e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0120, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11240 GB |   11239 GB |
|       from large pool |     787 MB |     977 MB |   10704 GB |   10703 GB |
|       from small pool |     857 MB |     858 MB |     536 GB |     535 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11240 GB |   11239 GB |
|       from large pool |     787 MB |     977 MB |   10704 GB |   10703 GB |
|       from small pool |     857 MB |     858 MB |     536 GB |     535 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15523 GB |   15523 GB |
|       from large pool |   32920 KB |     261 MB |   14864 GB |   14864 GB |
|       from small pool |   10990 KB |     708 MB |     659 GB |     659 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10785 K  |   10772 K  |
|       from large pool |      61    |      69    |    2444 K  |    2444 K  |
|       from small pool |   13012    |   13020    |    8340 K  |    8327 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10785 K  |   10772 K  |
|       from large pool |      61    |      69    |    2444 K  |    2444 K  |
|       from small pool |   13012    |   13020    |    8340 K  |    8327 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    7015 K  |    7015 K  |
|       from large pool |       9    |      15    |    2088 K  |    2088 K  |
|       from small pool |     439    |    2231    |    4926 K  |    4926 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11229 GB |   11228 GB |
|       from large pool |     680 MB |     870 MB |   10693 GB |   10692 GB |
|       from small pool |     856 MB |     857 MB |     536 GB |     535 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11229 GB |   11228 GB |
|       from large pool |     680 MB |     870 MB |   10693 GB |   10692 GB |
|       from small pool |     856 MB |     857 MB |     536 GB |     535 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11216 GB |   11216 GB |
|       from large pool |   19933 KB |     153 MB |   10556 GB |   10556 GB |
|       from small pool |   11705 KB |     711 MB |     659 GB |     659 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10775 K  |   10762 K  |
|       from large pool |      28    |      36    |    2441 K  |    2441 K  |
|       from small pool |   13002    |   13011    |    8333 K  |    8320 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10775 K  |   10762 K  |
|       from large pool |      28    |      36    |    2441 K  |    2441 K  |
|       from small pool |   13002    |   13011    |    8333 K  |    8320 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6837 K  |    6837 K  |
|       from large pool |       7    |      11    |    1912 K  |    1912 K  |
|       from small pool |     437    |    2228    |    4924 K  |    4924 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 110
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0
Device: 1
tensor([[ 1.5156e-03, -4.1084e-04,  1.7001e-03,  ..., -1.8019e-03,
         -1.7323e-03,  1.0550e-03],
        [ 2.1900e-04, -1.2687e-03, -7.7931e-04,  ..., -8.2103e-04,
          4.9536e-05,  1.0432e-03],
        [ 1.0435e-03, -4.6951e-04,  2.2415e-03,  ..., -1.0733e-03,
         -9.7604e-04, -1.7588e-03],
        ...,
        [ 2.1811e-03, -1.2233e-03, -1.7512e-03,  ..., -1.3072e-03,
          6.5223e-04, -1.8649e-03],
        [ 2.2022e-03, -8.7995e-04,  1.6359e-03,  ..., -2.9228e-04,
          1.7937e-03,  1.6886e-03],
        [-1.4942e-03, -1.7779e-03, -1.7381e-03,  ...,  1.5513e-03,
         -1.3847e-03, -4.5605e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5156e-03, -4.1084e-04,  1.7001e-03,  ..., -1.8019e-03,
         -1.7323e-03,  1.0550e-03],
        [ 2.1900e-04, -1.2687e-03, -7.7931e-04,  ..., -8.2103e-04,
          4.9536e-05,  1.0432e-03],
        [ 1.0435e-03, -4.6951e-04,  2.2415e-03,  ..., -1.0733e-03,
         -9.7604e-04, -1.7588e-03],
        ...,
        [ 2.1811e-03, -1.2233e-03, -1.7512e-03,  ..., -1.3072e-03,
          6.5223e-04, -1.8649e-03],
        [ 2.2022e-03, -8.7995e-04,  1.6359e-03,  ..., -2.9228e-04,
          1.7937e-03,  1.6886e-03],
        [-1.4942e-03, -1.7779e-03, -1.7381e-03,  ...,  1.5513e-03,
         -1.3847e-03, -4.5605e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0082, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11343 GB |   11342 GB |
|       from large pool |     787 MB |     977 MB |   10802 GB |   10801 GB |
|       from small pool |     857 MB |     858 MB |     541 GB |     540 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11343 GB |   11342 GB |
|       from large pool |     787 MB |     977 MB |   10802 GB |   10801 GB |
|       from small pool |     857 MB |     858 MB |     541 GB |     540 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15666 GB |   15666 GB |
|       from large pool |   32920 KB |     261 MB |   15000 GB |   15000 GB |
|       from small pool |   10990 KB |     708 MB |     665 GB |     665 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10884 K  |   10871 K  |
|       from large pool |      61    |      69    |    2467 K  |    2467 K  |
|       from small pool |   13012    |   13020    |    8417 K  |    8404 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10884 K  |   10871 K  |
|       from large pool |      61    |      69    |    2467 K  |    2467 K  |
|       from small pool |   13012    |   13020    |    8417 K  |    8404 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     449    |    2241    |    7079 K  |    7079 K  |
|       from large pool |       9    |      15    |    2108 K  |    2108 K  |
|       from small pool |     440    |    2231    |    4971 K  |    4971 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11332 GB |   11331 GB |
|       from large pool |     680 MB |     870 MB |   10791 GB |   10791 GB |
|       from small pool |     856 MB |     857 MB |     540 GB |     540 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11332 GB |   11331 GB |
|       from large pool |     680 MB |     870 MB |   10791 GB |   10791 GB |
|       from small pool |     856 MB |     857 MB |     540 GB |     540 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11319 GB |   11319 GB |
|       from large pool |   19933 KB |     153 MB |   10653 GB |   10653 GB |
|       from small pool |   11705 KB |     711 MB |     665 GB |     665 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10873 K  |   10860 K  |
|       from large pool |      28    |      36    |    2464 K  |    2464 K  |
|       from small pool |   13002    |   13011    |    8409 K  |    8396 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10873 K  |   10860 K  |
|       from large pool |      28    |      36    |    2464 K  |    2464 K  |
|       from small pool |   13002    |   13011    |    8409 K  |    8396 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6900 K  |    6899 K  |
|       from large pool |       7    |      11    |    1930 K  |    1930 K  |
|       from small pool |     437    |    2228    |    4969 K  |    4969 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 111
batch input size: torch.Size([16, 1855]) Device: 0
batch input size: torch.Size([16, 1855]) Device: 1
tensor([[ 1.5165e-03, -4.1000e-04,  1.7010e-03,  ..., -1.8028e-03,
         -1.7332e-03,  1.0541e-03],
        [ 2.2033e-04, -1.2673e-03, -7.7798e-04,  ..., -8.2235e-04,
          4.8212e-05,  1.0418e-03],
        [ 1.0425e-03, -4.7047e-04,  2.2405e-03,  ..., -1.0724e-03,
         -9.7508e-04, -1.7578e-03],
        ...,
        [ 2.1821e-03, -1.2223e-03, -1.7502e-03,  ..., -1.3082e-03,
          6.5123e-04, -1.8659e-03],
        [ 2.2026e-03, -8.7953e-04,  1.6363e-03,  ..., -2.9270e-04,
          1.7933e-03,  1.6882e-03],
        [-1.4938e-03, -1.7776e-03, -1.7377e-03,  ...,  1.5509e-03,
         -1.3850e-03, -4.5639e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5165e-03, -4.1000e-04,  1.7010e-03,  ..., -1.8028e-03,
         -1.7332e-03,  1.0541e-03],
        [ 2.2033e-04, -1.2673e-03, -7.7798e-04,  ..., -8.2235e-04,
          4.8212e-05,  1.0418e-03],
        [ 1.0425e-03, -4.7047e-04,  2.2405e-03,  ..., -1.0724e-03,
         -9.7508e-04, -1.7578e-03],
        ...,
        [ 2.1821e-03, -1.2223e-03, -1.7502e-03,  ..., -1.3082e-03,
          6.5123e-04, -1.8659e-03],
        [ 2.2026e-03, -8.7953e-04,  1.6363e-03,  ..., -2.9270e-04,
          1.7933e-03,  1.6882e-03],
        [-1.4938e-03, -1.7776e-03, -1.7377e-03,  ...,  1.5509e-03,
         -1.3850e-03, -4.5639e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0049, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11446 GB |   11445 GB |
|       from large pool |     787 MB |     977 MB |   10900 GB |   10900 GB |
|       from small pool |     857 MB |     858 MB |     545 GB |     545 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11446 GB |   11445 GB |
|       from large pool |     787 MB |     977 MB |   10900 GB |   10900 GB |
|       from small pool |     857 MB |     858 MB |     545 GB |     545 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15808 GB |   15808 GB |
|       from large pool |   32920 KB |     261 MB |   15136 GB |   15136 GB |
|       from small pool |   10990 KB |     708 MB |     671 GB |     671 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   10982 K  |   10969 K  |
|       from large pool |      61    |      69    |    2489 K  |    2489 K  |
|       from small pool |   13012    |   13020    |    8493 K  |    8480 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   10982 K  |   10969 K  |
|       from large pool |      61    |      69    |    2489 K  |    2489 K  |
|       from small pool |   13012    |   13020    |    8493 K  |    8480 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     445    |    2241    |    7144 K  |    7143 K  |
|       from large pool |       9    |      15    |    2127 K  |    2127 K  |
|       from small pool |     436    |    2231    |    5016 K  |    5016 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11435 GB |   11434 GB |
|       from large pool |     680 MB |     870 MB |   10889 GB |   10889 GB |
|       from small pool |     856 MB |     857 MB |     545 GB |     545 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11435 GB |   11434 GB |
|       from large pool |     680 MB |     870 MB |   10889 GB |   10889 GB |
|       from small pool |     856 MB |     857 MB |     545 GB |     545 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11422 GB |   11422 GB |
|       from large pool |   19933 KB |     153 MB |   10750 GB |   10750 GB |
|       from small pool |   11705 KB |     711 MB |     671 GB |     671 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   10972 K  |   10959 K  |
|       from large pool |      28    |      36    |    2486 K  |    2486 K  |
|       from small pool |   13002    |   13011    |    8485 K  |    8472 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   10972 K  |   10959 K  |
|       from large pool |      28    |      36    |    2486 K  |    2486 K  |
|       from small pool |   13002    |   13011    |    8485 K  |    8472 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    6962 K  |    6962 K  |
|       from large pool |       7    |      11    |    1948 K  |    1948 K  |
|       from small pool |     437    |    2228    |    5014 K  |    5014 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 112
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  0Device:
 1
tensor([[ 1.5173e-03, -4.0917e-04,  1.7018e-03,  ..., -1.8036e-03,
         -1.7340e-03,  1.0533e-03],
        [ 2.2052e-04, -1.2671e-03, -7.7779e-04,  ..., -8.2253e-04,
          4.8023e-05,  1.0416e-03],
        [ 1.0404e-03, -4.7259e-04,  2.2384e-03,  ..., -1.0702e-03,
         -9.7295e-04, -1.7557e-03],
        ...,
        [ 2.1830e-03, -1.2214e-03, -1.7493e-03,  ..., -1.3091e-03,
          6.5034e-04, -1.8668e-03],
        [ 2.2030e-03, -8.7913e-04,  1.6367e-03,  ..., -2.9309e-04,
          1.7929e-03,  1.6878e-03],
        [-1.4935e-03, -1.7773e-03, -1.7374e-03,  ...,  1.5506e-03,
         -1.3853e-03, -4.5671e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5173e-03, -4.0917e-04,  1.7018e-03,  ..., -1.8036e-03,
         -1.7340e-03,  1.0533e-03],
        [ 2.2052e-04, -1.2671e-03, -7.7779e-04,  ..., -8.2253e-04,
          4.8023e-05,  1.0416e-03],
        [ 1.0404e-03, -4.7259e-04,  2.2384e-03,  ..., -1.0702e-03,
         -9.7295e-04, -1.7557e-03],
        ...,
        [ 2.1830e-03, -1.2214e-03, -1.7493e-03,  ..., -1.3091e-03,
          6.5034e-04, -1.8668e-03],
        [ 2.2030e-03, -8.7913e-04,  1.6367e-03,  ..., -2.9309e-04,
          1.7929e-03,  1.6878e-03],
        [-1.4935e-03, -1.7773e-03, -1.7374e-03,  ...,  1.5506e-03,
         -1.3853e-03, -4.5671e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0104, 0.0024], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11549 GB |   11548 GB |
|       from large pool |     787 MB |     977 MB |   10999 GB |   10998 GB |
|       from small pool |     857 MB |     858 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11549 GB |   11548 GB |
|       from large pool |     787 MB |     977 MB |   10999 GB |   10998 GB |
|       from small pool |     857 MB |     858 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   15950 GB |   15950 GB |
|       from large pool |   32920 KB |     261 MB |   15273 GB |   15273 GB |
|       from small pool |   10990 KB |     708 MB |     677 GB |     677 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   11081 K  |   11068 K  |
|       from large pool |      61    |      69    |    2512 K  |    2511 K  |
|       from small pool |   13012    |   13020    |    8569 K  |    8556 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   11081 K  |   11068 K  |
|       from large pool |      61    |      69    |    2512 K  |    2511 K  |
|       from small pool |   13012    |   13020    |    8569 K  |    8556 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     448    |    2241    |    7208 K  |    7207 K  |
|       from large pool |       9    |      15    |    2146 K  |    2146 K  |
|       from small pool |     439    |    2231    |    5061 K  |    5061 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11538 GB |   11537 GB |
|       from large pool |     680 MB |     870 MB |   10987 GB |   10987 GB |
|       from small pool |     856 MB |     857 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11538 GB |   11537 GB |
|       from large pool |     680 MB |     870 MB |   10987 GB |   10987 GB |
|       from small pool |     856 MB |     857 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11525 GB |   11525 GB |
|       from large pool |   19933 KB |     153 MB |   10847 GB |   10847 GB |
|       from small pool |   11705 KB |     711 MB |     677 GB |     677 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   11070 K  |   11057 K  |
|       from large pool |      28    |      36    |    2509 K  |    2509 K  |
|       from small pool |   13002    |   13011    |    8561 K  |    8548 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   11070 K  |   11057 K  |
|       from large pool |      28    |      36    |    2509 K  |    2509 K  |
|       from small pool |   13002    |   13011    |    8561 K  |    8548 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    7025 K  |    7024 K  |
|       from large pool |       7    |      11    |    1965 K  |    1965 K  |
|       from small pool |     437    |    2228    |    5059 K  |    5059 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 113
batch input size: torch.Size([16, 1855])batch input size:  Device:torch.Size([16, 1855])  0Device:
 1
tensor([[ 1.5180e-03, -4.0844e-04,  1.7025e-03,  ..., -1.8043e-03,
         -1.7347e-03,  1.0526e-03],
        [ 2.2069e-04, -1.2670e-03, -7.7762e-04,  ..., -8.2270e-04,
          4.7850e-05,  1.0415e-03],
        [ 1.0378e-03, -4.7516e-04,  2.2358e-03,  ..., -1.0677e-03,
         -9.7038e-04, -1.7531e-03],
        ...,
        [ 2.1838e-03, -1.2206e-03, -1.7485e-03,  ..., -1.3099e-03,
          6.4954e-04, -1.8675e-03],
        [ 2.2033e-03, -8.7877e-04,  1.6370e-03,  ..., -2.9345e-04,
          1.7925e-03,  1.6874e-03],
        [-1.4932e-03, -1.7769e-03, -1.7371e-03,  ...,  1.5503e-03,
         -1.3856e-03, -4.5702e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5180e-03, -4.0844e-04,  1.7025e-03,  ..., -1.8043e-03,
         -1.7347e-03,  1.0526e-03],
        [ 2.2069e-04, -1.2670e-03, -7.7762e-04,  ..., -8.2270e-04,
          4.7850e-05,  1.0415e-03],
        [ 1.0378e-03, -4.7516e-04,  2.2358e-03,  ..., -1.0677e-03,
         -9.7038e-04, -1.7531e-03],
        ...,
        [ 2.1838e-03, -1.2206e-03, -1.7485e-03,  ..., -1.3099e-03,
          6.4954e-04, -1.8675e-03],
        [ 2.2033e-03, -8.7877e-04,  1.6370e-03,  ..., -2.9345e-04,
          1.7925e-03,  1.6874e-03],
        [-1.4932e-03, -1.7769e-03, -1.7371e-03,  ...,  1.5503e-03,
         -1.3856e-03, -4.5702e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0080, 0.0023], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11653 GB |   11651 GB |
|       from large pool |     787 MB |     977 MB |   11097 GB |   11096 GB |
|       from small pool |     857 MB |     858 MB |     555 GB |     554 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11653 GB |   11651 GB |
|       from large pool |     787 MB |     977 MB |   11097 GB |   11096 GB |
|       from small pool |     857 MB |     858 MB |     555 GB |     554 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   16093 GB |   16093 GB |
|       from large pool |   32920 KB |     261 MB |   15409 GB |   15409 GB |
|       from small pool |   10990 KB |     708 MB |     683 GB |     683 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   11180 K  |   11167 K  |
|       from large pool |      61    |      69    |    2534 K  |    2534 K  |
|       from small pool |   13012    |   13020    |    8645 K  |    8632 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   11180 K  |   11167 K  |
|       from large pool |      61    |      69    |    2534 K  |    2534 K  |
|       from small pool |   13012    |   13020    |    8645 K  |    8632 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    7272 K  |    7272 K  |
|       from large pool |       9    |      15    |    2165 K  |    2165 K  |
|       from small pool |     438    |    2231    |    5106 K  |    5106 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11641 GB |   11640 GB |
|       from large pool |     680 MB |     870 MB |   11086 GB |   11085 GB |
|       from small pool |     856 MB |     857 MB |     555 GB |     554 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11641 GB |   11640 GB |
|       from large pool |     680 MB |     870 MB |   11086 GB |   11085 GB |
|       from small pool |     856 MB |     857 MB |     555 GB |     554 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11627 GB |   11627 GB |
|       from large pool |   19933 KB |     153 MB |   10944 GB |   10944 GB |
|       from small pool |   11705 KB |     711 MB |     683 GB |     683 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   11169 K  |   11156 K  |
|       from large pool |      28    |      36    |    2531 K  |    2531 K  |
|       from small pool |   13002    |   13011    |    8637 K  |    8624 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   11169 K  |   11156 K  |
|       from large pool |      28    |      36    |    2531 K  |    2531 K  |
|       from small pool |   13002    |   13011    |    8637 K  |    8624 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    7087 K  |    7087 K  |
|       from large pool |       7    |      11    |    1983 K  |    1983 K  |
|       from small pool |     437    |    2228    |    5104 K  |    5104 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 114
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5186e-03, -4.0780e-04,  1.7031e-03,  ..., -1.8049e-03,
         -1.7353e-03,  1.0519e-03],
        [ 2.1898e-04, -1.2686e-03, -7.7931e-04,  ..., -8.2100e-04,
          4.9554e-05,  1.0432e-03],
        [ 1.0355e-03, -4.7747e-04,  2.2335e-03,  ..., -1.0654e-03,
         -9.6807e-04, -1.7508e-03],
        ...,
        [ 2.1845e-03, -1.2199e-03, -1.7478e-03,  ..., -1.3106e-03,
          6.4882e-04, -1.8683e-03],
        [ 2.2037e-03, -8.7843e-04,  1.6374e-03,  ..., -2.9378e-04,
          1.7921e-03,  1.6871e-03],
        [-1.4929e-03, -1.7767e-03, -1.7368e-03,  ...,  1.5500e-03,
         -1.3859e-03, -4.5730e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5186e-03, -4.0780e-04,  1.7031e-03,  ..., -1.8049e-03,
         -1.7353e-03,  1.0519e-03],
        [ 2.1898e-04, -1.2686e-03, -7.7931e-04,  ..., -8.2100e-04,
          4.9554e-05,  1.0432e-03],
        [ 1.0355e-03, -4.7747e-04,  2.2335e-03,  ..., -1.0654e-03,
         -9.6807e-04, -1.7508e-03],
        ...,
        [ 2.1845e-03, -1.2199e-03, -1.7478e-03,  ..., -1.3106e-03,
          6.4882e-04, -1.8683e-03],
        [ 2.2037e-03, -8.7843e-04,  1.6374e-03,  ..., -2.9378e-04,
          1.7921e-03,  1.6871e-03],
        [-1.4929e-03, -1.7767e-03, -1.7368e-03,  ...,  1.5500e-03,
         -1.3859e-03, -4.5730e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0275, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11756 GB |   11754 GB |
|       from large pool |     787 MB |     977 MB |   11195 GB |   11194 GB |
|       from small pool |     857 MB |     858 MB |     560 GB |     559 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11756 GB |   11754 GB |
|       from large pool |     787 MB |     977 MB |   11195 GB |   11194 GB |
|       from small pool |     857 MB |     858 MB |     560 GB |     559 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   16235 GB |   16235 GB |
|       from large pool |   32920 KB |     261 MB |   15545 GB |   15545 GB |
|       from small pool |   10990 KB |     708 MB |     689 GB |     689 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   11278 K  |   11265 K  |
|       from large pool |      61    |      69    |    2556 K  |    2556 K  |
|       from small pool |   13012    |   13020    |    8722 K  |    8708 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   11278 K  |   11265 K  |
|       from large pool |      61    |      69    |    2556 K  |    2556 K  |
|       from small pool |   13012    |   13020    |    8722 K  |    8708 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    7336 K  |    7336 K  |
|       from large pool |       9    |      15    |    2184 K  |    2184 K  |
|       from small pool |     438    |    2231    |    5152 K  |    5151 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11744 GB |   11743 GB |
|       from large pool |     680 MB |     870 MB |   11184 GB |   11183 GB |
|       from small pool |     856 MB |     857 MB |     560 GB |     559 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11744 GB |   11743 GB |
|       from large pool |     680 MB |     870 MB |   11184 GB |   11183 GB |
|       from small pool |     856 MB |     857 MB |     560 GB |     559 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11730 GB |   11730 GB |
|       from large pool |   19933 KB |     153 MB |   11041 GB |   11041 GB |
|       from small pool |   11705 KB |     711 MB |     689 GB |     689 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   11267 K  |   11254 K  |
|       from large pool |      28    |      36    |    2553 K  |    2553 K  |
|       from small pool |   13002    |   13011    |    8713 K  |    8700 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   11267 K  |   11254 K  |
|       from large pool |      28    |      36    |    2553 K  |    2553 K  |
|       from small pool |   13002    |   13011    |    8713 K  |    8700 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    7150 K  |    7150 K  |
|       from large pool |       7    |      11    |    2000 K  |    2000 K  |
|       from small pool |     437    |    2228    |    5149 K  |    5149 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 115
batch input size: batch input size:torch.Size([16, 1855])  torch.Size([16, 1855])Device:  Device:0
1
tensor([[ 1.5191e-03, -4.0730e-04,  1.7036e-03,  ..., -1.8054e-03,
         -1.7358e-03,  1.0514e-03],
        [ 2.1929e-04, -1.2683e-03, -7.7900e-04,  ..., -8.2130e-04,
          4.9245e-05,  1.0429e-03],
        [ 1.0333e-03, -4.7959e-04,  2.2313e-03,  ..., -1.0632e-03,
         -9.6594e-04, -1.7487e-03],
        ...,
        [ 2.1852e-03, -1.2192e-03, -1.7472e-03,  ..., -1.3112e-03,
          6.4817e-04, -1.8689e-03],
        [ 2.2040e-03, -8.7812e-04,  1.6377e-03,  ..., -2.9409e-04,
          1.7918e-03,  1.6868e-03],
        [-1.4926e-03, -1.7764e-03, -1.7366e-03,  ...,  1.5498e-03,
         -1.3861e-03, -4.5753e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5191e-03, -4.0730e-04,  1.7036e-03,  ..., -1.8054e-03,
         -1.7358e-03,  1.0514e-03],
        [ 2.1929e-04, -1.2683e-03, -7.7900e-04,  ..., -8.2130e-04,
          4.9245e-05,  1.0429e-03],
        [ 1.0333e-03, -4.7959e-04,  2.2313e-03,  ..., -1.0632e-03,
         -9.6594e-04, -1.7487e-03],
        ...,
        [ 2.1852e-03, -1.2192e-03, -1.7472e-03,  ..., -1.3112e-03,
          6.4817e-04, -1.8689e-03],
        [ 2.2040e-03, -8.7812e-04,  1.6377e-03,  ..., -2.9409e-04,
          1.7918e-03,  1.6868e-03],
        [-1.4926e-03, -1.7764e-03, -1.7366e-03,  ...,  1.5498e-03,
         -1.3861e-03, -4.5753e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0073, 0.8839], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1645 MB |    1836 MB |   11859 GB |   11857 GB |
|       from large pool |     787 MB |     977 MB |   11293 GB |   11292 GB |
|       from small pool |     857 MB |     858 MB |     565 GB |     564 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1645 MB |    1836 MB |   11859 GB |   11857 GB |
|       from large pool |     787 MB |     977 MB |   11293 GB |   11292 GB |
|       from small pool |     857 MB |     858 MB |     565 GB |     564 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2002 MB |    2002 MB |    2002 MB |       0 B  |
|       from large pool |    1132 MB |    1132 MB |    1132 MB |       0 B  |
|       from small pool |     870 MB |     870 MB |     870 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   43911 KB |     852 MB |   16378 GB |   16378 GB |
|       from large pool |   32920 KB |     261 MB |   15682 GB |   15682 GB |
|       from small pool |   10990 KB |     708 MB |     695 GB |     695 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13084    |   11377 K  |   11364 K  |
|       from large pool |      61    |      69    |    2579 K  |    2579 K  |
|       from small pool |   13012    |   13020    |    8798 K  |    8785 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13084    |   11377 K  |   11364 K  |
|       from large pool |      61    |      69    |    2579 K  |    2579 K  |
|       from small pool |   13012    |   13020    |    8798 K  |    8785 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     453    |     453    |     453    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     435    |     435    |     435    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     447    |    2241    |    7401 K  |    7400 K  |
|       from large pool |       9    |      15    |    2203 K  |    2203 K  |
|       from small pool |     438    |    2231    |    5197 K  |    5196 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1537 MB |    1728 MB |   11847 GB |   11846 GB |
|       from large pool |     680 MB |     870 MB |   11282 GB |   11281 GB |
|       from small pool |     856 MB |     857 MB |     565 GB |     564 GB |
|---------------------------------------------------------------------------|
| Active memory         |    1537 MB |    1728 MB |   11847 GB |   11846 GB |
|       from large pool |     680 MB |     870 MB |   11282 GB |   11281 GB |
|       from small pool |     856 MB |     857 MB |     565 GB |     564 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from large pool |    1012 MB |    1012 MB |    1012 MB |       0 B  |
|       from small pool |     868 MB |     868 MB |     868 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   31638 KB |     850 MB |   11833 GB |   11833 GB |
|       from large pool |   19933 KB |     153 MB |   11137 GB |   11137 GB |
|       from small pool |   11705 KB |     711 MB |     695 GB |     695 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13042    |   11366 K  |   11353 K  |
|       from large pool |      28    |      36    |    2576 K  |    2576 K  |
|       from small pool |   13002    |   13011    |    8790 K  |    8777 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13042    |   11366 K  |   11353 K  |
|       from large pool |      28    |      36    |    2576 K  |    2576 K  |
|       from small pool |   13002    |   13011    |    8790 K  |    8777 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     452    |     452    |     452    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     434    |     434    |     434    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     444    |    2235    |    7213 K  |    7212 K  |
|       from large pool |       7    |      11    |    2018 K  |    2018 K  |
|       from small pool |     437    |    2228    |    5194 K  |    5194 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
