/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py:541: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(dataset_tensor[:, 1, :].clone().detach(), dtype=torch.long)
PermutedDKT
Number of questions:  1855
Number of students:  6468
Number of concepts: 1076
Using batch size: 64
Using batch size: 64
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |   39973 KB |   39973 KB |   39973 KB |       0 B  |
|       from large pool |   39967 KB |   39967 KB |   39967 KB |       0 B  |
|       from small pool |       6 KB |       6 KB |       6 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |   39973 KB |   39973 KB |   39973 KB |       0 B  |
|       from large pool |   39967 KB |   39967 KB |   39967 KB |       0 B  |
|       from small pool |       6 KB |       6 KB |       6 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |   63488 KB |   63488 KB |   63488 KB |       0 B  |
|       from large pool |   61440 KB |   61440 KB |   61440 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   23514 KB |   23516 KB |   53176 KB |   29662 KB |
|       from large pool |   21473 KB |   21473 KB |   51133 KB |   29660 KB |
|       from small pool |    2041 KB |    2043 KB |    2043 KB |       2 KB |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |      11    |      11    |      11    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |      11    |      11    |      11    |       0    |
|       from small pool |       3    |       3    |       3    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       4    |       4    |       4    |       0    |
|       from large pool |       3    |       3    |       3    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       4    |       4    |       4    |       0    |
|       from large pool |       3    |       3    |       3    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |       0 B  |       0 B  |       0 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |       0 B  |       0 B  |       0 B  |       0 B  |
|---------------------------------------------------------------------------|
| Allocations           |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       0    |       0    |       0    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Successfull in data prepration!
Successfully loaded the optimizer
======== Epoch 1 / 100 ========
Training...
Step: 0
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
step loss: tensor([0.0314, 0.0000], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6108 MB |    3164 MB |
|       from large pool |    1235 MB |    1615 MB |    1716 MB |     481 MB |
|       from small pool |    1708 MB |    1710 MB |    4391 MB |    2683 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6108 MB |    3164 MB |
|       from large pool |    1235 MB |    1615 MB |    1716 MB |     481 MB |
|       from small pool |    1708 MB |    1710 MB |    4391 MB |    2683 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3372 MB |    3372 MB |    3372 MB |       0 B  |
|       from large pool |    1634 MB |    1634 MB |    1634 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   47907 KB |   47907 KB |    5175 MB |    5128 MB |
|       from large pool |   19341 KB |   31025 KB |     221 MB |     202 MB |
|       from small pool |   28565 KB |   28707 KB |    4953 MB |    4925 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13042    |   13053    |   33536    |   20494    |
|       from large pool |      36    |      39    |      51    |      15    |
|       from small pool |   13006    |   13014    |   33485    |   20479    |
|---------------------------------------------------------------------------|
| Active allocs         |   13042    |   13053    |   33536    |   20494    |
|       from large pool |      36    |      39    |      51    |      15    |
|       from small pool |   13006    |   13014    |   33485    |   20479    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     885    |     885    |     885    |       0    |
|       from large pool |      16    |      16    |      16    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     880    |     881    |    8208    |    7328    |
|       from large pool |       8    |       8    |      13    |       5    |
|       from small pool |     872    |     873    |    8195    |    7323    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6069 MB |    3126 MB |
|       from large pool |    1236 MB |    1616 MB |    1678 MB |     442 MB |
|       from small pool |    1706 MB |    1709 MB |    4390 MB |    2683 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6069 MB |    3126 MB |
|       from large pool |    1236 MB |    1616 MB |    1678 MB |     442 MB |
|       from small pool |    1706 MB |    1709 MB |    4390 MB |    2683 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3372 MB |    3372 MB |    3372 MB |       0 B  |
|       from large pool |    1636 MB |    1636 MB |    1636 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |   49814 KB |    5097 MB |    5049 MB |
|       from large pool |   19852 KB |   27012 KB |     147 MB |     128 MB |
|       from small pool |   29962 KB |   29962 KB |    4950 MB |    4920 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |   33500    |   20470    |
|       from large pool |      28    |      31    |      40    |      12    |
|       from small pool |   13002    |   13012    |   33460    |   20458    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |   33500    |   20470    |
|       from large pool |      28    |      31    |      40    |      12    |
|       from small pool |   13002    |   13012    |   33460    |   20458    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     885    |     885    |     885    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |     879    |    8197    |    7319    |
|       from large pool |       7    |       7    |      11    |       4    |
|       from small pool |     871    |     872    |    8186    |    7315    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 1
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0153,    inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |  118184 MB |  115132 MB |
|       from large pool |    1343 MB |    1723 MB |  103797 MB |  102453 MB |
|       from small pool |    1708 MB |    1710 MB |   14387 MB |   12678 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |  118184 MB |  115132 MB |
|       from large pool |    1343 MB |    1723 MB |  103797 MB |  102453 MB |
|       from small pool |    1708 MB |    1710 MB |   14387 MB |   12678 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |  117191 MB |  117009 MB |
|       from large pool |  157802 KB |     278 MB |  100091 MB |   99937 MB |
|       from small pool |   28552 KB |    1298 MB |   17100 MB |   17072 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  132202    |  119129    |
|       from large pool |      61    |      64    |   22499    |   22438    |
|       from small pool |   13012    |   13021    |  109703    |   96691    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  132202    |  119129    |
|       from large pool |      61    |      64    |   22499    |   22438    |
|       from small pool |   13012    |   13021    |  109703    |   96691    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2609    |   79420    |   78536    |
|       from large pool |      10    |      13    |   19156    |   19146    |
|       from small pool |     874    |    2601    |   60264    |   59390    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |  117970 MB |  115027 MB |
|       from large pool |    1236 MB |    1616 MB |  103585 MB |  102348 MB |
|       from small pool |    1706 MB |    1709 MB |   14385 MB |   12678 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |  117970 MB |  115027 MB |
|       from large pool |    1236 MB |    1616 MB |  103585 MB |  102348 MB |
|       from small pool |    1706 MB |    1709 MB |   14385 MB |   12678 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  116509 MB |  116460 MB |
|       from large pool |   19852 KB |     284 MB |   99412 MB |   99392 MB |
|       from small pool |   29962 KB |    1297 MB |   17096 MB |   17067 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  132045    |  119015    |
|       from large pool |      28    |      36    |   22443    |   22415    |
|       from small pool |   13002    |   13012    |  109602    |   96600    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  132045    |  119015    |
|       from large pool |      28    |      36    |   22443    |   22415    |
|       from small pool |   13002    |   13012    |  109602    |   96600    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |   77535    |   76657    |
|       from large pool |       7    |      11    |   17568    |   17561    |
|       from small pool |     871    |    2600    |   59967    |   59096    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 2
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([ 1.0782e-02, -6.9567e+11], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |  230192 MB |  227140 MB |
|       from large pool |    1343 MB |    1723 MB |  205809 MB |  204465 MB |
|       from small pool |    1708 MB |    1710 MB |   24382 MB |   22674 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |  230192 MB |  227140 MB |
|       from large pool |    1343 MB |    1723 MB |  205809 MB |  204465 MB |
|       from small pool |    1708 MB |    1710 MB |   24382 MB |   22674 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |  229163 MB |  228981 MB |
|       from large pool |  157802 KB |     338 MB |  199917 MB |  199763 MB |
|       from small pool |   28552 KB |    1298 MB |   29246 MB |   29218 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  230840    |  217767    |
|       from large pool |      61    |      69    |   44927    |   44866    |
|       from small pool |   13012    |   13021    |  185913    |  172901    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  230840    |  217767    |
|       from large pool |      61    |      69    |   44927    |   44866    |
|       from small pool |   13012    |   13021    |  185913    |  172901    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |  143184    |  142301    |
|       from large pool |      10    |      14    |   38319    |   38309    |
|       from small pool |     873    |    2603    |  104865    |  103992    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |  229880 MB |  226937 MB |
|       from large pool |    1236 MB |    1616 MB |  205500 MB |  204264 MB |
|       from small pool |    1706 MB |    1709 MB |   24379 MB |   22672 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |  229880 MB |  226937 MB |
|       from large pool |    1236 MB |    1616 MB |  205500 MB |  204264 MB |
|       from small pool |    1706 MB |    1709 MB |   24379 MB |   22672 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  227922 MB |  227873 MB |
|       from large pool |   19852 KB |     284 MB |  198678 MB |  198659 MB |
|       from small pool |   29962 KB |    1297 MB |   29243 MB |   29214 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  230590    |  217560    |
|       from large pool |      28    |      36    |   44846    |   44818    |
|       from small pool |   13002    |   13012    |  185744    |  172742    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  230590    |  217560    |
|       from large pool |      28    |      36    |   44846    |   44818    |
|       from small pool |   13002    |   13012    |  185744    |  172742    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  139650    |  138772    |
|       from large pool |       7    |      11    |   35136    |   35129    |
|       from small pool |     871    |    2600    |  104514    |  103643    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 3
batch input size: torch.Size([32, 1855])batch input size:  Device:torch.Size([32, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0174,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |  342200 MB |  339148 MB |
|       from large pool |    1343 MB |    1723 MB |  307822 MB |  306478 MB |
|       from small pool |    1708 MB |    1710 MB |   34377 MB |   32669 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |  342200 MB |  339148 MB |
|       from large pool |    1343 MB |    1723 MB |  307822 MB |  306478 MB |
|       from small pool |    1708 MB |    1710 MB |   34377 MB |   32669 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |  341137 MB |  340955 MB |
|       from large pool |  157802 KB |     338 MB |  299742 MB |  299588 MB |
|       from small pool |   28552 KB |    1298 MB |   41394 MB |   41366 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  329480    |  316407    |
|       from large pool |      61    |      69    |   67355    |   67294    |
|       from small pool |   13012    |   13021    |  262125    |  249113    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  329480    |  316407    |
|       from large pool |      61    |      69    |   67355    |   67294    |
|       from small pool |   13012    |   13021    |  262125    |  249113    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |  206938    |  206055    |
|       from large pool |      10    |      14    |   57482    |   57472    |
|       from small pool |     873    |    2603    |  149456    |  148583    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |  341790 MB |  338847 MB |
|       from large pool |    1236 MB |    1616 MB |  307416 MB |  306179 MB |
|       from small pool |    1706 MB |    1709 MB |   34374 MB |   32667 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |  341790 MB |  338847 MB |
|       from large pool |    1236 MB |    1616 MB |  307416 MB |  306179 MB |
|       from small pool |    1706 MB |    1709 MB |   34374 MB |   32667 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  339335 MB |  339286 MB |
|       from large pool |   19852 KB |     284 MB |  297945 MB |  297925 MB |
|       from small pool |   29962 KB |    1297 MB |   41390 MB |   41361 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  329135    |  316105    |
|       from large pool |      28    |      36    |   67249    |   67221    |
|       from small pool |   13002    |   13012    |  261886    |  248884    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  329135    |  316105    |
|       from large pool |      28    |      36    |   67249    |   67221    |
|       from small pool |   13002    |   13012    |  261886    |  248884    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  201765    |  200887    |
|       from large pool |       7    |      11    |   52704    |   52697    |
|       from small pool |     871    |    2600    |  149061    |  148190    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 4
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0197,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |  454207 MB |  451155 MB |
|       from large pool |    1343 MB |    1723 MB |  409834 MB |  408490 MB |
|       from small pool |    1708 MB |    1710 MB |   44373 MB |   42665 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |  454207 MB |  451155 MB |
|       from large pool |    1343 MB |    1723 MB |  409834 MB |  408490 MB |
|       from small pool |    1708 MB |    1710 MB |   44373 MB |   42665 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |  453110 MB |  452928 MB |
|       from large pool |  157802 KB |     338 MB |  399568 MB |  399414 MB |
|       from small pool |   28552 KB |    1298 MB |   53541 MB |   53513 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  428120    |  415047    |
|       from large pool |      61    |      69    |   89783    |   89722    |
|       from small pool |   13012    |   13021    |  338337    |  325325    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  428120    |  415047    |
|       from large pool |      61    |      69    |   89783    |   89722    |
|       from small pool |   13012    |   13021    |  338337    |  325325    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |  270768    |  269885    |
|       from large pool |      10    |      14    |   76645    |   76635    |
|       from small pool |     873    |    2603    |  194123    |  193250    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |  453700 MB |  450757 MB |
|       from large pool |    1236 MB |    1616 MB |  409332 MB |  408095 MB |
|       from small pool |    1706 MB |    1709 MB |   44368 MB |   42661 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |  453700 MB |  450757 MB |
|       from large pool |    1236 MB |    1616 MB |  409332 MB |  408095 MB |
|       from small pool |    1706 MB |    1709 MB |   44368 MB |   42661 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  450748 MB |  450699 MB |
|       from large pool |   19852 KB |     284 MB |  397211 MB |  397192 MB |
|       from small pool |   29962 KB |    1297 MB |   53537 MB |   53507 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  427680    |  414650    |
|       from large pool |      28    |      36    |   89652    |   89624    |
|       from small pool |   13002    |   13012    |  338028    |  325026    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  427680    |  414650    |
|       from large pool |      28    |      36    |   89652    |   89624    |
|       from small pool |   13002    |   13012    |  338028    |  325026    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  263880    |  263002    |
|       from large pool |       7    |      11    |   70272    |   70265    |
|       from small pool |     871    |    2600    |  193608    |  192737    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 5
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0132,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |  566215 MB |  563163 MB |
|       from large pool |    1343 MB |    1723 MB |  511846 MB |  510502 MB |
|       from small pool |    1708 MB |    1710 MB |   54368 MB |   52660 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |  566215 MB |  563163 MB |
|       from large pool |    1343 MB |    1723 MB |  511846 MB |  510502 MB |
|       from small pool |    1708 MB |    1710 MB |   54368 MB |   52660 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |  565082 MB |  564900 MB |
|       from large pool |  157802 KB |     338 MB |  499394 MB |  499240 MB |
|       from small pool |   28552 KB |    1298 MB |   65688 MB |   65660 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  526760    |  513687    |
|       from large pool |      61    |      69    |  112211    |  112150    |
|       from small pool |   13012    |   13021    |  414549    |  401537    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  526760    |  513687    |
|       from large pool |      61    |      69    |  112211    |  112150    |
|       from small pool |   13012    |   13021    |  414549    |  401537    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |  334526    |  333642    |
|       from large pool |      10    |      14    |   95808    |   95798    |
|       from small pool |     874    |    2603    |  238718    |  237844    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |  565610 MB |  562667 MB |
|       from large pool |    1236 MB |    1616 MB |  511247 MB |  510011 MB |
|       from small pool |    1706 MB |    1709 MB |   54363 MB |   52656 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |  565610 MB |  562667 MB |
|       from large pool |    1236 MB |    1616 MB |  511247 MB |  510011 MB |
|       from small pool |    1706 MB |    1709 MB |   54363 MB |   52656 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  562161 MB |  562113 MB |
|       from large pool |   19852 KB |     284 MB |  496477 MB |  496458 MB |
|       from small pool |   29962 KB |    1297 MB |   65683 MB |   65654 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  526225    |  513195    |
|       from large pool |      28    |      36    |  112055    |  112027    |
|       from small pool |   13002    |   13012    |  414170    |  401168    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  526225    |  513195    |
|       from large pool |      28    |      36    |  112055    |  112027    |
|       from small pool |   13002    |   13012    |  414170    |  401168    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  325995    |  325117    |
|       from large pool |       7    |      11    |   87840    |   87833    |
|       from small pool |     871    |    2600    |  238155    |  237284    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 6
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0112,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |  678222 MB |  675170 MB |
|       from large pool |    1343 MB |    1723 MB |  613858 MB |  612514 MB |
|       from small pool |    1708 MB |    1710 MB |   64364 MB |   62656 MB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |  678222 MB |  675170 MB |
|       from large pool |    1343 MB |    1723 MB |  613858 MB |  612514 MB |
|       from small pool |    1708 MB |    1710 MB |   64364 MB |   62656 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |  677056 MB |  676874 MB |
|       from large pool |  157802 KB |     338 MB |  599220 MB |  599066 MB |
|       from small pool |   28552 KB |    1298 MB |   77836 MB |   77808 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  625400    |  612327    |
|       from large pool |      61    |      69    |  134639    |  134578    |
|       from small pool |   13012    |   13021    |  490761    |  477749    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  625400    |  612327    |
|       from large pool |      61    |      69    |  134639    |  134578    |
|       from small pool |   13012    |   13021    |  490761    |  477749    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |  398286    |  397404    |
|       from large pool |      10    |      14    |  114971    |  114961    |
|       from small pool |     872    |    2603    |  283315    |  282443    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |  677520 MB |  674577 MB |
|       from large pool |    1236 MB |    1616 MB |  613163 MB |  611926 MB |
|       from small pool |    1706 MB |    1709 MB |   64357 MB |   62650 MB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |  677520 MB |  674577 MB |
|       from large pool |    1236 MB |    1616 MB |  613163 MB |  611926 MB |
|       from small pool |    1706 MB |    1709 MB |   64357 MB |   62650 MB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  673574 MB |  673526 MB |
|       from large pool |   19852 KB |     284 MB |  595744 MB |  595724 MB |
|       from small pool |   29962 KB |    1297 MB |   77830 MB |   77801 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  624770    |  611740    |
|       from large pool |      28    |      36    |  134458    |  134430    |
|       from small pool |   13002    |   13012    |  490312    |  477310    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  624770    |  611740    |
|       from large pool |      28    |      36    |  134458    |  134430    |
|       from small pool |   13002    |   13012    |  490312    |  477310    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  388110    |  387232    |
|       from large pool |       7    |      11    |  105408    |  105401    |
|       from small pool |     871    |    2600    |  282702    |  281831    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 7
batch input size: torch.Size([32, 1855]) Device: batch input size:0
torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0180,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |     771 GB |     768 GB |
|       from large pool |    1343 MB |    1723 MB |     699 GB |     697 GB |
|       from small pool |    1708 MB |    1710 MB |      72 GB |      70 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |     771 GB |     768 GB |
|       from large pool |    1343 MB |    1723 MB |     699 GB |     697 GB |
|       from small pool |    1708 MB |    1710 MB |      72 GB |      70 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |     770 GB |     770 GB |
|       from large pool |  157802 KB |     338 MB |     682 GB |     682 GB |
|       from small pool |   28552 KB |    1298 MB |      87 GB |      87 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |  724040    |  710967    |
|       from large pool |      61    |      69    |  157067    |  157006    |
|       from small pool |   13012    |   13021    |  566973    |  553961    |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |  724040    |  710967    |
|       from large pool |      61    |      69    |  157067    |  157006    |
|       from small pool |   13012    |   13021    |  566973    |  553961    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |  462110    |  461226    |
|       from large pool |      10    |      14    |  134134    |  134124    |
|       from small pool |     874    |    2603    |  327976    |  327102    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |     770 GB |     768 GB |
|       from large pool |    1236 MB |    1616 MB |     698 GB |     697 GB |
|       from small pool |    1706 MB |    1709 MB |      72 GB |      70 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |     770 GB |     768 GB |
|       from large pool |    1236 MB |    1616 MB |     698 GB |     697 GB |
|       from small pool |    1706 MB |    1709 MB |      72 GB |      70 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |  784988 MB |  784939 MB |
|       from large pool |   19852 KB |     284 MB |  695010 MB |  694991 MB |
|       from small pool |   29962 KB |    1297 MB |   89977 MB |   89948 MB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |  723315    |  710285    |
|       from large pool |      28    |      36    |  156861    |  156833    |
|       from small pool |   13002    |   13012    |  566454    |  553452    |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |  723315    |  710285    |
|       from large pool |      28    |      36    |  156861    |  156833    |
|       from small pool |   13002    |   13012    |  566454    |  553452    |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  450225    |  449347    |
|       from large pool |       7    |      11    |  122976    |  122969    |
|       from small pool |     871    |    2600    |  327249    |  326378    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 8
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0216,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |     881 GB |     878 GB |
|       from large pool |    1343 MB |    1723 MB |     798 GB |     797 GB |
|       from small pool |    1708 MB |    1710 MB |      82 GB |      80 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |     881 GB |     878 GB |
|       from large pool |    1343 MB |    1723 MB |     798 GB |     797 GB |
|       from small pool |    1708 MB |    1710 MB |      82 GB |      80 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |     879 GB |     879 GB |
|       from large pool |  157802 KB |     338 MB |     780 GB |     779 GB |
|       from small pool |   28552 KB |    1298 MB |      99 GB |      99 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |     822 K  |     809 K  |
|       from large pool |      61    |      69    |     179 K  |     179 K  |
|       from small pool |   13012    |   13021    |     643 K  |     630 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |     822 K  |     809 K  |
|       from large pool |      61    |      69    |     179 K  |     179 K  |
|       from small pool |   13012    |   13021    |     643 K  |     630 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |  525874    |  524991    |
|       from large pool |      10    |      14    |  153297    |  153287    |
|       from small pool |     873    |    2603    |  372577    |  371704    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |     880 GB |     877 GB |
|       from large pool |    1236 MB |    1616 MB |     797 GB |     796 GB |
|       from small pool |    1706 MB |    1709 MB |      82 GB |      80 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |     880 GB |     877 GB |
|       from large pool |    1236 MB |    1616 MB |     797 GB |     796 GB |
|       from small pool |    1706 MB |    1709 MB |      82 GB |      80 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |     875 GB |     875 GB |
|       from large pool |   19852 KB |     284 MB |     775 GB |     775 GB |
|       from small pool |   29962 KB |    1297 MB |      99 GB |      99 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |     821 K  |     808 K  |
|       from large pool |      28    |      36    |     179 K  |     179 K  |
|       from small pool |   13002    |   13012    |     642 K  |     629 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |     821 K  |     808 K  |
|       from large pool |      28    |      36    |     179 K  |     179 K  |
|       from small pool |   13002    |   13012    |     642 K  |     629 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  512340    |  511462    |
|       from large pool |       7    |      11    |  140544    |  140537    |
|       from small pool |     871    |    2600    |  371796    |  370925    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 9
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0166,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |     990 GB |     987 GB |
|       from large pool |    1343 MB |    1723 MB |     898 GB |     897 GB |
|       from small pool |    1708 MB |    1710 MB |      92 GB |      90 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |     990 GB |     987 GB |
|       from large pool |    1343 MB |    1723 MB |     898 GB |     897 GB |
|       from small pool |    1708 MB |    1710 MB |      92 GB |      90 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |     989 GB |     989 GB |
|       from large pool |  157802 KB |     338 MB |     877 GB |     877 GB |
|       from small pool |   28552 KB |    1298 MB |     111 GB |     111 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |     921 K  |     908 K  |
|       from large pool |      61    |      69    |     201 K  |     201 K  |
|       from small pool |   13012    |   13021    |     719 K  |     706 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |     921 K  |     908 K  |
|       from large pool |      61    |      69    |     201 K  |     201 K  |
|       from small pool |   13012    |   13021    |     719 K  |     706 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |  589628    |  588745    |
|       from large pool |      10    |      14    |  172460    |  172450    |
|       from small pool |     873    |    2603    |  417168    |  416295    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |     989 GB |     986 GB |
|       from large pool |    1236 MB |    1616 MB |     897 GB |     896 GB |
|       from small pool |    1706 MB |    1709 MB |      92 GB |      90 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |     989 GB |     986 GB |
|       from large pool |    1236 MB |    1616 MB |     897 GB |     896 GB |
|       from small pool |    1706 MB |    1709 MB |      92 GB |      90 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |     984 GB |     984 GB |
|       from large pool |   19852 KB |     284 MB |     872 GB |     872 GB |
|       from small pool |   29962 KB |    1297 MB |     111 GB |     111 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |     920 K  |     907 K  |
|       from large pool |      28    |      36    |     201 K  |     201 K  |
|       from small pool |   13002    |   13012    |     718 K  |     705 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |     920 K  |     907 K  |
|       from large pool |      28    |      36    |     201 K  |     201 K  |
|       from small pool |   13002    |   13012    |     718 K  |     705 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  574455    |  573577    |
|       from large pool |       7    |      11    |  158112    |  158105    |
|       from small pool |     871    |    2600    |  416343    |  415472    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 10
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0214,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1099 GB |    1096 GB |
|       from large pool |    1343 MB |    1723 MB |     997 GB |     996 GB |
|       from small pool |    1708 MB |    1710 MB |     101 GB |     100 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1099 GB |    1096 GB |
|       from large pool |    1343 MB |    1723 MB |     997 GB |     996 GB |
|       from small pool |    1708 MB |    1710 MB |     101 GB |     100 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1098 GB |    1098 GB |
|       from large pool |  157802 KB |     338 MB |     975 GB |     974 GB |
|       from small pool |   28552 KB |    1298 MB |     123 GB |     123 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1019 K  |    1006 K  |
|       from large pool |      61    |      69    |     224 K  |     224 K  |
|       from small pool |   13012    |   13021    |     795 K  |     782 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1019 K  |    1006 K  |
|       from large pool |      61    |      69    |     224 K  |     224 K  |
|       from small pool |   13012    |   13021    |     795 K  |     782 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |  653458    |  652575    |
|       from large pool |      10    |      14    |  191623    |  191613    |
|       from small pool |     873    |    2603    |  461835    |  460962    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1098 GB |    1095 GB |
|       from large pool |    1236 MB |    1616 MB |     996 GB |     995 GB |
|       from small pool |    1706 MB |    1709 MB |     101 GB |     100 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1098 GB |    1095 GB |
|       from large pool |    1236 MB |    1616 MB |     996 GB |     995 GB |
|       from small pool |    1706 MB |    1709 MB |     101 GB |     100 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1092 GB |    1092 GB |
|       from large pool |   19852 KB |     284 MB |     969 GB |     969 GB |
|       from small pool |   29962 KB |    1297 MB |     123 GB |     123 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1018 K  |    1005 K  |
|       from large pool |      28    |      36    |     224 K  |     224 K  |
|       from small pool |   13002    |   13012    |     794 K  |     781 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1018 K  |    1005 K  |
|       from large pool |      28    |      36    |     224 K  |     224 K  |
|       from small pool |   13002    |   13012    |     794 K  |     781 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  636570    |  635692    |
|       from large pool |       7    |      11    |  175680    |  175673    |
|       from small pool |     871    |    2600    |  460890    |  460019    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 11
batch input size: torch.Size([32, 1855]) Device:batch input size: 0
torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0129,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1209 GB |    1206 GB |
|       from large pool |    1343 MB |    1723 MB |    1097 GB |    1096 GB |
|       from small pool |    1708 MB |    1710 MB |     111 GB |     109 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1209 GB |    1206 GB |
|       from large pool |    1343 MB |    1723 MB |    1097 GB |    1096 GB |
|       from small pool |    1708 MB |    1710 MB |     111 GB |     109 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1207 GB |    1207 GB |
|       from large pool |  157802 KB |     338 MB |    1072 GB |    1072 GB |
|       from small pool |   28552 KB |    1298 MB |     135 GB |     135 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1118 K  |    1105 K  |
|       from large pool |      61    |      69    |     246 K  |     246 K  |
|       from small pool |   13012    |   13021    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1118 K  |    1105 K  |
|       from large pool |      61    |      69    |     246 K  |     246 K  |
|       from small pool |   13012    |   13021    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |  717216    |  716332    |
|       from large pool |      10    |      14    |  210786    |  210776    |
|       from small pool |     874    |    2603    |  506430    |  505556    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1208 GB |    1205 GB |
|       from large pool |    1236 MB |    1616 MB |    1096 GB |    1095 GB |
|       from small pool |    1706 MB |    1709 MB |     111 GB |     109 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1208 GB |    1205 GB |
|       from large pool |    1236 MB |    1616 MB |    1096 GB |    1095 GB |
|       from small pool |    1706 MB |    1709 MB |     111 GB |     109 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1201 GB |    1201 GB |
|       from large pool |   19852 KB |     284 MB |    1066 GB |    1066 GB |
|       from small pool |   29962 KB |    1297 MB |     135 GB |     135 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1117 K  |    1104 K  |
|       from large pool |      28    |      36    |     246 K  |     246 K  |
|       from small pool |   13002    |   13012    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1117 K  |    1104 K  |
|       from large pool |      28    |      36    |     246 K  |     246 K  |
|       from small pool |   13002    |   13012    |     871 K  |     858 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |  698685    |  697807    |
|       from large pool |       7    |      11    |  193248    |  193241    |
|       from small pool |     871    |    2600    |  505437    |  504566    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 12
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0163,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1318 GB |    1315 GB |
|       from large pool |    1343 MB |    1723 MB |    1197 GB |    1195 GB |
|       from small pool |    1708 MB |    1710 MB |     121 GB |     119 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1318 GB |    1315 GB |
|       from large pool |    1343 MB |    1723 MB |    1197 GB |    1195 GB |
|       from small pool |    1708 MB |    1710 MB |     121 GB |     119 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1317 GB |    1317 GB |
|       from large pool |  157802 KB |     338 MB |    1170 GB |    1169 GB |
|       from small pool |   28552 KB |    1298 MB |     147 GB |     147 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1217 K  |    1204 K  |
|       from large pool |      61    |      69    |     269 K  |     269 K  |
|       from small pool |   13012    |   13021    |     948 K  |     935 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1217 K  |    1204 K  |
|       from large pool |      61    |      69    |     269 K  |     269 K  |
|       from small pool |   13012    |   13021    |     948 K  |     935 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |     780 K  |     780 K  |
|       from large pool |      10    |      14    |     229 K  |     229 K  |
|       from small pool |     872    |    2603    |     551 K  |     550 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1317 GB |    1314 GB |
|       from large pool |    1236 MB |    1616 MB |    1195 GB |    1194 GB |
|       from small pool |    1706 MB |    1709 MB |     121 GB |     119 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1317 GB |    1314 GB |
|       from large pool |    1236 MB |    1616 MB |    1195 GB |    1194 GB |
|       from small pool |    1706 MB |    1709 MB |     121 GB |     119 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1310 GB |    1310 GB |
|       from large pool |   19852 KB |     284 MB |    1163 GB |    1163 GB |
|       from small pool |   29962 KB |    1297 MB |     147 GB |     147 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1216 K  |    1203 K  |
|       from large pool |      28    |      36    |     268 K  |     268 K  |
|       from small pool |   13002    |   13012    |     947 K  |     934 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1216 K  |    1203 K  |
|       from large pool |      28    |      36    |     268 K  |     268 K  |
|       from small pool |   13002    |   13012    |     947 K  |     934 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |     760 K  |     759 K  |
|       from large pool |       7    |      11    |     210 K  |     210 K  |
|       from small pool |     871    |    2600    |     549 K  |     549 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 13
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0175,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1428 GB |    1425 GB |
|       from large pool |    1343 MB |    1723 MB |    1296 GB |    1295 GB |
|       from small pool |    1708 MB |    1710 MB |     131 GB |     129 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1428 GB |    1425 GB |
|       from large pool |    1343 MB |    1723 MB |    1296 GB |    1295 GB |
|       from small pool |    1708 MB |    1710 MB |     131 GB |     129 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1426 GB |    1426 GB |
|       from large pool |  157802 KB |     338 MB |    1267 GB |    1267 GB |
|       from small pool |   28552 KB |    1298 MB |     159 GB |     159 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1315 K  |    1302 K  |
|       from large pool |      61    |      69    |     291 K  |     291 K  |
|       from small pool |   13012    |   13021    |    1024 K  |    1011 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1315 K  |    1302 K  |
|       from large pool |      61    |      69    |     291 K  |     291 K  |
|       from small pool |   13012    |   13021    |    1024 K  |    1011 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |     844 K  |     843 K  |
|       from large pool |      10    |      14    |     249 K  |     249 K  |
|       from small pool |     874    |    2603    |     595 K  |     594 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1426 GB |    1423 GB |
|       from large pool |    1236 MB |    1616 MB |    1295 GB |    1294 GB |
|       from small pool |    1706 MB |    1709 MB |     131 GB |     129 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1426 GB |    1423 GB |
|       from large pool |    1236 MB |    1616 MB |    1295 GB |    1294 GB |
|       from small pool |    1706 MB |    1709 MB |     131 GB |     129 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1419 GB |    1419 GB |
|       from large pool |   19852 KB |     284 MB |    1260 GB |    1260 GB |
|       from small pool |   29962 KB |    1297 MB |     159 GB |     159 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1314 K  |    1301 K  |
|       from large pool |      28    |      36    |     291 K  |     291 K  |
|       from small pool |   13002    |   13012    |    1023 K  |    1010 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1314 K  |    1301 K  |
|       from large pool |      28    |      36    |     291 K  |     291 K  |
|       from small pool |   13002    |   13012    |    1023 K  |    1010 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |     822 K  |     822 K  |
|       from large pool |       7    |      11    |     228 K  |     228 K  |
|       from small pool |     871    |    2600    |     594 K  |     593 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 14
batch input size: torch.Size([32, 1855]) Device: batch input size:0
torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0078,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1537 GB |    1534 GB |
|       from large pool |    1343 MB |    1723 MB |    1396 GB |    1395 GB |
|       from small pool |    1708 MB |    1710 MB |     140 GB |     139 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1537 GB |    1534 GB |
|       from large pool |    1343 MB |    1723 MB |    1396 GB |    1395 GB |
|       from small pool |    1708 MB |    1710 MB |     140 GB |     139 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1535 GB |    1535 GB |
|       from large pool |  157802 KB |     338 MB |    1365 GB |    1364 GB |
|       from small pool |   28552 KB |    1298 MB |     170 GB |     170 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1414 K  |    1401 K  |
|       from large pool |      61    |      69    |     314 K  |     314 K  |
|       from small pool |   13012    |   13021    |    1100 K  |    1087 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1414 K  |    1401 K  |
|       from large pool |      61    |      69    |     314 K  |     314 K  |
|       from small pool |   13012    |   13021    |    1100 K  |    1087 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |     908 K  |     907 K  |
|       from large pool |      10    |      14    |     268 K  |     268 K  |
|       from small pool |     873    |    2603    |     640 K  |     639 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1535 GB |    1533 GB |
|       from large pool |    1236 MB |    1616 MB |    1395 GB |    1393 GB |
|       from small pool |    1706 MB |    1709 MB |     140 GB |     139 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1535 GB |    1533 GB |
|       from large pool |    1236 MB |    1616 MB |    1395 GB |    1393 GB |
|       from small pool |    1706 MB |    1709 MB |     140 GB |     139 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1528 GB |    1528 GB |
|       from large pool |   19852 KB |     284 MB |    1357 GB |    1357 GB |
|       from small pool |   29962 KB |    1297 MB |     170 GB |     170 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1413 K  |    1400 K  |
|       from large pool |      28    |      36    |     313 K  |     313 K  |
|       from small pool |   13002    |   13012    |    1099 K  |    1086 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1413 K  |    1400 K  |
|       from large pool |      28    |      36    |     313 K  |     313 K  |
|       from small pool |   13002    |   13012    |    1099 K  |    1086 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |     885 K  |     884 K  |
|       from large pool |       7    |      11    |     245 K  |     245 K  |
|       from small pool |     871    |    2600    |     639 K  |     638 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 15
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0097,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1646 GB |    1643 GB |
|       from large pool |    1343 MB |    1723 MB |    1496 GB |    1494 GB |
|       from small pool |    1708 MB |    1710 MB |     150 GB |     149 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1646 GB |    1643 GB |
|       from large pool |    1343 MB |    1723 MB |    1496 GB |    1494 GB |
|       from small pool |    1708 MB |    1710 MB |     150 GB |     149 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1645 GB |    1645 GB |
|       from large pool |  157802 KB |     338 MB |    1462 GB |    1462 GB |
|       from small pool |   28552 KB |    1298 MB |     182 GB |     182 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1513 K  |    1500 K  |
|       from large pool |      61    |      69    |     336 K  |     336 K  |
|       from small pool |   13012    |   13021    |    1176 K  |    1163 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1513 K  |    1500 K  |
|       from large pool |      61    |      69    |     336 K  |     336 K  |
|       from small pool |   13012    |   13021    |    1176 K  |    1163 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |     972 K  |     971 K  |
|       from large pool |      10    |      14    |     287 K  |     287 K  |
|       from small pool |     873    |    2603    |     684 K  |     684 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1645 GB |    1642 GB |
|       from large pool |    1236 MB |    1616 MB |    1494 GB |    1493 GB |
|       from small pool |    1706 MB |    1709 MB |     150 GB |     149 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1645 GB |    1642 GB |
|       from large pool |    1236 MB |    1616 MB |    1494 GB |    1493 GB |
|       from small pool |    1706 MB |    1709 MB |     150 GB |     149 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1637 GB |    1636 GB |
|       from large pool |   19852 KB |     284 MB |    1454 GB |    1454 GB |
|       from small pool |   29962 KB |    1297 MB |     182 GB |     182 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1511 K  |    1498 K  |
|       from large pool |      28    |      36    |     336 K  |     336 K  |
|       from small pool |   13002    |   13012    |    1175 K  |    1162 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1511 K  |    1498 K  |
|       from large pool |      28    |      36    |     336 K  |     336 K  |
|       from small pool |   13002    |   13012    |    1175 K  |    1162 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |     947 K  |     946 K  |
|       from large pool |       7    |      11    |     263 K  |     263 K  |
|       from small pool |     871    |    2600    |     683 K  |     682 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 16
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0273,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1756 GB |    1753 GB |
|       from large pool |    1343 MB |    1723 MB |    1595 GB |    1594 GB |
|       from small pool |    1708 MB |    1710 MB |     160 GB |     158 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1756 GB |    1753 GB |
|       from large pool |    1343 MB |    1723 MB |    1595 GB |    1594 GB |
|       from small pool |    1708 MB |    1710 MB |     160 GB |     158 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1754 GB |    1754 GB |
|       from large pool |  157802 KB |     338 MB |    1560 GB |    1559 GB |
|       from small pool |   28552 KB |    1298 MB |     194 GB |     194 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1611 K  |    1598 K  |
|       from large pool |      61    |      69    |     358 K  |     358 K  |
|       from small pool |   13012    |   13021    |    1252 K  |    1239 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1611 K  |    1598 K  |
|       from large pool |      61    |      69    |     358 K  |     358 K  |
|       from small pool |   13012    |   13021    |    1252 K  |    1239 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1036 K  |    1035 K  |
|       from large pool |      10    |      14    |     306 K  |     306 K  |
|       from small pool |     873    |    2603    |     729 K  |     728 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1754 GB |    1751 GB |
|       from large pool |    1236 MB |    1616 MB |    1594 GB |    1592 GB |
|       from small pool |    1706 MB |    1709 MB |     160 GB |     158 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1754 GB |    1751 GB |
|       from large pool |    1236 MB |    1616 MB |    1594 GB |    1592 GB |
|       from small pool |    1706 MB |    1709 MB |     160 GB |     158 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1745 GB |    1745 GB |
|       from large pool |   19852 KB |     284 MB |    1551 GB |    1551 GB |
|       from small pool |   29962 KB |    1297 MB |     194 GB |     194 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1610 K  |    1597 K  |
|       from large pool |      28    |      36    |     358 K  |     358 K  |
|       from small pool |   13002    |   13012    |    1251 K  |    1238 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1610 K  |    1597 K  |
|       from large pool |      28    |      36    |     358 K  |     358 K  |
|       from small pool |   13002    |   13012    |    1251 K  |    1238 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1009 K  |    1008 K  |
|       from large pool |       7    |      11    |     281 K  |     281 K  |
|       from small pool |     871    |    2600    |     728 K  |     727 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 17
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0181,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1865 GB |    1862 GB |
|       from large pool |    1343 MB |    1723 MB |    1695 GB |    1693 GB |
|       from small pool |    1708 MB |    1710 MB |     170 GB |     168 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1865 GB |    1862 GB |
|       from large pool |    1343 MB |    1723 MB |    1695 GB |    1693 GB |
|       from small pool |    1708 MB |    1710 MB |     170 GB |     168 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1864 GB |    1863 GB |
|       from large pool |  157802 KB |     338 MB |    1657 GB |    1657 GB |
|       from small pool |   28552 KB |    1298 MB |     206 GB |     206 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1710 K  |    1697 K  |
|       from large pool |      61    |      69    |     381 K  |     381 K  |
|       from small pool |   13012    |   13021    |    1329 K  |    1316 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1710 K  |    1697 K  |
|       from large pool |      61    |      69    |     381 K  |     381 K  |
|       from small pool |   13012    |   13021    |    1329 K  |    1316 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    1099 K  |    1099 K  |
|       from large pool |      10    |      14    |     325 K  |     325 K  |
|       from small pool |     874    |    2603    |     774 K  |     773 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1863 GB |    1860 GB |
|       from large pool |    1236 MB |    1616 MB |    1693 GB |    1692 GB |
|       from small pool |    1706 MB |    1709 MB |     170 GB |     168 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1863 GB |    1860 GB |
|       from large pool |    1236 MB |    1616 MB |    1693 GB |    1692 GB |
|       from small pool |    1706 MB |    1709 MB |     170 GB |     168 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1854 GB |    1854 GB |
|       from large pool |   19852 KB |     284 MB |    1648 GB |    1648 GB |
|       from small pool |   29962 KB |    1297 MB |     206 GB |     206 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1708 K  |    1695 K  |
|       from large pool |      28    |      36    |     380 K  |     380 K  |
|       from small pool |   13002    |   13012    |    1327 K  |    1314 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1708 K  |    1695 K  |
|       from large pool |      28    |      36    |     380 K  |     380 K  |
|       from small pool |   13002    |   13012    |    1327 K  |    1314 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1071 K  |    1070 K  |
|       from large pool |       7    |      11    |     298 K  |     298 K  |
|       from small pool |     871    |    2600    |     772 K  |     771 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 18
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0208,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    1974 GB |    1971 GB |
|       from large pool |    1343 MB |    1723 MB |    1794 GB |    1793 GB |
|       from small pool |    1708 MB |    1710 MB |     179 GB |     178 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    1974 GB |    1971 GB |
|       from large pool |    1343 MB |    1723 MB |    1794 GB |    1793 GB |
|       from small pool |    1708 MB |    1710 MB |     179 GB |     178 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    1973 GB |    1973 GB |
|       from large pool |  157802 KB |     338 MB |    1755 GB |    1754 GB |
|       from small pool |   28552 KB |    1298 MB |     218 GB |     218 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1809 K  |    1796 K  |
|       from large pool |      61    |      69    |     403 K  |     403 K  |
|       from small pool |   13012    |   13021    |    1405 K  |    1392 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1809 K  |    1796 K  |
|       from large pool |      61    |      69    |     403 K  |     403 K  |
|       from small pool |   13012    |   13021    |    1405 K  |    1392 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    1163 K  |    1162 K  |
|       from large pool |      10    |      14    |     344 K  |     344 K  |
|       from small pool |     872    |    2603    |     818 K  |     817 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    1973 GB |    1970 GB |
|       from large pool |    1236 MB |    1616 MB |    1793 GB |    1791 GB |
|       from small pool |    1706 MB |    1709 MB |     179 GB |     178 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    1973 GB |    1970 GB |
|       from large pool |    1236 MB |    1616 MB |    1793 GB |    1791 GB |
|       from small pool |    1706 MB |    1709 MB |     179 GB |     178 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    1963 GB |    1963 GB |
|       from large pool |   19852 KB |     284 MB |    1745 GB |    1745 GB |
|       from small pool |   29962 KB |    1297 MB |     218 GB |     218 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1807 K  |    1794 K  |
|       from large pool |      28    |      36    |     403 K  |     403 K  |
|       from small pool |   13002    |   13012    |    1404 K  |    1391 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1807 K  |    1794 K  |
|       from large pool |      28    |      36    |     403 K  |     403 K  |
|       from small pool |   13002    |   13012    |    1404 K  |    1391 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1133 K  |    1132 K  |
|       from large pool |       7    |      11    |     316 K  |     316 K  |
|       from small pool |     871    |    2600    |     817 K  |     816 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 19
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0117,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2084 GB |    2081 GB |
|       from large pool |    1343 MB |    1723 MB |    1894 GB |    1893 GB |
|       from small pool |    1708 MB |    1710 MB |     189 GB |     188 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2084 GB |    2081 GB |
|       from large pool |    1343 MB |    1723 MB |    1894 GB |    1893 GB |
|       from small pool |    1708 MB |    1710 MB |     189 GB |     188 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2082 GB |    2082 GB |
|       from large pool |  157802 KB |     338 MB |    1852 GB |    1852 GB |
|       from small pool |   28552 KB |    1298 MB |     230 GB |     230 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    1907 K  |    1894 K  |
|       from large pool |      61    |      69    |     426 K  |     426 K  |
|       from small pool |   13012    |   13021    |    1481 K  |    1468 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    1907 K  |    1894 K  |
|       from large pool |      61    |      69    |     426 K  |     426 K  |
|       from small pool |   13012    |   13021    |    1481 K  |    1468 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    1227 K  |    1226 K  |
|       from large pool |      10    |      14    |     364 K  |     364 K  |
|       from small pool |     874    |    2603    |     863 K  |     862 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2082 GB |    2079 GB |
|       from large pool |    1236 MB |    1616 MB |    1892 GB |    1891 GB |
|       from small pool |    1706 MB |    1709 MB |     189 GB |     188 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2082 GB |    2079 GB |
|       from large pool |    1236 MB |    1616 MB |    1892 GB |    1891 GB |
|       from small pool |    1706 MB |    1709 MB |     189 GB |     188 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2072 GB |    2072 GB |
|       from large pool |   19852 KB |     284 MB |    1841 GB |    1841 GB |
|       from small pool |   29962 KB |    1297 MB |     230 GB |     230 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    1905 K  |    1892 K  |
|       from large pool |      28    |      36    |     425 K  |     425 K  |
|       from small pool |   13002    |   13012    |    1480 K  |    1467 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    1905 K  |    1892 K  |
|       from large pool |      28    |      36    |     425 K  |     425 K  |
|       from small pool |   13002    |   13012    |    1480 K  |    1467 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1195 K  |    1194 K  |
|       from large pool |       7    |      11    |     333 K  |     333 K  |
|       from small pool |     871    |    2600    |     861 K  |     860 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 20
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0122,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2193 GB |    2190 GB |
|       from large pool |    1343 MB |    1723 MB |    1994 GB |    1992 GB |
|       from small pool |    1708 MB |    1710 MB |     199 GB |     197 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2193 GB |    2190 GB |
|       from large pool |    1343 MB |    1723 MB |    1994 GB |    1992 GB |
|       from small pool |    1708 MB |    1710 MB |     199 GB |     197 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2192 GB |    2191 GB |
|       from large pool |  157802 KB |     338 MB |    1949 GB |    1949 GB |
|       from small pool |   28552 KB |    1298 MB |     242 GB |     242 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2006 K  |    1993 K  |
|       from large pool |      61    |      69    |     448 K  |     448 K  |
|       from small pool |   13012    |   13021    |    1557 K  |    1544 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2006 K  |    1993 K  |
|       from large pool |      61    |      69    |     448 K  |     448 K  |
|       from small pool |   13012    |   13021    |    1557 K  |    1544 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1291 K  |    1290 K  |
|       from large pool |      10    |      14    |     383 K  |     383 K  |
|       from small pool |     873    |    2603    |     908 K  |     907 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2191 GB |    2188 GB |
|       from large pool |    1236 MB |    1616 MB |    1992 GB |    1990 GB |
|       from small pool |    1706 MB |    1709 MB |     199 GB |     197 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2191 GB |    2188 GB |
|       from large pool |    1236 MB |    1616 MB |    1992 GB |    1990 GB |
|       from small pool |    1706 MB |    1709 MB |     199 GB |     197 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2181 GB |    2180 GB |
|       from large pool |   19852 KB |     284 MB |    1938 GB |    1938 GB |
|       from small pool |   29962 KB |    1297 MB |     242 GB |     242 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2004 K  |    1991 K  |
|       from large pool |      28    |      36    |     448 K  |     448 K  |
|       from small pool |   13002    |   13012    |    1556 K  |    1543 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2004 K  |    1991 K  |
|       from large pool |      28    |      36    |     448 K  |     448 K  |
|       from small pool |   13002    |   13012    |    1556 K  |    1543 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1257 K  |    1256 K  |
|       from large pool |       7    |      11    |     351 K  |     351 K  |
|       from small pool |     871    |    2600    |     906 K  |     905 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 21
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0134,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2303 GB |    2300 GB |
|       from large pool |    1343 MB |    1723 MB |    2093 GB |    2092 GB |
|       from small pool |    1708 MB |    1710 MB |     209 GB |     207 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2303 GB |    2300 GB |
|       from large pool |    1343 MB |    1723 MB |    2093 GB |    2092 GB |
|       from small pool |    1708 MB |    1710 MB |     209 GB |     207 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2301 GB |    2301 GB |
|       from large pool |  157802 KB |     338 MB |    2047 GB |    2047 GB |
|       from small pool |   28552 KB |    1298 MB |     253 GB |     253 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2105 K  |    2091 K  |
|       from large pool |      61    |      69    |     471 K  |     470 K  |
|       from small pool |   13012    |   13021    |    1633 K  |    1620 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2105 K  |    2091 K  |
|       from large pool |      61    |      69    |     471 K  |     470 K  |
|       from small pool |   13012    |   13021    |    1633 K  |    1620 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1355 K  |    1354 K  |
|       from large pool |      10    |      14    |     402 K  |     402 K  |
|       from small pool |     873    |    2603    |     952 K  |     951 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2300 GB |    2298 GB |
|       from large pool |    1236 MB |    1616 MB |    2091 GB |    2090 GB |
|       from small pool |    1706 MB |    1709 MB |     209 GB |     207 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2300 GB |    2298 GB |
|       from large pool |    1236 MB |    1616 MB |    2091 GB |    2090 GB |
|       from small pool |    1706 MB |    1709 MB |     209 GB |     207 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2289 GB |    2289 GB |
|       from large pool |   19852 KB |     284 MB |    2035 GB |    2035 GB |
|       from small pool |   29962 KB |    1297 MB |     253 GB |     253 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2102 K  |    2089 K  |
|       from large pool |      28    |      36    |     470 K  |     470 K  |
|       from small pool |   13002    |   13012    |    1632 K  |    1619 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2102 K  |    2089 K  |
|       from large pool |      28    |      36    |     470 K  |     470 K  |
|       from small pool |   13002    |   13012    |    1632 K  |    1619 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1319 K  |    1318 K  |
|       from large pool |       7    |      11    |     368 K  |     368 K  |
|       from small pool |     871    |    2600    |     950 K  |     950 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 22
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0093,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2412 GB |    2409 GB |
|       from large pool |    1343 MB |    1723 MB |    2193 GB |    2192 GB |
|       from small pool |    1708 MB |    1710 MB |     219 GB |     217 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2412 GB |    2409 GB |
|       from large pool |    1343 MB |    1723 MB |    2193 GB |    2192 GB |
|       from small pool |    1708 MB |    1710 MB |     219 GB |     217 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2410 GB |    2410 GB |
|       from large pool |  157802 KB |     338 MB |    2144 GB |    2144 GB |
|       from small pool |   28552 KB |    1298 MB |     265 GB |     265 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2203 K  |    2190 K  |
|       from large pool |      61    |      69    |     493 K  |     493 K  |
|       from small pool |   13012    |   13021    |    1710 K  |    1697 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2203 K  |    2190 K  |
|       from large pool |      61    |      69    |     493 K  |     493 K  |
|       from small pool |   13012    |   13021    |    1710 K  |    1697 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1418 K  |    1417 K  |
|       from large pool |      10    |      14    |     421 K  |     421 K  |
|       from small pool |     873    |    2603    |     997 K  |     996 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2410 GB |    2407 GB |
|       from large pool |    1236 MB |    1616 MB |    2191 GB |    2190 GB |
|       from small pool |    1706 MB |    1709 MB |     219 GB |     217 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2410 GB |    2407 GB |
|       from large pool |    1236 MB |    1616 MB |    2191 GB |    2190 GB |
|       from small pool |    1706 MB |    1709 MB |     219 GB |     217 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2398 GB |    2398 GB |
|       from large pool |   19852 KB |     284 MB |    2132 GB |    2132 GB |
|       from small pool |   29962 KB |    1297 MB |     265 GB |     265 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2201 K  |    2188 K  |
|       from large pool |      28    |      36    |     492 K  |     492 K  |
|       from small pool |   13002    |   13012    |    1708 K  |    1695 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2201 K  |    2188 K  |
|       from large pool |      28    |      36    |     492 K  |     492 K  |
|       from small pool |   13002    |   13012    |    1708 K  |    1695 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1381 K  |    1381 K  |
|       from large pool |       7    |      11    |     386 K  |     386 K  |
|       from small pool |     871    |    2600    |     995 K  |     994 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 23
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0111,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2521 GB |    2518 GB |
|       from large pool |    1343 MB |    1723 MB |    2293 GB |    2291 GB |
|       from small pool |    1708 MB |    1710 MB |     228 GB |     227 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2521 GB |    2518 GB |
|       from large pool |    1343 MB |    1723 MB |    2293 GB |    2291 GB |
|       from small pool |    1708 MB |    1710 MB |     228 GB |     227 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2520 GB |    2519 GB |
|       from large pool |  157802 KB |     338 MB |    2242 GB |    2242 GB |
|       from small pool |   28552 KB |    1298 MB |     277 GB |     277 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2302 K  |    2289 K  |
|       from large pool |      61    |      69    |     515 K  |     515 K  |
|       from small pool |   13012    |   13021    |    1786 K  |    1773 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2302 K  |    2289 K  |
|       from large pool |      61    |      69    |     515 K  |     515 K  |
|       from small pool |   13012    |   13021    |    1786 K  |    1773 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    1482 K  |    1481 K  |
|       from large pool |      10    |      14    |     440 K  |     440 K  |
|       from small pool |     874    |    2603    |    1041 K  |    1040 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2519 GB |    2516 GB |
|       from large pool |    1236 MB |    1616 MB |    2290 GB |    2289 GB |
|       from small pool |    1706 MB |    1709 MB |     228 GB |     227 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2519 GB |    2516 GB |
|       from large pool |    1236 MB |    1616 MB |    2290 GB |    2289 GB |
|       from small pool |    1706 MB |    1709 MB |     228 GB |     227 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2507 GB |    2507 GB |
|       from large pool |   19852 KB |     284 MB |    2229 GB |    2229 GB |
|       from small pool |   29962 KB |    1297 MB |     277 GB |     277 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2300 K  |    2287 K  |
|       from large pool |      28    |      36    |     515 K  |     515 K  |
|       from small pool |   13002    |   13012    |    1784 K  |    1771 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2300 K  |    2287 K  |
|       from large pool |      28    |      36    |     515 K  |     515 K  |
|       from small pool |   13002    |   13012    |    1784 K  |    1771 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1444 K  |    1443 K  |
|       from large pool |       7    |      11    |     404 K  |     404 K  |
|       from small pool |     871    |    2600    |    1040 K  |    1039 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
step loss: tensor([0.0123,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2631 GB |    2628 GB |
|       from large pool |    1343 MB |    1723 MB |    2392 GB |    2391 GB |
|       from small pool |    1708 MB |    1710 MB |     238 GB |     236 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2631 GB |    2628 GB |
|       from large pool |    1343 MB |    1723 MB |    2392 GB |    2391 GB |
|       from small pool |    1708 MB |    1710 MB |     238 GB |     236 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2629 GB |    2629 GB |
|       from large pool |  157802 KB |     338 MB |    2339 GB |    2339 GB |
|       from small pool |   28552 KB |    1298 MB |     289 GB |     289 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2400 K  |    2387 K  |
|       from large pool |      61    |      69    |     538 K  |     538 K  |
|       from small pool |   13012    |   13021    |    1862 K  |    1849 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2400 K  |    2387 K  |
|       from large pool |      61    |      69    |     538 K  |     538 K  |
|       from small pool |   13012    |   13021    |    1862 K  |    1849 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    1546 K  |    1545 K  |
|       from large pool |      10    |      14    |     459 K  |     459 K  |
|       from small pool |     872    |    2603    |    1086 K  |    1085 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2628 GB |    2625 GB |
|       from large pool |    1236 MB |    1616 MB |    2390 GB |    2389 GB |
|       from small pool |    1706 MB |    1709 MB |     238 GB |     236 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2628 GB |    2625 GB |
|       from large pool |    1236 MB |    1616 MB |    2390 GB |    2389 GB |
|       from small pool |    1706 MB |    1709 MB |     238 GB |     236 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2616 GB |    2616 GB |
|       from large pool |   19852 KB |     284 MB |    2326 GB |    2326 GB |
|       from small pool |   29962 KB |    1297 MB |     289 GB |     289 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2398 K  |    2385 K  |
|       from large pool |      28    |      36    |     537 K  |     537 K  |
|       from small pool |   13002    |   13012    |    1860 K  |    1847 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2398 K  |    2385 K  |
|       from large pool |      28    |      36    |     537 K  |     537 K  |
|       from small pool |   13002    |   13012    |    1860 K  |    1847 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1506 K  |    1505 K  |
|       from large pool |       7    |      11    |     421 K  |     421 K  |
|       from small pool |     871    |    2600    |    1084 K  |    1083 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 25
batch input size: torch.Size([32, 1855]) Device: 0batch input size:
 torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0272,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2740 GB |    2737 GB |
|       from large pool |    1343 MB |    1723 MB |    2492 GB |    2490 GB |
|       from small pool |    1708 MB |    1710 MB |     248 GB |     246 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2740 GB |    2737 GB |
|       from large pool |    1343 MB |    1723 MB |    2492 GB |    2490 GB |
|       from small pool |    1708 MB |    1710 MB |     248 GB |     246 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2738 GB |    2738 GB |
|       from large pool |  157802 KB |     338 MB |    2437 GB |    2437 GB |
|       from small pool |   28552 KB |    1298 MB |     301 GB |     301 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2499 K  |    2486 K  |
|       from large pool |      61    |      69    |     560 K  |     560 K  |
|       from small pool |   13012    |   13021    |    1938 K  |    1925 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2499 K  |    2486 K  |
|       from large pool |      61    |      69    |     560 K  |     560 K  |
|       from small pool |   13012    |   13021    |    1938 K  |    1925 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    1610 K  |    1609 K  |
|       from large pool |      10    |      14    |     479 K  |     479 K  |
|       from small pool |     874    |    2603    |    1131 K  |    1130 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2738 GB |    2735 GB |
|       from large pool |    1236 MB |    1616 MB |    2489 GB |    2488 GB |
|       from small pool |    1706 MB |    1709 MB |     248 GB |     246 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2738 GB |    2735 GB |
|       from large pool |    1236 MB |    1616 MB |    2489 GB |    2488 GB |
|       from small pool |    1706 MB |    1709 MB |     248 GB |     246 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2725 GB |    2724 GB |
|       from large pool |   19852 KB |     284 MB |    2423 GB |    2423 GB |
|       from small pool |   29962 KB |    1297 MB |     301 GB |     301 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2497 K  |    2484 K  |
|       from large pool |      28    |      36    |     560 K  |     560 K  |
|       from small pool |   13002    |   13012    |    1937 K  |    1924 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2497 K  |    2484 K  |
|       from large pool |      28    |      36    |     560 K  |     560 K  |
|       from small pool |   13002    |   13012    |    1937 K  |    1924 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1568 K  |    1567 K  |
|       from large pool |       7    |      11    |     439 K  |     439 K  |
|       from small pool |     871    |    2600    |    1129 K  |    1128 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 26
batch input size: torch.Size([32, 1855])batch input size:  Device:torch.Size([32, 1855])  0Device:
 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0099,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2849 GB |    2846 GB |
|       from large pool |    1343 MB |    1723 MB |    2591 GB |    2590 GB |
|       from small pool |    1708 MB |    1710 MB |     258 GB |     256 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2849 GB |    2846 GB |
|       from large pool |    1343 MB |    1723 MB |    2591 GB |    2590 GB |
|       from small pool |    1708 MB |    1710 MB |     258 GB |     256 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2848 GB |    2847 GB |
|       from large pool |  157802 KB |     338 MB |    2534 GB |    2534 GB |
|       from small pool |   28552 KB |    1298 MB |     313 GB |     313 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2598 K  |    2585 K  |
|       from large pool |      61    |      69    |     583 K  |     583 K  |
|       from small pool |   13012    |   13021    |    2015 K  |    2001 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2598 K  |    2585 K  |
|       from large pool |      61    |      69    |     583 K  |     583 K  |
|       from small pool |   13012    |   13021    |    2015 K  |    2001 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1673 K  |    1673 K  |
|       from large pool |      10    |      14    |     498 K  |     498 K  |
|       from small pool |     873    |    2603    |    1175 K  |    1174 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2847 GB |    2844 GB |
|       from large pool |    1236 MB |    1616 MB |    2589 GB |    2588 GB |
|       from small pool |    1706 MB |    1709 MB |     258 GB |     256 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2847 GB |    2844 GB |
|       from large pool |    1236 MB |    1616 MB |    2589 GB |    2588 GB |
|       from small pool |    1706 MB |    1709 MB |     258 GB |     256 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2833 GB |    2833 GB |
|       from large pool |   19852 KB |     284 MB |    2520 GB |    2520 GB |
|       from small pool |   29962 KB |    1297 MB |     313 GB |     313 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2595 K  |    2582 K  |
|       from large pool |      28    |      36    |     582 K  |     582 K  |
|       from small pool |   13002    |   13012    |    2013 K  |    2000 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2595 K  |    2582 K  |
|       from large pool |      28    |      36    |     582 K  |     582 K  |
|       from small pool |   13002    |   13012    |    2013 K  |    2000 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1630 K  |    1629 K  |
|       from large pool |       7    |      11    |     456 K  |     456 K  |
|       from small pool |     871    |    2600    |    1173 K  |    1172 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 27
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0076,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    2959 GB |    2956 GB |
|       from large pool |    1343 MB |    1723 MB |    2691 GB |    2690 GB |
|       from small pool |    1708 MB |    1710 MB |     267 GB |     266 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    2959 GB |    2956 GB |
|       from large pool |    1343 MB |    1723 MB |    2691 GB |    2690 GB |
|       from small pool |    1708 MB |    1710 MB |     267 GB |     266 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    2957 GB |    2957 GB |
|       from large pool |  157802 KB |     338 MB |    2632 GB |    2632 GB |
|       from small pool |   28552 KB |    1298 MB |     325 GB |     325 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2696 K  |    2683 K  |
|       from large pool |      61    |      69    |     605 K  |     605 K  |
|       from small pool |   13012    |   13021    |    2091 K  |    2078 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2696 K  |    2683 K  |
|       from large pool |      61    |      69    |     605 K  |     605 K  |
|       from small pool |   13012    |   13021    |    2091 K  |    2078 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1737 K  |    1736 K  |
|       from large pool |      10    |      14    |     517 K  |     517 K  |
|       from small pool |     873    |    2603    |    1220 K  |    1219 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    2956 GB |    2953 GB |
|       from large pool |    1236 MB |    1616 MB |    2688 GB |    2687 GB |
|       from small pool |    1706 MB |    1709 MB |     267 GB |     266 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    2956 GB |    2953 GB |
|       from large pool |    1236 MB |    1616 MB |    2688 GB |    2687 GB |
|       from small pool |    1706 MB |    1709 MB |     267 GB |     266 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    2942 GB |    2942 GB |
|       from large pool |   19852 KB |     284 MB |    2617 GB |    2617 GB |
|       from small pool |   29962 KB |    1297 MB |     325 GB |     325 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2694 K  |    2681 K  |
|       from large pool |      28    |      36    |     604 K  |     604 K  |
|       from small pool |   13002    |   13012    |    2089 K  |    2076 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2694 K  |    2681 K  |
|       from large pool |      28    |      36    |     604 K  |     604 K  |
|       from small pool |   13002    |   13012    |    2089 K  |    2076 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1692 K  |    1691 K  |
|       from large pool |       7    |      11    |     474 K  |     474 K  |
|       from small pool |     871    |    2600    |    1218 K  |    1217 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 28
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0135,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3068 GB |    3065 GB |
|       from large pool |    1343 MB |    1723 MB |    2791 GB |    2789 GB |
|       from small pool |    1708 MB |    1710 MB |     277 GB |     275 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3068 GB |    3065 GB |
|       from large pool |    1343 MB |    1723 MB |    2791 GB |    2789 GB |
|       from small pool |    1708 MB |    1710 MB |     277 GB |     275 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3066 GB |    3066 GB |
|       from large pool |  157802 KB |     338 MB |    2729 GB |    2729 GB |
|       from small pool |   28552 KB |    1298 MB |     336 GB |     336 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2795 K  |    2782 K  |
|       from large pool |      61    |      69    |     628 K  |     627 K  |
|       from small pool |   13012    |   13021    |    2167 K  |    2154 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2795 K  |    2782 K  |
|       from large pool |      61    |      69    |     628 K  |     627 K  |
|       from small pool |   13012    |   13021    |    2167 K  |    2154 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    1801 K  |    1800 K  |
|       from large pool |      10    |      14    |     536 K  |     536 K  |
|       from small pool |     873    |    2603    |    1264 K  |    1264 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3065 GB |    3063 GB |
|       from large pool |    1236 MB |    1616 MB |    2788 GB |    2787 GB |
|       from small pool |    1706 MB |    1709 MB |     277 GB |     275 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3065 GB |    3063 GB |
|       from large pool |    1236 MB |    1616 MB |    2788 GB |    2787 GB |
|       from small pool |    1706 MB |    1709 MB |     277 GB |     275 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3051 GB |    3051 GB |
|       from large pool |   19852 KB |     284 MB |    2714 GB |    2714 GB |
|       from small pool |   29962 KB |    1297 MB |     336 GB |     336 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2792 K  |    2779 K  |
|       from large pool |      28    |      36    |     627 K  |     627 K  |
|       from small pool |   13002    |   13012    |    2165 K  |    2152 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2792 K  |    2779 K  |
|       from large pool |      28    |      36    |     627 K  |     627 K  |
|       from small pool |   13002    |   13012    |    2165 K  |    2152 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1754 K  |    1753 K  |
|       from large pool |       7    |      11    |     491 K  |     491 K  |
|       from small pool |     871    |    2600    |    1262 K  |    1261 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 29
batch input size: torch.Size([32, 1855]) Device: 0batch input size:
 torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0102,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3178 GB |    3175 GB |
|       from large pool |    1343 MB |    1723 MB |    2890 GB |    2889 GB |
|       from small pool |    1708 MB |    1710 MB |     287 GB |     285 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3178 GB |    3175 GB |
|       from large pool |    1343 MB |    1723 MB |    2890 GB |    2889 GB |
|       from small pool |    1708 MB |    1710 MB |     287 GB |     285 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3176 GB |    3176 GB |
|       from large pool |  157802 KB |     338 MB |    2827 GB |    2827 GB |
|       from small pool |   28552 KB |    1298 MB |     348 GB |     348 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2894 K  |    2881 K  |
|       from large pool |      61    |      69    |     650 K  |     650 K  |
|       from small pool |   13012    |   13021    |    2243 K  |    2230 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2894 K  |    2881 K  |
|       from large pool |      61    |      69    |     650 K  |     650 K  |
|       from small pool |   13012    |   13021    |    2243 K  |    2230 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    1865 K  |    1864 K  |
|       from large pool |      10    |      14    |     555 K  |     555 K  |
|       from small pool |     874    |    2603    |    1309 K  |    1308 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3175 GB |    3172 GB |
|       from large pool |    1236 MB |    1616 MB |    2887 GB |    2886 GB |
|       from small pool |    1706 MB |    1709 MB |     287 GB |     285 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3175 GB |    3172 GB |
|       from large pool |    1236 MB |    1616 MB |    2887 GB |    2886 GB |
|       from small pool |    1706 MB |    1709 MB |     287 GB |     285 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3160 GB |    3160 GB |
|       from large pool |   19852 KB |     284 MB |    2811 GB |    2811 GB |
|       from small pool |   29962 KB |    1297 MB |     348 GB |     348 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2891 K  |    2878 K  |
|       from large pool |      28    |      36    |     649 K  |     649 K  |
|       from small pool |   13002    |   13012    |    2241 K  |    2228 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2891 K  |    2878 K  |
|       from large pool |      28    |      36    |     649 K  |     649 K  |
|       from small pool |   13002    |   13012    |    2241 K  |    2228 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1816 K  |    1815 K  |
|       from large pool |       7    |      11    |     509 K  |     509 K  |
|       from small pool |     871    |    2600    |    1307 K  |    1306 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 30
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0148,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3287 GB |    3284 GB |
|       from large pool |    1343 MB |    1723 MB |    2990 GB |    2989 GB |
|       from small pool |    1708 MB |    1710 MB |     297 GB |     295 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3287 GB |    3284 GB |
|       from large pool |    1343 MB |    1723 MB |    2990 GB |    2989 GB |
|       from small pool |    1708 MB |    1710 MB |     297 GB |     295 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3285 GB |    3285 GB |
|       from large pool |  157802 KB |     338 MB |    2924 GB |    2924 GB |
|       from small pool |   28552 KB |    1298 MB |     360 GB |     360 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    2992 K  |    2979 K  |
|       from large pool |      61    |      69    |     672 K  |     672 K  |
|       from small pool |   13012    |   13021    |    2319 K  |    2306 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    2992 K  |    2979 K  |
|       from large pool |      61    |      69    |     672 K  |     672 K  |
|       from small pool |   13012    |   13021    |    2319 K  |    2306 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    1929 K  |    1928 K  |
|       from large pool |      10    |      14    |     574 K  |     574 K  |
|       from small pool |     872    |    2603    |    1354 K  |    1353 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3284 GB |    3281 GB |
|       from large pool |    1236 MB |    1616 MB |    2987 GB |    2986 GB |
|       from small pool |    1706 MB |    1709 MB |     297 GB |     295 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3284 GB |    3281 GB |
|       from large pool |    1236 MB |    1616 MB |    2987 GB |    2986 GB |
|       from small pool |    1706 MB |    1709 MB |     297 GB |     295 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3269 GB |    3268 GB |
|       from large pool |   19852 KB |     284 MB |    2908 GB |    2908 GB |
|       from small pool |   29962 KB |    1297 MB |     360 GB |     360 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    2989 K  |    2976 K  |
|       from large pool |      28    |      36    |     672 K  |     672 K  |
|       from small pool |   13002    |   13012    |    2317 K  |    2304 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    2989 K  |    2976 K  |
|       from large pool |      28    |      36    |     672 K  |     672 K  |
|       from small pool |   13002    |   13012    |    2317 K  |    2304 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1878 K  |    1877 K  |
|       from large pool |       7    |      11    |     527 K  |     527 K  |
|       from small pool |     871    |    2600    |    1351 K  |    1350 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 31
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0192,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3396 GB |    3393 GB |
|       from large pool |    1343 MB |    1723 MB |    3090 GB |    3088 GB |
|       from small pool |    1708 MB |    1710 MB |     306 GB |     305 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3396 GB |    3393 GB |
|       from large pool |    1343 MB |    1723 MB |    3090 GB |    3088 GB |
|       from small pool |    1708 MB |    1710 MB |     306 GB |     305 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3394 GB |    3394 GB |
|       from large pool |  157802 KB |     338 MB |    3022 GB |    3022 GB |
|       from small pool |   28552 KB |    1298 MB |     372 GB |     372 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3091 K  |    3078 K  |
|       from large pool |      61    |      69    |     695 K  |     695 K  |
|       from small pool |   13012    |   13021    |    2396 K  |    2383 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3091 K  |    3078 K  |
|       from large pool |      61    |      69    |     695 K  |     695 K  |
|       from small pool |   13012    |   13021    |    2396 K  |    2383 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    1992 K  |    1991 K  |
|       from large pool |      10    |      14    |     594 K  |     594 K  |
|       from small pool |     874    |    2603    |    1398 K  |    1397 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3393 GB |    3390 GB |
|       from large pool |    1236 MB |    1616 MB |    3086 GB |    3085 GB |
|       from small pool |    1706 MB |    1709 MB |     306 GB |     305 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3393 GB |    3390 GB |
|       from large pool |    1236 MB |    1616 MB |    3086 GB |    3085 GB |
|       from small pool |    1706 MB |    1709 MB |     306 GB |     305 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3377 GB |    3377 GB |
|       from large pool |   19852 KB |     284 MB |    3005 GB |    3005 GB |
|       from small pool |   29962 KB |    1297 MB |     372 GB |     372 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3088 K  |    3075 K  |
|       from large pool |      28    |      36    |     694 K  |     694 K  |
|       from small pool |   13002    |   13012    |    2393 K  |    2380 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3088 K  |    3075 K  |
|       from large pool |      28    |      36    |     694 K  |     694 K  |
|       from small pool |   13002    |   13012    |    2393 K  |    2380 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    1940 K  |    1940 K  |
|       from large pool |       7    |      11    |     544 K  |     544 K  |
|       from small pool |     871    |    2600    |    1396 K  |    1395 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 32
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0159,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3506 GB |    3503 GB |
|       from large pool |    1343 MB |    1723 MB |    3189 GB |    3188 GB |
|       from small pool |    1708 MB |    1710 MB |     316 GB |     314 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3506 GB |    3503 GB |
|       from large pool |    1343 MB |    1723 MB |    3189 GB |    3188 GB |
|       from small pool |    1708 MB |    1710 MB |     316 GB |     314 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3504 GB |    3504 GB |
|       from large pool |  157802 KB |     338 MB |    3119 GB |    3119 GB |
|       from small pool |   28552 KB |    1298 MB |     384 GB |     384 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3190 K  |    3176 K  |
|       from large pool |      61    |      69    |     717 K  |     717 K  |
|       from small pool |   13012    |   13021    |    2472 K  |    2459 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3190 K  |    3176 K  |
|       from large pool |      61    |      69    |     717 K  |     717 K  |
|       from small pool |   13012    |   13021    |    2472 K  |    2459 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2056 K  |    2055 K  |
|       from large pool |      10    |      14    |     613 K  |     613 K  |
|       from small pool |     873    |    2603    |    1443 K  |    1442 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3503 GB |    3500 GB |
|       from large pool |    1236 MB |    1616 MB |    3186 GB |    3185 GB |
|       from small pool |    1706 MB |    1709 MB |     316 GB |     314 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3503 GB |    3500 GB |
|       from large pool |    1236 MB |    1616 MB |    3186 GB |    3185 GB |
|       from small pool |    1706 MB |    1709 MB |     316 GB |     314 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3486 GB |    3486 GB |
|       from large pool |   19852 KB |     284 MB |    3102 GB |    3102 GB |
|       from small pool |   29962 KB |    1297 MB |     384 GB |     384 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3186 K  |    3173 K  |
|       from large pool |      28    |      36    |     716 K  |     716 K  |
|       from small pool |   13002    |   13012    |    2470 K  |    2457 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3186 K  |    3173 K  |
|       from large pool |      28    |      36    |     716 K  |     716 K  |
|       from small pool |   13002    |   13012    |    2470 K  |    2457 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2003 K  |    2002 K  |
|       from large pool |       7    |      11    |     562 K  |     562 K  |
|       from small pool |     871    |    2600    |    1440 K  |    1440 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 33
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0185,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3615 GB |    3612 GB |
|       from large pool |    1343 MB |    1723 MB |    3289 GB |    3287 GB |
|       from small pool |    1708 MB |    1710 MB |     326 GB |     324 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3615 GB |    3612 GB |
|       from large pool |    1343 MB |    1723 MB |    3289 GB |    3287 GB |
|       from small pool |    1708 MB |    1710 MB |     326 GB |     324 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3613 GB |    3613 GB |
|       from large pool |  157802 KB |     338 MB |    3217 GB |    3217 GB |
|       from small pool |   28552 KB |    1298 MB |     396 GB |     396 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3288 K  |    3275 K  |
|       from large pool |      61    |      69    |     740 K  |     740 K  |
|       from small pool |   13012    |   13021    |    2548 K  |    2535 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3288 K  |    3275 K  |
|       from large pool |      61    |      69    |     740 K  |     740 K  |
|       from small pool |   13012    |   13021    |    2548 K  |    2535 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2120 K  |    2119 K  |
|       from large pool |      10    |      14    |     632 K  |     632 K  |
|       from small pool |     873    |    2603    |    1488 K  |    1487 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3612 GB |    3609 GB |
|       from large pool |    1236 MB |    1616 MB |    3286 GB |    3284 GB |
|       from small pool |    1706 MB |    1709 MB |     326 GB |     324 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3612 GB |    3609 GB |
|       from large pool |    1236 MB |    1616 MB |    3286 GB |    3284 GB |
|       from small pool |    1706 MB |    1709 MB |     326 GB |     324 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3595 GB |    3595 GB |
|       from large pool |   19852 KB |     284 MB |    3199 GB |    3199 GB |
|       from small pool |   29962 KB |    1297 MB |     396 GB |     396 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3285 K  |    3272 K  |
|       from large pool |      28    |      36    |     739 K  |     739 K  |
|       from small pool |   13002    |   13012    |    2546 K  |    2533 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3285 K  |    3272 K  |
|       from large pool |      28    |      36    |     739 K  |     739 K  |
|       from small pool |   13002    |   13012    |    2546 K  |    2533 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2065 K  |    2064 K  |
|       from large pool |       7    |      11    |     579 K  |     579 K  |
|       from small pool |     871    |    2600    |    1485 K  |    1484 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 34
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0140,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3725 GB |    3722 GB |
|       from large pool |    1343 MB |    1723 MB |    3388 GB |    3387 GB |
|       from small pool |    1708 MB |    1710 MB |     336 GB |     334 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3725 GB |    3722 GB |
|       from large pool |    1343 MB |    1723 MB |    3388 GB |    3387 GB |
|       from small pool |    1708 MB |    1710 MB |     336 GB |     334 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3722 GB |    3722 GB |
|       from large pool |  157802 KB |     338 MB |    3314 GB |    3314 GB |
|       from small pool |   28552 KB |    1298 MB |     408 GB |     408 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3387 K  |    3374 K  |
|       from large pool |      61    |      69    |     762 K  |     762 K  |
|       from small pool |   13012    |   13021    |    2624 K  |    2611 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3387 K  |    3374 K  |
|       from large pool |      61    |      69    |     762 K  |     762 K  |
|       from small pool |   13012    |   13021    |    2624 K  |    2611 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2184 K  |    2183 K  |
|       from large pool |      10    |      14    |     651 K  |     651 K  |
|       from small pool |     873    |    2603    |    1532 K  |    1531 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3721 GB |    3718 GB |
|       from large pool |    1236 MB |    1616 MB |    3385 GB |    3384 GB |
|       from small pool |    1706 MB |    1709 MB |     336 GB |     334 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3721 GB |    3718 GB |
|       from large pool |    1236 MB |    1616 MB |    3385 GB |    3384 GB |
|       from small pool |    1706 MB |    1709 MB |     336 GB |     334 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3704 GB |    3704 GB |
|       from large pool |   19852 KB |     284 MB |    3296 GB |    3296 GB |
|       from small pool |   29962 KB |    1297 MB |     408 GB |     408 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3384 K  |    3371 K  |
|       from large pool |      28    |      36    |     761 K  |     761 K  |
|       from small pool |   13002    |   13012    |    2622 K  |    2609 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3384 K  |    3371 K  |
|       from large pool |      28    |      36    |     761 K  |     761 K  |
|       from small pool |   13002    |   13012    |    2622 K  |    2609 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2127 K  |    2126 K  |
|       from large pool |       7    |      11    |     597 K  |     597 K  |
|       from small pool |     871    |    2600    |    1530 K  |    1529 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 35
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0153,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3834 GB |    3831 GB |
|       from large pool |    1343 MB |    1723 MB |    3488 GB |    3487 GB |
|       from small pool |    1708 MB |    1710 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3834 GB |    3831 GB |
|       from large pool |    1343 MB |    1723 MB |    3488 GB |    3487 GB |
|       from small pool |    1708 MB |    1710 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3832 GB |    3832 GB |
|       from large pool |  157802 KB |     338 MB |    3412 GB |    3412 GB |
|       from small pool |   28552 KB |    1298 MB |     420 GB |     419 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3485 K  |    3472 K  |
|       from large pool |      61    |      69    |     785 K  |     784 K  |
|       from small pool |   13012    |   13021    |    2700 K  |    2687 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3485 K  |    3472 K  |
|       from large pool |      61    |      69    |     785 K  |     784 K  |
|       from small pool |   13012    |   13021    |    2700 K  |    2687 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    2247 K  |    2247 K  |
|       from large pool |      10    |      14    |     670 K  |     670 K  |
|       from small pool |     874    |    2603    |    1577 K  |    1576 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3830 GB |    3828 GB |
|       from large pool |    1236 MB |    1616 MB |    3485 GB |    3483 GB |
|       from small pool |    1706 MB |    1709 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3830 GB |    3828 GB |
|       from large pool |    1236 MB |    1616 MB |    3485 GB |    3483 GB |
|       from small pool |    1706 MB |    1709 MB |     345 GB |     344 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3813 GB |    3812 GB |
|       from large pool |   19852 KB |     284 MB |    3393 GB |    3393 GB |
|       from small pool |   29962 KB |    1297 MB |     420 GB |     419 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3482 K  |    3469 K  |
|       from large pool |      28    |      36    |     784 K  |     784 K  |
|       from small pool |   13002    |   13012    |    2698 K  |    2685 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3482 K  |    3469 K  |
|       from large pool |      28    |      36    |     784 K  |     784 K  |
|       from small pool |   13002    |   13012    |    2698 K  |    2685 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2189 K  |    2188 K  |
|       from large pool |       7    |      11    |     614 K  |     614 K  |
|       from small pool |     871    |    2600    |    1574 K  |    1573 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 36
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0182,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    3943 GB |    3940 GB |
|       from large pool |    1343 MB |    1723 MB |    3588 GB |    3586 GB |
|       from small pool |    1708 MB |    1710 MB |     355 GB |     354 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    3943 GB |    3940 GB |
|       from large pool |    1343 MB |    1723 MB |    3588 GB |    3586 GB |
|       from small pool |    1708 MB |    1710 MB |     355 GB |     354 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    3941 GB |    3941 GB |
|       from large pool |  157802 KB |     338 MB |    3509 GB |    3509 GB |
|       from small pool |   28552 KB |    1298 MB |     431 GB |     431 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3584 K  |    3571 K  |
|       from large pool |      61    |      69    |     807 K  |     807 K  |
|       from small pool |   13012    |   13021    |    2777 K  |    2764 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3584 K  |    3571 K  |
|       from large pool |      61    |      69    |     807 K  |     807 K  |
|       from small pool |   13012    |   13021    |    2777 K  |    2764 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    2311 K  |    2310 K  |
|       from large pool |      10    |      14    |     689 K  |     689 K  |
|       from small pool |     872    |    2603    |    1621 K  |    1621 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    3940 GB |    3937 GB |
|       from large pool |    1236 MB |    1616 MB |    3584 GB |    3583 GB |
|       from small pool |    1706 MB |    1709 MB |     355 GB |     353 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    3940 GB |    3937 GB |
|       from large pool |    1236 MB |    1616 MB |    3584 GB |    3583 GB |
|       from small pool |    1706 MB |    1709 MB |     355 GB |     353 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    3921 GB |    3921 GB |
|       from large pool |   19852 KB |     284 MB |    3489 GB |    3489 GB |
|       from small pool |   29962 KB |    1297 MB |     431 GB |     431 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3581 K  |    3568 K  |
|       from large pool |      28    |      36    |     806 K  |     806 K  |
|       from small pool |   13002    |   13012    |    2774 K  |    2761 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3581 K  |    3568 K  |
|       from large pool |      28    |      36    |     806 K  |     806 K  |
|       from small pool |   13002    |   13012    |    2774 K  |    2761 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2251 K  |    2250 K  |
|       from large pool |       7    |      11    |     632 K  |     632 K  |
|       from small pool |     871    |    2600    |    1619 K  |    1618 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 37
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0017, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0203,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4053 GB |    4050 GB |
|       from large pool |    1343 MB |    1723 MB |    3687 GB |    3686 GB |
|       from small pool |    1708 MB |    1710 MB |     365 GB |     363 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4053 GB |    4050 GB |
|       from large pool |    1343 MB |    1723 MB |    3687 GB |    3686 GB |
|       from small pool |    1708 MB |    1710 MB |     365 GB |     363 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4050 GB |    4050 GB |
|       from large pool |  157802 KB |     338 MB |    3607 GB |    3607 GB |
|       from small pool |   28552 KB |    1298 MB |     443 GB |     443 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3683 K  |    3670 K  |
|       from large pool |      61    |      69    |     829 K  |     829 K  |
|       from small pool |   13012    |   13021    |    2853 K  |    2840 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3683 K  |    3670 K  |
|       from large pool |      61    |      69    |     829 K  |     829 K  |
|       from small pool |   13012    |   13021    |    2853 K  |    2840 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    2375 K  |    2374 K  |
|       from large pool |      10    |      14    |     709 K  |     709 K  |
|       from small pool |     874    |    2603    |    1666 K  |    1665 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4049 GB |    4046 GB |
|       from large pool |    1236 MB |    1616 MB |    3684 GB |    3682 GB |
|       from small pool |    1706 MB |    1709 MB |     365 GB |     363 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4049 GB |    4046 GB |
|       from large pool |    1236 MB |    1616 MB |    3684 GB |    3682 GB |
|       from small pool |    1706 MB |    1709 MB |     365 GB |     363 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4030 GB |    4030 GB |
|       from large pool |   19852 KB |     284 MB |    3586 GB |    3586 GB |
|       from small pool |   29962 KB |    1297 MB |     443 GB |     443 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3679 K  |    3666 K  |
|       from large pool |      28    |      36    |     828 K  |     828 K  |
|       from small pool |   13002    |   13012    |    2850 K  |    2837 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3679 K  |    3666 K  |
|       from large pool |      28    |      36    |     828 K  |     828 K  |
|       from small pool |   13002    |   13012    |    2850 K  |    2837 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2313 K  |    2312 K  |
|       from large pool |       7    |      11    |     650 K  |     650 K  |
|       from small pool |     871    |    2600    |    1663 K  |    1662 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 38
batch input size: torch.Size([32, 1855]) Device: batch input size:0
torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0274,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4162 GB |    4159 GB |
|       from large pool |    1343 MB |    1723 MB |    3787 GB |    3786 GB |
|       from small pool |    1708 MB |    1710 MB |     375 GB |     373 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4162 GB |    4159 GB |
|       from large pool |    1343 MB |    1723 MB |    3787 GB |    3786 GB |
|       from small pool |    1708 MB |    1710 MB |     375 GB |     373 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4160 GB |    4160 GB |
|       from large pool |  157802 KB |     338 MB |    3704 GB |    3704 GB |
|       from small pool |   28552 KB |    1298 MB |     455 GB |     455 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3781 K  |    3768 K  |
|       from large pool |      61    |      69    |     852 K  |     852 K  |
|       from small pool |   13012    |   13021    |    2929 K  |    2916 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3781 K  |    3768 K  |
|       from large pool |      61    |      69    |     852 K  |     852 K  |
|       from small pool |   13012    |   13021    |    2929 K  |    2916 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2439 K  |    2438 K  |
|       from large pool |      10    |      14    |     728 K  |     728 K  |
|       from small pool |     873    |    2603    |    1711 K  |    1710 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4158 GB |    4155 GB |
|       from large pool |    1236 MB |    1616 MB |    3783 GB |    3782 GB |
|       from small pool |    1706 MB |    1709 MB |     375 GB |     373 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4158 GB |    4155 GB |
|       from large pool |    1236 MB |    1616 MB |    3783 GB |    3782 GB |
|       from small pool |    1706 MB |    1709 MB |     375 GB |     373 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4139 GB |    4139 GB |
|       from large pool |   19852 KB |     284 MB |    3683 GB |    3683 GB |
|       from small pool |   29962 KB |    1297 MB |     455 GB |     455 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3778 K  |    3765 K  |
|       from large pool |      28    |      36    |     851 K  |     851 K  |
|       from small pool |   13002    |   13012    |    2926 K  |    2913 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3778 K  |    3765 K  |
|       from large pool |      28    |      36    |     851 K  |     851 K  |
|       from small pool |   13002    |   13012    |    2926 K  |    2913 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2375 K  |    2374 K  |
|       from large pool |       7    |      11    |     667 K  |     667 K  |
|       from small pool |     871    |    2600    |    1708 K  |    1707 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 39
batch input size: torch.Size([32, 1855])batch input size:  Device:torch.Size([32, 1855])  0Device:
 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0330,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4271 GB |    4268 GB |
|       from large pool |    1343 MB |    1723 MB |    3886 GB |    3885 GB |
|       from small pool |    1708 MB |    1710 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4271 GB |    4268 GB |
|       from large pool |    1343 MB |    1723 MB |    3886 GB |    3885 GB |
|       from small pool |    1708 MB |    1710 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4269 GB |    4269 GB |
|       from large pool |  157802 KB |     338 MB |    3802 GB |    3802 GB |
|       from small pool |   28552 KB |    1298 MB |     467 GB |     467 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3880 K  |    3867 K  |
|       from large pool |      61    |      69    |     874 K  |     874 K  |
|       from small pool |   13012    |   13021    |    3005 K  |    2992 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3880 K  |    3867 K  |
|       from large pool |      61    |      69    |     874 K  |     874 K  |
|       from small pool |   13012    |   13021    |    3005 K  |    2992 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2503 K  |    2502 K  |
|       from large pool |      10    |      14    |     747 K  |     747 K  |
|       from small pool |     873    |    2603    |    1755 K  |    1754 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4268 GB |    4265 GB |
|       from large pool |    1236 MB |    1616 MB |    3883 GB |    3881 GB |
|       from small pool |    1706 MB |    1709 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4268 GB |    4265 GB |
|       from large pool |    1236 MB |    1616 MB |    3883 GB |    3881 GB |
|       from small pool |    1706 MB |    1709 MB |     384 GB |     383 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4248 GB |    4248 GB |
|       from large pool |   19852 KB |     284 MB |    3780 GB |    3780 GB |
|       from small pool |   29962 KB |    1297 MB |     467 GB |     467 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3876 K  |    3863 K  |
|       from large pool |      28    |      36    |     873 K  |     873 K  |
|       from small pool |   13002    |   13012    |    3002 K  |    2989 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3876 K  |    3863 K  |
|       from large pool |      28    |      36    |     873 K  |     873 K  |
|       from small pool |   13002    |   13012    |    3002 K  |    2989 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2437 K  |    2437 K  |
|       from large pool |       7    |      11    |     685 K  |     685 K  |
|       from small pool |     871    |    2600    |    1752 K  |    1751 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 40
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0189,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4381 GB |    4378 GB |
|       from large pool |    1343 MB |    1723 MB |    3986 GB |    3985 GB |
|       from small pool |    1708 MB |    1710 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4381 GB |    4378 GB |
|       from large pool |    1343 MB |    1723 MB |    3986 GB |    3985 GB |
|       from small pool |    1708 MB |    1710 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4379 GB |    4378 GB |
|       from large pool |  157802 KB |     338 MB |    3899 GB |    3899 GB |
|       from small pool |   28552 KB |    1298 MB |     479 GB |     479 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    3979 K  |    3966 K  |
|       from large pool |      61    |      69    |     897 K  |     897 K  |
|       from small pool |   13012    |   13021    |    3081 K  |    3068 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    3979 K  |    3966 K  |
|       from large pool |      61    |      69    |     897 K  |     897 K  |
|       from small pool |   13012    |   13021    |    3081 K  |    3068 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2566 K  |    2566 K  |
|       from large pool |      10    |      14    |     766 K  |     766 K  |
|       from small pool |     873    |    2603    |    1800 K  |    1799 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4377 GB |    4374 GB |
|       from large pool |    1236 MB |    1616 MB |    3982 GB |    3981 GB |
|       from small pool |    1706 MB |    1709 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4377 GB |    4374 GB |
|       from large pool |    1236 MB |    1616 MB |    3982 GB |    3981 GB |
|       from small pool |    1706 MB |    1709 MB |     394 GB |     393 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4357 GB |    4357 GB |
|       from large pool |   19852 KB |     284 MB |    3877 GB |    3877 GB |
|       from small pool |   29962 KB |    1297 MB |     479 GB |     479 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    3975 K  |    3962 K  |
|       from large pool |      28    |      36    |     896 K  |     896 K  |
|       from small pool |   13002    |   13012    |    3079 K  |    3066 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    3975 K  |    3962 K  |
|       from large pool |      28    |      36    |     896 K  |     896 K  |
|       from small pool |   13002    |   13012    |    3079 K  |    3066 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2500 K  |    2499 K  |
|       from large pool |       7    |      11    |     702 K  |     702 K  |
|       from small pool |     871    |    2600    |    1797 K  |    1796 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 41
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0303,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4490 GB |    4487 GB |
|       from large pool |    1343 MB |    1723 MB |    4086 GB |    4084 GB |
|       from small pool |    1708 MB |    1710 MB |     404 GB |     402 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4490 GB |    4487 GB |
|       from large pool |    1343 MB |    1723 MB |    4086 GB |    4084 GB |
|       from small pool |    1708 MB |    1710 MB |     404 GB |     402 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4488 GB |    4488 GB |
|       from large pool |  157802 KB |     338 MB |    3997 GB |    3997 GB |
|       from small pool |   28552 KB |    1298 MB |     491 GB |     491 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4077 K  |    4064 K  |
|       from large pool |      61    |      69    |     919 K  |     919 K  |
|       from small pool |   13012    |   13021    |    3158 K  |    3145 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4077 K  |    4064 K  |
|       from large pool |      61    |      69    |     919 K  |     919 K  |
|       from small pool |   13012    |   13021    |    3158 K  |    3145 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    2630 K  |    2629 K  |
|       from large pool |      10    |      14    |     785 K  |     785 K  |
|       from small pool |     874    |    2603    |    1844 K  |    1844 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4486 GB |    4483 GB |
|       from large pool |    1236 MB |    1616 MB |    4082 GB |    4081 GB |
|       from small pool |    1706 MB |    1709 MB |     404 GB |     402 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4486 GB |    4483 GB |
|       from large pool |    1236 MB |    1616 MB |    4082 GB |    4081 GB |
|       from small pool |    1706 MB |    1709 MB |     404 GB |     402 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4465 GB |    4465 GB |
|       from large pool |   19852 KB |     284 MB |    3974 GB |    3974 GB |
|       from small pool |   29962 KB |    1297 MB |     491 GB |     491 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4073 K  |    4060 K  |
|       from large pool |      28    |      36    |     918 K  |     918 K  |
|       from small pool |   13002    |   13012    |    3155 K  |    3142 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4073 K  |    4060 K  |
|       from large pool |      28    |      36    |     918 K  |     918 K  |
|       from small pool |   13002    |   13012    |    3155 K  |    3142 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2562 K  |    2561 K  |
|       from large pool |       7    |      11    |     720 K  |     720 K  |
|       from small pool |     871    |    2600    |    1841 K  |    1840 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 42
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0012],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0134,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4600 GB |    4597 GB |
|       from large pool |    1343 MB |    1723 MB |    4185 GB |    4184 GB |
|       from small pool |    1708 MB |    1710 MB |     414 GB |     412 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4600 GB |    4597 GB |
|       from large pool |    1343 MB |    1723 MB |    4185 GB |    4184 GB |
|       from small pool |    1708 MB |    1710 MB |     414 GB |     412 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4597 GB |    4597 GB |
|       from large pool |  157802 KB |     338 MB |    4094 GB |    4094 GB |
|       from small pool |   28552 KB |    1298 MB |     503 GB |     503 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4176 K  |    4163 K  |
|       from large pool |      61    |      69    |     942 K  |     941 K  |
|       from small pool |   13012    |   13021    |    3234 K  |    3221 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4176 K  |    4163 K  |
|       from large pool |      61    |      69    |     942 K  |     941 K  |
|       from small pool |   13012    |   13021    |    3234 K  |    3221 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    2694 K  |    2693 K  |
|       from large pool |      10    |      14    |     804 K  |     804 K  |
|       from small pool |     872    |    2603    |    1889 K  |    1888 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4595 GB |    4593 GB |
|       from large pool |    1236 MB |    1616 MB |    4181 GB |    4180 GB |
|       from small pool |    1706 MB |    1709 MB |     414 GB |     412 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4595 GB |    4593 GB |
|       from large pool |    1236 MB |    1616 MB |    4181 GB |    4180 GB |
|       from small pool |    1706 MB |    1709 MB |     414 GB |     412 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4574 GB |    4574 GB |
|       from large pool |   19852 KB |     284 MB |    4071 GB |    4071 GB |
|       from small pool |   29962 KB |    1297 MB |     503 GB |     503 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4172 K  |    4159 K  |
|       from large pool |      28    |      36    |     940 K  |     940 K  |
|       from small pool |   13002    |   13012    |    3231 K  |    3218 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4172 K  |    4159 K  |
|       from large pool |      28    |      36    |     940 K  |     940 K  |
|       from small pool |   13002    |   13012    |    3231 K  |    3218 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2624 K  |    2623 K  |
|       from large pool |       7    |      11    |     737 K  |     737 K  |
|       from small pool |     871    |    2600    |    1886 K  |    1885 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 43
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0120,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4709 GB |    4706 GB |
|       from large pool |    1343 MB |    1723 MB |    4285 GB |    4284 GB |
|       from small pool |    1708 MB |    1710 MB |     424 GB |     422 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4709 GB |    4706 GB |
|       from large pool |    1343 MB |    1723 MB |    4285 GB |    4284 GB |
|       from small pool |    1708 MB |    1710 MB |     424 GB |     422 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4707 GB |    4706 GB |
|       from large pool |  157802 KB |     338 MB |    4192 GB |    4192 GB |
|       from small pool |   28552 KB |    1298 MB |     514 GB |     514 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4275 K  |    4262 K  |
|       from large pool |      61    |      69    |     964 K  |     964 K  |
|       from small pool |   13012    |   13021    |    3310 K  |    3297 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4275 K  |    4262 K  |
|       from large pool |      61    |      69    |     964 K  |     964 K  |
|       from small pool |   13012    |   13021    |    3310 K  |    3297 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    2758 K  |    2757 K  |
|       from large pool |      10    |      14    |     824 K  |     823 K  |
|       from small pool |     874    |    2603    |    1934 K  |    1933 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4705 GB |    4702 GB |
|       from large pool |    1236 MB |    1616 MB |    4281 GB |    4280 GB |
|       from small pool |    1706 MB |    1709 MB |     423 GB |     422 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4705 GB |    4702 GB |
|       from large pool |    1236 MB |    1616 MB |    4281 GB |    4280 GB |
|       from small pool |    1706 MB |    1709 MB |     423 GB |     422 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4683 GB |    4683 GB |
|       from large pool |   19852 KB |     284 MB |    4168 GB |    4168 GB |
|       from small pool |   29962 KB |    1297 MB |     514 GB |     514 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4270 K  |    4257 K  |
|       from large pool |      28    |      36    |     963 K  |     963 K  |
|       from small pool |   13002    |   13012    |    3307 K  |    3294 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4270 K  |    4257 K  |
|       from large pool |      28    |      36    |     963 K  |     963 K  |
|       from small pool |   13002    |   13012    |    3307 K  |    3294 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2686 K  |    2685 K  |
|       from large pool |       7    |      11    |     755 K  |     755 K  |
|       from small pool |     871    |    2600    |    1930 K  |    1930 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 44
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0019, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0121,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4818 GB |    4815 GB |
|       from large pool |    1343 MB |    1723 MB |    4385 GB |    4383 GB |
|       from small pool |    1708 MB |    1710 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4818 GB |    4815 GB |
|       from large pool |    1343 MB |    1723 MB |    4385 GB |    4383 GB |
|       from small pool |    1708 MB |    1710 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4816 GB |    4816 GB |
|       from large pool |  157802 KB |     338 MB |    4289 GB |    4289 GB |
|       from small pool |   28552 KB |    1298 MB |     526 GB |     526 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4373 K  |    4360 K  |
|       from large pool |      61    |      69    |     986 K  |     986 K  |
|       from small pool |   13012    |   13021    |    3386 K  |    3373 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4373 K  |    4360 K  |
|       from large pool |      61    |      69    |     986 K  |     986 K  |
|       from small pool |   13012    |   13021    |    3386 K  |    3373 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2822 K  |    2821 K  |
|       from large pool |      10    |      14    |     843 K  |     843 K  |
|       from small pool |     873    |    2603    |    1978 K  |    1977 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4814 GB |    4811 GB |
|       from large pool |    1236 MB |    1616 MB |    4380 GB |    4379 GB |
|       from small pool |    1706 MB |    1709 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4814 GB |    4811 GB |
|       from large pool |    1236 MB |    1616 MB |    4380 GB |    4379 GB |
|       from small pool |    1706 MB |    1709 MB |     433 GB |     432 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4792 GB |    4792 GB |
|       from large pool |   19852 KB |     284 MB |    4265 GB |    4265 GB |
|       from small pool |   29962 KB |    1297 MB |     526 GB |     526 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4369 K  |    4356 K  |
|       from large pool |      28    |      36    |     985 K  |     985 K  |
|       from small pool |   13002    |   13012    |    3383 K  |    3370 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4369 K  |    4356 K  |
|       from large pool |      28    |      36    |     985 K  |     985 K  |
|       from small pool |   13002    |   13012    |    3383 K  |    3370 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2748 K  |    2747 K  |
|       from large pool |       7    |      11    |     772 K  |     772 K  |
|       from small pool |     871    |    2600    |    1975 K  |    1974 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 45
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0079,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    4928 GB |    4925 GB |
|       from large pool |    1343 MB |    1723 MB |    4484 GB |    4483 GB |
|       from small pool |    1708 MB |    1710 MB |     443 GB |     441 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    4928 GB |    4925 GB |
|       from large pool |    1343 MB |    1723 MB |    4484 GB |    4483 GB |
|       from small pool |    1708 MB |    1710 MB |     443 GB |     441 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    4925 GB |    4925 GB |
|       from large pool |  157802 KB |     338 MB |    4387 GB |    4386 GB |
|       from small pool |   28552 KB |    1298 MB |     538 GB |     538 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4472 K  |    4459 K  |
|       from large pool |      61    |      69    |    1009 K  |    1009 K  |
|       from small pool |   13012    |   13021    |    3463 K  |    3450 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4472 K  |    4459 K  |
|       from large pool |      61    |      69    |    1009 K  |    1009 K  |
|       from small pool |   13012    |   13021    |    3463 K  |    3450 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2885 K  |    2884 K  |
|       from large pool |      10    |      14    |     862 K  |     862 K  |
|       from small pool |     873    |    2603    |    2023 K  |    2022 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    4923 GB |    4920 GB |
|       from large pool |    1236 MB |    1616 MB |    4480 GB |    4479 GB |
|       from small pool |    1706 MB |    1709 MB |     443 GB |     441 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    4923 GB |    4920 GB |
|       from large pool |    1236 MB |    1616 MB |    4480 GB |    4479 GB |
|       from small pool |    1706 MB |    1709 MB |     443 GB |     441 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    4901 GB |    4901 GB |
|       from large pool |   19852 KB |     284 MB |    4362 GB |    4362 GB |
|       from small pool |   29962 KB |    1297 MB |     538 GB |     538 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4468 K  |    4454 K  |
|       from large pool |      28    |      36    |    1008 K  |    1008 K  |
|       from small pool |   13002    |   13012    |    3459 K  |    3446 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4468 K  |    4454 K  |
|       from large pool |      28    |      36    |    1008 K  |    1008 K  |
|       from small pool |   13002    |   13012    |    3459 K  |    3446 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2810 K  |    2809 K  |
|       from large pool |       7    |      11    |     790 K  |     790 K  |
|       from small pool |     871    |    2600    |    2020 K  |    2019 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 46
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0120,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5037 GB |    5034 GB |
|       from large pool |    1343 MB |    1723 MB |    4584 GB |    4583 GB |
|       from small pool |    1708 MB |    1710 MB |     453 GB |     451 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5037 GB |    5034 GB |
|       from large pool |    1343 MB |    1723 MB |    4584 GB |    4583 GB |
|       from small pool |    1708 MB |    1710 MB |     453 GB |     451 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5035 GB |    5034 GB |
|       from large pool |  157802 KB |     338 MB |    4484 GB |    4484 GB |
|       from small pool |   28552 KB |    1298 MB |     550 GB |     550 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4571 K  |    4557 K  |
|       from large pool |      61    |      69    |    1031 K  |    1031 K  |
|       from small pool |   13012    |   13021    |    3539 K  |    3526 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4571 K  |    4557 K  |
|       from large pool |      61    |      69    |    1031 K  |    1031 K  |
|       from small pool |   13012    |   13021    |    3539 K  |    3526 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    2949 K  |    2948 K  |
|       from large pool |      10    |      14    |     881 K  |     881 K  |
|       from small pool |     873    |    2603    |    2068 K  |    2067 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5033 GB |    5030 GB |
|       from large pool |    1236 MB |    1616 MB |    4579 GB |    4578 GB |
|       from small pool |    1706 MB |    1709 MB |     453 GB |     451 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5033 GB |    5030 GB |
|       from large pool |    1236 MB |    1616 MB |    4579 GB |    4578 GB |
|       from small pool |    1706 MB |    1709 MB |     453 GB |     451 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5009 GB |    5009 GB |
|       from large pool |   19852 KB |     284 MB |    4459 GB |    4459 GB |
|       from small pool |   29962 KB |    1297 MB |     550 GB |     550 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4566 K  |    4553 K  |
|       from large pool |      28    |      36    |    1030 K  |    1030 K  |
|       from small pool |   13002    |   13012    |    3535 K  |    3522 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4566 K  |    4553 K  |
|       from large pool |      28    |      36    |    1030 K  |    1030 K  |
|       from small pool |   13002    |   13012    |    3535 K  |    3522 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2872 K  |    2871 K  |
|       from large pool |       7    |      11    |     808 K  |     808 K  |
|       from small pool |     871    |    2600    |    2064 K  |    2063 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 47
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0165,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5147 GB |    5144 GB |
|       from large pool |    1343 MB |    1723 MB |    4683 GB |    4682 GB |
|       from small pool |    1708 MB |    1710 MB |     463 GB |     461 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5147 GB |    5144 GB |
|       from large pool |    1343 MB |    1723 MB |    4683 GB |    4682 GB |
|       from small pool |    1708 MB |    1710 MB |     463 GB |     461 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5144 GB |    5144 GB |
|       from large pool |  157802 KB |     338 MB |    4582 GB |    4581 GB |
|       from small pool |   28552 KB |    1298 MB |     562 GB |     562 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4669 K  |    4656 K  |
|       from large pool |      61    |      69    |    1054 K  |    1054 K  |
|       from small pool |   13012    |   13021    |    3615 K  |    3602 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4669 K  |    4656 K  |
|       from large pool |      61    |      69    |    1054 K  |    1054 K  |
|       from small pool |   13012    |   13021    |    3615 K  |    3602 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    3013 K  |    3012 K  |
|       from large pool |      10    |      14    |     900 K  |     900 K  |
|       from small pool |     874    |    2603    |    2112 K  |    2111 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5142 GB |    5139 GB |
|       from large pool |    1236 MB |    1616 MB |    4679 GB |    4678 GB |
|       from small pool |    1706 MB |    1709 MB |     463 GB |     461 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5142 GB |    5139 GB |
|       from large pool |    1236 MB |    1616 MB |    4679 GB |    4678 GB |
|       from small pool |    1706 MB |    1709 MB |     463 GB |     461 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5118 GB |    5118 GB |
|       from large pool |   19852 KB |     284 MB |    4556 GB |    4556 GB |
|       from small pool |   29962 KB |    1297 MB |     562 GB |     562 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4665 K  |    4652 K  |
|       from large pool |      28    |      36    |    1052 K  |    1052 K  |
|       from small pool |   13002    |   13012    |    3612 K  |    3599 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4665 K  |    4652 K  |
|       from large pool |      28    |      36    |    1052 K  |    1052 K  |
|       from small pool |   13002    |   13012    |    3612 K  |    3599 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2934 K  |    2933 K  |
|       from large pool |       7    |      11    |     825 K  |     825 K  |
|       from small pool |     871    |    2600    |    2109 K  |    2108 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 48
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0109,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5256 GB |    5253 GB |
|       from large pool |    1343 MB |    1723 MB |    4783 GB |    4782 GB |
|       from small pool |    1708 MB |    1710 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5256 GB |    5253 GB |
|       from large pool |    1343 MB |    1723 MB |    4783 GB |    4782 GB |
|       from small pool |    1708 MB |    1710 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5253 GB |    5253 GB |
|       from large pool |  157802 KB |     338 MB |    4679 GB |    4679 GB |
|       from small pool |   28552 KB |    1298 MB |     574 GB |     574 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4768 K  |    4755 K  |
|       from large pool |      61    |      69    |    1076 K  |    1076 K  |
|       from small pool |   13012    |   13021    |    3691 K  |    3678 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4768 K  |    4755 K  |
|       from large pool |      61    |      69    |    1076 K  |    1076 K  |
|       from small pool |   13012    |   13021    |    3691 K  |    3678 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    3077 K  |    3076 K  |
|       from large pool |      10    |      14    |     919 K  |     919 K  |
|       from small pool |     872    |    2603    |    2157 K  |    2156 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5251 GB |    5248 GB |
|       from large pool |    1236 MB |    1616 MB |    4778 GB |    4777 GB |
|       from small pool |    1706 MB |    1709 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5251 GB |    5248 GB |
|       from large pool |    1236 MB |    1616 MB |    4778 GB |    4777 GB |
|       from small pool |    1706 MB |    1709 MB |     472 GB |     471 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5227 GB |    5227 GB |
|       from large pool |   19852 KB |     284 MB |    4653 GB |    4653 GB |
|       from small pool |   29962 KB |    1297 MB |     574 GB |     574 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4763 K  |    4750 K  |
|       from large pool |      28    |      36    |    1075 K  |    1075 K  |
|       from small pool |   13002    |   13012    |    3688 K  |    3675 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4763 K  |    4750 K  |
|       from large pool |      28    |      36    |    1075 K  |    1075 K  |
|       from small pool |   13002    |   13012    |    3688 K  |    3675 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    2996 K  |    2996 K  |
|       from large pool |       7    |      11    |     843 K  |     843 K  |
|       from small pool |     871    |    2600    |    2153 K  |    2152 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 49
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0002,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0116,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5365 GB |    5362 GB |
|       from large pool |    1343 MB |    1723 MB |    4883 GB |    4881 GB |
|       from small pool |    1708 MB |    1710 MB |     482 GB |     480 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5365 GB |    5362 GB |
|       from large pool |    1343 MB |    1723 MB |    4883 GB |    4881 GB |
|       from small pool |    1708 MB |    1710 MB |     482 GB |     480 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5363 GB |    5363 GB |
|       from large pool |  157802 KB |     338 MB |    4777 GB |    4776 GB |
|       from small pool |   28552 KB |    1298 MB |     586 GB |     586 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4866 K  |    4853 K  |
|       from large pool |      61    |      69    |    1099 K  |    1098 K  |
|       from small pool |   13012    |   13021    |    3767 K  |    3754 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4866 K  |    4853 K  |
|       from large pool |      61    |      69    |    1099 K  |    1098 K  |
|       from small pool |   13012    |   13021    |    3767 K  |    3754 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    3140 K  |    3140 K  |
|       from large pool |      10    |      14    |     938 K  |     938 K  |
|       from small pool |     874    |    2603    |    2201 K  |    2201 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5360 GB |    5358 GB |
|       from large pool |    1236 MB |    1616 MB |    4878 GB |    4877 GB |
|       from small pool |    1706 MB |    1709 MB |     482 GB |     480 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5360 GB |    5358 GB |
|       from large pool |    1236 MB |    1616 MB |    4878 GB |    4877 GB |
|       from small pool |    1706 MB |    1709 MB |     482 GB |     480 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5336 GB |    5336 GB |
|       from large pool |   19852 KB |     284 MB |    4750 GB |    4750 GB |
|       from small pool |   29962 KB |    1297 MB |     586 GB |     586 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4862 K  |    4849 K  |
|       from large pool |      28    |      36    |    1097 K  |    1097 K  |
|       from small pool |   13002    |   13012    |    3764 K  |    3751 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4862 K  |    4849 K  |
|       from large pool |      28    |      36    |    1097 K  |    1097 K  |
|       from small pool |   13002    |   13012    |    3764 K  |    3751 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3059 K  |    3058 K  |
|       from large pool |       7    |      11    |     860 K  |     860 K  |
|       from small pool |     871    |    2600    |    2198 K  |    2197 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 50
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0010,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0108,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5475 GB |    5472 GB |
|       from large pool |    1343 MB |    1723 MB |    4982 GB |    4981 GB |
|       from small pool |    1708 MB |    1710 MB |     492 GB |     490 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5475 GB |    5472 GB |
|       from large pool |    1343 MB |    1723 MB |    4982 GB |    4981 GB |
|       from small pool |    1708 MB |    1710 MB |     492 GB |     490 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5472 GB |    5472 GB |
|       from large pool |  157802 KB |     338 MB |    4874 GB |    4874 GB |
|       from small pool |   28552 KB |    1298 MB |     597 GB |     597 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    4965 K  |    4952 K  |
|       from large pool |      61    |      69    |    1121 K  |    1121 K  |
|       from small pool |   13012    |   13021    |    3844 K  |    3831 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    4965 K  |    4952 K  |
|       from large pool |      61    |      69    |    1121 K  |    1121 K  |
|       from small pool |   13012    |   13021    |    3844 K  |    3831 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3204 K  |    3203 K  |
|       from large pool |      10    |      14    |     958 K  |     958 K  |
|       from small pool |     873    |    2603    |    2246 K  |    2245 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5470 GB |    5467 GB |
|       from large pool |    1236 MB |    1616 MB |    4977 GB |    4976 GB |
|       from small pool |    1706 MB |    1709 MB |     492 GB |     490 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5470 GB |    5467 GB |
|       from large pool |    1236 MB |    1616 MB |    4977 GB |    4976 GB |
|       from small pool |    1706 MB |    1709 MB |     492 GB |     490 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5445 GB |    5445 GB |
|       from large pool |   19852 KB |     284 MB |    4847 GB |    4847 GB |
|       from small pool |   29962 KB |    1297 MB |     597 GB |     597 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    4960 K  |    4947 K  |
|       from large pool |      28    |      36    |    1120 K  |    1120 K  |
|       from small pool |   13002    |   13012    |    3840 K  |    3827 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    4960 K  |    4947 K  |
|       from large pool |      28    |      36    |    1120 K  |    1120 K  |
|       from small pool |   13002    |   13012    |    3840 K  |    3827 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3121 K  |    3120 K  |
|       from large pool |       7    |      11    |     878 K  |     878 K  |
|       from small pool |     871    |    2600    |    2242 K  |    2241 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 51
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0128,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5584 GB |    5581 GB |
|       from large pool |    1343 MB |    1723 MB |    5082 GB |    5081 GB |
|       from small pool |    1708 MB |    1710 MB |     502 GB |     500 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5584 GB |    5581 GB |
|       from large pool |    1343 MB |    1723 MB |    5082 GB |    5081 GB |
|       from small pool |    1708 MB |    1710 MB |     502 GB |     500 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5581 GB |    5581 GB |
|       from large pool |  157802 KB |     338 MB |    4972 GB |    4971 GB |
|       from small pool |   28552 KB |    1298 MB |     609 GB |     609 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5064 K  |    5051 K  |
|       from large pool |      61    |      69    |    1143 K  |    1143 K  |
|       from small pool |   13012    |   13021    |    3920 K  |    3907 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5064 K  |    5051 K  |
|       from large pool |      61    |      69    |    1143 K  |    1143 K  |
|       from small pool |   13012    |   13021    |    3920 K  |    3907 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3268 K  |    3267 K  |
|       from large pool |      10    |      14    |     977 K  |     977 K  |
|       from small pool |     873    |    2603    |    2291 K  |    2290 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5579 GB |    5576 GB |
|       from large pool |    1236 MB |    1616 MB |    5077 GB |    5076 GB |
|       from small pool |    1706 MB |    1709 MB |     502 GB |     500 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5579 GB |    5576 GB |
|       from large pool |    1236 MB |    1616 MB |    5077 GB |    5076 GB |
|       from small pool |    1706 MB |    1709 MB |     502 GB |     500 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5553 GB |    5553 GB |
|       from large pool |   19852 KB |     284 MB |    4944 GB |    4944 GB |
|       from small pool |   29962 KB |    1297 MB |     609 GB |     609 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5059 K  |    5046 K  |
|       from large pool |      28    |      36    |    1142 K  |    1142 K  |
|       from small pool |   13002    |   13012    |    3916 K  |    3903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5059 K  |    5046 K  |
|       from large pool |      28    |      36    |    1142 K  |    1142 K  |
|       from small pool |   13002    |   13012    |    3916 K  |    3903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3183 K  |    3182 K  |
|       from large pool |       7    |      11    |     895 K  |     895 K  |
|       from small pool |     871    |    2600    |    2287 K  |    2286 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 52
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0151,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5693 GB |    5690 GB |
|       from large pool |    1343 MB |    1723 MB |    5182 GB |    5180 GB |
|       from small pool |    1708 MB |    1710 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5693 GB |    5690 GB |
|       from large pool |    1343 MB |    1723 MB |    5182 GB |    5180 GB |
|       from small pool |    1708 MB |    1710 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5691 GB |    5691 GB |
|       from large pool |  157802 KB |     338 MB |    5069 GB |    5069 GB |
|       from small pool |   28552 KB |    1298 MB |     621 GB |     621 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5162 K  |    5149 K  |
|       from large pool |      61    |      69    |    1166 K  |    1166 K  |
|       from small pool |   13012    |   13021    |    3996 K  |    3983 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5162 K  |    5149 K  |
|       from large pool |      61    |      69    |    1166 K  |    1166 K  |
|       from small pool |   13012    |   13021    |    3996 K  |    3983 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3332 K  |    3331 K  |
|       from large pool |      10    |      14    |     996 K  |     996 K  |
|       from small pool |     873    |    2603    |    2335 K  |    2334 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5688 GB |    5685 GB |
|       from large pool |    1236 MB |    1616 MB |    5177 GB |    5175 GB |
|       from small pool |    1706 MB |    1709 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5688 GB |    5685 GB |
|       from large pool |    1236 MB |    1616 MB |    5177 GB |    5175 GB |
|       from small pool |    1706 MB |    1709 MB |     511 GB |     510 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5662 GB |    5662 GB |
|       from large pool |   19852 KB |     284 MB |    5041 GB |    5040 GB |
|       from small pool |   29962 KB |    1297 MB |     621 GB |     621 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5157 K  |    5144 K  |
|       from large pool |      28    |      36    |    1164 K  |    1164 K  |
|       from small pool |   13002    |   13012    |    3992 K  |    3979 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5157 K  |    5144 K  |
|       from large pool |      28    |      36    |    1164 K  |    1164 K  |
|       from small pool |   13002    |   13012    |    3992 K  |    3979 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3245 K  |    3244 K  |
|       from large pool |       7    |      11    |     913 K  |     913 K  |
|       from small pool |     871    |    2600    |    2331 K  |    2330 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 53
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0284,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5803 GB |    5800 GB |
|       from large pool |    1343 MB |    1723 MB |    5281 GB |    5280 GB |
|       from small pool |    1708 MB |    1710 MB |     521 GB |     519 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5803 GB |    5800 GB |
|       from large pool |    1343 MB |    1723 MB |    5281 GB |    5280 GB |
|       from small pool |    1708 MB |    1710 MB |     521 GB |     519 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5800 GB |    5800 GB |
|       from large pool |  157802 KB |     338 MB |    5167 GB |    5166 GB |
|       from small pool |   28552 KB |    1298 MB |     633 GB |     633 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5261 K  |    5248 K  |
|       from large pool |      61    |      69    |    1188 K  |    1188 K  |
|       from small pool |   13012    |   13021    |    4072 K  |    4059 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5261 K  |    5248 K  |
|       from large pool |      61    |      69    |    1188 K  |    1188 K  |
|       from small pool |   13012    |   13021    |    4072 K  |    4059 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    3396 K  |    3395 K  |
|       from large pool |      10    |      14    |    1015 K  |    1015 K  |
|       from small pool |     874    |    2603    |    2380 K  |    2379 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5798 GB |    5795 GB |
|       from large pool |    1236 MB |    1616 MB |    5276 GB |    5275 GB |
|       from small pool |    1706 MB |    1709 MB |     521 GB |     519 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5798 GB |    5795 GB |
|       from large pool |    1236 MB |    1616 MB |    5276 GB |    5275 GB |
|       from small pool |    1706 MB |    1709 MB |     521 GB |     519 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5771 GB |    5771 GB |
|       from large pool |   19852 KB |     284 MB |    5137 GB |    5137 GB |
|       from small pool |   29962 KB |    1297 MB |     633 GB |     633 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5256 K  |    5243 K  |
|       from large pool |      28    |      36    |    1187 K  |    1187 K  |
|       from small pool |   13002    |   13012    |    4068 K  |    4055 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5256 K  |    5243 K  |
|       from large pool |      28    |      36    |    1187 K  |    1187 K  |
|       from small pool |   13002    |   13012    |    4068 K  |    4055 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3307 K  |    3306 K  |
|       from large pool |       7    |      11    |     931 K  |     931 K  |
|       from small pool |     871    |    2600    |    2376 K  |    2375 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 54
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0019,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0157,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    5912 GB |    5909 GB |
|       from large pool |    1343 MB |    1723 MB |    5381 GB |    5379 GB |
|       from small pool |    1708 MB |    1710 MB |     531 GB |     529 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    5912 GB |    5909 GB |
|       from large pool |    1343 MB |    1723 MB |    5381 GB |    5379 GB |
|       from small pool |    1708 MB |    1710 MB |     531 GB |     529 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    5909 GB |    5909 GB |
|       from large pool |  157802 KB |     338 MB |    5264 GB |    5264 GB |
|       from small pool |   28552 KB |    1298 MB |     645 GB |     645 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5360 K  |    5347 K  |
|       from large pool |      61    |      69    |    1211 K  |    1211 K  |
|       from small pool |   13012    |   13021    |    4148 K  |    4135 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5360 K  |    5347 K  |
|       from large pool |      61    |      69    |    1211 K  |    1211 K  |
|       from small pool |   13012    |   13021    |    4148 K  |    4135 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    3459 K  |    3458 K  |
|       from large pool |      10    |      14    |    1034 K  |    1034 K  |
|       from small pool |     872    |    2603    |    2425 K  |    2424 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    5907 GB |    5904 GB |
|       from large pool |    1236 MB |    1616 MB |    5376 GB |    5374 GB |
|       from small pool |    1706 MB |    1709 MB |     531 GB |     529 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    5907 GB |    5904 GB |
|       from large pool |    1236 MB |    1616 MB |    5376 GB |    5374 GB |
|       from small pool |    1706 MB |    1709 MB |     531 GB |     529 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5880 GB |    5880 GB |
|       from large pool |   19852 KB |     284 MB |    5234 GB |    5234 GB |
|       from small pool |   29962 KB |    1297 MB |     645 GB |     645 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5354 K  |    5341 K  |
|       from large pool |      28    |      36    |    1209 K  |    1209 K  |
|       from small pool |   13002    |   13012    |    4145 K  |    4132 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5354 K  |    5341 K  |
|       from large pool |      28    |      36    |    1209 K  |    1209 K  |
|       from small pool |   13002    |   13012    |    4145 K  |    4132 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3369 K  |    3368 K  |
|       from large pool |       7    |      11    |     948 K  |     948 K  |
|       from small pool |     871    |    2600    |    2420 K  |    2420 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 55
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0161,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6022 GB |    6019 GB |
|       from large pool |    1343 MB |    1723 MB |    5480 GB |    5479 GB |
|       from small pool |    1708 MB |    1710 MB |     541 GB |     539 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6022 GB |    6019 GB |
|       from large pool |    1343 MB |    1723 MB |    5480 GB |    5479 GB |
|       from small pool |    1708 MB |    1710 MB |     541 GB |     539 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6019 GB |    6019 GB |
|       from large pool |  157802 KB |     338 MB |    5361 GB |    5361 GB |
|       from small pool |   28552 KB |    1298 MB |     657 GB |     657 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5458 K  |    5445 K  |
|       from large pool |      61    |      69    |    1233 K  |    1233 K  |
|       from small pool |   13012    |   13021    |    4225 K  |    4212 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5458 K  |    5445 K  |
|       from large pool |      61    |      69    |    1233 K  |    1233 K  |
|       from small pool |   13012    |   13021    |    4225 K  |    4212 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    3523 K  |    3522 K  |
|       from large pool |      10    |      14    |    1053 K  |    1053 K  |
|       from small pool |     874    |    2603    |    2469 K  |    2468 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6016 GB |    6013 GB |
|       from large pool |    1236 MB |    1616 MB |    5475 GB |    5474 GB |
|       from small pool |    1706 MB |    1709 MB |     541 GB |     539 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6016 GB |    6013 GB |
|       from large pool |    1236 MB |    1616 MB |    5475 GB |    5474 GB |
|       from small pool |    1706 MB |    1709 MB |     541 GB |     539 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    5989 GB |    5989 GB |
|       from large pool |   19852 KB |     284 MB |    5331 GB |    5331 GB |
|       from small pool |   29962 KB |    1297 MB |     657 GB |     657 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5453 K  |    5440 K  |
|       from large pool |      28    |      36    |    1232 K  |    1232 K  |
|       from small pool |   13002    |   13012    |    4221 K  |    4208 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5453 K  |    5440 K  |
|       from large pool |      28    |      36    |    1232 K  |    1232 K  |
|       from small pool |   13002    |   13012    |    4221 K  |    4208 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3431 K  |    3430 K  |
|       from large pool |       7    |      11    |     966 K  |     966 K  |
|       from small pool |     871    |    2600    |    2465 K  |    2464 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 56
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0289,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6131 GB |    6128 GB |
|       from large pool |    1343 MB |    1723 MB |    5580 GB |    5579 GB |
|       from small pool |    1708 MB |    1710 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6131 GB |    6128 GB |
|       from large pool |    1343 MB |    1723 MB |    5580 GB |    5579 GB |
|       from small pool |    1708 MB |    1710 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6128 GB |    6128 GB |
|       from large pool |  157802 KB |     338 MB |    5459 GB |    5459 GB |
|       from small pool |   28552 KB |    1298 MB |     669 GB |     669 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5557 K  |    5544 K  |
|       from large pool |      61    |      69    |    1256 K  |    1255 K  |
|       from small pool |   13012    |   13021    |    4301 K  |    4288 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5557 K  |    5544 K  |
|       from large pool |      61    |      69    |    1256 K  |    1255 K  |
|       from small pool |   13012    |   13021    |    4301 K  |    4288 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3587 K  |    3586 K  |
|       from large pool |      10    |      14    |    1073 K  |    1073 K  |
|       from small pool |     873    |    2603    |    2514 K  |    2513 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6126 GB |    6123 GB |
|       from large pool |    1236 MB |    1616 MB |    5575 GB |    5573 GB |
|       from small pool |    1706 MB |    1709 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6126 GB |    6123 GB |
|       from large pool |    1236 MB |    1616 MB |    5575 GB |    5573 GB |
|       from small pool |    1706 MB |    1709 MB |     550 GB |     549 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6097 GB |    6097 GB |
|       from large pool |   19852 KB |     284 MB |    5428 GB |    5428 GB |
|       from small pool |   29962 KB |    1297 MB |     669 GB |     669 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5552 K  |    5538 K  |
|       from large pool |      28    |      36    |    1254 K  |    1254 K  |
|       from small pool |   13002    |   13012    |    4297 K  |    4284 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5552 K  |    5538 K  |
|       from large pool |      28    |      36    |    1254 K  |    1254 K  |
|       from small pool |   13002    |   13012    |    4297 K  |    4284 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3493 K  |    3492 K  |
|       from large pool |       7    |      11    |     983 K  |     983 K  |
|       from small pool |     871    |    2600    |    2510 K  |    2509 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 57
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0178,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6240 GB |    6237 GB |
|       from large pool |    1343 MB |    1723 MB |    5680 GB |    5678 GB |
|       from small pool |    1708 MB |    1710 MB |     560 GB |     559 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6240 GB |    6237 GB |
|       from large pool |    1343 MB |    1723 MB |    5680 GB |    5678 GB |
|       from small pool |    1708 MB |    1710 MB |     560 GB |     559 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6237 GB |    6237 GB |
|       from large pool |  157802 KB |     338 MB |    5556 GB |    5556 GB |
|       from small pool |   28552 KB |    1298 MB |     681 GB |     680 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5656 K  |    5642 K  |
|       from large pool |      61    |      69    |    1278 K  |    1278 K  |
|       from small pool |   13012    |   13021    |    4377 K  |    4364 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5656 K  |    5642 K  |
|       from large pool |      61    |      69    |    1278 K  |    1278 K  |
|       from small pool |   13012    |   13021    |    4377 K  |    4364 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3651 K  |    3650 K  |
|       from large pool |      10    |      14    |    1092 K  |    1092 K  |
|       from small pool |     873    |    2603    |    2558 K  |    2557 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6235 GB |    6232 GB |
|       from large pool |    1236 MB |    1616 MB |    5674 GB |    5673 GB |
|       from small pool |    1706 MB |    1709 MB |     560 GB |     558 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6235 GB |    6232 GB |
|       from large pool |    1236 MB |    1616 MB |    5674 GB |    5673 GB |
|       from small pool |    1706 MB |    1709 MB |     560 GB |     558 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6206 GB |    6206 GB |
|       from large pool |   19852 KB |     284 MB |    5525 GB |    5525 GB |
|       from small pool |   29962 KB |    1297 MB |     680 GB |     680 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5650 K  |    5637 K  |
|       from large pool |      28    |      36    |    1277 K  |    1276 K  |
|       from small pool |   13002    |   13012    |    4373 K  |    4360 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5650 K  |    5637 K  |
|       from large pool |      28    |      36    |    1277 K  |    1276 K  |
|       from small pool |   13002    |   13012    |    4373 K  |    4360 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3555 K  |    3555 K  |
|       from large pool |       7    |      11    |    1001 K  |    1001 K  |
|       from small pool |     871    |    2600    |    2554 K  |    2553 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 58
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0018],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0132,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6350 GB |    6347 GB |
|       from large pool |    1343 MB |    1723 MB |    5779 GB |    5778 GB |
|       from small pool |    1708 MB |    1710 MB |     570 GB |     568 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6350 GB |    6347 GB |
|       from large pool |    1343 MB |    1723 MB |    5779 GB |    5778 GB |
|       from small pool |    1708 MB |    1710 MB |     570 GB |     568 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6347 GB |    6347 GB |
|       from large pool |  157802 KB |     338 MB |    5654 GB |    5654 GB |
|       from small pool |   28552 KB |    1298 MB |     692 GB |     692 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5754 K  |    5741 K  |
|       from large pool |      61    |      69    |    1300 K  |    1300 K  |
|       from small pool |   13012    |   13021    |    4453 K  |    4440 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5754 K  |    5741 K  |
|       from large pool |      61    |      69    |    1300 K  |    1300 K  |
|       from small pool |   13012    |   13021    |    4453 K  |    4440 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3714 K  |    3714 K  |
|       from large pool |      10    |      14    |    1111 K  |    1111 K  |
|       from small pool |     873    |    2603    |    2603 K  |    2602 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6344 GB |    6341 GB |
|       from large pool |    1236 MB |    1616 MB |    5774 GB |    5772 GB |
|       from small pool |    1706 MB |    1709 MB |     570 GB |     568 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6344 GB |    6341 GB |
|       from large pool |    1236 MB |    1616 MB |    5774 GB |    5772 GB |
|       from small pool |    1706 MB |    1709 MB |     570 GB |     568 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6315 GB |    6315 GB |
|       from large pool |   19852 KB |     284 MB |    5622 GB |    5622 GB |
|       from small pool |   29962 KB |    1297 MB |     692 GB |     692 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5749 K  |    5736 K  |
|       from large pool |      28    |      36    |    1299 K  |    1299 K  |
|       from small pool |   13002    |   13012    |    4449 K  |    4436 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5749 K  |    5736 K  |
|       from large pool |      28    |      36    |    1299 K  |    1299 K  |
|       from small pool |   13002    |   13012    |    4449 K  |    4436 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3618 K  |    3617 K  |
|       from large pool |       7    |      11    |    1018 K  |    1018 K  |
|       from small pool |     871    |    2600    |    2599 K  |    2598 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 59
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0009],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0320,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6459 GB |    6456 GB |
|       from large pool |    1343 MB |    1723 MB |    5879 GB |    5878 GB |
|       from small pool |    1708 MB |    1710 MB |     580 GB |     578 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6459 GB |    6456 GB |
|       from large pool |    1343 MB |    1723 MB |    5879 GB |    5878 GB |
|       from small pool |    1708 MB |    1710 MB |     580 GB |     578 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6456 GB |    6456 GB |
|       from large pool |  157802 KB |     338 MB |    5751 GB |    5751 GB |
|       from small pool |   28552 KB |    1298 MB |     704 GB |     704 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5853 K  |    5840 K  |
|       from large pool |      61    |      69    |    1323 K  |    1323 K  |
|       from small pool |   13012    |   13021    |    4529 K  |    4516 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5853 K  |    5840 K  |
|       from large pool |      61    |      69    |    1323 K  |    1323 K  |
|       from small pool |   13012    |   13021    |    4529 K  |    4516 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    3778 K  |    3777 K  |
|       from large pool |      10    |      14    |    1130 K  |    1130 K  |
|       from small pool |     874    |    2603    |    2648 K  |    2647 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6453 GB |    6450 GB |
|       from large pool |    1236 MB |    1616 MB |    5873 GB |    5872 GB |
|       from small pool |    1706 MB |    1709 MB |     580 GB |     578 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6453 GB |    6450 GB |
|       from large pool |    1236 MB |    1616 MB |    5873 GB |    5872 GB |
|       from small pool |    1706 MB |    1709 MB |     580 GB |     578 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6424 GB |    6424 GB |
|       from large pool |   19852 KB |     284 MB |    5719 GB |    5719 GB |
|       from small pool |   29962 KB |    1297 MB |     704 GB |     704 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5847 K  |    5834 K  |
|       from large pool |      28    |      36    |    1321 K  |    1321 K  |
|       from small pool |   13002    |   13012    |    4525 K  |    4512 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5847 K  |    5834 K  |
|       from large pool |      28    |      36    |    1321 K  |    1321 K  |
|       from small pool |   13002    |   13012    |    4525 K  |    4512 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3680 K  |    3679 K  |
|       from large pool |       7    |      11    |    1036 K  |    1036 K  |
|       from small pool |     871    |    2600    |    2643 K  |    2642 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 60
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0240,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6568 GB |    6565 GB |
|       from large pool |    1343 MB |    1723 MB |    5979 GB |    5977 GB |
|       from small pool |    1708 MB |    1710 MB |     589 GB |     588 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6568 GB |    6565 GB |
|       from large pool |    1343 MB |    1723 MB |    5979 GB |    5977 GB |
|       from small pool |    1708 MB |    1710 MB |     589 GB |     588 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6566 GB |    6565 GB |
|       from large pool |  157802 KB |     338 MB |    5849 GB |    5849 GB |
|       from small pool |   28552 KB |    1298 MB |     716 GB |     716 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    5951 K  |    5938 K  |
|       from large pool |      61    |      69    |    1345 K  |    1345 K  |
|       from small pool |   13012    |   13021    |    4606 K  |    4593 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    5951 K  |    5938 K  |
|       from large pool |      61    |      69    |    1345 K  |    1345 K  |
|       from small pool |   13012    |   13021    |    4606 K  |    4593 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    3842 K  |    3841 K  |
|       from large pool |      10    |      14    |    1149 K  |    1149 K  |
|       from small pool |     872    |    2603    |    2692 K  |    2691 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6563 GB |    6560 GB |
|       from large pool |    1236 MB |    1616 MB |    5973 GB |    5972 GB |
|       from small pool |    1706 MB |    1709 MB |     589 GB |     588 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6563 GB |    6560 GB |
|       from large pool |    1236 MB |    1616 MB |    5973 GB |    5972 GB |
|       from small pool |    1706 MB |    1709 MB |     589 GB |     588 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6533 GB |    6533 GB |
|       from large pool |   19852 KB |     284 MB |    5816 GB |    5816 GB |
|       from small pool |   29962 KB |    1297 MB |     716 GB |     716 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    5946 K  |    5933 K  |
|       from large pool |      28    |      36    |    1344 K  |    1344 K  |
|       from small pool |   13002    |   13012    |    4601 K  |    4588 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    5946 K  |    5933 K  |
|       from large pool |      28    |      36    |    1344 K  |    1344 K  |
|       from small pool |   13002    |   13012    |    4601 K  |    4588 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3742 K  |    3741 K  |
|       from large pool |       7    |      11    |    1054 K  |    1054 K  |
|       from small pool |     871    |    2600    |    2688 K  |    2687 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 61
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0014, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0019,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0122,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6678 GB |    6675 GB |
|       from large pool |    1343 MB |    1723 MB |    6078 GB |    6077 GB |
|       from small pool |    1708 MB |    1710 MB |     599 GB |     598 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6678 GB |    6675 GB |
|       from large pool |    1343 MB |    1723 MB |    6078 GB |    6077 GB |
|       from small pool |    1708 MB |    1710 MB |     599 GB |     598 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6675 GB |    6675 GB |
|       from large pool |  157802 KB |     338 MB |    5946 GB |    5946 GB |
|       from small pool |   28552 KB |    1298 MB |     728 GB |     728 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6050 K  |    6037 K  |
|       from large pool |      61    |      69    |    1368 K  |    1368 K  |
|       from small pool |   13012    |   13021    |    4682 K  |    4669 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6050 K  |    6037 K  |
|       from large pool |      61    |      69    |    1368 K  |    1368 K  |
|       from small pool |   13012    |   13021    |    4682 K  |    4669 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    3906 K  |    3905 K  |
|       from large pool |      10    |      14    |    1168 K  |    1168 K  |
|       from small pool |     874    |    2603    |    2737 K  |    2736 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6672 GB |    6669 GB |
|       from large pool |    1236 MB |    1616 MB |    6072 GB |    6071 GB |
|       from small pool |    1706 MB |    1709 MB |     599 GB |     597 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6672 GB |    6669 GB |
|       from large pool |    1236 MB |    1616 MB |    6072 GB |    6071 GB |
|       from small pool |    1706 MB |    1709 MB |     599 GB |     597 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6641 GB |    6641 GB |
|       from large pool |   19852 KB |     284 MB |    5913 GB |    5913 GB |
|       from small pool |   29962 KB |    1297 MB |     728 GB |     728 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6044 K  |    6031 K  |
|       from large pool |      28    |      36    |    1366 K  |    1366 K  |
|       from small pool |   13002    |   13012    |    4678 K  |    4665 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6044 K  |    6031 K  |
|       from large pool |      28    |      36    |    1366 K  |    1366 K  |
|       from small pool |   13002    |   13012    |    4678 K  |    4665 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3804 K  |    3803 K  |
|       from large pool |       7    |      11    |    1071 K  |    1071 K  |
|       from small pool |     871    |    2600    |    2732 K  |    2731 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 62
batch input size: torch.Size([32, 1855]) batch input size:Device:  torch.Size([32, 1855])0
Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0016, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0181,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6787 GB |    6784 GB |
|       from large pool |    1343 MB |    1723 MB |    6178 GB |    6176 GB |
|       from small pool |    1708 MB |    1710 MB |     609 GB |     607 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6787 GB |    6784 GB |
|       from large pool |    1343 MB |    1723 MB |    6178 GB |    6176 GB |
|       from small pool |    1708 MB |    1710 MB |     609 GB |     607 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6784 GB |    6784 GB |
|       from large pool |  157802 KB |     338 MB |    6044 GB |    6044 GB |
|       from small pool |   28552 KB |    1298 MB |     740 GB |     740 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6149 K  |    6136 K  |
|       from large pool |      61    |      69    |    1390 K  |    1390 K  |
|       from small pool |   13012    |   13021    |    4758 K  |    4745 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6149 K  |    6136 K  |
|       from large pool |      61    |      69    |    1390 K  |    1390 K  |
|       from small pool |   13012    |   13021    |    4758 K  |    4745 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    3970 K  |    3969 K  |
|       from large pool |      10    |      14    |    1188 K  |    1188 K  |
|       from small pool |     873    |    2603    |    2781 K  |    2781 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6781 GB |    6778 GB |
|       from large pool |    1236 MB |    1616 MB |    6172 GB |    6171 GB |
|       from small pool |    1706 MB |    1709 MB |     609 GB |     607 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6781 GB |    6778 GB |
|       from large pool |    1236 MB |    1616 MB |    6172 GB |    6171 GB |
|       from small pool |    1706 MB |    1709 MB |     609 GB |     607 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6750 GB |    6750 GB |
|       from large pool |   19852 KB |     284 MB |    6010 GB |    6010 GB |
|       from small pool |   29962 KB |    1297 MB |     740 GB |     740 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6143 K  |    6130 K  |
|       from large pool |      28    |      36    |    1389 K  |    1388 K  |
|       from small pool |   13002    |   13012    |    4754 K  |    4741 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6143 K  |    6130 K  |
|       from large pool |      28    |      36    |    1389 K  |    1388 K  |
|       from small pool |   13002    |   13012    |    4754 K  |    4741 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3866 K  |    3865 K  |
|       from large pool |       7    |      11    |    1089 K  |    1089 K  |
|       from small pool |     871    |    2600    |    2777 K  |    2776 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 63
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0021, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0307,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    6897 GB |    6894 GB |
|       from large pool |    1343 MB |    1723 MB |    6277 GB |    6276 GB |
|       from small pool |    1708 MB |    1710 MB |     619 GB |     617 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    6897 GB |    6894 GB |
|       from large pool |    1343 MB |    1723 MB |    6277 GB |    6276 GB |
|       from small pool |    1708 MB |    1710 MB |     619 GB |     617 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    6894 GB |    6893 GB |
|       from large pool |  157802 KB |     338 MB |    6141 GB |    6141 GB |
|       from small pool |   28552 KB |    1298 MB |     752 GB |     752 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6247 K  |    6234 K  |
|       from large pool |      61    |      69    |    1413 K  |    1412 K  |
|       from small pool |   13012    |   13021    |    4834 K  |    4821 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6247 K  |    6234 K  |
|       from large pool |      61    |      69    |    1413 K  |    1412 K  |
|       from small pool |   13012    |   13021    |    4834 K  |    4821 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4033 K  |    4032 K  |
|       from large pool |      10    |      14    |    1207 K  |    1207 K  |
|       from small pool |     873    |    2603    |    2826 K  |    2825 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    6891 GB |    6888 GB |
|       from large pool |    1236 MB |    1616 MB |    6271 GB |    6270 GB |
|       from small pool |    1706 MB |    1709 MB |     619 GB |     617 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    6891 GB |    6888 GB |
|       from large pool |    1236 MB |    1616 MB |    6271 GB |    6270 GB |
|       from small pool |    1706 MB |    1709 MB |     619 GB |     617 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6859 GB |    6859 GB |
|       from large pool |   19852 KB |     284 MB |    6107 GB |    6107 GB |
|       from small pool |   29962 KB |    1297 MB |     752 GB |     752 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6241 K  |    6228 K  |
|       from large pool |      28    |      36    |    1411 K  |    1411 K  |
|       from small pool |   13002    |   13012    |    4830 K  |    4817 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6241 K  |    6228 K  |
|       from large pool |      28    |      36    |    1411 K  |    1411 K  |
|       from small pool |   13002    |   13012    |    4830 K  |    4817 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3928 K  |    3927 K  |
|       from large pool |       7    |      11    |    1106 K  |    1106 K  |
|       from small pool |     871    |    2600    |    2821 K  |    2821 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 64
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0215,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7006 GB |    7003 GB |
|       from large pool |    1343 MB |    1723 MB |    6377 GB |    6376 GB |
|       from small pool |    1708 MB |    1710 MB |     629 GB |     627 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7006 GB |    7003 GB |
|       from large pool |    1343 MB |    1723 MB |    6377 GB |    6376 GB |
|       from small pool |    1708 MB |    1710 MB |     629 GB |     627 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7003 GB |    7003 GB |
|       from large pool |  157802 KB |     338 MB |    6239 GB |    6239 GB |
|       from small pool |   28552 KB |    1298 MB |     764 GB |     764 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6346 K  |    6333 K  |
|       from large pool |      61    |      69    |    1435 K  |    1435 K  |
|       from small pool |   13012    |   13021    |    4911 K  |    4898 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6346 K  |    6333 K  |
|       from large pool |      61    |      69    |    1435 K  |    1435 K  |
|       from small pool |   13012    |   13021    |    4911 K  |    4898 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4097 K  |    4096 K  |
|       from large pool |      10    |      14    |    1226 K  |    1226 K  |
|       from small pool |     873    |    2603    |    2871 K  |    2870 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7000 GB |    6997 GB |
|       from large pool |    1236 MB |    1616 MB |    6371 GB |    6370 GB |
|       from small pool |    1706 MB |    1709 MB |     628 GB |     627 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7000 GB |    6997 GB |
|       from large pool |    1236 MB |    1616 MB |    6371 GB |    6370 GB |
|       from small pool |    1706 MB |    1709 MB |     628 GB |     627 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    6968 GB |    6968 GB |
|       from large pool |   19852 KB |     284 MB |    6204 GB |    6204 GB |
|       from small pool |   29962 KB |    1297 MB |     764 GB |     763 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6340 K  |    6327 K  |
|       from large pool |      28    |      36    |    1433 K  |    1433 K  |
|       from small pool |   13002    |   13012    |    4906 K  |    4893 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6340 K  |    6327 K  |
|       from large pool |      28    |      36    |    1433 K  |    1433 K  |
|       from small pool |   13002    |   13012    |    4906 K  |    4893 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    3990 K  |    3989 K  |
|       from large pool |       7    |      11    |    1124 K  |    1124 K  |
|       from small pool |     871    |    2600    |    2866 K  |    2865 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 65
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0009,  ..., -0.0007,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0070,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7115 GB |    7112 GB |
|       from large pool |    1343 MB |    1723 MB |    6477 GB |    6475 GB |
|       from small pool |    1708 MB |    1710 MB |     638 GB |     637 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7115 GB |    7112 GB |
|       from large pool |    1343 MB |    1723 MB |    6477 GB |    6475 GB |
|       from small pool |    1708 MB |    1710 MB |     638 GB |     637 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7112 GB |    7112 GB |
|       from large pool |  157802 KB |     338 MB |    6336 GB |    6336 GB |
|       from small pool |   28552 KB |    1298 MB |     775 GB |     775 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6445 K  |    6432 K  |
|       from large pool |      61    |      69    |    1457 K  |    1457 K  |
|       from small pool |   13012    |   13021    |    4987 K  |    4974 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6445 K  |    6432 K  |
|       from large pool |      61    |      69    |    1457 K  |    1457 K  |
|       from small pool |   13012    |   13021    |    4987 K  |    4974 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    4161 K  |    4160 K  |
|       from large pool |      10    |      14    |    1245 K  |    1245 K  |
|       from small pool |     874    |    2603    |    2915 K  |    2914 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7109 GB |    7106 GB |
|       from large pool |    1236 MB |    1616 MB |    6470 GB |    6469 GB |
|       from small pool |    1706 MB |    1709 MB |     638 GB |     637 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7109 GB |    7106 GB |
|       from large pool |    1236 MB |    1616 MB |    6470 GB |    6469 GB |
|       from small pool |    1706 MB |    1709 MB |     638 GB |     637 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7077 GB |    7077 GB |
|       from large pool |   19852 KB |     284 MB |    6301 GB |    6301 GB |
|       from small pool |   29962 KB |    1297 MB |     775 GB |     775 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6438 K  |    6425 K  |
|       from large pool |      28    |      36    |    1456 K  |    1456 K  |
|       from small pool |   13002    |   13012    |    4982 K  |    4969 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6438 K  |    6425 K  |
|       from large pool |      28    |      36    |    1456 K  |    1456 K  |
|       from small pool |   13002    |   13012    |    4982 K  |    4969 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4052 K  |    4052 K  |
|       from large pool |       7    |      11    |    1141 K  |    1141 K  |
|       from small pool |     871    |    2600    |    2910 K  |    2910 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 66
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0001, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0114,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7225 GB |    7222 GB |
|       from large pool |    1343 MB |    1723 MB |    6576 GB |    6575 GB |
|       from small pool |    1708 MB |    1710 MB |     648 GB |     646 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7225 GB |    7222 GB |
|       from large pool |    1343 MB |    1723 MB |    6576 GB |    6575 GB |
|       from small pool |    1708 MB |    1710 MB |     648 GB |     646 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7222 GB |    7221 GB |
|       from large pool |  157802 KB |     338 MB |    6434 GB |    6434 GB |
|       from small pool |   28552 KB |    1298 MB |     787 GB |     787 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6543 K  |    6530 K  |
|       from large pool |      61    |      69    |    1480 K  |    1480 K  |
|       from small pool |   13012    |   13021    |    5063 K  |    5050 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6543 K  |    6530 K  |
|       from large pool |      61    |      69    |    1480 K  |    1480 K  |
|       from small pool |   13012    |   13021    |    5063 K  |    5050 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    4225 K  |    4224 K  |
|       from large pool |      10    |      14    |    1264 K  |    1264 K  |
|       from small pool |     872    |    2603    |    2960 K  |    2959 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7218 GB |    7215 GB |
|       from large pool |    1236 MB |    1616 MB |    6570 GB |    6569 GB |
|       from small pool |    1706 MB |    1709 MB |     648 GB |     646 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7218 GB |    7215 GB |
|       from large pool |    1236 MB |    1616 MB |    6570 GB |    6569 GB |
|       from small pool |    1706 MB |    1709 MB |     648 GB |     646 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7185 GB |    7185 GB |
|       from large pool |   19852 KB |     284 MB |    6398 GB |    6398 GB |
|       from small pool |   29962 KB |    1297 MB |     787 GB |     787 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6537 K  |    6524 K  |
|       from large pool |      28    |      36    |    1478 K  |    1478 K  |
|       from small pool |   13002    |   13012    |    5058 K  |    5045 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6537 K  |    6524 K  |
|       from large pool |      28    |      36    |    1478 K  |    1478 K  |
|       from small pool |   13002    |   13012    |    5058 K  |    5045 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4115 K  |    4114 K  |
|       from large pool |       7    |      11    |    1159 K  |    1159 K  |
|       from small pool |     871    |    2600    |    2955 K  |    2954 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 67
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0002,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0138,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7334 GB |    7331 GB |
|       from large pool |    1343 MB |    1723 MB |    6676 GB |    6675 GB |
|       from small pool |    1708 MB |    1710 MB |     658 GB |     656 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7334 GB |    7331 GB |
|       from large pool |    1343 MB |    1723 MB |    6676 GB |    6675 GB |
|       from small pool |    1708 MB |    1710 MB |     658 GB |     656 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7331 GB |    7331 GB |
|       from large pool |  157802 KB |     338 MB |    6531 GB |    6531 GB |
|       from small pool |   28552 KB |    1298 MB |     799 GB |     799 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6642 K  |    6629 K  |
|       from large pool |      61    |      69    |    1502 K  |    1502 K  |
|       from small pool |   13012    |   13021    |    5139 K  |    5126 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6642 K  |    6629 K  |
|       from large pool |      61    |      69    |    1502 K  |    1502 K  |
|       from small pool |   13012    |   13021    |    5139 K  |    5126 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    4289 K  |    4288 K  |
|       from large pool |      10    |      14    |    1283 K  |    1283 K  |
|       from small pool |     874    |    2603    |    3005 K  |    3004 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7328 GB |    7325 GB |
|       from large pool |    1236 MB |    1616 MB |    6669 GB |    6668 GB |
|       from small pool |    1706 MB |    1709 MB |     658 GB |     656 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7328 GB |    7325 GB |
|       from large pool |    1236 MB |    1616 MB |    6669 GB |    6668 GB |
|       from small pool |    1706 MB |    1709 MB |     658 GB |     656 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7294 GB |    7294 GB |
|       from large pool |   19852 KB |     284 MB |    6495 GB |    6495 GB |
|       from small pool |   29962 KB |    1297 MB |     799 GB |     799 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6636 K  |    6622 K  |
|       from large pool |      28    |      36    |    1501 K  |    1501 K  |
|       from small pool |   13002    |   13012    |    5134 K  |    5121 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6636 K  |    6622 K  |
|       from large pool |      28    |      36    |    1501 K  |    1501 K  |
|       from small pool |   13002    |   13012    |    5134 K  |    5121 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4177 K  |    4176 K  |
|       from large pool |       7    |      11    |    1177 K  |    1177 K  |
|       from small pool |     871    |    2600    |    3000 K  |    2999 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 68
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0157,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7444 GB |    7441 GB |
|       from large pool |    1343 MB |    1723 MB |    6775 GB |    6774 GB |
|       from small pool |    1708 MB |    1710 MB |     668 GB |     666 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7444 GB |    7441 GB |
|       from large pool |    1343 MB |    1723 MB |    6775 GB |    6774 GB |
|       from small pool |    1708 MB |    1710 MB |     668 GB |     666 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7440 GB |    7440 GB |
|       from large pool |  157802 KB |     338 MB |    6629 GB |    6629 GB |
|       from small pool |   28552 KB |    1298 MB |     811 GB |     811 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6741 K  |    6728 K  |
|       from large pool |      61    |      69    |    1525 K  |    1525 K  |
|       from small pool |   13012    |   13021    |    5215 K  |    5202 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6741 K  |    6728 K  |
|       from large pool |      61    |      69    |    1525 K  |    1525 K  |
|       from small pool |   13012    |   13021    |    5215 K  |    5202 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4352 K  |    4351 K  |
|       from large pool |      10    |      14    |    1303 K  |    1303 K  |
|       from small pool |     873    |    2603    |    3049 K  |    3048 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7437 GB |    7434 GB |
|       from large pool |    1236 MB |    1616 MB |    6769 GB |    6768 GB |
|       from small pool |    1706 MB |    1709 MB |     667 GB |     666 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7437 GB |    7434 GB |
|       from large pool |    1236 MB |    1616 MB |    6769 GB |    6768 GB |
|       from small pool |    1706 MB |    1709 MB |     667 GB |     666 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7403 GB |    7403 GB |
|       from large pool |   19852 KB |     284 MB |    6592 GB |    6592 GB |
|       from small pool |   29962 KB |    1297 MB |     811 GB |     811 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6734 K  |    6721 K  |
|       from large pool |      28    |      36    |    1523 K  |    1523 K  |
|       from small pool |   13002    |   13012    |    5211 K  |    5198 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6734 K  |    6721 K  |
|       from large pool |      28    |      36    |    1523 K  |    1523 K  |
|       from small pool |   13002    |   13012    |    5211 K  |    5198 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4239 K  |    4238 K  |
|       from large pool |       7    |      11    |    1194 K  |    1194 K  |
|       from small pool |     871    |    2600    |    3044 K  |    3043 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 69
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0109,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7553 GB |    7550 GB |
|       from large pool |    1343 MB |    1723 MB |    6875 GB |    6874 GB |
|       from small pool |    1708 MB |    1710 MB |     677 GB |     676 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7553 GB |    7550 GB |
|       from large pool |    1343 MB |    1723 MB |    6875 GB |    6874 GB |
|       from small pool |    1708 MB |    1710 MB |     677 GB |     676 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7550 GB |    7549 GB |
|       from large pool |  157802 KB |     338 MB |    6726 GB |    6726 GB |
|       from small pool |   28552 KB |    1298 MB |     823 GB |     823 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6839 K  |    6826 K  |
|       from large pool |      61    |      69    |    1547 K  |    1547 K  |
|       from small pool |   13012    |   13021    |    5292 K  |    5279 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6839 K  |    6826 K  |
|       from large pool |      61    |      69    |    1547 K  |    1547 K  |
|       from small pool |   13012    |   13021    |    5292 K  |    5279 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4416 K  |    4415 K  |
|       from large pool |      10    |      14    |    1322 K  |    1322 K  |
|       from small pool |     873    |    2603    |    3094 K  |    3093 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7546 GB |    7543 GB |
|       from large pool |    1236 MB |    1616 MB |    6868 GB |    6867 GB |
|       from small pool |    1706 MB |    1709 MB |     677 GB |     676 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7546 GB |    7543 GB |
|       from large pool |    1236 MB |    1616 MB |    6868 GB |    6867 GB |
|       from small pool |    1706 MB |    1709 MB |     677 GB |     676 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7512 GB |    7512 GB |
|       from large pool |   19852 KB |     284 MB |    6688 GB |    6688 GB |
|       from small pool |   29962 KB |    1297 MB |     823 GB |     823 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6833 K  |    6820 K  |
|       from large pool |      28    |      36    |    1545 K  |    1545 K  |
|       from small pool |   13002    |   13012    |    5287 K  |    5274 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6833 K  |    6820 K  |
|       from large pool |      28    |      36    |    1545 K  |    1545 K  |
|       from small pool |   13002    |   13012    |    5287 K  |    5274 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4301 K  |    4300 K  |
|       from large pool |       7    |      11    |    1212 K  |    1212 K  |
|       from small pool |     871    |    2600    |    3089 K  |    3088 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 70
batch input size: torch.Size([32, 1855])batch input size:  Device:torch.Size([32, 1855])  0Device:
 1tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0087,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7662 GB |    7659 GB |
|       from large pool |    1343 MB |    1723 MB |    6975 GB |    6973 GB |
|       from small pool |    1708 MB |    1710 MB |     687 GB |     685 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7662 GB |    7659 GB |
|       from large pool |    1343 MB |    1723 MB |    6975 GB |    6973 GB |
|       from small pool |    1708 MB |    1710 MB |     687 GB |     685 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7659 GB |    7659 GB |
|       from large pool |  157802 KB |     338 MB |    6824 GB |    6824 GB |
|       from small pool |   28552 KB |    1298 MB |     835 GB |     835 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    6938 K  |    6925 K  |
|       from large pool |      61    |      69    |    1570 K  |    1569 K  |
|       from small pool |   13012    |   13021    |    5368 K  |    5355 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    6938 K  |    6925 K  |
|       from large pool |      61    |      69    |    1570 K  |    1569 K  |
|       from small pool |   13012    |   13021    |    5368 K  |    5355 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4480 K  |    4479 K  |
|       from large pool |      10    |      14    |    1341 K  |    1341 K  |
|       from small pool |     873    |    2603    |    3138 K  |    3138 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7656 GB |    7653 GB |
|       from large pool |    1236 MB |    1616 MB |    6968 GB |    6967 GB |
|       from small pool |    1706 MB |    1709 MB |     687 GB |     685 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7656 GB |    7653 GB |
|       from large pool |    1236 MB |    1616 MB |    6968 GB |    6967 GB |
|       from small pool |    1706 MB |    1709 MB |     687 GB |     685 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7621 GB |    7621 GB |
|       from large pool |   19852 KB |     284 MB |    6785 GB |    6785 GB |
|       from small pool |   29962 KB |    1297 MB |     835 GB |     835 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    6931 K  |    6918 K  |
|       from large pool |      28    |      36    |    1568 K  |    1568 K  |
|       from small pool |   13002    |   13012    |    5363 K  |    5350 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    6931 K  |    6918 K  |
|       from large pool |      28    |      36    |    1568 K  |    1568 K  |
|       from small pool |   13002    |   13012    |    5363 K  |    5350 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4363 K  |    4362 K  |
|       from large pool |       7    |      11    |    1229 K  |    1229 K  |
|       from small pool |     871    |    2600    |    3133 K  |    3132 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 71
batch input size: torch.Size([32, 1855]) batch input size:Device:  torch.Size([32, 1855])0
Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0163,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7772 GB |    7769 GB |
|       from large pool |    1343 MB |    1723 MB |    7074 GB |    7073 GB |
|       from small pool |    1708 MB |    1710 MB |     697 GB |     695 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7772 GB |    7769 GB |
|       from large pool |    1343 MB |    1723 MB |    7074 GB |    7073 GB |
|       from small pool |    1708 MB |    1710 MB |     697 GB |     695 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7768 GB |    7768 GB |
|       from large pool |  157802 KB |     338 MB |    6921 GB |    6921 GB |
|       from small pool |   28552 KB |    1298 MB |     847 GB |     847 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7037 K  |    7023 K  |
|       from large pool |      61    |      69    |    1592 K  |    1592 K  |
|       from small pool |   13012    |   13021    |    5444 K  |    5431 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7037 K  |    7023 K  |
|       from large pool |      61    |      69    |    1592 K  |    1592 K  |
|       from small pool |   13012    |   13021    |    5444 K  |    5431 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    4544 K  |    4543 K  |
|       from large pool |      10    |      14    |    1360 K  |    1360 K  |
|       from small pool |     874    |    2603    |    3183 K  |    3182 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7765 GB |    7762 GB |
|       from large pool |    1236 MB |    1616 MB |    7068 GB |    7066 GB |
|       from small pool |    1706 MB |    1709 MB |     697 GB |     695 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7765 GB |    7762 GB |
|       from large pool |    1236 MB |    1616 MB |    7068 GB |    7066 GB |
|       from small pool |    1706 MB |    1709 MB |     697 GB |     695 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7729 GB |    7729 GB |
|       from large pool |   19852 KB |     284 MB |    6882 GB |    6882 GB |
|       from small pool |   29962 KB |    1297 MB |     847 GB |     847 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7030 K  |    7017 K  |
|       from large pool |      28    |      36    |    1590 K  |    1590 K  |
|       from small pool |   13002    |   13012    |    5439 K  |    5426 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7030 K  |    7017 K  |
|       from large pool |      28    |      36    |    1590 K  |    1590 K  |
|       from small pool |   13002    |   13012    |    5439 K  |    5426 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4425 K  |    4424 K  |
|       from large pool |       7    |      11    |    1247 K  |    1247 K  |
|       from small pool |     871    |    2600    |    3178 K  |    3177 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 72
batch input size: torch.Size([32, 1855]) Device: 0
batch input size: torch.Size([32, 1855]) Device: 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0272,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7881 GB |    7878 GB |
|       from large pool |    1343 MB |    1723 MB |    7174 GB |    7173 GB |
|       from small pool |    1708 MB |    1710 MB |     707 GB |     705 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7881 GB |    7878 GB |
|       from large pool |    1343 MB |    1723 MB |    7174 GB |    7173 GB |
|       from small pool |    1708 MB |    1710 MB |     707 GB |     705 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7878 GB |    7878 GB |
|       from large pool |  157802 KB |     338 MB |    7019 GB |    7019 GB |
|       from small pool |   28552 KB |    1298 MB |     858 GB |     858 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7135 K  |    7122 K  |
|       from large pool |      61    |      69    |    1614 K  |    1614 K  |
|       from small pool |   13012    |   13021    |    5520 K  |    5507 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7135 K  |    7122 K  |
|       from large pool |      61    |      69    |    1614 K  |    1614 K  |
|       from small pool |   13012    |   13021    |    5520 K  |    5507 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    4607 K  |    4606 K  |
|       from large pool |      10    |      14    |    1379 K  |    1379 K  |
|       from small pool |     872    |    2603    |    3228 K  |    3227 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7874 GB |    7871 GB |
|       from large pool |    1236 MB |    1616 MB |    7167 GB |    7166 GB |
|       from small pool |    1706 MB |    1709 MB |     707 GB |     705 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7874 GB |    7871 GB |
|       from large pool |    1236 MB |    1616 MB |    7167 GB |    7166 GB |
|       from small pool |    1706 MB |    1709 MB |     707 GB |     705 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7838 GB |    7838 GB |
|       from large pool |   19852 KB |     284 MB |    6979 GB |    6979 GB |
|       from small pool |   29962 KB |    1297 MB |     858 GB |     858 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7128 K  |    7115 K  |
|       from large pool |      28    |      36    |    1613 K  |    1613 K  |
|       from small pool |   13002    |   13012    |    5515 K  |    5502 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7128 K  |    7115 K  |
|       from large pool |      28    |      36    |    1613 K  |    1613 K  |
|       from small pool |   13002    |   13012    |    5515 K  |    5502 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4487 K  |    4486 K  |
|       from large pool |       7    |      11    |    1264 K  |    1264 K  |
|       from small pool |     871    |    2600    |    3222 K  |    3221 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 73
batch input size: torch.Size([32, 1855])batch input size:  Device:torch.Size([32, 1855])  0Device:
 1
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:1', grad_fn=<BroadcastBackward>)
tensor([[ 0.0016, -0.0003,  0.0018,  ..., -0.0019, -0.0018,  0.0010],
        [ 0.0002, -0.0013, -0.0008,  ..., -0.0008,  0.0001,  0.0011],
        [ 0.0010, -0.0005,  0.0022,  ..., -0.0010, -0.0009, -0.0017],
        ...,
        [ 0.0022, -0.0012, -0.0018,  ..., -0.0013,  0.0007, -0.0019],
        [ 0.0022, -0.0009,  0.0016,  ..., -0.0003,  0.0018,  0.0017],
        [-0.0015, -0.0018, -0.0018,  ...,  0.0016, -0.0013, -0.0004]],
       device='cuda:0', grad_fn=<BroadcastBackward>)
step loss: tensor([0.0211,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    7990 GB |    7987 GB |
|       from large pool |    1343 MB |    1723 MB |    7274 GB |    7272 GB |
|       from small pool |    1708 MB |    1710 MB |     716 GB |     715 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    7990 GB |    7987 GB |
|       from large pool |    1343 MB |    1723 MB |    7274 GB |    7272 GB |
|       from small pool |    1708 MB |    1710 MB |     716 GB |     715 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    7987 GB |    7987 GB |
|       from large pool |  157802 KB |     338 MB |    7116 GB |    7116 GB |
|       from small pool |   28552 KB |    1298 MB |     870 GB |     870 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7234 K  |    7221 K  |
|       from large pool |      61    |      69    |    1637 K  |    1637 K  |
|       from small pool |   13012    |   13021    |    5596 K  |    5583 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7234 K  |    7221 K  |
|       from large pool |      61    |      69    |    1637 K  |    1637 K  |
|       from small pool |   13012    |   13021    |    5596 K  |    5583 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    4671 K  |    4670 K  |
|       from large pool |      10    |      14    |    1398 K  |    1398 K  |
|       from small pool |     874    |    2603    |    3272 K  |    3271 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    7983 GB |    7981 GB |
|       from large pool |    1236 MB |    1616 MB |    7267 GB |    7265 GB |
|       from small pool |    1706 MB |    1709 MB |     716 GB |     715 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    7983 GB |    7981 GB |
|       from large pool |    1236 MB |    1616 MB |    7267 GB |    7265 GB |
|       from small pool |    1706 MB |    1709 MB |     716 GB |     715 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    7947 GB |    7947 GB |
|       from large pool |   19852 KB |     284 MB |    7076 GB |    7076 GB |
|       from small pool |   29962 KB |    1297 MB |     870 GB |     870 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7227 K  |    7214 K  |
|       from large pool |      28    |      36    |    1635 K  |    1635 K  |
|       from small pool |   13002    |   13012    |    5591 K  |    5578 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7227 K  |    7214 K  |
|       from large pool |      28    |      36    |    1635 K  |    1635 K  |
|       from small pool |   13002    |   13012    |    5591 K  |    5578 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4549 K  |    4548 K  |
|       from large pool |       7    |      11    |    1282 K  |    1282 K  |
|       from small pool |     871    |    2600    |    3267 K  |    3266 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 74
batch input size: torch.Size([32, 1855]) Device:batch input size:  0torch.Size([32, 1855])
 Device: 1
tensor([[ 1.5915e-03, -3.3566e-04,  1.7758e-03,  ..., -1.8771e-03,
         -1.8076e-03,  9.7958e-04],
        [ 1.6853e-04, -1.3191e-03, -8.2965e-04,  ..., -7.7092e-04,
          9.9982e-05,  1.0940e-03],
        [ 9.9905e-04, -5.1399e-04,  2.1973e-03,  ..., -1.0292e-03,
         -9.3182e-04, -1.7147e-03],
        ...,
        [ 2.1786e-03, -1.2264e-03, -1.7543e-03,  ..., -1.3046e-03,
          6.5521e-04, -1.8623e-03],
        [ 2.1762e-03, -9.0627e-04,  1.6099e-03,  ..., -2.6615e-04,
          1.8203e-03,  1.7153e-03],
        [-1.5292e-03, -1.8129e-03, -1.7730e-03,  ...,  1.5864e-03,
         -1.3502e-03, -4.2129e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5915e-03, -3.3566e-04,  1.7758e-03,  ..., -1.8771e-03,
         -1.8076e-03,  9.7958e-04],
        [ 1.6853e-04, -1.3191e-03, -8.2965e-04,  ..., -7.7092e-04,
          9.9982e-05,  1.0940e-03],
        [ 9.9905e-04, -5.1399e-04,  2.1973e-03,  ..., -1.0292e-03,
         -9.3182e-04, -1.7147e-03],
        ...,
        [ 2.1786e-03, -1.2264e-03, -1.7543e-03,  ..., -1.3046e-03,
          6.5521e-04, -1.8623e-03],
        [ 2.1762e-03, -9.0627e-04,  1.6099e-03,  ..., -2.6615e-04,
          1.8203e-03,  1.7153e-03],
        [-1.5292e-03, -1.8129e-03, -1.7730e-03,  ...,  1.5864e-03,
         -1.3502e-03, -4.2129e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0123,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    8100 GB |    8097 GB |
|       from large pool |    1343 MB |    1723 MB |    7373 GB |    7372 GB |
|       from small pool |    1708 MB |    1710 MB |     726 GB |     724 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    8100 GB |    8097 GB |
|       from large pool |    1343 MB |    1723 MB |    7373 GB |    7372 GB |
|       from small pool |    1708 MB |    1710 MB |     726 GB |     724 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    8096 GB |    8096 GB |
|       from large pool |  157802 KB |     338 MB |    7214 GB |    7214 GB |
|       from small pool |   28552 KB |    1298 MB |     882 GB |     882 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7332 K  |    7319 K  |
|       from large pool |      61    |      69    |    1659 K  |    1659 K  |
|       from small pool |   13012    |   13021    |    5673 K  |    5660 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7332 K  |    7319 K  |
|       from large pool |      61    |      69    |    1659 K  |    1659 K  |
|       from small pool |   13012    |   13021    |    5673 K  |    5660 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4735 K  |    4734 K  |
|       from large pool |      10    |      14    |    1418 K  |    1418 K  |
|       from small pool |     873    |    2603    |    3317 K  |    3316 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    8093 GB |    8090 GB |
|       from large pool |    1236 MB |    1616 MB |    7366 GB |    7365 GB |
|       from small pool |    1706 MB |    1709 MB |     726 GB |     724 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    8093 GB |    8090 GB |
|       from large pool |    1236 MB |    1616 MB |    7366 GB |    7365 GB |
|       from small pool |    1706 MB |    1709 MB |     726 GB |     724 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    8056 GB |    8056 GB |
|       from large pool |   19852 KB |     284 MB |    7173 GB |    7173 GB |
|       from small pool |   29962 KB |    1297 MB |     882 GB |     882 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7325 K  |    7312 K  |
|       from large pool |      28    |      36    |    1657 K  |    1657 K  |
|       from small pool |   13002    |   13012    |    5667 K  |    5654 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7325 K  |    7312 K  |
|       from large pool |      28    |      36    |    1657 K  |    1657 K  |
|       from small pool |   13002    |   13012    |    5667 K  |    5654 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4611 K  |    4611 K  |
|       from large pool |       7    |      11    |    1300 K  |    1300 K  |
|       from small pool |     871    |    2600    |    3311 K  |    3311 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 75
batch input size: torch.Size([32, 1855]) Device: batch input size:0
torch.Size([32, 1855]) Device: 1
tensor([[ 1.5898e-03, -3.3733e-04,  1.7742e-03,  ..., -1.8754e-03,
         -1.8060e-03,  9.8126e-04],
        [ 1.6979e-04, -1.3179e-03, -8.2839e-04,  ..., -7.7217e-04,
          9.8722e-05,  1.0927e-03],
        [ 1.0078e-03, -5.0530e-04,  2.2060e-03,  ..., -1.0379e-03,
         -9.4050e-04, -1.7234e-03],
        ...,
        [ 2.1790e-03, -1.2259e-03, -1.7539e-03,  ..., -1.3050e-03,
          6.5479e-04, -1.8628e-03],
        [ 2.1783e-03, -9.0412e-04,  1.6121e-03,  ..., -2.6830e-04,
          1.8182e-03,  1.7131e-03],
        [-1.5276e-03, -1.8113e-03, -1.7714e-03,  ...,  1.5848e-03,
         -1.3517e-03, -4.2284e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)tensor([[ 1.5898e-03, -3.3733e-04,  1.7742e-03,  ..., -1.8754e-03,
         -1.8060e-03,  9.8126e-04],
        [ 1.6979e-04, -1.3179e-03, -8.2839e-04,  ..., -7.7217e-04,
          9.8722e-05,  1.0927e-03],
        [ 1.0078e-03, -5.0530e-04,  2.2060e-03,  ..., -1.0379e-03,
         -9.4050e-04, -1.7234e-03],
        ...,
        [ 2.1790e-03, -1.2259e-03, -1.7539e-03,  ..., -1.3050e-03,
          6.5479e-04, -1.8628e-03],
        [ 2.1783e-03, -9.0412e-04,  1.6121e-03,  ..., -2.6830e-04,
          1.8182e-03,  1.7131e-03],
        [-1.5276e-03, -1.8113e-03, -1.7714e-03,  ...,  1.5848e-03,
         -1.3517e-03, -4.2284e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0126,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    8209 GB |    8206 GB |
|       from large pool |    1343 MB |    1723 MB |    7473 GB |    7472 GB |
|       from small pool |    1708 MB |    1710 MB |     736 GB |     734 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    8209 GB |    8206 GB |
|       from large pool |    1343 MB |    1723 MB |    7473 GB |    7472 GB |
|       from small pool |    1708 MB |    1710 MB |     736 GB |     734 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    8206 GB |    8206 GB |
|       from large pool |  157802 KB |     338 MB |    7311 GB |    7311 GB |
|       from small pool |   28552 KB |    1298 MB |     894 GB |     894 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7431 K  |    7418 K  |
|       from large pool |      61    |      69    |    1682 K  |    1682 K  |
|       from small pool |   13012    |   13021    |    5749 K  |    5736 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7431 K  |    7418 K  |
|       from large pool |      61    |      69    |    1682 K  |    1682 K  |
|       from small pool |   13012    |   13021    |    5749 K  |    5736 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4799 K  |    4798 K  |
|       from large pool |      10    |      14    |    1437 K  |    1437 K  |
|       from small pool |     873    |    2603    |    3362 K  |    3361 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    8202 GB |    8199 GB |
|       from large pool |    1236 MB |    1616 MB |    7466 GB |    7464 GB |
|       from small pool |    1706 MB |    1709 MB |     736 GB |     734 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    8202 GB |    8199 GB |
|       from large pool |    1236 MB |    1616 MB |    7466 GB |    7464 GB |
|       from small pool |    1706 MB |    1709 MB |     736 GB |     734 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    8165 GB |    8165 GB |
|       from large pool |   19852 KB |     284 MB |    7270 GB |    7270 GB |
|       from small pool |   29962 KB |    1297 MB |     894 GB |     894 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7424 K  |    7411 K  |
|       from large pool |      28    |      36    |    1680 K  |    1680 K  |
|       from small pool |   13002    |   13012    |    5744 K  |    5731 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7424 K  |    7411 K  |
|       from large pool |      28    |      36    |    1680 K  |    1680 K  |
|       from small pool |   13002    |   13012    |    5744 K  |    5731 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4674 K  |    4673 K  |
|       from large pool |       7    |      11    |    1317 K  |    1317 K  |
|       from small pool |     871    |    2600    |    3356 K  |    3355 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 76
batch input size: torch.Size([32, 1855])batch input size:  Device:torch.Size([32, 1855])  0Device:
 1
tensor([[ 1.5890e-03, -3.3817e-04,  1.7733e-03,  ..., -1.8746e-03,
         -1.8051e-03,  9.8210e-04],
        [ 1.7112e-04, -1.3165e-03, -8.2707e-04,  ..., -7.7348e-04,
          9.7397e-05,  1.0913e-03],
        [ 1.0158e-03, -4.9731e-04,  2.2140e-03,  ..., -1.0458e-03,
         -9.4847e-04, -1.7314e-03],
        ...,
        [ 2.1794e-03, -1.2255e-03, -1.7535e-03,  ..., -1.3054e-03,
          6.5437e-04, -1.8632e-03],
        [ 2.1804e-03, -9.0202e-04,  1.6141e-03,  ..., -2.7039e-04,
          1.8160e-03,  1.7110e-03],
        [-1.5261e-03, -1.8098e-03, -1.7699e-03,  ...,  1.5833e-03,
         -1.3532e-03, -4.2437e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5890e-03, -3.3817e-04,  1.7733e-03,  ..., -1.8746e-03,
         -1.8051e-03,  9.8210e-04],
        [ 1.7112e-04, -1.3165e-03, -8.2707e-04,  ..., -7.7348e-04,
          9.7397e-05,  1.0913e-03],
        [ 1.0158e-03, -4.9731e-04,  2.2140e-03,  ..., -1.0458e-03,
         -9.4847e-04, -1.7314e-03],
        ...,
        [ 2.1794e-03, -1.2255e-03, -1.7535e-03,  ..., -1.3054e-03,
          6.5437e-04, -1.8632e-03],
        [ 2.1804e-03, -9.0202e-04,  1.6141e-03,  ..., -2.7039e-04,
          1.8160e-03,  1.7110e-03],
        [-1.5261e-03, -1.8098e-03, -1.7699e-03,  ...,  1.5833e-03,
         -1.3532e-03, -4.2437e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0215,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    8319 GB |    8316 GB |
|       from large pool |    1343 MB |    1723 MB |    7572 GB |    7571 GB |
|       from small pool |    1708 MB |    1710 MB |     746 GB |     744 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    8319 GB |    8316 GB |
|       from large pool |    1343 MB |    1723 MB |    7572 GB |    7571 GB |
|       from small pool |    1708 MB |    1710 MB |     746 GB |     744 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    8315 GB |    8315 GB |
|       from large pool |  157802 KB |     338 MB |    7409 GB |    7409 GB |
|       from small pool |   28552 KB |    1298 MB |     906 GB |     906 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7530 K  |    7517 K  |
|       from large pool |      61    |      69    |    1704 K  |    1704 K  |
|       from small pool |   13012    |   13021    |    5825 K  |    5812 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7530 K  |    7517 K  |
|       from large pool |      61    |      69    |    1704 K  |    1704 K  |
|       from small pool |   13012    |   13021    |    5825 K  |    5812 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     883    |    2614    |    4863 K  |    4862 K  |
|       from large pool |      10    |      14    |    1456 K  |    1456 K  |
|       from small pool |     873    |    2603    |    3406 K  |    3405 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    8311 GB |    8308 GB |
|       from large pool |    1236 MB |    1616 MB |    7565 GB |    7564 GB |
|       from small pool |    1706 MB |    1709 MB |     746 GB |     744 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    8311 GB |    8308 GB |
|       from large pool |    1236 MB |    1616 MB |    7565 GB |    7564 GB |
|       from small pool |    1706 MB |    1709 MB |     746 GB |     744 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    8273 GB |    8273 GB |
|       from large pool |   19852 KB |     284 MB |    7367 GB |    7367 GB |
|       from small pool |   29962 KB |    1297 MB |     906 GB |     906 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7522 K  |    7509 K  |
|       from large pool |      28    |      36    |    1702 K  |    1702 K  |
|       from small pool |   13002    |   13012    |    5820 K  |    5807 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7522 K  |    7509 K  |
|       from large pool |      28    |      36    |    1702 K  |    1702 K  |
|       from small pool |   13002    |   13012    |    5820 K  |    5807 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4736 K  |    4735 K  |
|       from large pool |       7    |      11    |    1335 K  |    1335 K  |
|       from small pool |     871    |    2600    |    3400 K  |    3400 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 77
batch input size:batch input size:  torch.Size([32, 1855])torch.Size([32, 1855])  Device:Device:  01
tensor([[ 1.5878e-03, -3.3930e-04,  1.7722e-03,  ..., -1.8734e-03,
         -1.8040e-03,  9.8323e-04],
        [ 1.7162e-04, -1.3160e-03, -8.2656e-04,  ..., -7.7398e-04,
          9.6894e-05,  1.0908e-03],
        [ 1.0230e-03, -4.9009e-04,  2.2213e-03,  ..., -1.0530e-03,
         -9.5568e-04, -1.7386e-03],
        ...,
        [ 2.1798e-03, -1.2251e-03, -1.7531e-03,  ..., -1.3058e-03,
          6.5396e-04, -1.8636e-03],
        [ 2.1824e-03, -9.0000e-04,  1.6162e-03,  ..., -2.7241e-04,
          1.8140e-03,  1.7090e-03],
        [-1.5246e-03, -1.8083e-03, -1.7684e-03,  ...,  1.5818e-03,
         -1.3547e-03, -4.2585e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5878e-03, -3.3930e-04,  1.7722e-03,  ..., -1.8734e-03,
         -1.8040e-03,  9.8323e-04],
        [ 1.7162e-04, -1.3160e-03, -8.2656e-04,  ..., -7.7398e-04,
          9.6894e-05,  1.0908e-03],
        [ 1.0230e-03, -4.9009e-04,  2.2213e-03,  ..., -1.0530e-03,
         -9.5568e-04, -1.7386e-03],
        ...,
        [ 2.1798e-03, -1.2251e-03, -1.7531e-03,  ..., -1.3058e-03,
          6.5396e-04, -1.8636e-03],
        [ 2.1824e-03, -9.0000e-04,  1.6162e-03,  ..., -2.7241e-04,
          1.8140e-03,  1.7090e-03],
        [-1.5246e-03, -1.8083e-03, -1.7684e-03,  ...,  1.5818e-03,
         -1.3547e-03, -4.2585e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0155,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    8428 GB |    8425 GB |
|       from large pool |    1343 MB |    1723 MB |    7672 GB |    7671 GB |
|       from small pool |    1708 MB |    1710 MB |     755 GB |     754 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    8428 GB |    8425 GB |
|       from large pool |    1343 MB |    1723 MB |    7672 GB |    7671 GB |
|       from small pool |    1708 MB |    1710 MB |     755 GB |     754 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    8424 GB |    8424 GB |
|       from large pool |  157802 KB |     338 MB |    7506 GB |    7506 GB |
|       from small pool |   28552 KB |    1298 MB |     918 GB |     918 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7628 K  |    7615 K  |
|       from large pool |      61    |      69    |    1727 K  |    1726 K  |
|       from small pool |   13012    |   13021    |    5901 K  |    5888 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7628 K  |    7615 K  |
|       from large pool |      61    |      69    |    1727 K  |    1726 K  |
|       from small pool |   13012    |   13021    |    5901 K  |    5888 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    4926 K  |    4925 K  |
|       from large pool |      10    |      14    |    1475 K  |    1475 K  |
|       from small pool |     874    |    2603    |    3451 K  |    3450 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    8421 GB |    8418 GB |
|       from large pool |    1236 MB |    1616 MB |    7665 GB |    7663 GB |
|       from small pool |    1706 MB |    1709 MB |     755 GB |     754 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    8421 GB |    8418 GB |
|       from large pool |    1236 MB |    1616 MB |    7665 GB |    7663 GB |
|       from small pool |    1706 MB |    1709 MB |     755 GB |     754 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    8382 GB |    8382 GB |
|       from large pool |   19852 KB |     284 MB |    7464 GB |    7464 GB |
|       from small pool |   29962 KB |    1297 MB |     918 GB |     918 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7621 K  |    7608 K  |
|       from large pool |      28    |      36    |    1725 K  |    1725 K  |
|       from small pool |   13002    |   13012    |    5896 K  |    5883 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7621 K  |    7608 K  |
|       from large pool |      28    |      36    |    1725 K  |    1725 K  |
|       from small pool |   13002    |   13012    |    5896 K  |    5883 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4798 K  |    4797 K  |
|       from large pool |       7    |      11    |    1352 K  |    1352 K  |
|       from small pool |     871    |    2600    |    3445 K  |    3444 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 78
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 1.5871e-03, -3.4008e-04,  1.7714e-03,  ..., -1.8727e-03,
         -1.8032e-03,  9.8401e-04],
        [ 1.7320e-04, -1.3144e-03, -8.2499e-04,  ..., -7.7555e-04,
          9.5317e-05,  1.0892e-03],
        [ 1.0333e-03, -4.7986e-04,  2.2315e-03,  ..., -1.0632e-03,
         -9.6590e-04, -1.7488e-03],
        ...,
        [ 2.1802e-03, -1.2247e-03, -1.7527e-03,  ..., -1.3062e-03,
          6.5358e-04, -1.8639e-03],
        [ 2.1843e-03, -8.9811e-04,  1.6180e-03,  ..., -2.7429e-04,
          1.8121e-03,  1.7070e-03],
        [-1.5232e-03, -1.8069e-03, -1.7670e-03,  ...,  1.5804e-03,
         -1.3561e-03, -4.2724e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5871e-03, -3.4008e-04,  1.7714e-03,  ..., -1.8727e-03,
         -1.8032e-03,  9.8401e-04],
        [ 1.7320e-04, -1.3144e-03, -8.2499e-04,  ..., -7.7555e-04,
          9.5317e-05,  1.0892e-03],
        [ 1.0333e-03, -4.7986e-04,  2.2315e-03,  ..., -1.0632e-03,
         -9.6590e-04, -1.7488e-03],
        ...,
        [ 2.1802e-03, -1.2247e-03, -1.7527e-03,  ..., -1.3062e-03,
          6.5358e-04, -1.8639e-03],
        [ 2.1843e-03, -8.9811e-04,  1.6180e-03,  ..., -2.7429e-04,
          1.8121e-03,  1.7070e-03],
        [-1.5232e-03, -1.8069e-03, -1.7670e-03,  ...,  1.5804e-03,
         -1.3561e-03, -4.2724e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0321,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    8537 GB |    8534 GB |
|       from large pool |    1343 MB |    1723 MB |    7772 GB |    7770 GB |
|       from small pool |    1708 MB |    1710 MB |     765 GB |     763 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    8537 GB |    8534 GB |
|       from large pool |    1343 MB |    1723 MB |    7772 GB |    7770 GB |
|       from small pool |    1708 MB |    1710 MB |     765 GB |     763 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    8534 GB |    8534 GB |
|       from large pool |  157802 KB |     338 MB |    7604 GB |    7604 GB |
|       from small pool |   28552 KB |    1298 MB |     930 GB |     930 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7727 K  |    7714 K  |
|       from large pool |      61    |      69    |    1749 K  |    1749 K  |
|       from small pool |   13012    |   13021    |    5978 K  |    5965 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7727 K  |    7714 K  |
|       from large pool |      61    |      69    |    1749 K  |    1749 K  |
|       from small pool |   13012    |   13021    |    5978 K  |    5965 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     882    |    2614    |    4990 K  |    4989 K  |
|       from large pool |      10    |      14    |    1494 K  |    1494 K  |
|       from small pool |     872    |    2603    |    3495 K  |    3494 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    8530 GB |    8527 GB |
|       from large pool |    1236 MB |    1616 MB |    7764 GB |    7763 GB |
|       from small pool |    1706 MB |    1709 MB |     765 GB |     763 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    8530 GB |    8527 GB |
|       from large pool |    1236 MB |    1616 MB |    7764 GB |    7763 GB |
|       from small pool |    1706 MB |    1709 MB |     765 GB |     763 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    8491 GB |    8491 GB |
|       from large pool |   19852 KB |     284 MB |    7561 GB |    7561 GB |
|       from small pool |   29962 KB |    1297 MB |     930 GB |     930 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7720 K  |    7706 K  |
|       from large pool |      28    |      36    |    1747 K  |    1747 K  |
|       from small pool |   13002    |   13012    |    5972 K  |    5959 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7720 K  |    7706 K  |
|       from large pool |      28    |      36    |    1747 K  |    1747 K  |
|       from small pool |   13002    |   13012    |    5972 K  |    5959 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4860 K  |    4859 K  |
|       from large pool |       7    |      11    |    1370 K  |    1370 K  |
|       from small pool |     871    |    2600    |    3490 K  |    3489 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 79
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  Device:0
1
tensor([[ 1.5868e-03, -3.4036e-04,  1.7711e-03,  ..., -1.8724e-03,
         -1.8029e-03,  9.8428e-04],
        [ 1.7484e-04, -1.3128e-03, -8.2336e-04,  ..., -7.7717e-04,
          9.3683e-05,  1.0876e-03],
        [ 1.0419e-03, -4.7129e-04,  2.2401e-03,  ..., -1.0718e-03,
         -9.7445e-04, -1.7573e-03],
        ...,
        [ 2.1802e-03, -1.2246e-03, -1.7526e-03,  ..., -1.3062e-03,
          6.5351e-04, -1.8640e-03],
        [ 2.1861e-03, -8.9634e-04,  1.6198e-03,  ..., -2.7605e-04,
          1.8103e-03,  1.7053e-03],
        [-1.5219e-03, -1.8056e-03, -1.7657e-03,  ...,  1.5791e-03,
         -1.3574e-03, -4.2853e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5868e-03, -3.4036e-04,  1.7711e-03,  ..., -1.8724e-03,
         -1.8029e-03,  9.8428e-04],
        [ 1.7484e-04, -1.3128e-03, -8.2336e-04,  ..., -7.7717e-04,
          9.3683e-05,  1.0876e-03],
        [ 1.0419e-03, -4.7129e-04,  2.2401e-03,  ..., -1.0718e-03,
         -9.7445e-04, -1.7573e-03],
        ...,
        [ 2.1802e-03, -1.2246e-03, -1.7526e-03,  ..., -1.3062e-03,
          6.5351e-04, -1.8640e-03],
        [ 2.1861e-03, -8.9634e-04,  1.6198e-03,  ..., -2.7605e-04,
          1.8103e-03,  1.7053e-03],
        [-1.5219e-03, -1.8056e-03, -1.7657e-03,  ...,  1.5791e-03,
         -1.3574e-03, -4.2853e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0062,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    3052 MB |    3434 MB |    8647 GB |    8644 GB |
|       from large pool |    1343 MB |    1723 MB |    7871 GB |    7870 GB |
|       from small pool |    1708 MB |    1710 MB |     775 GB |     773 GB |
|---------------------------------------------------------------------------|
| Active memory         |    3052 MB |    3434 MB |    8647 GB |    8644 GB |
|       from large pool |    1343 MB |    1723 MB |    7871 GB |    7870 GB |
|       from small pool |    1708 MB |    1710 MB |     775 GB |     773 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  186355 KB |    1559 MB |    8643 GB |    8643 GB |
|       from large pool |  157802 KB |     338 MB |    7701 GB |    7701 GB |
|       from small pool |   28552 KB |    1298 MB |     941 GB |     941 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7826 K  |    7813 K  |
|       from large pool |      61    |      69    |    1771 K  |    1771 K  |
|       from small pool |   13012    |   13021    |    6054 K  |    6041 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7826 K  |    7813 K  |
|       from large pool |      61    |      69    |    1771 K  |    1771 K  |
|       from small pool |   13012    |   13021    |    6054 K  |    6041 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     884    |    2614    |    5054 K  |    5053 K  |
|       from large pool |      10    |      14    |    1513 K  |    1513 K  |
|       from small pool |     874    |    2603    |    3540 K  |    3539 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2943 MB |    3325 MB |    8639 GB |    8636 GB |
|       from large pool |    1236 MB |    1616 MB |    7864 GB |    7863 GB |
|       from small pool |    1706 MB |    1709 MB |     775 GB |     773 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2943 MB |    3325 MB |    8639 GB |    8636 GB |
|       from large pool |    1236 MB |    1616 MB |    7864 GB |    7863 GB |
|       from small pool |    1706 MB |    1709 MB |     775 GB |     773 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   49814 KB |    1558 MB |    8600 GB |    8600 GB |
|       from large pool |   19852 KB |     284 MB |    7658 GB |    7658 GB |
|       from small pool |   29962 KB |    1297 MB |     941 GB |     941 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7818 K  |    7805 K  |
|       from large pool |      28    |      36    |    1769 K  |    1769 K  |
|       from small pool |   13002    |   13012    |    6048 K  |    6035 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7818 K  |    7805 K  |
|       from large pool |      28    |      36    |    1769 K  |    1769 K  |
|       from small pool |   13002    |   13012    |    6048 K  |    6035 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     878    |    2607    |    4922 K  |    4921 K  |
|       from large pool |       7    |      11    |    1387 K  |    1387 K  |
|       from small pool |     871    |    2600    |    3534 K  |    3533 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Step: 80
batch input size: torch.Size([27, 1855])batch input size:  Device:torch.Size([27, 1855])  0Device:
 1
tensor([[ 1.5862e-03, -3.4087e-04,  1.7706e-03,  ..., -1.8718e-03,
         -1.8024e-03,  9.8479e-04],
        [ 1.7531e-04, -1.3123e-03, -8.2288e-04,  ..., -7.7764e-04,
          9.3208e-05,  1.0871e-03],
        [ 1.0484e-03, -4.6482e-04,  2.2466e-03,  ..., -1.0782e-03,
         -9.8091e-04, -1.7638e-03],
        ...,
        [ 2.1803e-03, -1.2246e-03, -1.7525e-03,  ..., -1.3063e-03,
          6.5343e-04, -1.8640e-03],
        [ 2.1877e-03, -8.9468e-04,  1.6215e-03,  ..., -2.7771e-04,
          1.8086e-03,  1.7036e-03],
        [-1.5207e-03, -1.8044e-03, -1.7645e-03,  ...,  1.5779e-03,
         -1.3586e-03, -4.2976e-04]], device='cuda:1',
       grad_fn=<BroadcastBackward>)
tensor([[ 1.5862e-03, -3.4087e-04,  1.7706e-03,  ..., -1.8718e-03,
         -1.8024e-03,  9.8479e-04],
        [ 1.7531e-04, -1.3123e-03, -8.2288e-04,  ..., -7.7764e-04,
          9.3208e-05,  1.0871e-03],
        [ 1.0484e-03, -4.6482e-04,  2.2466e-03,  ..., -1.0782e-03,
         -9.8091e-04, -1.7638e-03],
        ...,
        [ 2.1803e-03, -1.2246e-03, -1.7525e-03,  ..., -1.3063e-03,
          6.5343e-04, -1.8640e-03],
        [ 2.1877e-03, -8.9468e-04,  1.6215e-03,  ..., -2.7771e-04,
          1.8086e-03,  1.7036e-03],
        [-1.5207e-03, -1.8044e-03, -1.7645e-03,  ...,  1.5779e-03,
         -1.3586e-03, -4.2976e-04]], device='cuda:0',
       grad_fn=<BroadcastBackward>)
step loss: tensor([0.0208,   -inf], device='cuda:0', grad_fn=<GatherBackward>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2610 MB |    3434 MB |    8755 GB |    8753 GB |
|       from large pool |    1169 MB |    1723 MB |    7971 GB |    7970 GB |
|       from small pool |    1441 MB |    1710 MB |     784 GB |     783 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2610 MB |    3434 MB |    8755 GB |    8753 GB |
|       from large pool |    1169 MB |    1723 MB |    7971 GB |    7970 GB |
|       from small pool |    1441 MB |    1710 MB |     784 GB |     783 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1878 MB |    1878 MB |    1878 MB |       0 B  |
|       from small pool |    1738 MB |    1738 MB |    1738 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  482818 KB |    1559 MB |    8752 GB |    8751 GB |
|       from large pool |  476095 KB |     503 MB |    7799 GB |    7798 GB |
|       from small pool |    6722 KB |    1298 MB |     953 GB |     953 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13073    |   13085    |    7924 K  |    7911 K  |
|       from large pool |      61    |      69    |    1794 K  |    1794 K  |
|       from small pool |   13012    |   13021    |    6130 K  |    6117 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13073    |   13085    |    7924 K  |    7911 K  |
|       from large pool |      61    |      69    |    1794 K  |    1794 K  |
|       from small pool |   13012    |   13021    |    6130 K  |    6117 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      17    |      17    |      17    |       0    |
|       from small pool |     869    |     869    |     869    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     749    |    2614    |    5118 K  |    5117 K  |
|       from large pool |      18    |      19    |    1533 K  |    1533 K  |
|       from small pool |     731    |    2603    |    3584 K  |    3584 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 1                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2501 MB |    3325 MB |    8747 GB |    8745 GB |
|       from large pool |    1061 MB |    1616 MB |    7963 GB |    7962 GB |
|       from small pool |    1440 MB |    1709 MB |     784 GB |     783 GB |
|---------------------------------------------------------------------------|
| Active memory         |    2501 MB |    3325 MB |    8747 GB |    8745 GB |
|       from large pool |    1061 MB |    1616 MB |    7963 GB |    7962 GB |
|       from small pool |    1440 MB |    1709 MB |     784 GB |     783 GB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    3616 MB |    3616 MB |    3616 MB |       0 B  |
|       from large pool |    1880 MB |    1880 MB |    1880 MB |       0 B  |
|       from small pool |    1736 MB |    1736 MB |    1736 MB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |  323602 KB |    1558 MB |    8708 GB |    8708 GB |
|       from large pool |  317734 KB |     348 MB |    7755 GB |    7755 GB |
|       from small pool |    5867 KB |    1297 MB |     953 GB |     953 GB |
|---------------------------------------------------------------------------|
| Allocations           |   13030    |   13043    |    7917 K  |    7904 K  |
|       from large pool |      28    |      36    |    1792 K  |    1792 K  |
|       from small pool |   13002    |   13012    |    6124 K  |    6111 K  |
|---------------------------------------------------------------------------|
| Active allocs         |   13030    |   13043    |    7917 K  |    7904 K  |
|       from large pool |      28    |      36    |    1792 K  |    1792 K  |
|       from small pool |   13002    |   13012    |    6124 K  |    6111 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |     886    |     886    |     886    |       0    |
|       from large pool |      18    |      18    |      18    |       0    |
|       from small pool |     868    |     868    |     868    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |     743    |    2607    |    4984 K  |    4983 K  |
|       from large pool |      15    |      16    |    1405 K  |    1405 K  |
|       from small pool |     728    |    2600    |    3579 K  |    3578 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Traceback (most recent call last):
  File "/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py", line 605, in <module>
    main()
  File "/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py", line 590, in main
    model, epoch_train_loss, epoch_val_loss = train(epochs, dkt_model, train_dataloader, val_dataloader, optimizer, scheduler) # add val_dataloader later
  File "/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py", line 489, in train
    valloss = model(b_input_ids_val, b_labels_val, epoch_i+1)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 168, in forward
    outputs = self.parallel_apply(replicas, inputs, kwargs)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/data_parallel.py", line 178, in parallel_apply
    return parallel_apply(replicas, inputs, kwargs, self.device_ids[:len(replicas)])
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/parallel_apply.py", line 86, in parallel_apply
    output.reraise()
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/_utils.py", line 461, in reraise
    raise exception
RuntimeError: Caught RuntimeError in replica 0 on device 0.
Original Traceback (most recent call last):
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parallel/parallel_apply.py", line 61, in _worker
    output = module(*input, **kwargs)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py", line 312, in forward
    hidden_states = self.gru(input_embed, epoch) # initially hidden_states, _
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py", line 176, in forward
    lower = self.permuted_matrix(epoch, verbose=False) # (PLP')'
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py", line 91, in forward
    print(self.matrix)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/nn/parameter.py", line 61, in __repr__
    return 'Parameter containing:\n' + super(Parameter, self).__repr__()
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/_tensor.py", line 338, in __repr__
    return torch._tensor_str._str(self, tensor_contents=tensor_contents)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/_tensor_str.py", line 481, in _str
    return _str_intern(self, tensor_contents=tensor_contents)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/_tensor_str.py", line 447, in _str_intern
    tensor_str = _tensor_str(self, indent)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/_tensor_str.py", line 270, in _tensor_str
    formatter = _Formatter(get_summarized_data(self) if summarize else self)
  File "/work/nashokkumar_umass_edu/.conda/envs/nistorch/lib/python3.10/site-packages/torch/_tensor_str.py", line 103, in __init__
    nonzero_finite_vals = torch.masked_select(tensor_view, torch.isfinite(tensor_view) & tensor_view.ne(0))
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
  Average training loss: nan
batch input size: batch input size:torch.Size([32, 1855])  torch.Size([32, 1855])Device:  0Device:
 1