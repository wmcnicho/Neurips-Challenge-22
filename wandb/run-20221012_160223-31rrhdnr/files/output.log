/work/nashokkumar_umass_edu/nipschal/Neurips-Challenge-22/predict_graph_embed_mask.py:546: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  labels = torch.tensor(dataset_tensor[:, 1, :].clone().detach(), dtype=torch.long)
PermutedDKT
Number of questions:  20
Number of students:  9
Number of concepts: 52
Using batch size: 64
Using batch size: 64
AFTER LOADING THE MODEL
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|       from large pool |       0 B  |       0 B  |       0 B  |       0 B  |
|       from small pool |  280064 B  |  280064 B  |  280064 B  |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1774 KB |    1987 KB |    1987 KB |  217600 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    1774 KB |    1987 KB |    1987 KB |  217600 B  |
|---------------------------------------------------------------------------|
| Allocations           |      14    |      14    |      14    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |      14    |      14    |      14    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |      14    |      14    |      14    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
Successfull in data prepration!
Successfully loaded the optimizer
======== Epoch 1 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0136, -0.0190,  0.0003,  ...,  0.0433,  0.0381,  0.0397],
        [ 0.0010, -0.0135, -0.0453,  ..., -0.0081,  0.0124,  0.0410],
        [ 0.0331, -0.0087,  0.0067,  ...,  0.0036, -0.0303, -0.0194],
        ...,
        [ 0.0274, -0.0008,  0.0460,  ...,  0.0275,  0.0407, -0.0304],
        [-0.0285, -0.0410,  0.0217,  ..., -0.0182,  0.0050,  0.0400],
        [-0.0398,  0.0070, -0.0124,  ..., -0.0170,  0.0179, -0.0254]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.7034, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    1150 KB |    1517 KB |    1925 KB |     775 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1150 KB |    1517 KB |    1925 KB |     775 KB |
|---------------------------------------------------------------------------|
| Active memory         |    1150 KB |    1517 KB |    1925 KB |     775 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1150 KB |    1517 KB |    1925 KB |     775 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2048 KB |    2048 KB |    2048 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |     898 KB |    1987 KB |    2762 KB |    1864 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |     898 KB |    1987 KB |    2762 KB |    1864 KB |
|---------------------------------------------------------------------------|
| Allocations           |     197    |     208    |     493    |     296    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     197    |     208    |     493    |     296    |
|---------------------------------------------------------------------------|
| Active allocs         |     197    |     208    |     493    |     296    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     197    |     208    |     493    |     296    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       1    |       1    |       1    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       1    |       1    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |       6    |     173    |     168    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       5    |       6    |     173    |     168    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0136, -0.0190,  0.0003,  ...,  0.0433,  0.0381,  0.0396],
        [ 0.0005, -0.0139, -0.0457,  ..., -0.0077,  0.0128,  0.0414],
        [ 0.0334, -0.0085,  0.0070,  ...,  0.0033, -0.0306, -0.0197],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0303],
        [-0.0289, -0.0415,  0.0212,  ..., -0.0177,  0.0054,  0.0404],
        [-0.0394,  0.0074, -0.0120,  ..., -0.0174,  0.0175, -0.0258]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.71
======== Epoch 2 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0136, -0.0190,  0.0003,  ...,  0.0433,  0.0381,  0.0396],
        [ 0.0005, -0.0139, -0.0457,  ..., -0.0077,  0.0128,  0.0414],
        [ 0.0334, -0.0085,  0.0070,  ...,  0.0033, -0.0306, -0.0197],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0303],
        [-0.0289, -0.0415,  0.0212,  ..., -0.0177,  0.0054,  0.0404],
        [-0.0394,  0.0074, -0.0120,  ..., -0.0174,  0.0175, -0.0258]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.7012, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   10639 KB |    8427 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   10639 KB |    8427 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   10639 KB |    8427 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   10639 KB |    8427 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2069 KB |   12451 KB |   10567 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2069 KB |   12451 KB |   10567 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |    2317    |    2064    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    2317    |    2064    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |    2317    |    2064    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    2317    |    2064    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      26    |    1325    |    1317    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       8    |      26    |    1325    |    1317    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0137, -0.0191,  0.0003,  ...,  0.0434,  0.0382,  0.0397],
        [ 0.0002, -0.0143, -0.0460,  ..., -0.0074,  0.0131,  0.0418],
        [ 0.0337, -0.0082,  0.0073,  ...,  0.0030, -0.0308, -0.0199],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0277,  0.0408, -0.0303],
        [-0.0293, -0.0419,  0.0208,  ..., -0.0173,  0.0058,  0.0408],
        [-0.0391,  0.0078, -0.0116,  ..., -0.0178,  0.0171, -0.0261]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.71
======== Epoch 3 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0137, -0.0191,  0.0003,  ...,  0.0434,  0.0382,  0.0397],
        [ 0.0002, -0.0143, -0.0460,  ..., -0.0074,  0.0131,  0.0418],
        [ 0.0337, -0.0082,  0.0073,  ...,  0.0030, -0.0308, -0.0199],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0277,  0.0408, -0.0303],
        [-0.0293, -0.0419,  0.0208,  ..., -0.0173,  0.0058,  0.0408],
        [-0.0391,  0.0078, -0.0116,  ..., -0.0178,  0.0171, -0.0261]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6993, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   18828 KB |   16616 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   18828 KB |   16616 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   18828 KB |   16616 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   18828 KB |   16616 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   24385 KB |   22501 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   24385 KB |   22501 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |    4115    |    3862    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    4115    |    3862    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |    4115    |    3862    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    4115    |    3862    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      26    |    2473    |    2464    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       9    |      26    |    2473    |    2464    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0138, -0.0192,  0.0002,  ...,  0.0435,  0.0383,  0.0398],
        [-0.0002, -0.0146, -0.0464,  ..., -0.0070,  0.0135,  0.0421],
        [ 0.0339, -0.0080,  0.0075,  ...,  0.0028, -0.0311, -0.0202],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0304],
        [-0.0296, -0.0422,  0.0205,  ..., -0.0170,  0.0062,  0.0412],
        [-0.0388,  0.0081, -0.0113,  ..., -0.0181,  0.0168, -0.0265]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.71
======== Epoch 4 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0138, -0.0192,  0.0002,  ...,  0.0435,  0.0383,  0.0398],
        [-0.0002, -0.0146, -0.0464,  ..., -0.0070,  0.0135,  0.0421],
        [ 0.0339, -0.0080,  0.0075,  ...,  0.0028, -0.0311, -0.0202],
        ...,
        [ 0.0272, -0.0010,  0.0458,  ...,  0.0276,  0.0408, -0.0304],
        [-0.0296, -0.0422,  0.0205,  ..., -0.0170,  0.0062,  0.0412],
        [-0.0388,  0.0081, -0.0113,  ..., -0.0181,  0.0168, -0.0265]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6975, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   27017 KB |   24805 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   27017 KB |   24805 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   27017 KB |   24805 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   27017 KB |   24805 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   34446 KB |   32562 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   34446 KB |   32562 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |    5913    |    5660    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    5913    |    5660    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |    5913    |    5660    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    5913    |    5660    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      30    |    3535    |    3526    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       9    |      30    |    3535    |    3526    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-1.3913e-02, -1.9372e-02,  1.4754e-05,  ...,  4.3681e-02,
          3.8448e-02,  3.9945e-02],
        [-4.4931e-04, -1.4903e-02, -4.6654e-02,  ..., -6.7555e-03,
          1.3756e-02,  4.2422e-02],
        [ 3.4178e-02, -7.7192e-03,  7.7672e-03,  ...,  2.5634e-03,
         -3.1326e-02, -2.0442e-02],
        ...,
        [ 2.7315e-02, -9.5407e-04,  4.5921e-02,  ...,  2.7565e-02,
          4.0725e-02, -3.0456e-02],
        [-2.9954e-02, -4.2531e-02,  2.0181e-02,  ..., -1.6686e-02,
          6.5010e-03,  4.1489e-02],
        [-3.8459e-02,  8.3982e-03, -1.1022e-02,  ..., -1.8396e-02,
          1.6480e-02, -2.6764e-02]], device='cuda:0', requires_grad=True)
  Average validation loss: 0.71
======== Epoch 5 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-1.3913e-02, -1.9372e-02,  1.4754e-05,  ...,  4.3681e-02,
          3.8448e-02,  3.9945e-02],
        [-4.4931e-04, -1.4903e-02, -4.6654e-02,  ..., -6.7555e-03,
          1.3756e-02,  4.2422e-02],
        [ 3.4178e-02, -7.7192e-03,  7.7672e-03,  ...,  2.5634e-03,
         -3.1326e-02, -2.0442e-02],
        ...,
        [ 2.7315e-02, -9.5407e-04,  4.5921e-02,  ...,  2.7565e-02,
          4.0725e-02, -3.0456e-02],
        [-2.9954e-02, -4.2531e-02,  2.0181e-02,  ..., -1.6686e-02,
          6.5010e-03,  4.1489e-02],
        [-3.8459e-02,  8.3982e-03, -1.1022e-02,  ..., -1.8396e-02,
          1.6480e-02, -2.6764e-02]], device='cuda:0', requires_grad=True)
step loss: tensor(0.6960, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   35204 KB |   32992 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   35204 KB |   32992 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   35204 KB |   32992 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   35204 KB |   32992 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   46378 KB |   44494 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   46378 KB |   44494 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |    7707    |    7454    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    7707    |    7454    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |    7707    |    7454    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    7707    |    7454    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      30    |    4610    |    4602    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       8    |      30    |    4610    |    4602    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.70
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0141, -0.0195, -0.0001,  ...,  0.0438,  0.0386,  0.0401],
        [-0.0007, -0.0152, -0.0469,  ..., -0.0065,  0.0140,  0.0427],
        [ 0.0344, -0.0075,  0.0080,  ...,  0.0024, -0.0315, -0.0207],
        ...,
        [ 0.0274, -0.0009,  0.0460,  ...,  0.0275,  0.0406, -0.0306],
        [-0.0302, -0.0428,  0.0199,  ..., -0.0164,  0.0068,  0.0418],
        [-0.0382,  0.0087, -0.0108,  ..., -0.0186,  0.0162, -0.0270]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.70
======== Epoch 6 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0141, -0.0195, -0.0001,  ...,  0.0438,  0.0386,  0.0401],
        [-0.0007, -0.0152, -0.0469,  ..., -0.0065,  0.0140,  0.0427],
        [ 0.0344, -0.0075,  0.0080,  ...,  0.0024, -0.0315, -0.0207],
        ...,
        [ 0.0274, -0.0009,  0.0460,  ...,  0.0275,  0.0406, -0.0306],
        [-0.0302, -0.0428,  0.0199,  ..., -0.0164,  0.0068,  0.0418],
        [-0.0382,  0.0087, -0.0108,  ..., -0.0186,  0.0162, -0.0270]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6946, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   43393 KB |   41181 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   43393 KB |   41181 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   43393 KB |   41181 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   43393 KB |   41181 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   56593 KB |   54709 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   56593 KB |   54709 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |    9505    |    9252    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    9505    |    9252    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |    9505    |    9252    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |    9505    |    9252    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      30    |    5745    |    5738    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      30    |    5745    |    5738    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0142, -0.0197, -0.0003,  ...,  0.0440,  0.0387,  0.0402],
        [-0.0009, -0.0154, -0.0471,  ..., -0.0063,  0.0142,  0.0429],
        [ 0.0346, -0.0073,  0.0082,  ...,  0.0022, -0.0317, -0.0208],
        ...,
        [ 0.0275, -0.0008,  0.0461,  ...,  0.0274,  0.0405, -0.0307],
        [-0.0304, -0.0430,  0.0197,  ..., -0.0162,  0.0070,  0.0420],
        [-0.0380,  0.0089, -0.0106,  ..., -0.0189,  0.0160, -0.0272]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.70
======== Epoch 7 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0142, -0.0197, -0.0003,  ...,  0.0440,  0.0387,  0.0402],
        [-0.0009, -0.0154, -0.0471,  ..., -0.0063,  0.0142,  0.0429],
        [ 0.0346, -0.0073,  0.0082,  ...,  0.0022, -0.0317, -0.0208],
        ...,
        [ 0.0275, -0.0008,  0.0461,  ...,  0.0274,  0.0405, -0.0307],
        [-0.0304, -0.0430,  0.0197,  ..., -0.0162,  0.0070,  0.0420],
        [-0.0380,  0.0089, -0.0106,  ..., -0.0189,  0.0160, -0.0272]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6935, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   51582 KB |   49370 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   51582 KB |   49370 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   51582 KB |   49370 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   51582 KB |   49370 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   68527 KB |   66643 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   68527 KB |   66643 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |   11303    |   11050    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |   11303    |   11050    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |   11303    |   11050    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |   11303    |   11050    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      30    |    6896    |    6887    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       9    |      30    |    6896    |    6887    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0143, -0.0198, -0.0004,  ...,  0.0441,  0.0388,  0.0403],
        [-0.0011, -0.0155, -0.0473,  ..., -0.0061,  0.0144,  0.0431],
        [ 0.0347, -0.0072,  0.0083,  ...,  0.0020, -0.0319, -0.0210],
        ...,
        [ 0.0276, -0.0007,  0.0462,  ...,  0.0273,  0.0404, -0.0308],
        [-0.0306, -0.0432,  0.0195,  ..., -0.0160,  0.0072,  0.0422],
        [-0.0378,  0.0090, -0.0104,  ..., -0.0190,  0.0158, -0.0274]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.70
======== Epoch 8 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0143, -0.0198, -0.0004,  ...,  0.0441,  0.0388,  0.0403],
        [-0.0011, -0.0155, -0.0473,  ..., -0.0061,  0.0144,  0.0431],
        [ 0.0347, -0.0072,  0.0083,  ...,  0.0020, -0.0319, -0.0210],
        ...,
        [ 0.0276, -0.0007,  0.0462,  ...,  0.0273,  0.0404, -0.0308],
        [-0.0306, -0.0432,  0.0195,  ..., -0.0160,  0.0072,  0.0422],
        [-0.0378,  0.0090, -0.0104,  ..., -0.0190,  0.0158, -0.0274]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6926, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   59771 KB |   57559 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   59771 KB |   57559 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   59771 KB |   57559 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   59771 KB |   57559 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   78588 KB |   76704 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   78588 KB |   76704 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |   13101    |   12848    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |   13101    |   12848    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |   13101    |   12848    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |   13101    |   12848    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |      31    |    8041    |    8034    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       7    |      31    |    8041    |    8034    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0144, -0.0199, -0.0005,  ...,  0.0442,  0.0389,  0.0404],
        [-0.0012, -0.0157, -0.0474,  ..., -0.0060,  0.0145,  0.0432],
        [ 0.0349, -0.0071,  0.0084,  ...,  0.0019, -0.0320, -0.0211],
        ...,
        [ 0.0277, -0.0006,  0.0463,  ...,  0.0272,  0.0403, -0.0308],
        [-0.0308, -0.0433,  0.0194,  ..., -0.0159,  0.0073,  0.0423],
        [-0.0377,  0.0092, -0.0102,  ..., -0.0192,  0.0157, -0.0275]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.70
======== Epoch 9 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0144, -0.0199, -0.0005,  ...,  0.0442,  0.0389,  0.0404],
        [-0.0012, -0.0157, -0.0474,  ..., -0.0060,  0.0145,  0.0432],
        [ 0.0349, -0.0071,  0.0084,  ...,  0.0019, -0.0320, -0.0211],
        ...,
        [ 0.0277, -0.0006,  0.0463,  ...,  0.0272,  0.0403, -0.0308],
        [-0.0308, -0.0433,  0.0194,  ..., -0.0159,  0.0073,  0.0423],
        [-0.0377,  0.0092, -0.0102,  ..., -0.0192,  0.0157, -0.0275]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6919, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2212 KB |    2580 KB |   67960 KB |   65748 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   67960 KB |   65748 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2212 KB |    2580 KB |   67960 KB |   65748 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2212 KB |    2580 KB |   67960 KB |   65748 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1883 KB |    2370 KB |   90522 KB |   88638 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1883 KB |    2370 KB |   90522 KB |   88638 KB |
|---------------------------------------------------------------------------|
| Allocations           |     253    |     265    |   14899    |   14646    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |   14899    |   14646    |
|---------------------------------------------------------------------------|
| Active allocs         |     253    |     265    |   14899    |   14646    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     253    |     265    |   14899    |   14646    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |      31    |    9162    |    9153    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       9    |      31    |    9162    |    9153    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0145, -0.0199, -0.0005,  ...,  0.0442,  0.0390,  0.0405],
        [-0.0013, -0.0157, -0.0475,  ..., -0.0059,  0.0146,  0.0433],
        [ 0.0349, -0.0070,  0.0085,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0278, -0.0005,  0.0464,  ...,  0.0271,  0.0403, -0.0309],
        [-0.0308, -0.0434,  0.0193,  ..., -0.0158,  0.0074,  0.0424],
        [-0.0376,  0.0093, -0.0102,  ..., -0.0193,  0.0156, -0.0276]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.70
======== Epoch 10 / 10 ========
Training...
Step: 0
batch input size: torch.Size([7, 20]) Device: 0
Parameter containing:
tensor([[-0.0145, -0.0199, -0.0005,  ...,  0.0442,  0.0390,  0.0405],
        [-0.0013, -0.0157, -0.0475,  ..., -0.0059,  0.0146,  0.0433],
        [ 0.0349, -0.0070,  0.0085,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0278, -0.0005,  0.0464,  ...,  0.0271,  0.0403, -0.0309],
        [-0.0308, -0.0434,  0.0193,  ..., -0.0158,  0.0074,  0.0424],
        [-0.0376,  0.0093, -0.0102,  ..., -0.0193,  0.0156, -0.0276]],
       device='cuda:0', requires_grad=True)
step loss: tensor(0.6914, device='cuda:0', grad_fn=<DivBackward0>)
AFTER FORWARD PASS
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2327 KB |    2695 KB |   76264 KB |   73937 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2327 KB |    2695 KB |   76264 KB |   73937 KB |
|---------------------------------------------------------------------------|
| Active memory         |    2327 KB |    2695 KB |   76264 KB |   73937 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2327 KB |    2695 KB |   76264 KB |   73937 KB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    1768 KB |    2370 KB |  100737 KB |   98968 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    1768 KB |    2370 KB |  100737 KB |   98968 KB |
|---------------------------------------------------------------------------|
| Allocations           |     273    |     285    |   16717    |   16444    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     273    |     285    |   16717    |   16444    |
|---------------------------------------------------------------------------|
| Active allocs         |     273    |     285    |   16717    |   16444    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     273    |     285    |   16717    |   16444    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |      31    |   10244    |   10236    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       8    |      31    |   10244    |   10236    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|
  Average training loss: 0.69
batch input size: torch.Size([2, 20]) Device: 0
Parameter containing:
tensor([[-0.0145, -0.0200, -0.0006,  ...,  0.0443,  0.0390,  0.0405],
        [-0.0013, -0.0158, -0.0475,  ..., -0.0059,  0.0146,  0.0433],
        [ 0.0350, -0.0069,  0.0085,  ...,  0.0018, -0.0321, -0.0212],
        ...,
        [ 0.0278, -0.0005,  0.0464,  ...,  0.0271,  0.0403, -0.0309],
        [-0.0309, -0.0435,  0.0192,  ..., -0.0158,  0.0074,  0.0424],
        [-0.0375,  0.0093, -0.0101,  ..., -0.0193,  0.0156, -0.0277]],
       device='cuda:0', requires_grad=True)
  Average validation loss: 0.70
Least Validation loss: 0.7038545608520508